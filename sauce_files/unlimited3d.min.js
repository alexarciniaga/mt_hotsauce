/*! For license information please see unlimited3d.min.js.LICENSE */
var e, t;
(e = window),
  (t = function() {
    return (function(e) {
      var t = {};
      function n(r) {
        if (t[r]) return t[r].exports;
        var i = (t[r] = { i: r, l: !1, exports: {} });
        return e[r].call(i.exports, i, i.exports, n), (i.l = !0), i.exports;
      }
      return (
        (n.m = e),
        (n.c = t),
        (n.d = function(e, t, r) {
          n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r });
        }),
        (n.r = function(e) {
          "undefined" != typeof Symbol &&
            Symbol.toStringTag &&
            Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }),
            Object.defineProperty(e, "__esModule", { value: !0 });
        }),
        (n.t = function(e, t) {
          if ((1 & t && (e = n(e)), 8 & t)) return e;
          if (4 & t && "object" == typeof e && e && e.__esModule) return e;
          var r = Object.create(null);
          if (
            (n.r(r),
            Object.defineProperty(r, "default", { enumerable: !0, value: e }),
            2 & t && "string" != typeof e)
          )
            for (var i in e)
              n.d(
                r,
                i,
                function(t) {
                  return e[t];
                }.bind(null, i)
              );
          return r;
        }),
        (n.n = function(e) {
          var t =
            e && e.__esModule
              ? function() {
                  return e.default;
                }
              : function() {
                  return e;
                };
          return n.d(t, "a", t), t;
        }),
        (n.o = function(e, t) {
          return Object.prototype.hasOwnProperty.call(e, t);
        }),
        (n.p = ""),
        n((n.s = 22))
      );
    })([
      function(e, t, n) {
        "use strict";
        n.r(t);
        var r = {
            100: { title: "Error", message: "Something went wrong!" },
            101: { title: "Error", message: "Bad init data" },
            200: { title: "Error", message: "User fail to login" },
            300: { title: "Error", message: "Unable to load 3D design" },
            301: { title: "Error", message: "Unable to setup 3D design" },
            302: { title: "Error", message: "Field is required" },
            303: { title: "Error", message: "Unable to create entity" },
            304: { title: "Error", message: "Field have to be unique" },
            305: { title: "Error", message: "Fail to parse model" },
            306: { title: "Error", message: "Unable to update entity" },
            307: { title: "Error", message: "Can not save" },
            308: { title: "Error", message: "Field is type is wrong" },
            309: { title: "Error", message: "Wrong reference" },
            400: {
              title: "Error",
              message:
                "Something went wrong. 3D Viewer is not updated properly!"
            }
          },
          i = {
            report(e, t, n, r) {
              var i = this.set(e, n, t, r);
              if (0 !== i.statusCode && 1 !== i.statusCode) throw i;
            },
            info() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              this.report(0, t, e, n);
            },
            setInfo() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              return this.set(0, e, t, n);
            },
            warning() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              this.report(1, t, e, n);
            },
            setWarning() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              return this.set(1, e, t, n);
            },
            standard() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              this.report(2, t, e, n);
            },
            setStandard() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              return this.set(0, e, t, n);
            },
            fatal() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              this.report(3, t, e, n);
            },
            setFatal() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 100,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "";
              return this.set(0, e, t, n);
            },
            set() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : -1,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : null,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : 100,
                i =
                  arguments.length > 3 && void 0 !== arguments[3]
                    ? arguments[3]
                    : "";
              return null != t && t.customError
                ? t
                : {
                    customError: !0,
                    code: n,
                    errorTitle: r[n].title,
                    errorMessage: r[n].message,
                    error: t,
                    reference: i,
                    statusCode: e,
                    status: !1
                  };
            }
          };
        t.default = i;
      },
      function(e, t, n) {
        (function(n) {
          var r,
            i = function() {
              (this._tweens = {}), (this._tweensAddedDuringUpdate = {});
            };
          i.prototype = {
            getAll: function() {
              return Object.keys(this._tweens).map(
                function(e) {
                  return this._tweens[e];
                }.bind(this)
              );
            },
            removeAll: function() {
              this._tweens = {};
            },
            add: function(e) {
              (this._tweens[e.getId()] = e),
                (this._tweensAddedDuringUpdate[e.getId()] = e);
            },
            remove: function(e) {
              delete this._tweens[e.getId()],
                delete this._tweensAddedDuringUpdate[e.getId()];
            },
            update: function(e, t) {
              var n = Object.keys(this._tweens);
              if (0 === n.length) return !1;
              for (e = void 0 !== e ? e : o.now(); n.length > 0; ) {
                this._tweensAddedDuringUpdate = {};
                for (var r = 0; r < n.length; r++) {
                  var i = this._tweens[n[r]];
                  i &&
                    !1 === i.update(e) &&
                    ((i._isPlaying = !1), t || delete this._tweens[n[r]]);
                }
                n = Object.keys(this._tweensAddedDuringUpdate);
              }
              return !0;
            }
          };
          var a,
            o = new i();
          (o.Group = i),
            (o._nextId = 0),
            (o.nextId = function() {
              return o._nextId++;
            }),
            "undefined" == typeof self && void 0 !== n && n.hrtime
              ? (o.now = function() {
                  var e = n.hrtime();
                  return 1e3 * e[0] + e[1] / 1e6;
                })
              : "undefined" != typeof self &&
                void 0 !== self.performance &&
                void 0 !== self.performance.now
              ? (o.now = self.performance.now.bind(self.performance))
              : void 0 !== Date.now
              ? (o.now = Date.now)
              : (o.now = function() {
                  return new Date().getTime();
                }),
            (o.Tween = function(e, t) {
              (this._object = e),
                (this._valuesStart = {}),
                (this._valuesEnd = {}),
                (this._valuesStartRepeat = {}),
                (this._duration = 1e3),
                (this._repeat = 0),
                (this._repeatDelayTime = void 0),
                (this._yoyo = !1),
                (this._isPlaying = !1),
                (this._reversed = !1),
                (this._delayTime = 0),
                (this._startTime = null),
                (this._easingFunction = o.Easing.Linear.None),
                (this._interpolationFunction = o.Interpolation.Linear),
                (this._chainedTweens = []),
                (this._onStartCallback = null),
                (this._onStartCallbackFired = !1),
                (this._onUpdateCallback = null),
                (this._onRepeatCallback = null),
                (this._onCompleteCallback = null),
                (this._onStopCallback = null),
                (this._group = t || o),
                (this._id = o.nextId());
            }),
            (o.Tween.prototype = {
              getId: function() {
                return this._id;
              },
              isPlaying: function() {
                return this._isPlaying;
              },
              to: function(e, t) {
                return (
                  (this._valuesEnd = Object.create(e)),
                  void 0 !== t && (this._duration = t),
                  this
                );
              },
              duration: function(e) {
                return (this._duration = e), this;
              },
              start: function(e) {
                for (var t in (this._group.add(this),
                (this._isPlaying = !0),
                (this._onStartCallbackFired = !1),
                (this._startTime =
                  void 0 !== e
                    ? "string" == typeof e
                      ? o.now() + parseFloat(e)
                      : e
                    : o.now()),
                (this._startTime += this._delayTime),
                this._valuesEnd)) {
                  if (this._valuesEnd[t] instanceof Array) {
                    if (0 === this._valuesEnd[t].length) continue;
                    this._valuesEnd[t] = [this._object[t]].concat(
                      this._valuesEnd[t]
                    );
                  }
                  void 0 !== this._object[t] &&
                    ((this._valuesStart[t] = this._object[t]),
                    this._valuesStart[t] instanceof Array == 0 &&
                      (this._valuesStart[t] *= 1),
                    (this._valuesStartRepeat[t] = this._valuesStart[t] || 0));
                }
                return this;
              },
              stop: function() {
                return this._isPlaying
                  ? (this._group.remove(this),
                    (this._isPlaying = !1),
                    null !== this._onStopCallback &&
                      this._onStopCallback(this._object),
                    this.stopChainedTweens(),
                    this)
                  : this;
              },
              end: function() {
                return this.update(1 / 0), this;
              },
              stopChainedTweens: function() {
                for (var e = 0, t = this._chainedTweens.length; e < t; e++)
                  this._chainedTweens[e].stop();
              },
              group: function(e) {
                return (this._group = e), this;
              },
              delay: function(e) {
                return (this._delayTime = e), this;
              },
              repeat: function(e) {
                return (this._repeat = e), this;
              },
              repeatDelay: function(e) {
                return (this._repeatDelayTime = e), this;
              },
              yoyo: function(e) {
                return (this._yoyo = e), this;
              },
              easing: function(e) {
                return (this._easingFunction = e), this;
              },
              interpolation: function(e) {
                return (this._interpolationFunction = e), this;
              },
              chain: function() {
                return (this._chainedTweens = arguments), this;
              },
              onStart: function(e) {
                return (this._onStartCallback = e), this;
              },
              onUpdate: function(e) {
                return (this._onUpdateCallback = e), this;
              },
              onRepeat: function(e) {
                return (this._onRepeatCallback = e), this;
              },
              onComplete: function(e) {
                return (this._onCompleteCallback = e), this;
              },
              onStop: function(e) {
                return (this._onStopCallback = e), this;
              },
              update: function(e) {
                var t, n, r;
                if (e < this._startTime) return !0;
                for (t in (!1 === this._onStartCallbackFired &&
                  (null !== this._onStartCallback &&
                    this._onStartCallback(this._object),
                  (this._onStartCallbackFired = !0)),
                (n = (e - this._startTime) / this._duration),
                (n = 0 === this._duration || n > 1 ? 1 : n),
                (r = this._easingFunction(n)),
                this._valuesEnd))
                  if (void 0 !== this._valuesStart[t]) {
                    var i = this._valuesStart[t] || 0,
                      a = this._valuesEnd[t];
                    a instanceof Array
                      ? (this._object[t] = this._interpolationFunction(a, r))
                      : ("string" == typeof a &&
                          (a =
                            "+" === a.charAt(0) || "-" === a.charAt(0)
                              ? i + parseFloat(a)
                              : parseFloat(a)),
                        "number" == typeof a &&
                          (this._object[t] = i + (a - i) * r));
                  }
                if (
                  (null !== this._onUpdateCallback &&
                    this._onUpdateCallback(this._object, n),
                  1 === n)
                ) {
                  if (this._repeat > 0) {
                    for (t in (isFinite(this._repeat) && this._repeat--,
                    this._valuesStartRepeat)) {
                      if (
                        ("string" == typeof this._valuesEnd[t] &&
                          (this._valuesStartRepeat[t] =
                            this._valuesStartRepeat[t] +
                            parseFloat(this._valuesEnd[t])),
                        this._yoyo)
                      ) {
                        var o = this._valuesStartRepeat[t];
                        (this._valuesStartRepeat[t] = this._valuesEnd[t]),
                          (this._valuesEnd[t] = o);
                      }
                      this._valuesStart[t] = this._valuesStartRepeat[t];
                    }
                    return (
                      this._yoyo && (this._reversed = !this._reversed),
                      void 0 !== this._repeatDelayTime
                        ? (this._startTime = e + this._repeatDelayTime)
                        : (this._startTime = e + this._delayTime),
                      null !== this._onRepeatCallback &&
                        this._onRepeatCallback(this._object),
                      !0
                    );
                  }
                  null !== this._onCompleteCallback &&
                    this._onCompleteCallback(this._object);
                  for (var s = 0, l = this._chainedTweens.length; s < l; s++)
                    this._chainedTweens[s].start(
                      this._startTime + this._duration
                    );
                  return !1;
                }
                return !0;
              }
            }),
            (o.Easing = {
              Linear: {
                None: function(e) {
                  return e;
                }
              },
              Quadratic: {
                In: function(e) {
                  return e * e;
                },
                Out: function(e) {
                  return e * (2 - e);
                },
                InOut: function(e) {
                  return (e *= 2) < 1
                    ? 0.5 * e * e
                    : -0.5 * (--e * (e - 2) - 1);
                }
              },
              Cubic: {
                In: function(e) {
                  return e * e * e;
                },
                Out: function(e) {
                  return --e * e * e + 1;
                },
                InOut: function(e) {
                  return (e *= 2) < 1
                    ? 0.5 * e * e * e
                    : 0.5 * ((e -= 2) * e * e + 2);
                }
              },
              Quartic: {
                In: function(e) {
                  return e * e * e * e;
                },
                Out: function(e) {
                  return 1 - --e * e * e * e;
                },
                InOut: function(e) {
                  return (e *= 2) < 1
                    ? 0.5 * e * e * e * e
                    : -0.5 * ((e -= 2) * e * e * e - 2);
                }
              },
              Quintic: {
                In: function(e) {
                  return e * e * e * e * e;
                },
                Out: function(e) {
                  return --e * e * e * e * e + 1;
                },
                InOut: function(e) {
                  return (e *= 2) < 1
                    ? 0.5 * e * e * e * e * e
                    : 0.5 * ((e -= 2) * e * e * e * e + 2);
                }
              },
              Sinusoidal: {
                In: function(e) {
                  return 1 - Math.cos((e * Math.PI) / 2);
                },
                Out: function(e) {
                  return Math.sin((e * Math.PI) / 2);
                },
                InOut: function(e) {
                  return 0.5 * (1 - Math.cos(Math.PI * e));
                }
              },
              Exponential: {
                In: function(e) {
                  return 0 === e ? 0 : Math.pow(1024, e - 1);
                },
                Out: function(e) {
                  return 1 === e ? 1 : 1 - Math.pow(2, -10 * e);
                },
                InOut: function(e) {
                  return 0 === e
                    ? 0
                    : 1 === e
                    ? 1
                    : (e *= 2) < 1
                    ? 0.5 * Math.pow(1024, e - 1)
                    : 0.5 * (2 - Math.pow(2, -10 * (e - 1)));
                }
              },
              Circular: {
                In: function(e) {
                  return 1 - Math.sqrt(1 - e * e);
                },
                Out: function(e) {
                  return Math.sqrt(1 - --e * e);
                },
                InOut: function(e) {
                  return (e *= 2) < 1
                    ? -0.5 * (Math.sqrt(1 - e * e) - 1)
                    : 0.5 * (Math.sqrt(1 - (e -= 2) * e) + 1);
                }
              },
              Elastic: {
                In: function(e) {
                  return 0 === e
                    ? 0
                    : 1 === e
                    ? 1
                    : -Math.pow(2, 10 * (e - 1)) *
                      Math.sin(5 * (e - 1.1) * Math.PI);
                },
                Out: function(e) {
                  return 0 === e
                    ? 0
                    : 1 === e
                    ? 1
                    : Math.pow(2, -10 * e) * Math.sin(5 * (e - 0.1) * Math.PI) +
                      1;
                },
                InOut: function(e) {
                  return 0 === e
                    ? 0
                    : 1 === e
                    ? 1
                    : (e *= 2) < 1
                    ? -0.5 *
                      Math.pow(2, 10 * (e - 1)) *
                      Math.sin(5 * (e - 1.1) * Math.PI)
                    : 0.5 *
                        Math.pow(2, -10 * (e - 1)) *
                        Math.sin(5 * (e - 1.1) * Math.PI) +
                      1;
                }
              },
              Back: {
                In: function(e) {
                  var t = 1.70158;
                  return e * e * ((t + 1) * e - t);
                },
                Out: function(e) {
                  var t = 1.70158;
                  return --e * e * ((t + 1) * e + t) + 1;
                },
                InOut: function(e) {
                  var t = 2.5949095;
                  return (e *= 2) < 1
                    ? e * e * ((t + 1) * e - t) * 0.5
                    : 0.5 * ((e -= 2) * e * ((t + 1) * e + t) + 2);
                }
              },
              Bounce: {
                In: function(e) {
                  return 1 - o.Easing.Bounce.Out(1 - e);
                },
                Out: function(e) {
                  return e < 1 / 2.75
                    ? 7.5625 * e * e
                    : e < 2 / 2.75
                    ? 7.5625 * (e -= 1.5 / 2.75) * e + 0.75
                    : e < 2.5 / 2.75
                    ? 7.5625 * (e -= 2.25 / 2.75) * e + 0.9375
                    : 7.5625 * (e -= 2.625 / 2.75) * e + 0.984375;
                },
                InOut: function(e) {
                  return e < 0.5
                    ? 0.5 * o.Easing.Bounce.In(2 * e)
                    : 0.5 * o.Easing.Bounce.Out(2 * e - 1) + 0.5;
                }
              }
            }),
            (o.Interpolation = {
              Linear: function(e, t) {
                var n = e.length - 1,
                  r = n * t,
                  i = Math.floor(r),
                  a = o.Interpolation.Utils.Linear;
                return t < 0
                  ? a(e[0], e[1], r)
                  : t > 1
                  ? a(e[n], e[n - 1], n - r)
                  : a(e[i], e[i + 1 > n ? n : i + 1], r - i);
              },
              Bezier: function(e, t) {
                for (
                  var n = 0,
                    r = e.length - 1,
                    i = Math.pow,
                    a = o.Interpolation.Utils.Bernstein,
                    s = 0;
                  s <= r;
                  s++
                )
                  n += i(1 - t, r - s) * i(t, s) * e[s] * a(r, s);
                return n;
              },
              CatmullRom: function(e, t) {
                var n = e.length - 1,
                  r = n * t,
                  i = Math.floor(r),
                  a = o.Interpolation.Utils.CatmullRom;
                return e[0] === e[n]
                  ? (t < 0 && (i = Math.floor((r = n * (1 + t)))),
                    a(
                      e[(i - 1 + n) % n],
                      e[i],
                      e[(i + 1) % n],
                      e[(i + 2) % n],
                      r - i
                    ))
                  : t < 0
                  ? e[0] - (a(e[0], e[0], e[1], e[1], -r) - e[0])
                  : t > 1
                  ? e[n] - (a(e[n], e[n], e[n - 1], e[n - 1], r - n) - e[n])
                  : a(
                      e[i ? i - 1 : 0],
                      e[i],
                      e[n < i + 1 ? n : i + 1],
                      e[n < i + 2 ? n : i + 2],
                      r - i
                    );
              },
              Utils: {
                Linear: function(e, t, n) {
                  return (t - e) * n + e;
                },
                Bernstein: function(e, t) {
                  var n = o.Interpolation.Utils.Factorial;
                  return n(e) / n(t) / n(e - t);
                },
                Factorial:
                  ((a = [1]),
                  function(e) {
                    var t = 1;
                    if (a[e]) return a[e];
                    for (var n = e; n > 1; n--) t *= n;
                    return (a[e] = t), t;
                  }),
                CatmullRom: function(e, t, n, r, i) {
                  var a = 0.5 * (n - e),
                    o = 0.5 * (r - t),
                    s = i * i;
                  return (
                    (2 * t - 2 * n + a + o) * (i * s) +
                    (-3 * t + 3 * n - 2 * a - o) * s +
                    a * i +
                    t
                  );
                }
              }
            }),
            void 0 ===
              (r = function() {
                return o;
              }.apply(t, [])) || (e.exports = r);
        }.call(this, n(11)));
      },
      function(e, t, n) {
        var r = n(43),
          i = n(44),
          a = i;
        (a.v1 = r), (a.v4 = i), (e.exports = a);
      },
      function(e, t, n) {
        "use strict";
        var r = n(10),
          i = n(24),
          a = Object.prototype.toString;
        function o(e) {
          return "[object Array]" === a.call(e);
        }
        function s(e) {
          return null !== e && "object" == typeof e;
        }
        function l(e) {
          return "[object Function]" === a.call(e);
        }
        function c(e, t) {
          if (null != e)
            if (("object" != typeof e && (e = [e]), o(e)))
              for (var n = 0, r = e.length; n < r; n++)
                t.call(null, e[n], n, e);
            else
              for (var i in e)
                Object.prototype.hasOwnProperty.call(e, i) &&
                  t.call(null, e[i], i, e);
        }
        e.exports = {
          isArray: o,
          isArrayBuffer: function(e) {
            return "[object ArrayBuffer]" === a.call(e);
          },
          isBuffer: i,
          isFormData: function(e) {
            return "undefined" != typeof FormData && e instanceof FormData;
          },
          isArrayBufferView: function(e) {
            return "undefined" != typeof ArrayBuffer && ArrayBuffer.isView
              ? ArrayBuffer.isView(e)
              : e && e.buffer && e.buffer instanceof ArrayBuffer;
          },
          isString: function(e) {
            return "string" == typeof e;
          },
          isNumber: function(e) {
            return "number" == typeof e;
          },
          isObject: s,
          isUndefined: function(e) {
            return void 0 === e;
          },
          isDate: function(e) {
            return "[object Date]" === a.call(e);
          },
          isFile: function(e) {
            return "[object File]" === a.call(e);
          },
          isBlob: function(e) {
            return "[object Blob]" === a.call(e);
          },
          isFunction: l,
          isStream: function(e) {
            return s(e) && l(e.pipe);
          },
          isURLSearchParams: function(e) {
            return (
              "undefined" != typeof URLSearchParams &&
              e instanceof URLSearchParams
            );
          },
          isStandardBrowserEnv: function() {
            return (
              ("undefined" == typeof navigator ||
                "ReactNative" !== navigator.product) &&
              "undefined" != typeof window &&
              "undefined" != typeof document
            );
          },
          forEach: c,
          merge: function e() {
            var t = {};
            function n(n, r) {
              "object" == typeof t[r] && "object" == typeof n
                ? (t[r] = e(t[r], n))
                : (t[r] = n);
            }
            for (var r = 0, i = arguments.length; r < i; r++)
              c(arguments[r], n);
            return t;
          },
          extend: function(e, t, n) {
            return (
              c(t, function(t, i) {
                e[i] = n && "function" == typeof t ? r(t, n) : t;
              }),
              e
            );
          },
          trim: function(e) {
            return e.replace(/^\s*/, "").replace(/\s*$/, "");
          }
        };
      },
      function(e, t, n) {
        var r, i, a;
        !(function(n, o) {
          "use strict";
          "object" == typeof e.exports
            ? (e.exports = o())
            : ((i = []),
              void 0 ===
                (a = "function" == typeof (r = o) ? r.apply(t, i) : r) ||
                (e.exports = a));
        })(0, function() {
          "use strict";
          var e = Object.prototype.toString;
          function t(e, t) {
            return null != e && Object.prototype.hasOwnProperty.call(e, t);
          }
          function n(e) {
            if (!e) return !0;
            if (i(e) && 0 === e.length) return !0;
            if ("string" != typeof e) {
              for (var n in e) if (t(e, n)) return !1;
              return !0;
            }
            return !1;
          }
          function r(t) {
            return e.call(t);
          }
          var i =
            Array.isArray ||
            function(t) {
              return "[object Array]" === e.call(t);
            };
          function a(e) {
            var t = parseInt(e);
            return t.toString() === e ? t : e;
          }
          function o(e) {
            e = e || {};
            var o = function(e) {
              return Object.keys(o).reduce(function(t, n) {
                return "create" === n
                  ? t
                  : ("function" == typeof o[n] && (t[n] = o[n].bind(o, e)), t);
              }, {});
            };
            function s(n, r) {
              return (
                e.includeInheritedProps ||
                ("number" == typeof r && Array.isArray(n)) ||
                t(n, r)
              );
            }
            function l(e, t) {
              if (s(e, t)) return e[t];
            }
            function c(e, t, n, r) {
              if (("number" == typeof t && (t = [t]), !t || 0 === t.length))
                return e;
              if ("string" == typeof t) return c(e, t.split(".").map(a), n, r);
              var i = t[0],
                o = l(e, i);
              return 1 === t.length
                ? ((void 0 !== o && r) || (e[i] = n), o)
                : (void 0 === o &&
                    ("number" == typeof t[1] ? (e[i] = []) : (e[i] = {})),
                  c(e[i], t.slice(1), n, r));
            }
            return (
              (o.has = function(n, r) {
                if (
                  ("number" == typeof r
                    ? (r = [r])
                    : "string" == typeof r && (r = r.split(".")),
                  !r || 0 === r.length)
                )
                  return !!n;
                for (var o = 0; o < r.length; o++) {
                  var s = a(r[o]);
                  if (
                    !(
                      ("number" == typeof s && i(n) && s < n.length) ||
                      (e.includeInheritedProps ? s in Object(n) : t(n, s))
                    )
                  )
                    return !1;
                  n = n[s];
                }
                return !0;
              }),
              (o.ensureExists = function(e, t, n) {
                return c(e, t, n, !0);
              }),
              (o.set = function(e, t, n, r) {
                return c(e, t, n, r);
              }),
              (o.insert = function(e, t, n, r) {
                var a = o.get(e, t);
                (r = ~~r),
                  i(a) || ((a = []), o.set(e, t, a)),
                  a.splice(r, 0, n);
              }),
              (o.empty = function(e, t) {
                var a, l;
                if (!n(t) && null != e && (a = o.get(e, t))) {
                  if ("string" == typeof a) return o.set(e, t, "");
                  if (
                    (function(e) {
                      return (
                        "boolean" == typeof e || "[object Boolean]" === r(e)
                      );
                    })(a)
                  )
                    return o.set(e, t, !1);
                  if ("number" == typeof a) return o.set(e, t, 0);
                  if (i(a)) a.length = 0;
                  else {
                    if (
                      !(function(e) {
                        return (
                          "object" == typeof e && "[object Object]" === r(e)
                        );
                      })(a)
                    )
                      return o.set(e, t, null);
                    for (l in a) s(a, l) && delete a[l];
                  }
                }
              }),
              (o.push = function(e, t) {
                var n = o.get(e, t);
                i(n) || ((n = []), o.set(e, t, n)),
                  n.push.apply(n, Array.prototype.slice.call(arguments, 2));
              }),
              (o.coalesce = function(e, t, n) {
                for (var r, i = 0, a = t.length; i < a; i++)
                  if (void 0 !== (r = o.get(e, t[i]))) return r;
                return n;
              }),
              (o.get = function(e, t, n) {
                if (("number" == typeof t && (t = [t]), !t || 0 === t.length))
                  return e;
                if (null == e) return n;
                if ("string" == typeof t) return o.get(e, t.split("."), n);
                var r = a(t[0]),
                  i = l(e, r);
                return void 0 === i
                  ? n
                  : 1 === t.length
                  ? i
                  : o.get(e[r], t.slice(1), n);
              }),
              (o.del = function(e, t) {
                if (("number" == typeof t && (t = [t]), null == e)) return e;
                if (n(t)) return e;
                if ("string" == typeof t) return o.del(e, t.split("."));
                var r = a(t[0]);
                return s(e, r)
                  ? 1 !== t.length
                    ? o.del(e[r], t.slice(1))
                    : (i(e) ? e.splice(r, 1) : delete e[r], e)
                  : e;
              }),
              o
            );
          }
          var s = o();
          return (
            (s.create = o),
            (s.withInheritedProps = o({ includeInheritedProps: !0 })),
            s
          );
        });
      },
      function(e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, "__DO_NOT_USE__ActionTypes", function() {
            return a;
          }),
          n.d(t, "applyMiddleware", function() {
            return v;
          }),
          n.d(t, "bindActionCreators", function() {
            return h;
          }),
          n.d(t, "combineReducers", function() {
            return c;
          }),
          n.d(t, "compose", function() {
            return m;
          }),
          n.d(t, "createStore", function() {
            return s;
          });
        var r = n(9),
          i = function() {
            return Math.random()
              .toString(36)
              .substring(7)
              .split("")
              .join(".");
          },
          a = {
            INIT: "@@redux/INIT" + i(),
            REPLACE: "@@redux/REPLACE" + i(),
            PROBE_UNKNOWN_ACTION: function() {
              return "@@redux/PROBE_UNKNOWN_ACTION" + i();
            }
          };
        function o(e) {
          if ("object" != typeof e || null === e) return !1;
          for (var t = e; null !== Object.getPrototypeOf(t); )
            t = Object.getPrototypeOf(t);
          return Object.getPrototypeOf(e) === t;
        }
        function s(e, t, n) {
          var i;
          if (
            ("function" == typeof t && "function" == typeof n) ||
            ("function" == typeof n && "function" == typeof arguments[3])
          )
            throw new Error(
              "It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function."
            );
          if (
            ("function" == typeof t && void 0 === n && ((n = t), (t = void 0)),
            void 0 !== n)
          ) {
            if ("function" != typeof n)
              throw new Error("Expected the enhancer to be a function.");
            return n(s)(e, t);
          }
          if ("function" != typeof e)
            throw new Error("Expected the reducer to be a function.");
          var l = e,
            c = t,
            u = [],
            h = u,
            d = !1;
          function p() {
            h === u && (h = u.slice());
          }
          function f() {
            if (d)
              throw new Error(
                "You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store."
              );
            return c;
          }
          function m(e) {
            if ("function" != typeof e)
              throw new Error("Expected the listener to be a function.");
            if (d)
              throw new Error(
                "You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details."
              );
            var t = !0;
            return (
              p(),
              h.push(e),
              function() {
                if (t) {
                  if (d)
                    throw new Error(
                      "You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details."
                    );
                  (t = !1), p();
                  var n = h.indexOf(e);
                  h.splice(n, 1);
                }
              }
            );
          }
          function v(e) {
            if (!o(e))
              throw new Error(
                "Actions must be plain objects. Use custom middleware for async actions."
              );
            if (void 0 === e.type)
              throw new Error(
                'Actions may not have an undefined "type" property. Have you misspelled a constant?'
              );
            if (d) throw new Error("Reducers may not dispatch actions.");
            try {
              (d = !0), (c = l(c, e));
            } finally {
              d = !1;
            }
            for (var t = (u = h), n = 0; n < t.length; n++) (0, t[n])();
            return e;
          }
          return (
            v({ type: a.INIT }),
            ((i = {
              dispatch: v,
              subscribe: m,
              getState: f,
              replaceReducer: function(e) {
                if ("function" != typeof e)
                  throw new Error("Expected the nextReducer to be a function.");
                (l = e), v({ type: a.REPLACE });
              }
            })[r.a] = function() {
              var e,
                t = m;
              return (
                ((e = {
                  subscribe: function(e) {
                    if ("object" != typeof e || null === e)
                      throw new TypeError(
                        "Expected the observer to be an object."
                      );
                    function n() {
                      e.next && e.next(f());
                    }
                    return n(), { unsubscribe: t(n) };
                  }
                })[r.a] = function() {
                  return this;
                }),
                e
              );
            }),
            i
          );
        }
        function l(e, t) {
          var n = t && t.type;
          return (
            "Given " +
            ((n && 'action "' + String(n) + '"') || "an action") +
            ', reducer "' +
            e +
            '" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'
          );
        }
        function c(e) {
          for (var t = Object.keys(e), n = {}, r = 0; r < t.length; r++) {
            var i = t[r];
            "function" == typeof e[i] && (n[i] = e[i]);
          }
          var o,
            s = Object.keys(n);
          try {
            !(function(e) {
              Object.keys(e).forEach(function(t) {
                var n = e[t];
                if (void 0 === n(void 0, { type: a.INIT }))
                  throw new Error(
                    'Reducer "' +
                      t +
                      "\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined."
                  );
                if (void 0 === n(void 0, { type: a.PROBE_UNKNOWN_ACTION() }))
                  throw new Error(
                    'Reducer "' +
                      t +
                      "\" returned undefined when probed with a random type. Don't try to handle " +
                      a.INIT +
                      ' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.'
                  );
              });
            })(n);
          } catch (e) {
            o = e;
          }
          return function(e, t) {
            if ((void 0 === e && (e = {}), o)) throw o;
            for (var r = !1, i = {}, a = 0; a < s.length; a++) {
              var c = s[a],
                u = n[c],
                h = e[c],
                d = u(h, t);
              if (void 0 === d) {
                var p = l(c, t);
                throw new Error(p);
              }
              (i[c] = d), (r = r || d !== h);
            }
            return r ? i : e;
          };
        }
        function u(e, t) {
          return function() {
            return t(e.apply(this, arguments));
          };
        }
        function h(e, t) {
          if ("function" == typeof e) return u(e, t);
          if ("object" != typeof e || null === e)
            throw new Error(
              "bindActionCreators expected an object or a function, instead received " +
                (null === e ? "null" : typeof e) +
                '. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?'
            );
          var n = {};
          for (var r in e) {
            var i = e[r];
            "function" == typeof i && (n[r] = u(i, t));
          }
          return n;
        }
        function d(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function p(e, t) {
          var n = Object.keys(e);
          return (
            Object.getOwnPropertySymbols &&
              n.push.apply(n, Object.getOwnPropertySymbols(e)),
            t &&
              (n = n.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
            n
          );
        }
        function f(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? p(n, !0).forEach(function(t) {
                  d(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : p(n).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function m() {
          for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++)
            t[n] = arguments[n];
          return 0 === t.length
            ? function(e) {
                return e;
              }
            : 1 === t.length
            ? t[0]
            : t.reduce(function(e, t) {
                return function() {
                  return e(t.apply(void 0, arguments));
                };
              });
        }
        function v() {
          for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++)
            t[n] = arguments[n];
          return function(e) {
            return function() {
              var n = e.apply(void 0, arguments),
                r = function() {
                  throw new Error(
                    "Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch."
                  );
                },
                i = {
                  getState: n.getState,
                  dispatch: function() {
                    return r.apply(void 0, arguments);
                  }
                },
                a = t.map(function(e) {
                  return e(i);
                });
              return f({}, n, {
                dispatch: (r = m.apply(void 0, a)(n.dispatch))
              });
            };
          };
        }
      },
      function(e, t, n) {
        e.exports = n(23);
      },
      function(e, t, n) {
        e.exports = (function() {
          "use strict";
          var e = function(e) {
              return (
                (function(e) {
                  return !!e && "object" == typeof e;
                })(e) &&
                !(function(e) {
                  var n = Object.prototype.toString.call(e);
                  return (
                    "[object RegExp]" === n ||
                    "[object Date]" === n ||
                    (function(e) {
                      return e.$$typeof === t;
                    })(e)
                  );
                })(e)
              );
            },
            t =
              "function" == typeof Symbol && Symbol.for
                ? Symbol.for("react.element")
                : 60103;
          function n(e, t) {
            return !1 !== t.clone && t.isMergeableObject(e)
              ? o(((n = e), Array.isArray(n) ? [] : {}), e, t)
              : e;
            var n;
          }
          function r(e, t, r) {
            return e.concat(t).map(function(e) {
              return n(e, r);
            });
          }
          function i(e) {
            return Object.keys(e).concat(
              (function(e) {
                return Object.getOwnPropertySymbols
                  ? Object.getOwnPropertySymbols(e).filter(function(t) {
                      return e.propertyIsEnumerable(t);
                    })
                  : [];
              })(e)
            );
          }
          function a(e, t, r) {
            var a = {};
            return (
              r.isMergeableObject(e) &&
                i(e).forEach(function(t) {
                  a[t] = n(e[t], r);
                }),
              i(t).forEach(function(i) {
                r.isMergeableObject(t[i]) && e[i]
                  ? (a[i] = (function(e, t) {
                      if (!t.customMerge) return o;
                      var n = t.customMerge(e);
                      return "function" == typeof n ? n : o;
                    })(i, r)(e[i], t[i], r))
                  : (a[i] = n(t[i], r));
              }),
              a
            );
          }
          function o(t, i, o) {
            ((o = o || {}).arrayMerge = o.arrayMerge || r),
              (o.isMergeableObject = o.isMergeableObject || e);
            var s = Array.isArray(i);
            return s === Array.isArray(t)
              ? s
                ? o.arrayMerge(t, i, o)
                : a(t, i, o)
              : n(i, o);
          }
          return (
            (o.all = function(e, t) {
              if (!Array.isArray(e))
                throw new Error("first argument should be an array");
              return e.reduce(function(e, n) {
                return o(e, n, t);
              }, {});
            }),
            o
          );
        })();
      },
      function(e, t, n) {
        "use strict";
        (function(t) {
          var r = n(3),
            i = n(26),
            a = { "Content-Type": "application/x-www-form-urlencoded" };
          function o(e, t) {
            !r.isUndefined(e) &&
              r.isUndefined(e["Content-Type"]) &&
              (e["Content-Type"] = t);
          }
          var s,
            l = {
              adapter:
                ("undefined" != typeof XMLHttpRequest
                  ? (s = n(12))
                  : void 0 !== t && (s = n(12)),
                s),
              transformRequest: [
                function(e, t) {
                  return (
                    i(t, "Content-Type"),
                    r.isFormData(e) ||
                    r.isArrayBuffer(e) ||
                    r.isBuffer(e) ||
                    r.isStream(e) ||
                    r.isFile(e) ||
                    r.isBlob(e)
                      ? e
                      : r.isArrayBufferView(e)
                      ? e.buffer
                      : r.isURLSearchParams(e)
                      ? (o(
                          t,
                          "application/x-www-form-urlencoded;charset=utf-8"
                        ),
                        e.toString())
                      : r.isObject(e)
                      ? (o(t, "application/json;charset=utf-8"),
                        JSON.stringify(e))
                      : e
                  );
                }
              ],
              transformResponse: [
                function(e) {
                  if ("string" == typeof e)
                    try {
                      e = JSON.parse(e);
                    } catch (e) {}
                  return e;
                }
              ],
              timeout: 0,
              xsrfCookieName: "XSRF-TOKEN",
              xsrfHeaderName: "X-XSRF-TOKEN",
              maxContentLength: -1,
              validateStatus: function(e) {
                return e >= 200 && e < 300;
              },
              headers: {
                common: { Accept: "application/json, text/plain, */*" }
              }
            };
          r.forEach(["delete", "get", "head"], function(e) {
            l.headers[e] = {};
          }),
            r.forEach(["post", "put", "patch"], function(e) {
              l.headers[e] = r.merge(a);
            }),
            (e.exports = l);
        }.call(this, n(11)));
      },
      function(e, t, n) {
        "use strict";
        (function(e, r) {
          var i,
            a = n(18);
          i =
            "undefined" != typeof self
              ? self
              : "undefined" != typeof window
              ? window
              : void 0 !== e
              ? e
              : r;
          var o = Object(a.a)(i);
          t.a = o;
        }.call(this, n(41), n(42)(e)));
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e, t) {
          return function() {
            for (var n = new Array(arguments.length), r = 0; r < n.length; r++)
              n[r] = arguments[r];
            return e.apply(t, n);
          };
        };
      },
      function(e, t) {
        var n,
          r,
          i = (e.exports = {});
        function a() {
          throw new Error("setTimeout has not been defined");
        }
        function o() {
          throw new Error("clearTimeout has not been defined");
        }
        function s(e) {
          if (n === setTimeout) return setTimeout(e, 0);
          if ((n === a || !n) && setTimeout)
            return (n = setTimeout), setTimeout(e, 0);
          try {
            return n(e, 0);
          } catch (t) {
            try {
              return n.call(null, e, 0);
            } catch (t) {
              return n.call(this, e, 0);
            }
          }
        }
        !(function() {
          try {
            n = "function" == typeof setTimeout ? setTimeout : a;
          } catch (e) {
            n = a;
          }
          try {
            r = "function" == typeof clearTimeout ? clearTimeout : o;
          } catch (e) {
            r = o;
          }
        })();
        var l,
          c = [],
          u = !1,
          h = -1;
        function d() {
          u &&
            l &&
            ((u = !1),
            l.length ? (c = l.concat(c)) : (h = -1),
            c.length && p());
        }
        function p() {
          if (!u) {
            var e = s(d);
            u = !0;
            for (var t = c.length; t; ) {
              for (l = c, c = []; ++h < t; ) l && l[h].run();
              (h = -1), (t = c.length);
            }
            (l = null),
              (u = !1),
              (function(e) {
                if (r === clearTimeout) return clearTimeout(e);
                if ((r === o || !r) && clearTimeout)
                  return (r = clearTimeout), clearTimeout(e);
                try {
                  r(e);
                } catch (t) {
                  try {
                    return r.call(null, e);
                  } catch (t) {
                    return r.call(this, e);
                  }
                }
              })(e);
          }
        }
        function f(e, t) {
          (this.fun = e), (this.array = t);
        }
        function m() {}
        (i.nextTick = function(e) {
          var t = new Array(arguments.length - 1);
          if (arguments.length > 1)
            for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
          c.push(new f(e, t)), 1 !== c.length || u || s(p);
        }),
          (f.prototype.run = function() {
            this.fun.apply(null, this.array);
          }),
          (i.title = "browser"),
          (i.browser = !0),
          (i.env = {}),
          (i.argv = []),
          (i.version = ""),
          (i.versions = {}),
          (i.on = m),
          (i.addListener = m),
          (i.once = m),
          (i.off = m),
          (i.removeListener = m),
          (i.removeAllListeners = m),
          (i.emit = m),
          (i.prependListener = m),
          (i.prependOnceListener = m),
          (i.listeners = function(e) {
            return [];
          }),
          (i.binding = function(e) {
            throw new Error("process.binding is not supported");
          }),
          (i.cwd = function() {
            return "/";
          }),
          (i.chdir = function(e) {
            throw new Error("process.chdir is not supported");
          }),
          (i.umask = function() {
            return 0;
          });
      },
      function(e, t, n) {
        "use strict";
        var r = n(3),
          i = n(27),
          a = n(29),
          o = n(30),
          s = n(31),
          l = n(13);
        e.exports = function(e) {
          return new Promise(function(t, c) {
            var u = e.data,
              h = e.headers;
            r.isFormData(u) && delete h["Content-Type"];
            var d = new XMLHttpRequest();
            if (e.auth) {
              var p = e.auth.username || "",
                f = e.auth.password || "";
              h.Authorization = "Basic " + btoa(p + ":" + f);
            }
            if (
              (d.open(
                e.method.toUpperCase(),
                a(e.url, e.params, e.paramsSerializer),
                !0
              ),
              (d.timeout = e.timeout),
              (d.onreadystatechange = function() {
                if (
                  d &&
                  4 === d.readyState &&
                  (0 !== d.status ||
                    (d.responseURL && 0 === d.responseURL.indexOf("file:")))
                ) {
                  var n =
                      "getAllResponseHeaders" in d
                        ? o(d.getAllResponseHeaders())
                        : null,
                    r = {
                      data:
                        e.responseType && "text" !== e.responseType
                          ? d.response
                          : d.responseText,
                      status: d.status,
                      statusText: d.statusText,
                      headers: n,
                      config: e,
                      request: d
                    };
                  i(t, c, r), (d = null);
                }
              }),
              (d.onerror = function() {
                c(l("Network Error", e, null, d)), (d = null);
              }),
              (d.ontimeout = function() {
                c(
                  l(
                    "timeout of " + e.timeout + "ms exceeded",
                    e,
                    "ECONNABORTED",
                    d
                  )
                ),
                  (d = null);
              }),
              r.isStandardBrowserEnv())
            ) {
              var m = n(32),
                v =
                  (e.withCredentials || s(e.url)) && e.xsrfCookieName
                    ? m.read(e.xsrfCookieName)
                    : void 0;
              v && (h[e.xsrfHeaderName] = v);
            }
            if (
              ("setRequestHeader" in d &&
                r.forEach(h, function(e, t) {
                  void 0 === u && "content-type" === t.toLowerCase()
                    ? delete h[t]
                    : d.setRequestHeader(t, e);
                }),
              e.withCredentials && (d.withCredentials = !0),
              e.responseType)
            )
              try {
                d.responseType = e.responseType;
              } catch (t) {
                if ("json" !== e.responseType) throw t;
              }
            "function" == typeof e.onDownloadProgress &&
              d.addEventListener("progress", e.onDownloadProgress),
              "function" == typeof e.onUploadProgress &&
                d.upload &&
                d.upload.addEventListener("progress", e.onUploadProgress),
              e.cancelToken &&
                e.cancelToken.promise.then(function(e) {
                  d && (d.abort(), c(e), (d = null));
                }),
              void 0 === u && (u = null),
              d.send(u);
          });
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(28);
        e.exports = function(e, t, n, i, a) {
          var o = new Error(e);
          return r(o, t, n, i, a);
        };
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e) {
          return !(!e || !e.__CANCEL__);
        };
      },
      function(e, t, n) {
        "use strict";
        function r(e) {
          this.message = e;
        }
        (r.prototype.toString = function() {
          return "Cancel" + (this.message ? ": " + this.message : "");
        }),
          (r.prototype.__CANCEL__ = !0),
          (e.exports = r);
      },
      function(e, t) {
        var n =
          ("undefined" != typeof crypto &&
            crypto.getRandomValues &&
            crypto.getRandomValues.bind(crypto)) ||
          ("undefined" != typeof msCrypto &&
            "function" == typeof window.msCrypto.getRandomValues &&
            msCrypto.getRandomValues.bind(msCrypto));
        if (n) {
          var r = new Uint8Array(16);
          e.exports = function() {
            return n(r), r;
          };
        } else {
          var i = new Array(16);
          e.exports = function() {
            for (var e, t = 0; t < 16; t++)
              0 == (3 & t) && (e = 4294967296 * Math.random()),
                (i[t] = (e >>> ((3 & t) << 3)) & 255);
            return i;
          };
        }
      },
      function(e, t) {
        for (var n = [], r = 0; r < 256; ++r)
          n[r] = (r + 256).toString(16).substr(1);
        e.exports = function(e, t) {
          var r = t || 0,
            i = n;
          return [
            i[e[r++]],
            i[e[r++]],
            i[e[r++]],
            i[e[r++]],
            "-",
            i[e[r++]],
            i[e[r++]],
            "-",
            i[e[r++]],
            i[e[r++]],
            "-",
            i[e[r++]],
            i[e[r++]],
            "-",
            i[e[r++]],
            i[e[r++]],
            i[e[r++]],
            i[e[r++]],
            i[e[r++]],
            i[e[r++]]
          ].join("");
        };
      },
      function(e, t, n) {
        "use strict";
        function r(e) {
          var t,
            n = e.Symbol;
          return (
            "function" == typeof n
              ? n.observable
                ? (t = n.observable)
                : ((t = n("observable")), (n.observable = t))
              : (t = "@@observable"),
            t
          );
        }
        n.d(t, "a", function() {
          return r;
        });
      },
      function(e, t, n) {
        "use strict";
        const r = Object.prototype.toString,
          i = n(45),
          a = e =>
            "__proto__" !== e && "constructor" !== e && "prototype" !== e,
          o = (e.exports = (e, ...t) => {
            let n = 0;
            for (
              (function(e) {
                return "object" == typeof e
                  ? null === e
                  : "function" != typeof e;
              })(e) && (e = t[n++]),
                e || (e = {});
              n < t.length;
              n++
            )
              if (s(t[n])) {
                for (const r of Object.keys(t[n]))
                  a(r) &&
                    (s(e[r]) && s(t[n][r])
                      ? o(e[r], t[n][r])
                      : (e[r] = t[n][r]));
                i(e, t[n]);
              }
            return e;
          });
        function s(e) {
          return "function" == typeof e || "[object Object]" === r.call(e);
        }
      },
      function(e, t, n) {
        var r, i;
        (i = (function(e) {
          var t = ["N", "E", "A", "D"];
          function n(e, t) {
            (e.super_ = t),
              (e.prototype = Object.create(t.prototype, {
                constructor: {
                  value: e,
                  enumerable: !1,
                  writable: !0,
                  configurable: !0
                }
              }));
          }
          function r(e, t) {
            Object.defineProperty(this, "kind", { value: e, enumerable: !0 }),
              t &&
                t.length &&
                Object.defineProperty(this, "path", {
                  value: t,
                  enumerable: !0
                });
          }
          function i(e, t, n) {
            i.super_.call(this, "E", e),
              Object.defineProperty(this, "lhs", { value: t, enumerable: !0 }),
              Object.defineProperty(this, "rhs", { value: n, enumerable: !0 });
          }
          function a(e, t) {
            a.super_.call(this, "N", e),
              Object.defineProperty(this, "rhs", { value: t, enumerable: !0 });
          }
          function o(e, t) {
            o.super_.call(this, "D", e),
              Object.defineProperty(this, "lhs", { value: t, enumerable: !0 });
          }
          function s(e, t, n) {
            s.super_.call(this, "A", e),
              Object.defineProperty(this, "index", {
                value: t,
                enumerable: !0
              }),
              Object.defineProperty(this, "item", { value: n, enumerable: !0 });
          }
          function l(e, t, n) {
            var r = e.slice((n || t) + 1 || e.length);
            return (e.length = t < 0 ? e.length + t : t), e.push.apply(e, r), e;
          }
          function c(e) {
            var t = typeof e;
            return "object" !== t
              ? t
              : e === Math
              ? "math"
              : null === e
              ? "null"
              : Array.isArray(e)
              ? "array"
              : "[object Date]" === Object.prototype.toString.call(e)
              ? "date"
              : "function" == typeof e.toString && /^\/.*\//.test(e.toString())
              ? "regexp"
              : "object";
          }
          function u(e) {
            var t = 0;
            if (0 === e.length) return t;
            for (var n = 0; n < e.length; n++)
              (t = (t << 5) - t + e.charCodeAt(n)), (t &= t);
            return t;
          }
          function h(e) {
            var t = 0,
              n = c(e);
            if ("array" === n)
              return (
                e.forEach(function(e) {
                  t += h(e);
                }),
                t + u("[type: array, hash: " + t + "]")
              );
            if ("object" === n) {
              for (var r in e)
                if (e.hasOwnProperty(r)) {
                  var i =
                    "[ type: object, key: " +
                    r +
                    ", value hash: " +
                    h(e[r]) +
                    "]";
                  t += u(i);
                }
              return t;
            }
            return t + u("[ type: " + n + " ; value: " + e + "]");
          }
          function d(e, t, n, r, l, u, p, f) {
            (n = n || []), (p = p || []);
            var m = (l = l || []).slice(0);
            if (null != u) {
              if (r) {
                if ("function" == typeof r && r(m, u)) return;
                if ("object" == typeof r) {
                  if (r.prefilter && r.prefilter(m, u)) return;
                  if (r.normalize) {
                    var v = r.normalize(m, u, e, t);
                    v && ((e = v[0]), (t = v[1]));
                  }
                }
              }
              m.push(u);
            }
            "regexp" === c(e) &&
              "regexp" === c(t) &&
              ((e = e.toString()), (t = t.toString()));
            var g,
              y,
              b,
              x,
              w = typeof e,
              _ = typeof t,
              M =
                "undefined" !== w ||
                (p &&
                  p.length > 0 &&
                  p[p.length - 1].lhs &&
                  Object.getOwnPropertyDescriptor(p[p.length - 1].lhs, u)),
              T =
                "undefined" !== _ ||
                (p &&
                  p.length > 0 &&
                  p[p.length - 1].rhs &&
                  Object.getOwnPropertyDescriptor(p[p.length - 1].rhs, u));
            if (!M && T) n.push(new a(m, t));
            else if (!T && M) n.push(new o(m, e));
            else if (c(e) !== c(t)) n.push(new i(m, e, t));
            else if ("date" === c(e) && e - t != 0) n.push(new i(m, e, t));
            else if ("object" === w && null !== e && null !== t) {
              for (g = p.length - 1; g > -1; --g)
                if (p[g].lhs === e) {
                  x = !0;
                  break;
                }
              if (x) e !== t && n.push(new i(m, e, t));
              else {
                if ((p.push({ lhs: e, rhs: t }), Array.isArray(e))) {
                  for (
                    f &&
                      (e.sort(function(e, t) {
                        return h(e) - h(t);
                      }),
                      t.sort(function(e, t) {
                        return h(e) - h(t);
                      })),
                      g = t.length - 1,
                      y = e.length - 1;
                    g > y;

                  )
                    n.push(new s(m, g, new a(void 0, t[g--])));
                  for (; y > g; ) n.push(new s(m, y, new o(void 0, e[y--])));
                  for (; g >= 0; --g) d(e[g], t[g], n, r, m, g, p, f);
                } else {
                  var A = Object.keys(e),
                    S = Object.keys(t);
                  for (g = 0; g < A.length; ++g)
                    (b = A[g]),
                      (x = S.indexOf(b)) >= 0
                        ? (d(e[b], t[b], n, r, m, b, p, f), (S[x] = null))
                        : d(e[b], void 0, n, r, m, b, p, f);
                  for (g = 0; g < S.length; ++g)
                    (b = S[g]) && d(void 0, t[b], n, r, m, b, p, f);
                }
                p.length = p.length - 1;
              }
            } else
              e !== t &&
                (("number" === w && isNaN(e) && isNaN(t)) ||
                  n.push(new i(m, e, t)));
          }
          function p(e, t, n, r, i) {
            var a = [];
            if ((d(e, t, a, r, null, null, null, i), n))
              for (var o = 0; o < a.length; ++o) n(a[o]);
            return a;
          }
          function f(e, t, n, r) {
            var i = p(
              e,
              t,
              r
                ? function(e) {
                    e && r.push(e);
                  }
                : void 0,
              n
            );
            return r || (i.length ? i : void 0);
          }
          function m(e, n, r) {
            if (
              (void 0 === r && n && ~t.indexOf(n.kind) && (r = n),
              e && r && r.kind)
            ) {
              for (
                var i = e, a = -1, o = r.path ? r.path.length - 1 : 0;
                ++a < o;

              )
                void 0 === i[r.path[a]] &&
                  (i[r.path[a]] =
                    void 0 !== r.path[a + 1] && "number" == typeof r.path[a + 1]
                      ? []
                      : {}),
                  (i = i[r.path[a]]);
              switch (r.kind) {
                case "A":
                  r.path && void 0 === i[r.path[a]] && (i[r.path[a]] = []),
                    (function e(t, n, r) {
                      if (r.path && r.path.length) {
                        var i,
                          a = t[n],
                          o = r.path.length - 1;
                        for (i = 0; i < o; i++) a = a[r.path[i]];
                        switch (r.kind) {
                          case "A":
                            e(a[r.path[i]], r.index, r.item);
                            break;
                          case "D":
                            delete a[r.path[i]];
                            break;
                          case "E":
                          case "N":
                            a[r.path[i]] = r.rhs;
                        }
                      } else
                        switch (r.kind) {
                          case "A":
                            e(t[n], r.index, r.item);
                            break;
                          case "D":
                            t = l(t, n);
                            break;
                          case "E":
                          case "N":
                            t[n] = r.rhs;
                        }
                      return t;
                    })(r.path ? i[r.path[a]] : i, r.index, r.item);
                  break;
                case "D":
                  delete i[r.path[a]];
                  break;
                case "E":
                case "N":
                  i[r.path[a]] = r.rhs;
              }
            }
          }
          return (
            n(i, r),
            n(a, r),
            n(o, r),
            n(s, r),
            Object.defineProperties(f, {
              diff: { value: f, enumerable: !0 },
              orderIndependentDiff: {
                value: function(e, t, n, r) {
                  var i = r
                      ? function(e) {
                          e && r.push(e);
                        }
                      : void 0,
                    a = p(e, t, i, n, !0);
                  return r || (a.length ? a : void 0);
                },
                enumerable: !0
              },
              observableDiff: { value: p, enumerable: !0 },
              orderIndependentObservableDiff: {
                value: function(e, t, n, r, i, a, o) {
                  return d(e, t, n, r, i, a, o, !0);
                },
                enumerable: !0
              },
              orderIndepHash: { value: h, enumerable: !0 },
              applyDiff: {
                value: function(e, t, n) {
                  e &&
                    t &&
                    p(e, t, function(r) {
                      (n && !n(e, t, r)) || m(e, t, r);
                    });
                },
                enumerable: !0
              },
              applyChange: { value: m, enumerable: !0 },
              revertChange: {
                value: function(e, t, n) {
                  if (e && t && n && n.kind) {
                    var r,
                      i,
                      a = e;
                    for (i = n.path.length - 1, r = 0; r < i; r++)
                      void 0 === a[n.path[r]] && (a[n.path[r]] = {}),
                        (a = a[n.path[r]]);
                    switch (n.kind) {
                      case "A":
                        !(function e(t, n, r) {
                          if (r.path && r.path.length) {
                            var i,
                              a = t[n],
                              o = r.path.length - 1;
                            for (i = 0; i < o; i++) a = a[r.path[i]];
                            switch (r.kind) {
                              case "A":
                                e(a[r.path[i]], r.index, r.item);
                                break;
                              case "D":
                              case "E":
                                a[r.path[i]] = r.lhs;
                                break;
                              case "N":
                                delete a[r.path[i]];
                            }
                          } else
                            switch (r.kind) {
                              case "A":
                                e(t[n], r.index, r.item);
                                break;
                              case "D":
                              case "E":
                                t[n] = r.lhs;
                                break;
                              case "N":
                                t = l(t, n);
                            }
                          return t;
                        })(a[n.path[r]], n.index, n.item);
                        break;
                      case "D":
                      case "E":
                        a[n.path[r]] = n.lhs;
                        break;
                      case "N":
                        delete a[n.path[r]];
                    }
                  }
                },
                enumerable: !0
              },
              isConflict: {
                value: function() {
                  return "undefined" != typeof $conflict;
                },
                enumerable: !0
              }
            }),
            (f.DeepDiff = f),
            e && (e.DeepDiff = f),
            f
          );
        })(this)),
          void 0 ===
            (r = function() {
              return i;
            }.call(t, n, t, e)) || (e.exports = r);
      },
      function(e, t, n) {
        e.exports = (function() {
          "use strict";
          var e = function() {
            var t = 0,
              n = document.createElement("div");
            function r(e) {
              return n.appendChild(e.dom), e;
            }
            function i(e) {
              for (var r = 0; r < n.children.length; r++)
                n.children[r].style.display = r === e ? "block" : "none";
              t = e;
            }
            (n.style.cssText =
              "position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000"),
              n.addEventListener(
                "click",
                function(e) {
                  e.preventDefault(), i(++t % n.children.length);
                },
                !1
              );
            var a = (performance || Date).now(),
              o = a,
              s = 0,
              l = r(new e.Panel("FPS", "#0ff", "#002")),
              c = r(new e.Panel("MS", "#0f0", "#020"));
            if (self.performance && self.performance.memory)
              var u = r(new e.Panel("MB", "#f08", "#201"));
            return (
              i(0),
              {
                REVISION: 16,
                dom: n,
                addPanel: r,
                showPanel: i,
                begin: function() {
                  a = (performance || Date).now();
                },
                end: function() {
                  s++;
                  var e = (performance || Date).now();
                  if (
                    (c.update(e - a, 200),
                    o + 1e3 <= e &&
                      (l.update((1e3 * s) / (e - o), 100), (o = e), (s = 0), u))
                  ) {
                    var t = performance.memory;
                    u.update(
                      t.usedJSHeapSize / 1048576,
                      t.jsHeapSizeLimit / 1048576
                    );
                  }
                  return e;
                },
                update: function() {
                  a = this.end();
                },
                domElement: n,
                setMode: i
              }
            );
          };
          return (
            (e.Panel = function(e, t, n) {
              var r = 1 / 0,
                i = 0,
                a = Math.round,
                o = a(window.devicePixelRatio || 1),
                s = 80 * o,
                l = 48 * o,
                c = 3 * o,
                u = 2 * o,
                h = 3 * o,
                d = 15 * o,
                p = 74 * o,
                f = 30 * o,
                m = document.createElement("canvas");
              (m.width = s),
                (m.height = l),
                (m.style.cssText = "width:80px;height:48px");
              var v = m.getContext("2d");
              return (
                (v.font = "bold " + 9 * o + "px Helvetica,Arial,sans-serif"),
                (v.textBaseline = "top"),
                (v.fillStyle = n),
                v.fillRect(0, 0, s, l),
                (v.fillStyle = t),
                v.fillText(e, c, u),
                v.fillRect(h, d, p, f),
                (v.fillStyle = n),
                (v.globalAlpha = 0.9),
                v.fillRect(h, d, p, f),
                {
                  dom: m,
                  update: function(l, g) {
                    (r = Math.min(r, l)),
                      (i = Math.max(i, l)),
                      (v.fillStyle = n),
                      (v.globalAlpha = 1),
                      v.fillRect(0, 0, s, d),
                      (v.fillStyle = t),
                      v.fillText(
                        a(l) + " " + e + " (" + a(r) + "-" + a(i) + ")",
                        c,
                        u
                      ),
                      v.drawImage(m, h + o, d, p - o, f, h, d, p - o, f),
                      v.fillRect(h + p - o, d, o, f),
                      (v.fillStyle = n),
                      (v.globalAlpha = 0.9),
                      v.fillRect(h + p - o, d, o, a((1 - l / g) * f));
                  }
                }
              );
            }),
            e
          );
        })();
      },
      function(e, t, n) {
        var r = n(46).default,
          i = n(0).default,
          a = new r();
        function o(e, t) {
          t && (e.customError ? t(e) : t(i.set(3, e)));
        }
        function s() {}
        var l = {
          init(e) {
            var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : {},
              n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : s;
            a.init(e, t)
              .then(e => {
                n(null, { status: e });
              })
              .catch(e => {
                o(e, n);
              });
          },
          dispose() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.dispose()
              .then(() => {
                e(null, !0);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getMaterial(e) {
            var t = e.part,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            return Promise.resolve()
              .then(() => {
                var e = a.getMaterial(t);
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getAvailableMaterials() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getAvailableMaterials()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          changeMaterial(e) {
            var t = e.parts,
              n = void 0 === t ? [] : t,
              r = e.material,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeMaterial(n, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          changeMaterials(e) {
            var t = e.partObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeMaterials(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          applyMaterialToAllParts(e) {
            var t = e.material,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.applyMaterialToAllParts(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          switchMaterials(e) {
            var t = e.oldMaterial,
              n = e.newMaterial,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.switchMaterials(t, n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          changeAnnotationMaterial(e) {
            var t = e.annotations,
              n = void 0 === t ? [] : t,
              r = e.material,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeAnnotationMaterial(n, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          changeMaterialColor(e) {
            var t = e.material,
              n = e.color,
              r = void 0 === n ? "#ffffff" : n,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeMaterialColor(t, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          changeMaterialOption(e) {
            var t = e.material,
              n = e.options,
              r = void 0 === n ? {} : n,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeMaterialOption(t, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          hideParts(e) {
            var t = e.parts,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.hideParts(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showParts(e) {
            var t = e.partObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showParts(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showAllParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.showAllParts()
              .then(() => {
                e(null);
              })
              .catch(t => {
                o(t, e);
              });
          },
          showOnlyParts(e) {
            var t = e.partObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showOnlyParts(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          getAvailableParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getAvailableParts()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getVisibleParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getVisibleParts()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getHiddenParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getHiddenParts()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          showGroups(e) {
            var t = e.groups,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showGroups(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          hideGroups(e) {
            var t = e.groups,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.hideGroups(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          changeGroupMaterial(e) {
            var t = e.groupObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeGroupMaterial(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          isPartVisible(e) {
            var t = e.part,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isPartVisible(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          selectParts(e) {
            var t = e.parts,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.selectParts(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          selectAllPartsExcept(e) {
            var t = e.parts,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.selectAllPartsExcept(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          getSelectedParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getSelectedParts()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getSelectedAnnotations() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getSelectedAnnotations()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getSelected() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getSelected()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          isPartSelected(e) {
            var t = e.part,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isPartSelected(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          activateCamera(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.activateCamera(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          activateCameraControl(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.activateCameraControl(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          activateViewport(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.activateEnvironment(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          activateRenderer(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.activateRenderer(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          isActiveCamera(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isActiveCamera(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          isActiveCameraControl(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isActiveCameraControl(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          isActiveViewport(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isActiveEnvironment(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          isActiveRenderer(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isActiveRenderer(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          isVisibleLight(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.isVisibleLight(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          showLights(e) {
            var t = e.lights,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showLights(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          hideLights(e) {
            var t = e.lights,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.hideLights(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showOnlyLights(e) {
            var t = e.lights,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showOnlyLights(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showAnnotations(e) {
            var t = e.annotationObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showAnnotations(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          hideAnnotations(e) {
            var t = e.annotations,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.hideAnnotations(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showOnlyAnnotations(e) {
            var t = e.annotationObjects,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showOnlyAnnotations(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          getAvailableAnnotations() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getAvailableAnnotations()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getSelectable() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getSelectable()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getSelectableParts() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getSelectableParts()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          enableAutoRotate() {
            var e = (arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {}
              ).enable,
              t = void 0 === e || e,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.enableAutoRotate(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          setAutoRotateSpeed() {
            var e = (arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {}
              ).speed,
              t = void 0 === e ? 1 : e,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.setAutoRotateSpeed(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getCameraPosition() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getCameraPosition()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          setCameraPosition() {
            var e = (arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {}
              ).position,
              t = void 0 === e ? [0, 0, 0] : e,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.setCameraPosition(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getCameraTarget() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getCameraTarget()
              .then(t => {
                e(null, t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          setCameraTarget() {
            var e = (arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {}
              ).target,
              t = void 0 === e ? [0, 0, 0] : e,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.setCameraTarget(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          activateTransition(e) {
            var t = e.transition,
              n = e.target,
              r = void 0 === n ? null : n,
              i = e.duration,
              l = void 0 === i ? null : i,
              c =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.activateTransition(t, r, l)
              .then(() => {
                c(null);
              })
              .catch(e => {
                o(e, c);
              });
          },
          resetCameraPosition(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.resetCameraPosition(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          resetCameraTarget() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.resetCameraTarget()
              .then(() => {
                e(null);
              })
              .catch(t => {
                o(t, e);
              });
          },
          enableCameraControls() {
            var e = (arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {}
              ).enable,
              t = void 0 === e || e,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.enableCameraControls(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          updateCameraControl(e) {
            var t = e.name,
              n = e.minAzimuthAngle,
              r = void 0 === n ? null : n,
              i = e.maxAzimuthAngle,
              l = void 0 === i ? null : i,
              c = e.minPolarAngle,
              u = void 0 === c ? null : c,
              h = e.maxPolarAngle,
              d = void 0 === h ? null : h,
              p =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.updateCameraControl(t, r, l, u, d)
              .then(() => {
                p(null);
              })
              .catch(e => {
                o(e, p);
              });
          },
          enableObjectControl(e) {
            var t = e.name,
              n = e.enable,
              r = void 0 === n || n,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.enableObjectControl(t, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          getModelPosition(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.getModelPosition(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getPartPosition(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.getPartPosition(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getPartCenter(e) {
            var t = e.name,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.getPartCenter(t)
              .then(e => {
                n(null, e);
              })
              .catch(e => {
                o(e, n);
              });
          },
          showModels(e) {
            var t = e.models,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showModels(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          hideModels(e) {
            var t = e.models,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.hideModels(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          showOnlyModels(e) {
            var t = e.models,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.showOnlyModels(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          addSelectable(e) {
            var t = e.partNames,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.addSelectable(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          setSelectable(e) {
            var t = e.partNames,
              n = void 0 === t ? [] : t,
              r =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.setSelectable(n)
              .then(() => {
                r(null);
              })
              .catch(e => {
                o(e, r);
              });
          },
          setAllSelectable() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.setAllSelectable()
              .then(() => {
                e(null);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getSnapshot() {
            var e =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : {},
              t = e.width,
              n = void 0 === t ? 1280 : t,
              r = e.height,
              i = void 0 === r ? 720 : r,
              l =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.getSnapshot(n, i)
              .then(e => {
                l(null, e);
              })
              .catch(e => {
                o(e, l);
              });
          },
          changeViewportBackgroundColor(e) {
            var t = e.viewport,
              n = e.color,
              r = void 0 === n ? "#ffffff" : n,
              i =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.changeEnvironmentBackgroundColor(t, r)
              .then(() => {
                i(null);
              })
              .catch(e => {
                o(e, i);
              });
          },
          setViewportTransparent(e) {
            var t = e.viewport,
              n =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : s;
            a.setEnvironmentTransparent(t)
              .then(() => {
                n(null);
              })
              .catch(e => {
                o(e, n);
              });
          },
          getAssetsInfo() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.getAssetsInfo()
              .then(t => {
                e(t);
              })
              .catch(t => {
                o(t, e);
              });
          },
          resetAssetsInfo() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : s;
            a.resetAssetsInfo()
              .then(() => {
                e(null);
              })
              .catch(t => {
                o(t, e);
              });
          },
          getViewer3D: () => a.getViewer3D()
        };
        (e.exports = l), (e.exports.default = l);
      },
      function(e, t, n) {
        "use strict";
        var r = n(3),
          i = n(10),
          a = n(25),
          o = n(8);
        function s(e) {
          var t = new a(e),
            n = i(a.prototype.request, t);
          return r.extend(n, a.prototype, t), r.extend(n, t), n;
        }
        var l = s(o);
        (l.Axios = a),
          (l.create = function(e) {
            return s(r.merge(o, e));
          }),
          (l.Cancel = n(15)),
          (l.CancelToken = n(38)),
          (l.isCancel = n(14)),
          (l.all = function(e) {
            return Promise.all(e);
          }),
          (l.spread = n(39)),
          (e.exports = l),
          (e.exports.default = l);
      },
      function(e, t) {
        e.exports = function(e) {
          return (
            null != e &&
            null != e.constructor &&
            "function" == typeof e.constructor.isBuffer &&
            e.constructor.isBuffer(e)
          );
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(8),
          i = n(3),
          a = n(33),
          o = n(34);
        function s(e) {
          (this.defaults = e),
            (this.interceptors = { request: new a(), response: new a() });
        }
        (s.prototype.request = function(e) {
          "string" == typeof e &&
            (e = i.merge({ url: arguments[0] }, arguments[1])),
            ((e = i.merge(
              r,
              { method: "get" },
              this.defaults,
              e
            )).method = e.method.toLowerCase());
          var t = [o, void 0],
            n = Promise.resolve(e);
          for (
            this.interceptors.request.forEach(function(e) {
              t.unshift(e.fulfilled, e.rejected);
            }),
              this.interceptors.response.forEach(function(e) {
                t.push(e.fulfilled, e.rejected);
              });
            t.length;

          )
            n = n.then(t.shift(), t.shift());
          return n;
        }),
          i.forEach(["delete", "get", "head", "options"], function(e) {
            s.prototype[e] = function(t, n) {
              return this.request(i.merge(n || {}, { method: e, url: t }));
            };
          }),
          i.forEach(["post", "put", "patch"], function(e) {
            s.prototype[e] = function(t, n, r) {
              return this.request(
                i.merge(r || {}, { method: e, url: t, data: n })
              );
            };
          }),
          (e.exports = s);
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        e.exports = function(e, t) {
          r.forEach(e, function(n, r) {
            r !== t &&
              r.toUpperCase() === t.toUpperCase() &&
              ((e[t] = n), delete e[r]);
          });
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(13);
        e.exports = function(e, t, n) {
          var i = n.config.validateStatus;
          n.status && i && !i(n.status)
            ? t(
                r(
                  "Request failed with status code " + n.status,
                  n.config,
                  null,
                  n.request,
                  n
                )
              )
            : e(n);
        };
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e, t, n, r, i) {
          return (
            (e.config = t),
            n && (e.code = n),
            (e.request = r),
            (e.response = i),
            e
          );
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        function i(e) {
          return encodeURIComponent(e)
            .replace(/%40/gi, "@")
            .replace(/%3A/gi, ":")
            .replace(/%24/g, "$")
            .replace(/%2C/gi, ",")
            .replace(/%20/g, "+")
            .replace(/%5B/gi, "[")
            .replace(/%5D/gi, "]");
        }
        e.exports = function(e, t, n) {
          if (!t) return e;
          var a;
          if (n) a = n(t);
          else if (r.isURLSearchParams(t)) a = t.toString();
          else {
            var o = [];
            r.forEach(t, function(e, t) {
              null != e &&
                (r.isArray(e) ? (t += "[]") : (e = [e]),
                r.forEach(e, function(e) {
                  r.isDate(e)
                    ? (e = e.toISOString())
                    : r.isObject(e) && (e = JSON.stringify(e)),
                    o.push(i(t) + "=" + i(e));
                }));
            }),
              (a = o.join("&"));
          }
          return a && (e += (-1 === e.indexOf("?") ? "?" : "&") + a), e;
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3),
          i = [
            "age",
            "authorization",
            "content-length",
            "content-type",
            "etag",
            "expires",
            "from",
            "host",
            "if-modified-since",
            "if-unmodified-since",
            "last-modified",
            "location",
            "max-forwards",
            "proxy-authorization",
            "referer",
            "retry-after",
            "user-agent"
          ];
        e.exports = function(e) {
          var t,
            n,
            a,
            o = {};
          return e
            ? (r.forEach(e.split("\n"), function(e) {
                if (
                  ((a = e.indexOf(":")),
                  (t = r.trim(e.substr(0, a)).toLowerCase()),
                  (n = r.trim(e.substr(a + 1))),
                  t)
                ) {
                  if (o[t] && i.indexOf(t) >= 0) return;
                  o[t] =
                    "set-cookie" === t
                      ? (o[t] ? o[t] : []).concat([n])
                      : o[t]
                      ? o[t] + ", " + n
                      : n;
                }
              }),
              o)
            : o;
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        e.exports = r.isStandardBrowserEnv()
          ? (function() {
              var e,
                t = /(msie|trident)/i.test(navigator.userAgent),
                n = document.createElement("a");
              function i(e) {
                var r = e;
                return (
                  t && (n.setAttribute("href", r), (r = n.href)),
                  n.setAttribute("href", r),
                  {
                    href: n.href,
                    protocol: n.protocol ? n.protocol.replace(/:$/, "") : "",
                    host: n.host,
                    search: n.search ? n.search.replace(/^\?/, "") : "",
                    hash: n.hash ? n.hash.replace(/^#/, "") : "",
                    hostname: n.hostname,
                    port: n.port,
                    pathname:
                      "/" === n.pathname.charAt(0)
                        ? n.pathname
                        : "/" + n.pathname
                  }
                );
              }
              return (
                (e = i(window.location.href)),
                function(t) {
                  var n = r.isString(t) ? i(t) : t;
                  return n.protocol === e.protocol && n.host === e.host;
                }
              );
            })()
          : function() {
              return !0;
            };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        e.exports = r.isStandardBrowserEnv()
          ? {
              write: function(e, t, n, i, a, o) {
                var s = [];
                s.push(e + "=" + encodeURIComponent(t)),
                  r.isNumber(n) &&
                    s.push("expires=" + new Date(n).toGMTString()),
                  r.isString(i) && s.push("path=" + i),
                  r.isString(a) && s.push("domain=" + a),
                  !0 === o && s.push("secure"),
                  (document.cookie = s.join("; "));
              },
              read: function(e) {
                var t = document.cookie.match(
                  new RegExp("(^|;\\s*)(" + e + ")=([^;]*)")
                );
                return t ? decodeURIComponent(t[3]) : null;
              },
              remove: function(e) {
                this.write(e, "", Date.now() - 864e5);
              }
            }
          : {
              write: function() {},
              read: function() {
                return null;
              },
              remove: function() {}
            };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        function i() {
          this.handlers = [];
        }
        (i.prototype.use = function(e, t) {
          return (
            this.handlers.push({ fulfilled: e, rejected: t }),
            this.handlers.length - 1
          );
        }),
          (i.prototype.eject = function(e) {
            this.handlers[e] && (this.handlers[e] = null);
          }),
          (i.prototype.forEach = function(e) {
            r.forEach(this.handlers, function(t) {
              null !== t && e(t);
            });
          }),
          (e.exports = i);
      },
      function(e, t, n) {
        "use strict";
        var r = n(3),
          i = n(35),
          a = n(14),
          o = n(8),
          s = n(36),
          l = n(37);
        function c(e) {
          e.cancelToken && e.cancelToken.throwIfRequested();
        }
        e.exports = function(e) {
          return (
            c(e),
            e.baseURL && !s(e.url) && (e.url = l(e.baseURL, e.url)),
            (e.headers = e.headers || {}),
            (e.data = i(e.data, e.headers, e.transformRequest)),
            (e.headers = r.merge(
              e.headers.common || {},
              e.headers[e.method] || {},
              e.headers || {}
            )),
            r.forEach(
              ["delete", "get", "head", "post", "put", "patch", "common"],
              function(t) {
                delete e.headers[t];
              }
            ),
            (e.adapter || o.adapter)(e).then(
              function(t) {
                return (
                  c(e), (t.data = i(t.data, t.headers, e.transformResponse)), t
                );
              },
              function(t) {
                return (
                  a(t) ||
                    (c(e),
                    t &&
                      t.response &&
                      (t.response.data = i(
                        t.response.data,
                        t.response.headers,
                        e.transformResponse
                      ))),
                  Promise.reject(t)
                );
              }
            )
          );
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(3);
        e.exports = function(e, t, n) {
          return (
            r.forEach(n, function(n) {
              e = n(e, t);
            }),
            e
          );
        };
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e) {
          return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e);
        };
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e, t) {
          return t ? e.replace(/\/+$/, "") + "/" + t.replace(/^\/+/, "") : e;
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(15);
        function i(e) {
          if ("function" != typeof e)
            throw new TypeError("executor must be a function.");
          var t;
          this.promise = new Promise(function(e) {
            t = e;
          });
          var n = this;
          e(function(e) {
            n.reason || ((n.reason = new r(e)), t(n.reason));
          });
        }
        (i.prototype.throwIfRequested = function() {
          if (this.reason) throw this.reason;
        }),
          (i.source = function() {
            var e;
            return {
              token: new i(function(t) {
                e = t;
              }),
              cancel: e
            };
          }),
          (e.exports = i);
      },
      function(e, t, n) {
        "use strict";
        e.exports = function(e) {
          return function(t) {
            return e.apply(null, t);
          };
        };
      },
      function(e, t, n) {
        "use strict";
        var r = n(5).compose;
        (t.__esModule = !0),
          (t.composeWithDevTools =
            "undefined" != typeof window &&
            window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__
              ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__
              : function() {
                  if (0 !== arguments.length)
                    return "object" == typeof arguments[0]
                      ? r
                      : r.apply(null, arguments);
                }),
          (t.devToolsEnhancer =
            "undefined" != typeof window && window.__REDUX_DEVTOOLS_EXTENSION__
              ? window.__REDUX_DEVTOOLS_EXTENSION__
              : function() {
                  return function(e) {
                    return e;
                  };
                });
      },
      function(e, t) {
        var n;
        n = (function() {
          return this;
        })();
        try {
          n = n || new Function("return this")();
        } catch (e) {
          "object" == typeof window && (n = window);
        }
        e.exports = n;
      },
      function(e, t) {
        e.exports = function(e) {
          if (!e.webpackPolyfill) {
            var t = Object.create(e);
            t.children || (t.children = []),
              Object.defineProperty(t, "loaded", {
                enumerable: !0,
                get: function() {
                  return t.l;
                }
              }),
              Object.defineProperty(t, "id", {
                enumerable: !0,
                get: function() {
                  return t.i;
                }
              }),
              Object.defineProperty(t, "exports", { enumerable: !0 }),
              (t.webpackPolyfill = 1);
          }
          return t;
        };
      },
      function(e, t, n) {
        var r,
          i,
          a = n(16),
          o = n(17),
          s = 0,
          l = 0;
        e.exports = function(e, t, n) {
          var c = (t && n) || 0,
            u = t || [],
            h = (e = e || {}).node || r,
            d = void 0 !== e.clockseq ? e.clockseq : i;
          if (null == h || null == d) {
            var p = a();
            null == h && (h = r = [1 | p[0], p[1], p[2], p[3], p[4], p[5]]),
              null == d && (d = i = 16383 & ((p[6] << 8) | p[7]));
          }
          var f = void 0 !== e.msecs ? e.msecs : new Date().getTime(),
            m = void 0 !== e.nsecs ? e.nsecs : l + 1,
            v = f - s + (m - l) / 1e4;
          if (
            (v < 0 && void 0 === e.clockseq && (d = (d + 1) & 16383),
            (v < 0 || f > s) && void 0 === e.nsecs && (m = 0),
            m >= 1e4)
          )
            throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
          (s = f), (l = m), (i = d);
          var g = (1e4 * (268435455 & (f += 122192928e5)) + m) % 4294967296;
          (u[c++] = (g >>> 24) & 255),
            (u[c++] = (g >>> 16) & 255),
            (u[c++] = (g >>> 8) & 255),
            (u[c++] = 255 & g);
          var y = ((f / 4294967296) * 1e4) & 268435455;
          (u[c++] = (y >>> 8) & 255),
            (u[c++] = 255 & y),
            (u[c++] = ((y >>> 24) & 15) | 16),
            (u[c++] = (y >>> 16) & 255),
            (u[c++] = (d >>> 8) | 128),
            (u[c++] = 255 & d);
          for (var b = 0; b < 6; ++b) u[c + b] = h[b];
          return t || o(u);
        };
      },
      function(e, t, n) {
        var r = n(16),
          i = n(17);
        e.exports = function(e, t, n) {
          var a = (t && n) || 0;
          "string" == typeof e &&
            ((t = "binary" === e ? new Array(16) : null), (e = null));
          var o = (e = e || {}).random || (e.rng || r)();
          if (((o[6] = (15 & o[6]) | 64), (o[8] = (63 & o[8]) | 128), t))
            for (var s = 0; s < 16; ++s) t[a + s] = o[s];
          return t || i(o);
        };
      },
      function(e, t, n) {
        "use strict";
        const r = Object.prototype.toString,
          i = Object.prototype.propertyIsEnumerable,
          a = Object.getOwnPropertySymbols;
        e.exports = (e, ...t) => {
          if (
            !(function(e) {
              return (
                "function" == typeof e ||
                "[object Object]" === r.call(e) ||
                Array.isArray(e)
              );
            })(e)
          )
            throw new TypeError("expected the first argument to be an object");
          if (
            0 === t.length ||
            "function" != typeof Symbol ||
            "function" != typeof a
          )
            return e;
          for (let n of t) {
            let t = a(n);
            for (let r of t) i.call(n, r) && (e[r] = n[r]);
          }
          return e;
        };
      },
      function(e, t, n) {
        "use strict";
        n.r(t);
        var r = {};
        n.r(r),
          n.d(r, "ACESFilmicToneMapping", function() {
            return jn;
          }),
          n.d(r, "AddEquation", function() {
            return sn;
          }),
          n.d(r, "AddOperation", function() {
            return Cn;
          }),
          n.d(r, "AdditiveBlending", function() {
            return nn;
          }),
          n.d(r, "AlphaFormat", function() {
            return br;
          }),
          n.d(r, "AlwaysDepth", function() {
            return Tn;
          }),
          n.d(r, "AlwaysStencilFunc", function() {
            return Fi;
          }),
          n.d(r, "AmbientLight", function() {
            return Pp;
          }),
          n.d(r, "AmbientLightProbe", function() {
            return Kp;
          }),
          n.d(r, "AnimationClip", function() {
            return Fd;
          }),
          n.d(r, "AnimationLoader", function() {
            return Hd;
          }),
          n.d(r, "AnimationMixer", function() {
            return Pf;
          }),
          n.d(r, "AnimationObjectGroup", function() {
            return Ef;
          }),
          n.d(r, "AnimationUtils", function() {
            return Md;
          }),
          n.d(r, "ArcCurve", function() {
            return Kd;
          }),
          n.d(r, "ArrayCamera", function() {
            return Xc;
          }),
          n.d(r, "ArrowHelper", function() {
            return Pm;
          }),
          n.d(r, "Audio", function() {
            return cf;
          }),
          n.d(r, "AudioAnalyser", function() {
            return mf;
          }),
          n.d(r, "AudioContext", function() {
            return Yp;
          }),
          n.d(r, "AudioListener", function() {
            return lf;
          }),
          n.d(r, "AudioLoader", function() {
            return qp;
          }),
          n.d(r, "AxesHelper", function() {
            return Im;
          }),
          n.d(r, "AxisHelper", function() {
            return nv;
          }),
          n.d(r, "BackSide", function() {
            return Yt;
          }),
          n.d(r, "BasicDepthPacking", function() {
            return gi;
          }),
          n.d(r, "BasicShadowMap", function() {
            return Vt;
          }),
          n.d(r, "BinaryTextureLoader", function() {
            return sv;
          }),
          n.d(r, "Bone", function() {
            return Au;
          }),
          n.d(r, "BooleanKeyframeTrack", function() {
            return Pd;
          }),
          n.d(r, "BoundingBoxHelper", function() {
            return rv;
          }),
          n.d(r, "Box2", function() {
            return Uf;
          }),
          n.d(r, "Box3", function() {
            return Za;
          }),
          n.d(r, "Box3Helper", function() {
            return Tm;
          }),
          n.d(r, "BoxBufferGeometry", function() {
            return Es;
          }),
          n.d(r, "BoxGeometry", function() {
            return Ss;
          }),
          n.d(r, "BoxHelper", function() {
            return Mm;
          }),
          n.d(r, "BufferAttribute", function() {
            return No;
          }),
          n.d(r, "BufferGeometry", function() {
            return es;
          }),
          n.d(r, "BufferGeometryLoader", function() {
            return Np;
          }),
          n.d(r, "ByteType", function() {
            return lr;
          }),
          n.d(r, "Cache", function() {
            return Ud;
          }),
          n.d(r, "Camera", function() {
            return Ls;
          }),
          n.d(r, "CameraHelper", function() {
            return xm;
          }),
          n.d(r, "CanvasRenderer", function() {
            return cv;
          }),
          n.d(r, "CanvasTexture", function() {
            return Ju;
          }),
          n.d(r, "CatmullRomCurve3", function() {
            return ip;
          }),
          n.d(r, "CineonToneMapping", function() {
            return Un;
          }),
          n.d(r, "CircleBufferGeometry", function() {
            return ud;
          }),
          n.d(r, "CircleGeometry", function() {
            return cd;
          }),
          n.d(r, "ClampToEdgeWrapping", function() {
            return Qn;
          }),
          n.d(r, "Clock", function() {
            return nf;
          }),
          n.d(r, "ClosedSplineCurve3", function() {
            return $m;
          }),
          n.d(r, "Color", function() {
            return Eo;
          }),
          n.d(r, "ColorKeyframeTrack", function() {
            return Id;
          }),
          n.d(r, "CompressedTexture", function() {
            return Zu;
          }),
          n.d(r, "CompressedTextureLoader", function() {
            return Xd;
          }),
          n.d(r, "ConeBufferGeometry", function() {
            return ld;
          }),
          n.d(r, "ConeGeometry", function() {
            return sd;
          }),
          n.d(r, "CubeCamera", function() {
            return Us;
          }),
          n.d(r, "CubeGeometry", function() {
            return Ss;
          }),
          n.d(r, "CubeReflectionMapping", function() {
            return zn;
          }),
          n.d(r, "CubeRefractionMapping", function() {
            return Vn;
          }),
          n.d(r, "CubeTexture", function() {
            return ll;
          }),
          n.d(r, "CubeTextureLoader", function() {
            return qd;
          }),
          n.d(r, "CubeUVReflectionMapping", function() {
            return Wn;
          }),
          n.d(r, "CubeUVRefractionMapping", function() {
            return Yn;
          }),
          n.d(r, "CubicBezierCurve", function() {
            return lp;
          }),
          n.d(r, "CubicBezierCurve3", function() {
            return cp;
          }),
          n.d(r, "CubicInterpolant", function() {
            return Ad;
          }),
          n.d(r, "CullFaceBack", function() {
            return kt;
          }),
          n.d(r, "CullFaceFront", function() {
            return Ut;
          }),
          n.d(r, "CullFaceFrontBack", function() {
            return jt;
          }),
          n.d(r, "CullFaceNone", function() {
            return Ft;
          }),
          n.d(r, "Curve", function() {
            return Zd;
          }),
          n.d(r, "CurvePath", function() {
            return vp;
          }),
          n.d(r, "CustomBlending", function() {
            return on;
          }),
          n.d(r, "CylinderBufferGeometry", function() {
            return od;
          }),
          n.d(r, "CylinderGeometry", function() {
            return ad;
          }),
          n.d(r, "Cylindrical", function() {
            return Ff;
          }),
          n.d(r, "DataTexture", function() {
            return Bs;
          }),
          n.d(r, "DataTexture2DArray", function() {
            return cl;
          }),
          n.d(r, "DataTexture3D", function() {
            return ul;
          }),
          n.d(r, "DataTextureLoader", function() {
            return Wd;
          }),
          n.d(r, "DecrementStencilOp", function() {
            return Ai;
          }),
          n.d(r, "DecrementWrapStencilOp", function() {
            return Ei;
          }),
          n.d(r, "DefaultLoadingManager", function() {
            return Bd;
          }),
          n.d(r, "DepthFormat", function() {
            return Ar;
          }),
          n.d(r, "DepthStencilFormat", function() {
            return Sr;
          }),
          n.d(r, "DepthTexture", function() {
            return Ku;
          }),
          n.d(r, "DirectionalLight", function() {
            return Rp;
          }),
          n.d(r, "DirectionalLightHelper", function() {
            return gm;
          }),
          n.d(r, "DirectionalLightShadow", function() {
            return Ep;
          }),
          n.d(r, "DiscreteInterpolant", function() {
            return Ed;
          }),
          n.d(r, "DodecahedronBufferGeometry", function() {
            return hh;
          }),
          n.d(r, "DodecahedronGeometry", function() {
            return uh;
          }),
          n.d(r, "DoubleSide", function() {
            return qt;
          }),
          n.d(r, "DstAlphaFactor", function() {
            return yn;
          }),
          n.d(r, "DstColorFactor", function() {
            return xn;
          }),
          n.d(r, "DynamicBufferAttribute", function() {
            return Gm;
          }),
          n.d(r, "DynamicCopyUsage", function() {
            return Hi;
          }),
          n.d(r, "DynamicDrawUsage", function() {
            return Ui;
          }),
          n.d(r, "DynamicReadUsage", function() {
            return zi;
          }),
          n.d(r, "EdgesGeometry", function() {
            return id;
          }),
          n.d(r, "EdgesHelper", function() {
            return iv;
          }),
          n.d(r, "EllipseCurve", function() {
            return Jd;
          }),
          n.d(r, "EqualDepth", function() {
            return En;
          }),
          n.d(r, "EqualStencilFunc", function() {
            return Di;
          }),
          n.d(r, "EquirectangularReflectionMapping", function() {
            return Gn;
          }),
          n.d(r, "EquirectangularRefractionMapping", function() {
            return Hn;
          }),
          n.d(r, "Euler", function() {
            return xa;
          }),
          n.d(r, "EventDispatcher", function() {
            return Wi;
          }),
          n.d(r, "ExtrudeBufferGeometry", function() {
            return Hh;
          }),
          n.d(r, "ExtrudeGeometry", function() {
            return Gh;
          }),
          n.d(r, "Face3", function() {
            return Do;
          }),
          n.d(r, "Face4", function() {
            return Dm;
          }),
          n.d(r, "FaceColors", function() {
            return Kt;
          }),
          n.d(r, "FaceNormalsHelper", function() {
            return pm;
          }),
          n.d(r, "FileLoader", function() {
            return Gd;
          }),
          n.d(r, "FlatShading", function() {
            return Qt;
          }),
          n.d(r, "Float32Attribute", function() {
            return Jm;
          }),
          n.d(r, "Float32BufferAttribute", function() {
            return Go;
          }),
          n.d(r, "Float64Attribute", function() {
            return Km;
          }),
          n.d(r, "Float64BufferAttribute", function() {
            return Ho;
          }),
          n.d(r, "FloatType", function() {
            return pr;
          }),
          n.d(r, "Fog", function() {
            return eu;
          }),
          n.d(r, "FogExp2", function() {
            return $c;
          }),
          n.d(r, "Font", function() {
            return Hp;
          }),
          n.d(r, "FontLoader", function() {
            return Wp;
          }),
          n.d(r, "FrontFaceDirectionCCW", function() {
            return zt;
          }),
          n.d(r, "FrontFaceDirectionCW", function() {
            return Bt;
          }),
          n.d(r, "FrontSide", function() {
            return Wt;
          }),
          n.d(r, "Frustum", function() {
            return Gs;
          }),
          n.d(r, "GammaEncoding", function() {
            return hi;
          }),
          n.d(r, "Geometry", function() {
            return As;
          }),
          n.d(r, "GeometryUtils", function() {
            return lv;
          }),
          n.d(r, "GreaterDepth", function() {
            return Pn;
          }),
          n.d(r, "GreaterEqualDepth", function() {
            return Rn;
          }),
          n.d(r, "GreaterEqualStencilFunc", function() {
            return Ni;
          }),
          n.d(r, "GreaterStencilFunc", function() {
            return Ci;
          }),
          n.d(r, "GridHelper", function() {
            return sm;
          }),
          n.d(r, "Group", function() {
            return Hc;
          }),
          n.d(r, "HalfFloatType", function() {
            return fr;
          }),
          n.d(r, "HemisphereLight", function() {
            return xp;
          }),
          n.d(r, "HemisphereLightHelper", function() {
            return am;
          }),
          n.d(r, "HemisphereLightProbe", function() {
            return Jp;
          }),
          n.d(r, "IcosahedronBufferGeometry", function() {
            return ch;
          }),
          n.d(r, "IcosahedronGeometry", function() {
            return lh;
          }),
          n.d(r, "ImageBitmapLoader", function() {
            return Vp;
          }),
          n.d(r, "ImageLoader", function() {
            return Yd;
          }),
          n.d(r, "ImageUtils", function() {
            return ia;
          }),
          n.d(r, "ImmediateRenderObject", function() {
            return Vf;
          }),
          n.d(r, "IncrementStencilOp", function() {
            return Ti;
          }),
          n.d(r, "IncrementWrapStencilOp", function() {
            return Si;
          }),
          n.d(r, "InstancedBufferAttribute", function() {
            return Lp;
          }),
          n.d(r, "InstancedBufferGeometry", function() {
            return Cp;
          }),
          n.d(r, "InstancedInterleavedBuffer", function() {
            return Df;
          }),
          n.d(r, "InstancedMesh", function() {
            return Iu;
          }),
          n.d(r, "Int16Attribute", function() {
            return Ym;
          }),
          n.d(r, "Int16BufferAttribute", function() {
            return jo;
          }),
          n.d(r, "Int32Attribute", function() {
            return Qm;
          }),
          n.d(r, "Int32BufferAttribute", function() {
            return zo;
          }),
          n.d(r, "Int8Attribute", function() {
            return Hm;
          }),
          n.d(r, "Int8BufferAttribute", function() {
            return Fo;
          }),
          n.d(r, "IntType", function() {
            return hr;
          }),
          n.d(r, "InterleavedBuffer", function() {
            return tu;
          }),
          n.d(r, "InterleavedBufferAttribute", function() {
            return nu;
          }),
          n.d(r, "Interpolant", function() {
            return Td;
          }),
          n.d(r, "InterpolateDiscrete", function() {
            return ei;
          }),
          n.d(r, "InterpolateLinear", function() {
            return ti;
          }),
          n.d(r, "InterpolateSmooth", function() {
            return ni;
          }),
          n.d(r, "InvertStencilOp", function() {
            return Ri;
          }),
          n.d(r, "JSONLoader", function() {
            return uv;
          }),
          n.d(r, "KeepStencilOp", function() {
            return _i;
          }),
          n.d(r, "KeyframeTrack", function() {
            return Rd;
          }),
          n.d(r, "LOD", function() {
            return xu;
          }),
          n.d(r, "LatheBufferGeometry", function() {
            return ed;
          }),
          n.d(r, "LatheGeometry", function() {
            return $h;
          }),
          n.d(r, "Layers", function() {
            return wa;
          }),
          n.d(r, "LensFlare", function() {
            return dv;
          }),
          n.d(r, "LessDepth", function() {
            return An;
          }),
          n.d(r, "LessEqualDepth", function() {
            return Sn;
          }),
          n.d(r, "LessEqualStencilFunc", function() {
            return Oi;
          }),
          n.d(r, "LessStencilFunc", function() {
            return Ii;
          }),
          n.d(r, "Light", function() {
            return bp;
          }),
          n.d(r, "LightProbe", function() {
            return Zp;
          }),
          n.d(r, "LightProbeHelper", function() {
            return om;
          }),
          n.d(r, "LightShadow", function() {
            return wp;
          }),
          n.d(r, "Line", function() {
            return ku;
          }),
          n.d(r, "Line3", function() {
            return zf;
          }),
          n.d(r, "LineBasicMaterial", function() {
            return Du;
          }),
          n.d(r, "LineCurve", function() {
            return up;
          }),
          n.d(r, "LineCurve3", function() {
            return hp;
          }),
          n.d(r, "LineDashedMaterial", function() {
            return wd;
          }),
          n.d(r, "LineLoop", function() {
            return zu;
          }),
          n.d(r, "LinePieces", function() {
            return Cm;
          }),
          n.d(r, "LineSegments", function() {
            return Bu;
          }),
          n.d(r, "LineStrip", function() {
            return Om;
          }),
          n.d(r, "LinearEncoding", function() {
            return ci;
          }),
          n.d(r, "LinearFilter", function() {
            return nr;
          }),
          n.d(r, "LinearInterpolant", function() {
            return Sd;
          }),
          n.d(r, "LinearMipMapLinearFilter", function() {
            return or;
          }),
          n.d(r, "LinearMipMapNearestFilter", function() {
            return ir;
          }),
          n.d(r, "LinearMipmapLinearFilter", function() {
            return ar;
          }),
          n.d(r, "LinearMipmapNearestFilter", function() {
            return rr;
          }),
          n.d(r, "LinearToneMapping", function() {
            return Nn;
          }),
          n.d(r, "Loader", function() {
            return zd;
          }),
          n.d(r, "LoaderUtils", function() {
            return Op;
          }),
          n.d(r, "LoadingManager", function() {
            return jd;
          }),
          n.d(r, "LogLuvEncoding", function() {
            return pi;
          }),
          n.d(r, "LoopOnce", function() {
            return Jr;
          }),
          n.d(r, "LoopPingPong", function() {
            return $r;
          }),
          n.d(r, "LoopRepeat", function() {
            return Kr;
          }),
          n.d(r, "LuminanceAlphaFormat", function() {
            return Mr;
          }),
          n.d(r, "LuminanceFormat", function() {
            return _r;
          }),
          n.d(r, "MOUSE", function() {
            return Lt;
          }),
          n.d(r, "Material", function() {
            return Co;
          }),
          n.d(r, "MaterialLoader", function() {
            return Dp;
          }),
          n.d(r, "Math", function() {
            return Qi;
          }),
          n.d(r, "Matrix3", function() {
            return ra;
          }),
          n.d(r, "Matrix4", function() {
            return ga;
          }),
          n.d(r, "MaxEquation", function() {
            return hn;
          }),
          n.d(r, "Mesh", function() {
            return ys;
          }),
          n.d(r, "MeshBasicMaterial", function() {
            return Lo;
          }),
          n.d(r, "MeshDepthMaterial", function() {
            return Lc;
          }),
          n.d(r, "MeshDistanceMaterial", function() {
            return Nc;
          }),
          n.d(r, "MeshFaceMaterial", function() {
            return Lm;
          }),
          n.d(r, "MeshLambertMaterial", function() {
            return bd;
          }),
          n.d(r, "MeshMatcapMaterial", function() {
            return xd;
          }),
          n.d(r, "MeshNormalMaterial", function() {
            return yd;
          }),
          n.d(r, "MeshPhongMaterial", function() {
            return vd;
          }),
          n.d(r, "MeshPhysicalMaterial", function() {
            return md;
          }),
          n.d(r, "MeshStandardMaterial", function() {
            return fd;
          }),
          n.d(r, "MeshToonMaterial", function() {
            return gd;
          }),
          n.d(r, "MinEquation", function() {
            return un;
          }),
          n.d(r, "MirroredRepeatWrapping", function() {
            return Zn;
          }),
          n.d(r, "MixOperation", function() {
            return On;
          }),
          n.d(r, "MultiMaterial", function() {
            return Nm;
          }),
          n.d(r, "MultiplyBlending", function() {
            return an;
          }),
          n.d(r, "MultiplyOperation", function() {
            return Dn;
          }),
          n.d(r, "NearestFilter", function() {
            return Jn;
          }),
          n.d(r, "NearestMipMapLinearFilter", function() {
            return tr;
          }),
          n.d(r, "NearestMipMapNearestFilter", function() {
            return $n;
          }),
          n.d(r, "NearestMipmapLinearFilter", function() {
            return er;
          }),
          n.d(r, "NearestMipmapNearestFilter", function() {
            return Kn;
          }),
          n.d(r, "NeverDepth", function() {
            return Mn;
          }),
          n.d(r, "NeverStencilFunc", function() {
            return Pi;
          }),
          n.d(r, "NoBlending", function() {
            return en;
          }),
          n.d(r, "NoColors", function() {
            return Jt;
          }),
          n.d(r, "NoToneMapping", function() {
            return Ln;
          }),
          n.d(r, "NormalBlending", function() {
            return tn;
          }),
          n.d(r, "NotEqualDepth", function() {
            return In;
          }),
          n.d(r, "NotEqualStencilFunc", function() {
            return Li;
          }),
          n.d(r, "NumberKeyframeTrack", function() {
            return Dd;
          }),
          n.d(r, "Object3D", function() {
            return Na;
          }),
          n.d(r, "ObjectLoader", function() {
            return kp;
          }),
          n.d(r, "ObjectSpaceNormalMap", function() {
            return xi;
          }),
          n.d(r, "OctahedronBufferGeometry", function() {
            return sh;
          }),
          n.d(r, "OctahedronGeometry", function() {
            return oh;
          }),
          n.d(r, "OneFactor", function() {
            return pn;
          }),
          n.d(r, "OneMinusDstAlphaFactor", function() {
            return bn;
          }),
          n.d(r, "OneMinusDstColorFactor", function() {
            return wn;
          }),
          n.d(r, "OneMinusSrcAlphaFactor", function() {
            return gn;
          }),
          n.d(r, "OneMinusSrcColorFactor", function() {
            return mn;
          }),
          n.d(r, "OrthographicCamera", function() {
            return Sp;
          }),
          n.d(r, "PCFShadowMap", function() {
            return Gt;
          }),
          n.d(r, "PCFSoftShadowMap", function() {
            return Ht;
          }),
          n.d(r, "ParametricBufferGeometry", function() {
            return th;
          }),
          n.d(r, "ParametricGeometry", function() {
            return eh;
          }),
          n.d(r, "Particle", function() {
            return km;
          }),
          n.d(r, "ParticleBasicMaterial", function() {
            return Bm;
          }),
          n.d(r, "ParticleSystem", function() {
            return Um;
          }),
          n.d(r, "ParticleSystemMaterial", function() {
            return zm;
          }),
          n.d(r, "Path", function() {
            return gp;
          }),
          n.d(r, "PerspectiveCamera", function() {
            return Ns;
          }),
          n.d(r, "Plane", function() {
            return ho;
          }),
          n.d(r, "PlaneBufferGeometry", function() {
            return Zs;
          }),
          n.d(r, "PlaneGeometry", function() {
            return Qs;
          }),
          n.d(r, "PlaneHelper", function() {
            return Am;
          }),
          n.d(r, "PointCloud", function() {
            return Fm;
          }),
          n.d(r, "PointCloudMaterial", function() {
            return jm;
          }),
          n.d(r, "PointLight", function() {
            return Ap;
          }),
          n.d(r, "PointLightHelper", function() {
            return em;
          }),
          n.d(r, "Points", function() {
            return Yu;
          }),
          n.d(r, "PointsMaterial", function() {
            return Vu;
          }),
          n.d(r, "PolarGridHelper", function() {
            return lm;
          }),
          n.d(r, "PolyhedronBufferGeometry", function() {
            return rh;
          }),
          n.d(r, "PolyhedronGeometry", function() {
            return nh;
          }),
          n.d(r, "PositionalAudio", function() {
            return ff;
          }),
          n.d(r, "PositionalAudioHelper", function() {
            return cm;
          }),
          n.d(r, "PropertyBinding", function() {
            return Sf;
          }),
          n.d(r, "PropertyMixer", function() {
            return vf;
          }),
          n.d(r, "QuadraticBezierCurve", function() {
            return dp;
          }),
          n.d(r, "QuadraticBezierCurve3", function() {
            return pp;
          }),
          n.d(r, "Quaternion", function() {
            return Ji;
          }),
          n.d(r, "QuaternionKeyframeTrack", function() {
            return Cd;
          }),
          n.d(r, "QuaternionLinearInterpolant", function() {
            return Od;
          }),
          n.d(r, "REVISION", function() {
            return Ct;
          }),
          n.d(r, "RGBADepthPacking", function() {
            return yi;
          }),
          n.d(r, "RGBAFormat", function() {
            return wr;
          }),
          n.d(r, "RGBA_ASTC_10x10_Format", function() {
            return qr;
          }),
          n.d(r, "RGBA_ASTC_10x5_Format", function() {
            return Xr;
          }),
          n.d(r, "RGBA_ASTC_10x6_Format", function() {
            return Wr;
          }),
          n.d(r, "RGBA_ASTC_10x8_Format", function() {
            return Yr;
          }),
          n.d(r, "RGBA_ASTC_12x10_Format", function() {
            return Qr;
          }),
          n.d(r, "RGBA_ASTC_12x12_Format", function() {
            return Zr;
          }),
          n.d(r, "RGBA_ASTC_4x4_Format", function() {
            return kr;
          }),
          n.d(r, "RGBA_ASTC_5x4_Format", function() {
            return Ur;
          }),
          n.d(r, "RGBA_ASTC_5x5_Format", function() {
            return jr;
          }),
          n.d(r, "RGBA_ASTC_6x5_Format", function() {
            return Br;
          }),
          n.d(r, "RGBA_ASTC_6x6_Format", function() {
            return zr;
          }),
          n.d(r, "RGBA_ASTC_8x5_Format", function() {
            return Vr;
          }),
          n.d(r, "RGBA_ASTC_8x6_Format", function() {
            return Gr;
          }),
          n.d(r, "RGBA_ASTC_8x8_Format", function() {
            return Hr;
          }),
          n.d(r, "RGBA_PVRTC_2BPPV1_Format", function() {
            return Nr;
          }),
          n.d(r, "RGBA_PVRTC_4BPPV1_Format", function() {
            return Lr;
          }),
          n.d(r, "RGBA_S3TC_DXT1_Format", function() {
            return Pr;
          }),
          n.d(r, "RGBA_S3TC_DXT3_Format", function() {
            return Ir;
          }),
          n.d(r, "RGBA_S3TC_DXT5_Format", function() {
            return Dr;
          }),
          n.d(r, "RGBDEncoding", function() {
            return vi;
          }),
          n.d(r, "RGBEEncoding", function() {
            return di;
          }),
          n.d(r, "RGBEFormat", function() {
            return Tr;
          }),
          n.d(r, "RGBFormat", function() {
            return xr;
          }),
          n.d(r, "RGBM16Encoding", function() {
            return mi;
          }),
          n.d(r, "RGBM7Encoding", function() {
            return fi;
          }),
          n.d(r, "RGB_ETC1_Format", function() {
            return Fr;
          }),
          n.d(r, "RGB_PVRTC_2BPPV1_Format", function() {
            return Cr;
          }),
          n.d(r, "RGB_PVRTC_4BPPV1_Format", function() {
            return Or;
          }),
          n.d(r, "RGB_S3TC_DXT1_Format", function() {
            return Rr;
          }),
          n.d(r, "RawShaderMaterial", function() {
            return pd;
          }),
          n.d(r, "Ray", function() {
            return so;
          }),
          n.d(r, "Raycaster", function() {
            return Of;
          }),
          n.d(r, "RectAreaLight", function() {
            return Ip;
          }),
          n.d(r, "RectAreaLightHelper", function() {
            return tm;
          }),
          n.d(r, "RedFormat", function() {
            return Er;
          }),
          n.d(r, "ReinhardToneMapping", function() {
            return Fn;
          }),
          n.d(r, "RepeatWrapping", function() {
            return qn;
          }),
          n.d(r, "ReplaceStencilOp", function() {
            return Mi;
          }),
          n.d(r, "ReverseSubtractEquation", function() {
            return cn;
          }),
          n.d(r, "RingBufferGeometry", function() {
            return Kh;
          }),
          n.d(r, "RingGeometry", function() {
            return Jh;
          }),
          n.d(r, "Scene", function() {
            return Fa;
          }),
          n.d(r, "SceneUtils", function() {
            return hv;
          }),
          n.d(r, "ShaderChunk", function() {
            return Hs;
          }),
          n.d(r, "ShaderLib", function() {
            return Ws;
          }),
          n.d(r, "ShaderMaterial", function() {
            return Cs;
          }),
          n.d(r, "ShadowMaterial", function() {
            return dd;
          }),
          n.d(r, "Shape", function() {
            return yp;
          }),
          n.d(r, "ShapeBufferGeometry", function() {
            return nd;
          }),
          n.d(r, "ShapeGeometry", function() {
            return td;
          }),
          n.d(r, "ShapePath", function() {
            return Gp;
          }),
          n.d(r, "ShapeUtils", function() {
            return Bh;
          }),
          n.d(r, "ShortType", function() {
            return cr;
          }),
          n.d(r, "Skeleton", function() {
            return Tu;
          }),
          n.d(r, "SkeletonHelper", function() {
            return $f;
          }),
          n.d(r, "SkinnedMesh", function() {
            return wu;
          }),
          n.d(r, "SmoothShading", function() {
            return Zt;
          }),
          n.d(r, "Sphere", function() {
            return $a;
          }),
          n.d(r, "SphereBufferGeometry", function() {
            return Zh;
          }),
          n.d(r, "SphereGeometry", function() {
            return Qh;
          }),
          n.d(r, "Spherical", function() {
            return Nf;
          }),
          n.d(r, "SphericalHarmonics3", function() {
            return Qp;
          }),
          n.d(r, "SphericalReflectionMapping", function() {
            return Xn;
          }),
          n.d(r, "Spline", function() {
            return tv;
          }),
          n.d(r, "SplineCurve", function() {
            return fp;
          }),
          n.d(r, "SplineCurve3", function() {
            return ev;
          }),
          n.d(r, "SpotLight", function() {
            return Mp;
          }),
          n.d(r, "SpotLightHelper", function() {
            return Qf;
          }),
          n.d(r, "SpotLightShadow", function() {
            return _p;
          }),
          n.d(r, "Sprite", function() {
            return vu;
          }),
          n.d(r, "SpriteMaterial", function() {
            return ru;
          }),
          n.d(r, "SrcAlphaFactor", function() {
            return vn;
          }),
          n.d(r, "SrcAlphaSaturateFactor", function() {
            return _n;
          }),
          n.d(r, "SrcColorFactor", function() {
            return fn;
          }),
          n.d(r, "StaticCopyUsage", function() {
            return Gi;
          }),
          n.d(r, "StaticDrawUsage", function() {
            return ki;
          }),
          n.d(r, "StaticReadUsage", function() {
            return Bi;
          }),
          n.d(r, "StereoCamera", function() {
            return tf;
          }),
          n.d(r, "StreamCopyUsage", function() {
            return Xi;
          }),
          n.d(r, "StreamDrawUsage", function() {
            return ji;
          }),
          n.d(r, "StreamReadUsage", function() {
            return Vi;
          }),
          n.d(r, "StringKeyframeTrack", function() {
            return Ld;
          }),
          n.d(r, "SubtractEquation", function() {
            return ln;
          }),
          n.d(r, "SubtractiveBlending", function() {
            return rn;
          }),
          n.d(r, "TOUCH", function() {
            return Nt;
          }),
          n.d(r, "TangentSpaceNormalMap", function() {
            return bi;
          }),
          n.d(r, "TetrahedronBufferGeometry", function() {
            return ah;
          }),
          n.d(r, "TetrahedronGeometry", function() {
            return ih;
          }),
          n.d(r, "TextBufferGeometry", function() {
            return qh;
          }),
          n.d(r, "TextGeometry", function() {
            return Yh;
          }),
          n.d(r, "Texture", function() {
            return oa;
          }),
          n.d(r, "TextureLoader", function() {
            return Qd;
          }),
          n.d(r, "TorusBufferGeometry", function() {
            return gh;
          }),
          n.d(r, "TorusGeometry", function() {
            return vh;
          }),
          n.d(r, "TorusKnotBufferGeometry", function() {
            return mh;
          }),
          n.d(r, "TorusKnotGeometry", function() {
            return fh;
          }),
          n.d(r, "Triangle", function() {
            return Mo;
          }),
          n.d(r, "TriangleFanDrawMode", function() {
            return li;
          }),
          n.d(r, "TriangleStripDrawMode", function() {
            return si;
          }),
          n.d(r, "TrianglesDrawMode", function() {
            return oi;
          }),
          n.d(r, "TubeBufferGeometry", function() {
            return ph;
          }),
          n.d(r, "TubeGeometry", function() {
            return dh;
          }),
          n.d(r, "UVMapping", function() {
            return Bn;
          }),
          n.d(r, "Uint16Attribute", function() {
            return qm;
          }),
          n.d(r, "Uint16BufferAttribute", function() {
            return Bo;
          }),
          n.d(r, "Uint32Attribute", function() {
            return Zm;
          }),
          n.d(r, "Uint32BufferAttribute", function() {
            return Vo;
          }),
          n.d(r, "Uint8Attribute", function() {
            return Xm;
          }),
          n.d(r, "Uint8BufferAttribute", function() {
            return ko;
          }),
          n.d(r, "Uint8ClampedAttribute", function() {
            return Wm;
          }),
          n.d(r, "Uint8ClampedBufferAttribute", function() {
            return Uo;
          }),
          n.d(r, "Uncharted2ToneMapping", function() {
            return kn;
          }),
          n.d(r, "Uniform", function() {
            return If;
          }),
          n.d(r, "UniformsLib", function() {
            return Xs;
          }),
          n.d(r, "UniformsUtils", function() {
            return Is;
          }),
          n.d(r, "UnsignedByteType", function() {
            return sr;
          }),
          n.d(r, "UnsignedInt248Type", function() {
            return yr;
          }),
          n.d(r, "UnsignedIntType", function() {
            return dr;
          }),
          n.d(r, "UnsignedShort4444Type", function() {
            return mr;
          }),
          n.d(r, "UnsignedShort5551Type", function() {
            return vr;
          }),
          n.d(r, "UnsignedShort565Type", function() {
            return gr;
          }),
          n.d(r, "UnsignedShortType", function() {
            return ur;
          }),
          n.d(r, "VSMShadowMap", function() {
            return Xt;
          }),
          n.d(r, "Vector2", function() {
            return Zi;
          }),
          n.d(r, "Vector3", function() {
            return ea;
          }),
          n.d(r, "Vector4", function() {
            return sa;
          }),
          n.d(r, "VectorKeyframeTrack", function() {
            return Nd;
          }),
          n.d(r, "Vertex", function() {
            return Vm;
          }),
          n.d(r, "VertexColors", function() {
            return $t;
          }),
          n.d(r, "VertexNormalsHelper", function() {
            return Yf;
          }),
          n.d(r, "VideoTexture", function() {
            return Qu;
          }),
          n.d(r, "WebGLMultisampleRenderTarget", function() {
            return ca;
          }),
          n.d(r, "WebGLRenderTarget", function() {
            return la;
          }),
          n.d(r, "WebGLRenderTargetCube", function() {
            return js;
          }),
          n.d(r, "WebGLRenderer", function() {
            return Kc;
          }),
          n.d(r, "WebGLUtils", function() {
            return zc;
          }),
          n.d(r, "WireframeGeometry", function() {
            return $u;
          }),
          n.d(r, "WireframeHelper", function() {
            return av;
          }),
          n.d(r, "WrapAroundEnding", function() {
            return ai;
          }),
          n.d(r, "XHRLoader", function() {
            return ov;
          }),
          n.d(r, "ZeroCurvatureEnding", function() {
            return ri;
          }),
          n.d(r, "ZeroFactor", function() {
            return dn;
          }),
          n.d(r, "ZeroSlopeEnding", function() {
            return ii;
          }),
          n.d(r, "ZeroStencilOp", function() {
            return wi;
          }),
          n.d(r, "sRGBEncoding", function() {
            return ui;
          });
        var i = "asset",
          a = "camera",
          o = "editorData",
          s = "environment",
          l = "info",
          c = "light",
          u = "material",
          h = "meshNode",
          d = "model",
          p = "renderer",
          f = "scene",
          m = "texture",
          v = "node",
          g = "transition",
          y = "annotation",
          b = "state",
          x = "controls",
          w = n(0),
          _ = n(6),
          M = n.n(_),
          T = new (class {
            create(e, t) {
              var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : null;
              (this.solution3DID = n),
                (this.axiosInstance = M.a.create({
                  timeout: 3e4,
                  validateStatus: e => e >= 200 && e <= 299,
                  baseURL: t,
                  headers: { common: { Authorization: "Bearer ".concat(e) } }
                }));
            }
            getSolution3DById(e) {
              return Promise.resolve(!0)
                .then(() => this.axiosInstance.get("api/solution3d/".concat(e)))
                .then(e => {
                  if (e.data.errors.length > 0) throw e.data.errors;
                  return e.data.res;
                });
            }
            parseModel(e, t, n) {
              return Promise.resolve(!0)
                .then(() =>
                  this.axiosInstance.get(
                    "api/solution3d/"
                      .concat(this.solution3DID, "/parseModel/")
                      .concat(e, "/")
                      .concat(t, "/")
                      .concat(n)
                  )
                )
                .then(e => {
                  if (e.data.errors.length > 0) throw e.data.errors;
                  return e.data.res;
                });
            }
            saveTUF(e, t) {
              var n = JSON.stringify(e);
              return Promise.resolve(!0)
                .then(() =>
                  this.axiosInstance.post(
                    "api/solution3d/update/".concat(this.solution3DID),
                    { tuf: n, oldCommit: t, tufVersion: e.info.version }
                  )
                )
                .then(e => {
                  if (e.data.errors.length > 0) throw e.data.errors;
                  return e.data.res;
                });
            }
            getDistibutionInfo(e, t, n, r) {
              return Promise.resolve(!0)
                .then(() =>
                  this.axiosInstance.get(
                    "api/dists/"
                      .concat(n, "/")
                      .concat(t, "/")
                      .concat(e, "/")
                      .concat(r, ".json")
                  )
                )
                .then(e => {
                  if (e.data.errors.length > 0) throw e.data.errors;
                  return e.data.res;
                });
            }
            getDistibutionTUF(e, t) {
              return new Promise((n, r) => {
                M.a
                  .create({ baseURL: e, timeout: 3e4, headers: { common: {} } })
                  .get("/".concat(t), { crossdomain: !0 })
                  .then(e => {
                    e.data.info ? n(e.data) : r("Bad TUF");
                  })
                  .catch(e => {
                    r(e);
                  });
              });
            }
          })(),
          A = n(5),
          S = (n(40), n(2)),
          E = n.n(S),
          R = {
            editor: { loading: 0 },
            TUF: {
              asset: { byId: {}, allIds: [] },
              texture: { byId: {}, allIds: [] },
              textureType: { byId: {}, allIds: [] },
              model: { byId: {}, allIds: [] },
              meshNode: { byId: {}, allIds: [] },
              meshNodeType: { byId: {}, allIds: [] },
              material: { byId: {}, allIds: [] },
              materialType: { byId: {}, allIds: [] },
              renderer: { byId: {}, allIds: [] },
              camera: { byId: {}, allIds: [] },
              cameraType: { byId: {}, allIds: [] },
              light: { byId: {}, allIds: [] },
              lightType: { byId: {}, allIds: [] },
              action: { byId: {}, allIds: [] },
              actionType: { byId: {}, allIds: [] },
              info: {
                version: null,
                converterVersion: null,
                commit: null,
                currentCommit: null,
                solutionID: null,
                solutionType: null,
                entity: "info"
              },
              editorData: {
                processor: null,
                designer3D: {},
                config: {},
                entity: "editorData"
              },
              animation: { byId: {}, allIds: [] },
              scene: {
                editorData: {},
                rendererID: null,
                cameraID: null,
                environmentID: null,
                cameras: [],
                meshNodes: [],
                lights: [],
                selectable: [],
                controls: [],
                entity: "scene",
                active: {
                  rendererID: null,
                  cameraID: null,
                  environmentID: null,
                  cameras: [],
                  meshNodes: [],
                  lights: [],
                  controls: [],
                  selectable: []
                }
              },
              modification: { byId: {}, allIds: [] },
              modificationAction: { byId: {}, allIds: [] },
              modificationActionType: { byId: {}, allIds: [] },
              environment: { byId: {}, allIds: [] },
              node: { byId: {}, allIds: [] },
              nodeType: { byId: {}, allIds: [] },
              transition: { byId: {}, allIds: [] },
              transitionType: { byId: {}, allIds: [] },
              state: { byId: {}, allIds: [] },
              stateType: { byId: {}, allIds: [] },
              annotation: { byId: {}, allIds: [] },
              annotationType: { byId: {}, allIds: [] },
              controls: { byId: {}, allIds: [] },
              controlsType: { byId: {}, allIds: [] }
            }
          };
        function P(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function I(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? P(Object(n), !0).forEach(function(t) {
                  D(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : P(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function D(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        var O = Object(A.combineReducers)({
            editor: function() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : R,
                t = arguments.length > 1 ? arguments[1] : void 0;
              switch (t.type) {
                case "EDITOR_LOADING":
                  return Object.assign({}, e, { loading: t.payload });
                default:
                  return e;
              }
            },
            TUF: function() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : R,
                t = arguments.length > 1 ? arguments[1] : void 0,
                n = {},
                r = null,
                i = null;
              switch (t.type) {
                case "TUF_LOAD":
                  return t.payload.tuf;
                case "TUF_ENTITY_ADD":
                  return (
                    (r = t.payload.entity.entity),
                    (i = t.payload.entity),
                    Object.assign({}, e, {
                      [r]: {
                        byId: I({}, e[r].byId, { [i.id]: I({}, i) }),
                        allIds: [...e[r].allIds, i.id]
                      },
                      info: I({}, e.info, { currentCommit: E()() })
                    })
                  );
                case "TUF_ENTITY_DELETE":
                  return (
                    (r = t.payload.entity.entity),
                    (i = t.payload.entity),
                    delete (n = Object.assign({}, e, {
                      [r]: {
                        byId: I({}, e[r].byId),
                        allIds: [...e[r].allIds.filter(e => e !== i.id)]
                      },
                      info: I({}, e.info, { currentCommit: E()() })
                    }))[r].byId[i.id],
                    n
                  );
                case "TUF_ENTITY_ADD_GROUP":
                  if (0 === t.payload.entityGroup.allIds.length) return e;
                  var a = t.payload.entityGroup.allIds[0];
                  return (
                    (r = t.payload.entityGroup.byId[a].entity),
                    Object.assign({}, e, {
                      [r]: {
                        byId: I({}, e[r].byId, {}, t.payload.entityGroup.byId),
                        allIds: [
                          ...e[r].allIds,
                          ...t.payload.entityGroup.allIds
                        ]
                      },
                      info: I({}, e.info, { currentCommit: E()() })
                    })
                  );
                case "TUF_ENTITY_UPDATE_GROUP":
                  if (0 === t.payload.entityGroup.allIds.length) return e;
                  var o = t.payload.entityGroup.allIds[0];
                  return (
                    (r = t.payload.entityGroup.byId[o].entity),
                    Object.assign({}, e, {
                      [r]: {
                        byId: I({}, e[r].byId, {}, t.payload.entityGroup.byId),
                        allIds: e[r].allIds
                      },
                      info: I({}, e.info, { currentCommit: E()() })
                    })
                  );
                case "TUF_ENTITY_UPDATE":
                  return (
                    (r = t.payload.entity.entity),
                    (i = t.payload.entity),
                    Object.assign({}, e, {
                      [r]: {
                        byId: I({}, e[r].byId, { [i.id]: I({}, i) }),
                        allIds: e[r].allIds
                      },
                      info: I({}, e.info, { currentCommit: E()() })
                    })
                  );
                case "TUF_SINGLE_UPDATE":
                  return (
                    (r = t.payload.single.entity),
                    (i = t.payload.single),
                    "info" !== r
                      ? Object.assign({}, e, {
                          [r]: I({}, i),
                          info: I({}, e.info, { currentCommit: E()() })
                        })
                      : Object.assign({}, e, { [r]: I({}, i) })
                  );
                default:
                  return e;
              }
            }
          }),
          C = Object(A.createStore)(O, R, Object(A.applyMiddleware)()),
          L = (e, t) => {
            var n = e(C.getState());
            function r() {
              var r = e(C.getState());
              r !== n && t((n = r));
            }
            var i = C.subscribe(r);
            return r(), i;
          },
          N = n(19),
          F = n.n(N),
          k = n(20),
          U = n.n(k),
          j = n(7),
          B = n.n(j),
          z = "reference",
          V = "arrayReference",
          G = "belongsTo",
          H = "hasOne",
          X = "hasMany",
          W = "entity",
          Y = "single",
          q = "1",
          Q = "1",
          Z = "2",
          J = "3",
          K = "4",
          $ = "1",
          ee = "2",
          te = "3",
          ne = "4",
          re = "5",
          ie = "2",
          ae = "3",
          oe = 4,
          se = 6,
          le = class {
            constructor() {}
            static getRelation(e, t) {
              var n =
                arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
              switch (t.referenceType) {
                case G:
                  return this._getBelongsTo(e, t, n);
                case H:
                  return this._getHasOne(e, t, n);
                case X:
                  return this._getHasMany(e, t, n);
              }
              return null;
            }
            static _getHasMany(e, t, n) {
              for (
                var r = e[t.field],
                  i = { byId: {}, allIds: [] },
                  a = Ot.getEntityGroup(t.referenceEntity),
                  o = 0;
                o < a.allIds.length;
                o++
              ) {
                var s = a.byId[a.allIds[o]];
                if (void 0 !== s.relations[t.relationReferenceName]) {
                  var l = s[t.referenceOn];
                  if (
                    (n && (l = s.active[t.referenceOn]),
                    Array.isArray(l) && -1 !== l.indexOf(r))
                  ) {
                    (i.byId[s.id] = s), i.allIds.push(s.id);
                    break;
                  }
                  l === r &&
                    null !== l &&
                    ((i.byId[s.id] = s), i.allIds.push(s.id));
                }
              }
              return i;
            }
            static _getHasOne(e, t, n) {
              var r = e[t.field],
                i = null,
                a = { byId: {}, allIds: [] };
              Ot.getTUFModelForEntity(t.referenceEntity).getEntityType() === Y
                ? ((a.byId.single = Ot.getSingle(t.referenceEntity)),
                  a.allIds.push(Y))
                : (a = Ot.getEntityGroup(t.referenceEntity));
              for (var o = 0; o < a.allIds.length; o++) {
                var s = a.byId[a.allIds[o]];
                if (void 0 !== s.relations[t.relationReferenceName]) {
                  var l = s[t.referenceOn];
                  if (
                    (n && (l = s.active[t.referenceOn]),
                    Array.isArray(l) && -1 !== l.indexOf(r))
                  ) {
                    i = s;
                    break;
                  }
                  l === r && null !== l && (i = s);
                }
              }
              return i;
            }
            static _getBelongsTo(e, t, n) {
              var r = [],
                i = { byId: {}, allIds: [] },
                a = e;
              n && (a = e.active),
                t.fieldType === V && (r = a[t.field]),
                t.fieldType === z && null !== a[t.field] && (r[0] = a[t.field]);
              for (var o = 0; o < r.length; o++) {
                var s = Ot.getEntity(t.referenceEntity, r[o]);
                null !== s && ((i.byId[s.id] = s), i.allIds.push(s.id));
              }
              return t.fieldType === z
                ? 0 === i.allIds.length
                  ? null
                  : i.byId[i.allIds[0]]
                : i;
            }
          };
        class ce {
          constructor() {
            (this.relations = {}), (this.relActive = {}), (this.rel = {});
          }
          getTypeName() {
            var e = this.getType();
            return null === e ? null : e.nameUQ;
          }
          getType() {
            if (null == this.constructor._typeRelation) return null;
            var e = this.constructor._relations.commonRelations[
              this.constructor._typeRelation
            ];
            return Ot.getEntity(e.referenceEntity, this[e.field]);
          }
          setFromData(e) {
            void 0 !== e.rel && delete e.rel,
              void 0 !== e.relActive && delete e.relActive,
              void 0 !== e.relations && delete e.relations,
              Object.keys(e).map(t => {
                "object" == typeof e[t] && null !== e[t]
                  ? (this[t] = JSON.parse(JSON.stringify(e[t])))
                  : (this[t] = e[t]);
              });
            var t = this.getTypeName();
            (this.relations = this.constructor.getRelations(t)),
              Object.keys(this.relations).map(e => {
                (this.rel[e] = () => le.getRelation(this, this.relations[e])),
                  this.relations[e].active &&
                    (this.relActive[e] = () =>
                      le.getRelation(this, this.relations[e], !0));
              });
          }
          assignFromData(e) {
            return (
              void 0 !== e.rel && delete e.rel,
              void 0 !== e.relActive && delete e.relActive,
              void 0 !== e.relations && delete e.relations,
              F()(this, e)
            );
          }
          getDiff(e) {
            var t =
                !(arguments.length > 1 && void 0 !== arguments[1]) ||
                arguments[1],
              n = U()(this, e) || [];
            return t
              ? n.filter(
                  e => !["rel", "relActive", "relations"].includes(e.path[0])
                )
              : n;
          }
          static getEntityType() {
            return this._entityType;
          }
          static getEntityName() {
            return this._entity;
          }
          static getUniqueGroups() {
            return this._uniqueGroups;
          }
          static getRules() {
            var e =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : null,
              t = {};
            return (
              e && this._rules.typeRules[e] && (t = this._rules.typeRules[e]),
              B()(this._rules.commonRules, t, { arrayMerge: (e, t) => t })
            );
          }
          static getRelations() {
            var e =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : null,
              t = {};
            return (
              e &&
                this._relations.typeRelations[e] &&
                (t = this._relations.typeRelations[e]),
              B()(this._relations.commonRelations, t, {
                arrayMerge: (e, t) => t
              })
            );
          }
          static getAllRelationFileds() {
            var e =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : null,
              t = [],
              n = this.getRelations(this._defaultType);
            return (
              Object.keys(n).map(r => {
                null === e
                  ? t.push(n[r].field)
                  : n[r].referenceType === e && t.push(n[r].field);
              }),
              t
            );
          }
        }
        (ce._entity = null),
          (ce._entityType = W),
          (ce._defaultType = null),
          (ce._typeRelation = null),
          (ce._uniqueGroups = []),
          (ce._rules = { commonRules: {}, typeRules: {} }),
          (ce._relations = { commonRelations: {}, typeRelations: {} });
        var ue = ce,
          he = "id",
          de = "entityLocation",
          pe = "fixedValue",
          fe = "coordinate2",
          me = "coordinate3",
          ve = "coordinate4",
          ge = "color",
          ye = "object",
          be = "copyObj",
          xe = "array",
          we = "enum",
          _e = "config",
          Me = "string",
          Te = "boolean",
          Ae = "float",
          Se = "range",
          Ee = "integer";
        class Re extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Re._entity = i),
          (Re._entityType = W),
          (Re._relations = {
            commonRelations: {
              model: {
                field: he,
                fieldType: z,
                referenceEntity: d,
                relationReferenceName: "asset",
                referenceOn: "assetID",
                referenceType: H
              },
              textures: {
                field: he,
                fieldType: z,
                referenceEntity: m,
                relationReferenceName: "asset",
                referenceOn: "assetID",
                referenceType: X
              }
            },
            typeRelations: {}
          }),
          (Re._rules = {
            commonRules: {
              id: { typeRes: he },
              name: { typeRes: Me, requiredRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                src: { typeRes: Me, requiredRes: !0 },
                size: { typeRes: Ee, requiredRes: !0 },
                thumb_src: { typeRes: Me, requiredRes: !0 },
                extension: {
                  typeRes: we,
                  enumValuesRes: [
                    "tuf",
                    "jpg",
                    "png",
                    "gif",
                    "jpeg",
                    "tif",
                    "hdr",
                    "exr"
                  ],
                  requiredRes: !0
                },
                refAssetID: { typeRes: Me, requiredRes: !0 },
                tuf_version: { typeRes: Me, defaultRes: "none" },
                converter_version: { typeRes: Me, defaultRes: "none" }
              }
            },
            typeRules: {}
          });
        var Pe = Re;
        class Ie extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Ie._entity = m),
          (Ie._entityType = W),
          (Ie._defaultType = "Basic"),
          (Ie._typeRelation = "textureType"),
          (Ie._relations = {
            commonRelations: {
              textureType: {
                field: "textureTypeID",
                fieldType: z,
                referenceEntity: "textureType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              alphaMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "alphaMap",
                referenceOn: "alphaMapID",
                referenceType: X,
                active: !0
              },
              aoMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "aoMap",
                referenceOn: "aoMapID",
                referenceType: X,
                active: !0
              },
              bumpMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "bumpMap",
                referenceOn: "bumpMapID",
                referenceType: X,
                active: !0
              },
              displacementMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "displacementMap",
                referenceOn: "displacementMapID",
                referenceType: X,
                active: !0
              },
              emissiveMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "emissiveMap",
                referenceOn: "emissiveMapID",
                referenceType: X,
                active: !0
              },
              envMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "envMap",
                referenceOn: "envMapID",
                referenceType: X,
                active: !0
              },
              lightMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "lightMap",
                referenceOn: "lightMapID",
                referenceType: X,
                active: !0
              },
              diffuseMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "diffuseMap",
                referenceOn: "diffuseMapID",
                referenceType: X,
                active: !0
              },
              metalnessMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "metalnessMap",
                referenceOn: "metalnessMapID",
                referenceType: X,
                active: !0
              },
              normalMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "normalMap",
                referenceOn: "normalMapID",
                referenceType: X,
                active: !0
              },
              roughnessMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "roughnessMap",
                referenceOn: "roughnessMapID",
                referenceType: X,
                active: !0
              },
              specularMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "specularMap",
                referenceOn: "specularMapID",
                referenceType: X,
                active: !0
              },
              envMapsEnv: {
                field: he,
                fieldType: z,
                referenceEntity: s,
                relationReferenceName: "envMap",
                referenceOn: "envMapID",
                referenceType: X,
                active: !0
              },
              gradientMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "gradientMap",
                referenceOn: "gradientMapID",
                referenceType: X,
                active: !0
              },
              clearcoatNormalMaps: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                relationReferenceName: "clearcoatNormalMap",
                referenceOn: "clearcoatNormalMapID",
                referenceType: X,
                active: !0
              }
            },
            typeRelations: {
              Basic: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              BasicHDR: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              BasicEXR: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              Equirectangular: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              EquirectangularHDR: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              EquirectangularEXR: {
                asset: {
                  field: "assetID",
                  fieldType: z,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G
                }
              },
              Cube: {
                assetIDs: {
                  field: "assetIDs",
                  fieldType: V,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: []
                }
              },
              CubeHDR: {
                assetIDs: {
                  field: "assetIDs",
                  fieldType: V,
                  referenceEntity: i,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: []
                }
              }
            }
          }),
          (Ie._rules = {
            commonRules: {
              id: { typeRes: he },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                mapping: {
                  typeRes: we,
                  enumValuesRes: [
                    "UVMapping",
                    "CubeReflectionMapping",
                    "CubeRefractionMapping",
                    "EquirectangularReflectionMapping",
                    "EquirectangularRefractionMapping",
                    "SphericalReflectionMapping",
                    "CubeUVReflectionMapping",
                    "CubeUVRefractionMapping"
                  ],
                  defaultRes: "UVMapping"
                },
                wrapS: {
                  typeRes: we,
                  enumValuesRes: [
                    "ClampToEdgeWrapping",
                    "RepeatWrapping",
                    "MirroredRepeatWrapping"
                  ],
                  defaultRes: "RepeatWrapping"
                },
                wrapT: {
                  typeRes: we,
                  enumValuesRes: [
                    "ClampToEdgeWrapping",
                    "RepeatWrapping",
                    "MirroredRepeatWrapping"
                  ],
                  defaultRes: "RepeatWrapping"
                },
                magFilter: {
                  typeRes: we,
                  enumValuesRes: ["LinearFilter", "NearestFilter"],
                  defaultRes: "LinearFilter"
                },
                minFilter: {
                  typeRes: we,
                  enumValuesRes: [
                    "NearestFilter",
                    "NearestMipmapNearestFilter",
                    "NearestMipmapLinearFilter",
                    "LinearFilter",
                    "LinearMipmapNearestFilter",
                    "LinearMipmapLinearFilter"
                  ],
                  defaultRes: "LinearMipmapLinearFilter"
                },
                anisotropy: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 32,
                  defaultRes: 1
                },
                format: {
                  typeRes: we,
                  enumValuesRes: [
                    "RGBAFormat",
                    "AlphaFormat",
                    "RGBFormat",
                    "LuminanceFormat",
                    "LuminanceAlphaFormat",
                    "RGBEFormat",
                    "DepthFormat",
                    "DepthStencilFormat"
                  ],
                  defaultRes: "RGBAFormat"
                },
                type: {
                  typeRes: we,
                  enumValuesRes: [
                    "UnsignedByteType",
                    "ByteType",
                    "ShortType",
                    "UnsignedShortType",
                    "IntType",
                    "UnsignedIntType",
                    "FloatType",
                    "HalfFloatType",
                    "UnsignedShort4444Type",
                    "UnsignedShort5551Type",
                    "UnsignedShort565Type",
                    "UnsignedInt248Type"
                  ],
                  defaultRes: "UnsignedByteType"
                },
                offset: { typeRes: fe, defaultRes: [0, 0] },
                repeat: { typeRes: fe, defaultRes: [1, 1] },
                rotation: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 6.28,
                  defaultRes: 0
                },
                center: { typeRes: fe, defaultRes: [0, 0] },
                premultiplyAlpha: { typeRes: Te, defaultRes: !1 },
                flipY: { typeRes: Te, defaultRes: !0 },
                unpackAlignment: {
                  typeRes: we,
                  enumValuesRes: ["1", "2", "4", "8"],
                  defaultRes: "8"
                },
                encoding: {
                  typeRes: we,
                  enumValuesRes: [
                    "LinearEncoding",
                    "sRGBEncoding",
                    "GammaEncoding",
                    "RGBEEncoding",
                    "LogLuvEncoding",
                    "RGBM7Encoding",
                    "RGBM16Encoding",
                    "RGBDEncoding",
                    "BasicDepthPacking",
                    "RGBADepthPacking"
                  ],
                  defaultRes: "LinearEncoding"
                },
                useLegacy: { typeRes: Te, defaultRes: !1 }
              }
            },
            typeRules: {
              Basic: {},
              BasicHDR: {},
              BasicEXR: {},
              Equirectangular: {
                config: {
                  typeRes: _e,
                  resolution: { typeRes: Ee, defaultRes: 512 }
                }
              },
              EquirectangularHDR: {
                config: {
                  typeRes: _e,
                  resolution: { typeRes: Ee, defaultRes: 512 }
                }
              },
              EquirectangularEXR: {
                config: {
                  typeRes: _e,
                  resolution: { typeRes: Ee, defaultRes: 512 }
                }
              },
              Cube: {},
              CubeHDR: {}
            }
          });
        var De = Ie;
        class Oe extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Oe._entity = "textureType"),
          (Oe._entityType = W),
          (Oe._relations = {
            commonRelations: {
              textures: {
                field: he,
                fieldType: z,
                referenceEntity: m,
                referenceOn: "textureTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (Oe._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var Ce = Oe;
        class Le extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Le._entity = d),
          (Le._entityType = W),
          (Le._relations = {
            commonRelations: {
              asset: {
                field: "assetID",
                fieldType: z,
                referenceEntity: i,
                referenceOn: he,
                referenceType: G
              },
              rootNode: {
                field: "rootNodeID",
                fieldType: z,
                referenceEntity: h,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              },
              meshNodes: {
                field: he,
                fieldType: z,
                referenceEntity: h,
                relationReferenceName: d,
                referenceOn: "modelID",
                referenceType: X
              }
            },
            typeRelations: {}
          }),
          (Le._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var Ne = Le;
        class Fe extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return (
              "Mesh" === this.getTypeName() && null !== this.relActive.scene()
            );
          }
          isSceneDefault() {
            return "Mesh" === this.getTypeName() && null !== this.rel.scene();
          }
        }
        (Fe._entity = h),
          (Fe._entityType = W),
          (Fe._defaultType = "Mesh"),
          (Fe._typeRelation = "meshNodeType"),
          (Fe._uniqueGroups = [
            ["modelID", "nameUQ"],
            ["modelID", "titleUQ"]
          ]),
          (Fe._relations = {
            commonRelations: {
              meshNodeType: {
                field: "meshNodeTypeID",
                fieldType: z,
                referenceEntity: "meshNodeType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              model: {
                field: "modelID",
                fieldType: z,
                referenceEntity: d,
                referenceOn: he,
                relationReferenceName: "meshNodes",
                referenceType: G
              },
              modelRootNode: {
                field: he,
                fieldType: z,
                referenceEntity: d,
                referenceOn: "rootNodeID",
                referenceType: H
              },
              node: {
                field: "nodeID",
                fieldType: z,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: "meshNodes",
                referenceOn: "meshNodes",
                referenceType: H,
                active: !0
              }
            },
            typeRelations: {
              Mesh: {
                material: {
                  field: "materialID",
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: he,
                  referenceType: G,
                  active: !0
                }
              },
              Object3D: {
                material: {
                  field: "materialID",
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              },
              Group: {
                material: {
                  field: "materialID",
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              }
            }
          }),
          (Fe._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0 },
              titleUQ: { typeRes: Me, requiredRes: !0 },
              action: { typeRes: xe },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                position: { typeRes: me, defaultRes: [0, 0, 0], activeRes: !0 },
                lockPosition: { typeRes: Te, defaultRes: !0 },
                scale: { typeRes: me, defaultRes: [1, 1, 1], activeRes: !0 },
                lockScale: { typeRes: Te, defaultRes: !0 },
                quaternion: {
                  typeRes: ve,
                  defaultRes: [0, 0, 0, 1],
                  activeRes: !0
                },
                lockQuaternion: { typeRes: Te, defaultRes: !0 },
                frustumCulled: { typeRes: Te, defaultRes: !0 },
                receiveShadow: { typeRes: Te, defaultRes: !1 },
                castShadow: { typeRes: Te, defaultRes: !1 },
                renderOrder: { typeRes: Ee, defaultRes: 0 }
              }
            },
            typeRules: {}
          });
        var ke = Fe;
        class Ue extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Ue._entity = "meshNodeType"),
          (Ue._entityType = W),
          (Ue._relations = {
            commonRelations: {
              meshNodes: {
                field: he,
                fieldType: z,
                referenceEntity: h,
                referenceOn: "meshNodeTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (Ue._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var je = Ue,
          Be = {
            typeRes: _e,
            alphaTest: { typeRes: Ae, defaultRes: 0 },
            blendDst: {
              typeRes: we,
              enumValuesRes: [
                "ZeroFactor",
                "OneFactor",
                "SrcColorFactor",
                "OneMinusSrcColorFactor",
                "SrcAlphaFactor",
                "OneMinusSrcAlphaFactor",
                "DstAlphaFactor",
                "OneMinusDstAlphaFactor",
                "DstColorFactor",
                "OneMinusDstColorFactor"
              ],
              defaultRes: "OneMinusSrcAlphaFactor"
            },
            blendDstAlpha: { typeRes: Ee, defaultRes: null },
            blendEquation: {
              typeRes: we,
              enumValuesRes: [
                "AddEquation",
                "SubtractEquation",
                "ReverseSubtractEquation",
                "MinEquation",
                "MaxEquation"
              ],
              defaultRes: "AddEquation"
            },
            blendEquationAlpha: { typeRes: Ee, defaultRes: null },
            blending: {
              typeRes: we,
              enumValuesRes: [
                "NoBlending",
                "NormalBlending",
                "AdditiveBlending",
                "SubtractiveBlending",
                "MultiplyBlending",
                "CustomBlending"
              ],
              defaultRes: "NormalBlending"
            },
            blendSrc: {
              typeRes: we,
              enumValuesRes: [
                "ZeroFactor",
                "OneFactor",
                "SrcColorFactor",
                "OneMinusSrcColorFactor",
                "SrcAlphaFactor",
                "OneMinusSrcAlphaFactor",
                "DstAlphaFactor",
                "OneMinusDstAlphaFactor",
                "DstColorFactor",
                "OneMinusDstColorFactor",
                "SrcAlphaSaturateFactor"
              ],
              defaultRes: "SrcAlphaFactor"
            },
            blendSrcAlpha: { typeRes: Ee, defaultRes: null },
            clipIntersection: { typeRes: Te, defaultRes: !1 },
            clipShadows: { typeRes: Te, defaultRes: !1 },
            colorWrite: { typeRes: Te, defaultRes: !0 },
            depthFunc: {
              typeRes: we,
              enumValuesRes: [
                "NeverDepth",
                "AlwaysDepth",
                "LessDepth",
                "LessEqualDepth",
                "GreaterEqualDepth",
                "GreaterDepth",
                "NotEqualDepth"
              ],
              defaultRes: "LessEqualDepth"
            },
            depthTest: { typeRes: Te, defaultRes: !0 },
            depthWrite: { typeRes: Te, defaultRes: !0 },
            flatShading: { typeRes: Te, defaultRes: !1 },
            fog: { typeRes: Te, defaultRes: !0 },
            lights: { typeRes: Te, defaultRes: !0 },
            opacity: {
              typeRes: Se,
              minRangeRes: 0,
              maxRangeRes: 1,
              defaultRes: 1
            },
            polygonOffset: { typeRes: Te, defaultRes: !1 },
            polygonOffsetFactor: { typeRes: Ee, defaultRes: 0 },
            polygonOffsetUnits: { typeRes: Ee, defaultRes: 0 },
            precision: {
              typeRes: we,
              enumValuesRes: ["highp", "mediump", "lowp", null],
              defaultRes: null
            },
            premultipliedAlpha: { typeRes: Te, defaultRes: !1 },
            dithering: { typeRes: Te, defaultRes: !1 },
            shadowSide: {
              typeRes: we,
              enumValuesRes: ["FrontSide", "BackSide", "DoubleSide", null],
              defaultRes: null
            },
            side: {
              typeRes: we,
              enumValuesRes: ["FrontSide", "BackSide", "DoubleSide"],
              defaultRes: "FrontSide"
            },
            transparent: { typeRes: Te, defaultRes: !1 },
            vertexColors: {
              typeRes: we,
              enumValuesRes: ["NoColors", "VertexColors", "FaceColors"],
              defaultRes: "NoColors"
            },
            vertexTangents: { typeRes: Te, defaultRes: !1 }
          };
        function ze(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Ve(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? ze(Object(n), !0).forEach(function(t) {
                  Ge(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : ze(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function Ge(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        class He extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (He._entity = u),
          (He._entityType = W),
          (He._defaultType = "MeshBasicMaterial"),
          (He._typeRelation = "materialType"),
          (He._relations = {
            commonRelations: {
              materialType: {
                field: "materialTypeID",
                fieldType: z,
                referenceEntity: "materialType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              meshNodes: {
                field: he,
                fieldType: z,
                referenceEntity: h,
                relationReferenceName: u,
                active: !0,
                referenceOn: "materialID",
                referenceType: X
              },
              annotations: {
                field: he,
                fieldType: z,
                referenceEntity: y,
                relationReferenceName: u,
                active: !0,
                referenceOn: "materialID",
                referenceType: X
              }
            },
            typeRelations: {
              MeshBasicMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                specularMap: {
                  field: "specularMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              MeshStandardMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                bumpMap: {
                  field: "bumpMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                displacementMap: {
                  field: "displacementMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                emissiveMap: {
                  field: "emissiveMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                metalnessMap: {
                  field: "metalnessMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                normalMap: {
                  field: "normalMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                roughnessMap: {
                  field: "roughnessMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              MeshPhongMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                bumpMap: {
                  field: "bumpMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                displacementMap: {
                  field: "displacementMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                emissiveMap: {
                  field: "emissiveMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                normalMap: {
                  field: "normalMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                specularMap: {
                  field: "specularMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              MeshLambertMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                emissiveMap: {
                  field: "emissiveMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                specularMap: {
                  field: "specularMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              SpriteMaterial: {
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                }
              },
              MeshPhysicalMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                bumpMap: {
                  field: "bumpMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                displacementMap: {
                  field: "displacementMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                emissiveMap: {
                  field: "emissiveMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                metalnessMap: {
                  field: "metalnessMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                normalMap: {
                  field: "normalMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                roughnessMap: {
                  field: "roughnessMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                clearcoatNormalMap: {
                  field: "clearcoatNormalMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              CompoundMaterial: {
                materialIDs: {
                  field: "materialIDs",
                  fieldType: V,
                  referenceEntity: u,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: [],
                  active: !0
                }
              },
              MeshToonMaterial: {
                alphaMap: {
                  field: "alphaMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                aoMap: {
                  field: "aoMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                bumpMap: {
                  field: "bumpMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                displacementMap: {
                  field: "displacementMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                emissiveMap: {
                  field: "emissiveMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                envMap: {
                  field: "envMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                lightMap: {
                  field: "lightMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                diffuseMap: {
                  field: "diffuseMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                normalMap: {
                  field: "normalMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                specularMap: {
                  field: "specularMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                gradientMap: {
                  field: "gradientMapID",
                  fieldType: z,
                  referenceEntity: m,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null,
                  active: !0
                },
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              },
              ShadowMaterial: {
                compoundMaterial: {
                  field: he,
                  fieldType: z,
                  referenceEntity: u,
                  referenceOn: "materialIDs",
                  relationReferenceName: "materialIDs",
                  referenceType: H,
                  defaultValue: null
                }
              }
            }
          }),
          (He._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: {
                typeRes: be,
                defaultRes: { useGlobalAoMap: !0, useGlobalEnvMap: !0 }
              },
              showData: { typeRes: be, defaultRes: {} },
              config: {}
            },
            typeRules: {
              MeshBasicMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  combine: {
                    typeRes: we,
                    enumValuesRes: ["Multiply", "MixOperation", "AddOperation"],
                    defaultRes: "Multiply"
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 1
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  lights: { typeRes: pe, fixedValueRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              MeshStandardMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  bumpScale: {
                    typeRes: Se,
                    minRangeRes: -100,
                    maxRangeRes: 100,
                    defaultRes: 1
                  },
                  displacementScale: { typeRes: Ae, defaultRes: 1 },
                  displacementBias: { typeRes: Ae, defaultRes: 0 },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  envMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  metalness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  morphNormals: { typeRes: Te, defaultRes: !1 },
                  normalMapType: {
                    typeRes: we,
                    enumValuesRes: [
                      "TangentSpaceNormalMap",
                      "ObjectSpaceNormalMap"
                    ],
                    defaultRes: "TangentSpaceNormalMap"
                  },
                  normalScale: { typeRes: fe, defaultRes: [1, 1] },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  roughness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.5
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinejoin: {
                    typeRes: we,
                    enumValuesRes: ["round", "bevel", "miter"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              MeshPhongMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  bumpScale: {
                    typeRes: Se,
                    minRangeRes: -100,
                    maxRangeRes: 100,
                    defaultRes: 1
                  },
                  displacementScale: { typeRes: Ae, defaultRes: 1 },
                  displacementBias: { typeRes: Ae, defaultRes: 0 },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  combine: {
                    typeRes: we,
                    enumValuesRes: ["Multiply", "MixOperation", "AddOperation"],
                    defaultRes: "Multiply"
                  },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  morphNormals: { typeRes: Te, defaultRes: !1 },
                  normalMapType: {
                    typeRes: we,
                    enumValuesRes: [
                      "TangentSpaceNormalMap",
                      "ObjectSpaceNormalMap"
                    ],
                    defaultRes: "TangentSpaceNormalMap"
                  },
                  normalScale: { typeRes: fe, defaultRes: [1, 1] },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.04
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  shininess: {
                    typeRes: Se,
                    minRangeRes: -1e3,
                    maxRangeRes: 1e3,
                    defaultRes: 30
                  },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinejoin: {
                    typeRes: we,
                    enumValuesRes: ["round", "bevel", "miter"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              MeshLambertMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  combine: {
                    typeRes: we,
                    enumValuesRes: ["Multiply", "MixOperation", "AddOperation"],
                    defaultRes: "Multiply"
                  },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  morphNormals: { typeRes: Te, defaultRes: !1 },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 1
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinejoin: {
                    typeRes: we,
                    enumValuesRes: ["round", "bevel", "miter"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              SpriteMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  rotation: { typeRes: Ae, defaultRes: 0 },
                  sizeAttenuation: { typeRes: Te, defaultRes: !0 },
                  lights: { typeRes: pe, fixedValueRes: !1 },
                  transparent: { typeRes: Te, defaultRes: !0 },
                  precisionPicking: { typeRes: Te, defaultRes: !0 }
                })
              },
              CompoundMaterial: { config: { typeRes: _e } },
              MeshPhysicalMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  bumpScale: {
                    typeRes: Se,
                    minRangeRes: -100,
                    maxRangeRes: 100,
                    defaultRes: 1
                  },
                  displacementScale: { typeRes: Ae, defaultRes: 1 },
                  displacementBias: { typeRes: Ae, defaultRes: 0 },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  clearcoat: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  clearcoatRoughness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  clearcoatNormalScale: { typeRes: fe, defaultRes: [1, 1] },
                  sheen: { typeRes: ge, defaultRes: null },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  envMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  metalness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  morphNormals: { typeRes: Te, defaultRes: !1 },
                  normalMapType: {
                    typeRes: we,
                    enumValuesRes: [
                      "TangentSpaceNormalMap",
                      "ObjectSpaceNormalMap"
                    ],
                    defaultRes: "TangentSpaceNormalMap"
                  },
                  normalScale: { typeRes: fe, defaultRes: [1, 1] },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.04
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  roughness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.5
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinejoin: {
                    typeRes: we,
                    enumValuesRes: ["round", "bevel", "miter"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              MeshToonMaterial: {
                config: Ve({ typeRes: _e }, Be, {
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  bumpScale: {
                    typeRes: Se,
                    minRangeRes: -100,
                    maxRangeRes: 100,
                    defaultRes: 1
                  },
                  displacementScale: { typeRes: Ae, defaultRes: 1 },
                  displacementBias: { typeRes: Ae, defaultRes: 0 },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  combine: {
                    typeRes: we,
                    enumValuesRes: ["Multiply", "MixOperation", "AddOperation"],
                    defaultRes: "Multiply"
                  },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  envMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  morphNormals: { typeRes: Te, defaultRes: !1 },
                  normalMapType: {
                    typeRes: we,
                    enumValuesRes: [
                      "TangentSpaceNormalMap",
                      "ObjectSpaceNormalMap"
                    ],
                    defaultRes: "TangentSpaceNormalMap"
                  },
                  normalScale: { typeRes: fe, defaultRes: [1, 1] },
                  morphTargets: { typeRes: Te, defaultRes: !1 },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 1
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  skinning: { typeRes: Te, defaultRes: !1 },
                  shininess: {
                    typeRes: Se,
                    minRangeRes: -1e3,
                    maxRangeRes: 1e3,
                    defaultRes: 30
                  },
                  wireframe: { typeRes: Te, defaultRes: !1 },
                  wireframeLinecap: {
                    typeRes: we,
                    enumValuesRes: ["butt", "round", "square"],
                    defaultRes: "round"
                  },
                  wireframeLinejoin: {
                    typeRes: we,
                    enumValuesRes: ["round", "bevel", "miter"],
                    defaultRes: "round"
                  },
                  wireframeLinewidth: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  }
                })
              },
              ShadowMaterial: { config: Ve({ typeRes: _e }, Be) }
            }
          });
        var Xe = He;
        class We extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (We._entity = "materialType"),
          (We._entityType = W),
          (We._relations = {
            commonRelations: {
              materials: {
                field: he,
                fieldType: z,
                referenceEntity: u,
                referenceOn: "materialTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (We._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var Ye = We;
        class qe extends ue {
          constructor() {
            super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (qe._entity = p),
          (qe._entityType = W),
          (qe._relations = {
            commonRelations: {
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: p,
                referenceOn: "rendererID",
                referenceType: H,
                active: !0
              }
            },
            typeRelations: {}
          }),
          (qe._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                alpha: { typeRes: Te, defaultRes: !0 },
                aaBuiltin: { typeRes: Te, defaultRes: !0 },
                aaPostProcessingAA: {
                  typeRes: we,
                  enumValuesRes: ["None", "FXAA", "SMAA", "SSAA"],
                  defaultRes: "None"
                },
                HQaaPostProcessingAA: {
                  typeRes: we,
                  enumValuesRes: ["None", "FXAA", "SMAA", "SSAA"],
                  defaultRes: "None"
                },
                aaSampleLevel: { typeRes: Ee, defaultRes: 0 },
                HQaaSampleLevel: { typeRes: Ee, defaultRes: 0 },
                aaUnbiased: { typeRes: Te, defaultRes: !0 },
                aaDprCoef: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 2,
                  defaultRes: 1
                },
                HQaaDprCoef: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 2,
                  defaultRes: 1
                },
                frameRateThrottling: { typeRes: Te, defaultRes: !0 },
                throttlingDelay: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 2,
                  defaultRes: 0.7
                },
                gammaFactor: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 5,
                  defaultRes: 2.2
                },
                gammaInput: { typeRes: Te, defaultRes: !1 },
                gammaOutput: { typeRes: Te, defaultRes: !0 },
                toneMapping: {
                  typeRes: we,
                  enumValuesRes: [
                    "NoToneMapping",
                    "LinearToneMapping",
                    "ReinhardToneMapping",
                    "Uncharted2ToneMapping",
                    "CineonToneMapping",
                    "ACESFilmicToneMapping"
                  ],
                  defaultRes: "LinearToneMapping"
                },
                toneMappingExposure: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 2,
                  defaultRes: 1
                },
                toneMappingWhitePoint: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 2,
                  defaultRes: 1
                },
                physicallyCorrectLights: { typeRes: Te, defaultRes: !1 },
                usePostProcessing: { typeRes: Te, defaultRes: !1 },
                HQusePostProcessing: { typeRes: Te, defaultRes: !1 },
                targetFrameRate: { typeRes: Ae, defaultRes: 30 },
                shadowMapEnabled: { typeRes: Te, defaultRes: !1 },
                HQshadowMapEnabled: { typeRes: Te, defaultRes: !1 },
                shadowMapType: {
                  typeRes: we,
                  enumValuesRes: [
                    "BasicShadowMap",
                    "PCFShadowMap",
                    "PCFSoftShadowMap"
                  ],
                  defaultRes: "PCFShadowMap"
                },
                HQshadowMapType: {
                  typeRes: we,
                  enumValuesRes: [
                    "BasicShadowMap",
                    "PCFShadowMap",
                    "PCFSoftShadowMap"
                  ],
                  defaultRes: "PCFShadowMap"
                },
                preserveDrawingBuffer: { typeRes: Te, defaultRes: !0 },
                logarithmicDepthBuffer: { typeRes: Te, defaultRes: !0 },
                autoRenderMode: { typeRes: Te, defaultRes: !1 },
                renderMode: {
                  typeRes: we,
                  enumValuesRes: ["MQ", "HQ"],
                  defaultRes: "MQ"
                },
                statsEnabled: { typeRes: Te, defaultRes: !1 },
                statsPanel: { typeRes: Ee, defaultRes: 0 },
                useColorConversion: { typeRes: Te, defaultRes: !0 },
                useLegacyEnvMaps: { typeRes: Te, defaultRes: !1 },
                needsRestart: { typeRes: Te, defaultRes: !1, activeRes: !0 }
              }
            },
            typeRules: {}
          });
        var Qe = qe;
        class Ze extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (Ze._entity = a),
          (Ze._entityType = W),
          (Ze._defaultType = "PerspectiveCamera"),
          (Ze._typeRelation = "cameraType"),
          (Ze._relations = {
            commonRelations: {
              cameraType: {
                field: "cameraTypeID",
                fieldType: z,
                referenceEntity: "cameraType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: a,
                referenceOn: "cameraID",
                referenceType: H,
                active: !0
              },
              scenePr: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                referenceOn: "cameras",
                referenceType: H,
                active: !0
              },
              node: {
                field: "nodeID",
                fieldType: z,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              }
            },
            typeRelations: {
              PerspectiveCamera: {},
              OrthographicCamera: {},
              CubeCamera: {},
              StereoCamera: {}
            }
          }),
          (Ze._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {
              PerspectiveCamera: {
                config: {
                  typeRes: _e,
                  far: { typeRes: Ae, defaultRes: 2e3 },
                  near: { typeRes: Ae, defaultRes: 0.1 },
                  fov: { typeRes: Ae, defaultRes: 50 },
                  position: {
                    typeRes: me,
                    defaultRes: [1, 1, 1],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  direction: {
                    typeRes: me,
                    defaultRes: [0, 0, 0],
                    activeRes: !0
                  },
                  lockDirection: { typeRes: Te, defaultRes: !0 },
                  zoom: { typeRes: Ae, defaultRes: 1 }
                }
              },
              OrthographicCamera: {
                config: {
                  typeRes: _e,
                  left: { typeRes: Ae, defaultRes: -1 },
                  right: { typeRes: Ae, defaultRes: 1 },
                  bottom: { typeRes: Ae, defaultRes: -1 },
                  top: { typeRes: Ae, defaultRes: 1 },
                  far: { typeRes: Ae, defaultRes: 2e3 },
                  near: { typeRes: Ae, defaultRes: 0.1 },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 0, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  zoom: { typeRes: Ae, defaultRes: 1 }
                }
              },
              CubeCamera: {},
              StereoCamera: {}
            }
          });
        var Je = Ze;
        class Ke extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Ke._entity = "cameraType"),
          (Ke._entityType = W),
          (Ke._relations = {
            commonRelations: {
              cameras: {
                field: he,
                fieldType: z,
                referenceEntity: a,
                referenceOn: "cameraTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (Ke._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var $e = Ke;
        class et extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (et._entity = c),
          (et._entityType = W),
          (et._defaultType = "PointLight"),
          (et._typeRelation = "lightType"),
          (et._relations = {
            commonRelations: {
              lightType: {
                field: "lightTypeID",
                fieldType: z,
                referenceEntity: "lightType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: "lights",
                referenceOn: "lights",
                referenceType: H,
                active: !0
              },
              node: {
                field: "nodeID",
                fieldType: z,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              }
            },
            typeRelations: {
              PointLight: {},
              SpotLight: {},
              DirectionalLight: {},
              HemisphereLight: {},
              AmbientLight: {},
              RectAreaLight: {}
            }
          }),
          (et._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                color: { typeRes: ge, defaultRes: "#ffffff" },
                intensity: {
                  typeRes: Se,
                  minRangeRes: 0,
                  maxRangeRes: 100,
                  defaultRes: 1,
                  activeRes: !0
                }
              }
            },
            typeRules: {
              PointLight: {
                config: {
                  typeRes: _e,
                  distance: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e5,
                    defaultRes: 0
                  },
                  decay: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  power: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 100,
                    defaultRes: 4 * Math.PI,
                    activeRes: !0
                  },
                  castShadow: { typeRes: Te, defaultRes: !1 },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 1, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  shadowMapSize: {
                    typeRes: fe,
                    defaultRes: [512, 512],
                    activeRes: !0
                  },
                  helperSize: { typeRes: Ae, defaultRes: 1, activeRes: !0 }
                }
              },
              SpotLight: {
                config: {
                  typeRes: _e,
                  distance: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e5,
                    defaultRes: 0
                  },
                  angle: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 90,
                    defaultRes: 60
                  },
                  castShadow: { typeRes: Te, defaultRes: !1 },
                  decay: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  power: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 100,
                    defaultRes: 4 * Math.PI,
                    activeRes: !0
                  },
                  penumbra: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 1, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  target: { typeRes: me, defaultRes: [0, 0, 0] },
                  shadowMapSize: {
                    typeRes: fe,
                    defaultRes: [512, 512],
                    activeRes: !0
                  }
                }
              },
              DirectionalLight: {
                config: {
                  typeRes: _e,
                  castShadow: { typeRes: Te, defaultRes: !1 },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 1, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  target: { typeRes: me, defaultRes: [0, 0, 0] },
                  shadowMapSize: {
                    typeRes: fe,
                    defaultRes: [512, 512],
                    activeRes: !0
                  },
                  helperSize: { typeRes: Ae, defaultRes: 1, activeRes: !0 }
                }
              },
              HemisphereLight: {
                config: {
                  typeRes: _e,
                  groundColor: { typeRes: ge, defaultRes: "#ffffff" },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 1, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  helperSize: { typeRes: Ae, defaultRes: 1, activeRes: !0 }
                }
              },
              AmbientLight: {},
              RectAreaLight: {
                config: {
                  typeRes: _e,
                  width: { typeRes: Ae, defaultRes: 10 },
                  height: { typeRes: Ae, defaultRes: 10 },
                  position: {
                    typeRes: me,
                    defaultRes: [0, 1, 0],
                    activeRes: !0
                  },
                  lockPosition: { typeRes: Te, defaultRes: !0 },
                  target: { typeRes: me, defaultRes: [0, 0, 0] }
                }
              }
            }
          });
        var tt = et;
        class nt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (nt._entity = "lightType"),
          (nt._entityType = W),
          (nt._relations = {
            commonRelations: {
              lights: {
                field: he,
                fieldType: z,
                referenceEntity: c,
                referenceOn: "lightTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (nt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var rt = nt;
        class it extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (it._entity = l),
          (it._entityType = Y),
          (it._relations = { commonRelations: {}, typeRelations: {} }),
          (it._rules = {
            commonRules: {
              version: { typeRes: Me, requiredRes: !0 },
              converterVersion: { typeRes: Me, requiredRes: !0 },
              commit: { typeRes: Me, requiredRes: !0 },
              currentCommit: { typeRes: Me, requiredRes: !0 },
              solutionID: { typeRes: Me, requiredRes: !0 },
              solutionType: { typeRes: Me, requiredRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var at = it;
        class ot extends ue {
          constructor() {
            super();
          }
        }
        (ot._entity = f),
          (ot._entityType = Y),
          (ot._relations = {
            commonRelations: {
              renderer: {
                field: "rendererID",
                fieldType: z,
                referenceEntity: p,
                referenceOn: he,
                referenceType: G,
                active: !0
              },
              camera: {
                field: "cameraID",
                fieldType: z,
                referenceEntity: a,
                referenceOn: he,
                referenceType: G,
                active: !0
              },
              environment: {
                field: "environmentID",
                fieldType: z,
                referenceEntity: s,
                referenceOn: he,
                referenceType: G,
                active: !0
              },
              cameras: {
                field: "cameras",
                fieldType: V,
                referenceEntity: a,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              },
              meshNodes: {
                field: "meshNodes",
                fieldType: V,
                referenceEntity: h,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              },
              selectable: {
                field: "selectable",
                fieldType: V,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              },
              lights: {
                field: "lights",
                fieldType: V,
                referenceEntity: c,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              },
              annotations: {
                field: "annotations",
                fieldType: V,
                referenceEntity: y,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              },
              controls: {
                field: "controls",
                fieldType: V,
                referenceEntity: x,
                referenceOn: he,
                referenceType: G,
                defaultValue: [],
                active: !0
              }
            },
            typeRelations: {}
          }),
          (ot._rules = {
            commonRules: {
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var st = ot;
        class lt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (lt._entity = s),
          (lt._entityType = W),
          (lt._relations = {
            commonRelations: {
              envMap: {
                field: "envMapID",
                fieldType: z,
                referenceEntity: m,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: s,
                referenceOn: "environmentID",
                referenceType: H,
                active: !0
              }
            },
            typeRelations: {}
          }),
          (lt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                bgType: { typeRes: Me, defaultRes: "Color" },
                bgColor: { typeRes: ge, defaultRes: "#555555" },
                bgOpacity: { typeRes: Ae, defaultRes: 1 },
                grVisible: { typeRes: Te, defaultRes: !1 },
                grSize: { typeRes: Ae, defaultRes: 10 },
                grDivisions: { typeRes: Ee, defaultRes: 20 },
                grColorCenterLine: { typeRes: ge, defaultRes: "#070707" },
                grColor: { typeRes: ge, defaultRes: "#343434" },
                axVisible: { typeRes: Te, defaultRes: !1 },
                axSize: { typeRes: Ae, defaultRes: 10 },
                axWidth: { typeRes: Ae, defaultRes: 2 },
                slType: {
                  typeRes: we,
                  enumValuesRes: ["BoundaryBox", "SimpleHighlight"],
                  defaultRes: "BoundaryBox"
                },
                slEnabled: { typeRes: Te, defaultRes: !0 },
                slSelectionVisible: { typeRes: Te, defaultRes: !0 },
                slSelectionColor: { typeRes: ge, defaultRes: "#ffff00" },
                slHoverVisible: { typeRes: Te, defaultRes: !1 },
                slHoverColor: { typeRes: ge, defaultRes: "#777700" },
                slOverlap: { typeRes: Te, defaultRes: !0 },
                slMultiple: { typeRes: Te, defaultRes: !1 },
                slDimNotFocused: { typeRes: Te, defaultRes: !1 },
                slDimSelectionColor: { typeRes: ge, defaultRes: "#505050" },
                slAnimationEnabled: { typeRes: Te, defaultRes: !0 },
                slAnimateSelection: { typeRes: Te, defaultRes: !0 },
                slAnimateHover: { typeRes: Te, defaultRes: !1 },
                slAnimationInterval: { typeRes: Ee, defaultRes: 400 },
                opClickTimeout: { typeRes: Ee, defaultRes: 250 },
                opTouchTimeout: { typeRes: Ee, defaultRes: 250 },
                opHoverPeriod: { typeRes: Ee, defaultRes: 50 },
                opClickDelta: { typeRes: Ee, defaultRes: 3 },
                opTouchDelta: { typeRes: Ee, defaultRes: 5 }
              }
            },
            typeRules: {}
          });
        var ct = lt;
        class ut extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (ut._entity = o),
          (ut._entityType = Y),
          (ut._relations = { commonRelations: {}, typeRelations: {} }),
          (ut._rules = {
            commonRules: {
              processor: { typeRes: Me, defaultRes: "3D Designer" },
              designer3D: { typeRes: be, defaultRes: {} },
              entity: { typeRes: de },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var ht = ut;
        class dt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (dt._entity = v),
          (dt._entityType = W),
          (dt._defaultType = "MeshNode"),
          (dt._typeRelation = "nodeType"),
          (dt._relations = {
            commonRelations: {
              nodeType: {
                field: "nodeTypeID",
                fieldType: z,
                referenceEntity: "nodeType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              parent: {
                field: "parentID",
                fieldType: z,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              },
              children: {
                field: "children",
                fieldType: V,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: []
              }
            },
            typeRelations: {
              MeshNode: {
                relEntity: {
                  field: "relEntityID",
                  fieldType: z,
                  referenceEntity: h,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              },
              Camera: {
                relEntity: {
                  field: "relEntityID",
                  fieldType: z,
                  referenceEntity: a,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              },
              Light: {
                relEntity: {
                  field: "relEntityID",
                  fieldType: z,
                  referenceEntity: c,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              },
              Annotation: {
                relEntity: {
                  field: "relEntityID",
                  fieldType: z,
                  referenceEntity: y,
                  referenceOn: he,
                  referenceType: G,
                  defaultValue: null
                }
              }
            }
          }),
          (dt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {
              MeshNode: { config: {} },
              Camera: { config: {} },
              Light: { config: {} }
            }
          });
        var pt = dt;
        class ft extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (ft._entity = "nodeType"),
          (ft._entityType = W),
          (ft._relations = {
            commonRelations: {
              nodes: {
                field: he,
                fieldType: z,
                referenceEntity: v,
                referenceOn: "nodeTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (ft._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var mt = ft;
        class vt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (vt._entity = y),
          (vt._entityType = W),
          (vt._defaultType = "Sprite"),
          (vt._typeRelation = "annotationType"),
          (vt._relations = {
            commonRelations: {
              annotationType: {
                field: "annotationTypeID",
                fieldType: z,
                referenceEntity: "annotationType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: "annotations",
                referenceOn: "annotations",
                referenceType: H,
                active: !0
              },
              node: {
                field: "nodeID",
                fieldType: z,
                referenceEntity: v,
                referenceOn: he,
                referenceType: G,
                defaultValue: null
              },
              material: {
                field: "materialID",
                fieldType: z,
                referenceEntity: u,
                referenceOn: he,
                referenceType: G,
                active: !0
              }
            },
            typeRelations: { Sprite: {} }
          }),
          (vt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                position: { typeRes: me, defaultRes: [0, 0, 0], activeRes: !0 },
                lockPosition: { typeRes: Te, defaultRes: !0 },
                scale: { typeRes: me, defaultRes: [1, 1, 1], activeRes: !0 },
                lockScale: { typeRes: Te, defaultRes: !0 },
                quaternion: {
                  typeRes: ve,
                  defaultRes: [0, 0, 0, 1],
                  activeRes: !0
                },
                lockQuaternion: { typeRes: Te, defaultRes: !0 },
                center: { typeRes: fe, defaultRes: [0.5, 0.5], activeRes: !0 },
                lockCenter: { typeRes: Te, defaultRes: !0 },
                frustumCulled: { typeRes: Te, defaultRes: !0 },
                receiveShadow: { typeRes: Te, defaultRes: !1 },
                castShadow: { typeRes: Te, defaultRes: !1 },
                renderOrder: { typeRes: Ee, defaultRes: 0 }
              }
            },
            typeRules: { Sprite: {} }
          });
        var gt = vt;
        class yt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (yt._entity = "annotationType"),
          (yt._entityType = W),
          (yt._relations = {
            commonRelations: {
              annotations: {
                field: he,
                fieldType: z,
                referenceEntity: y,
                referenceOn: "annotationTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (yt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var bt = yt;
        class xt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (xt._entity = g),
          (xt._entityType = W),
          (xt._defaultType = "BasicTransition"),
          (xt._typeRelation = "transitionType"),
          (xt._relations = {
            commonRelations: {
              transitionType: {
                field: "transitionTypeID",
                fieldType: z,
                referenceEntity: "transitionType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              state: {
                field: "targetStateID",
                fieldType: z,
                referenceEntity: b,
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              }
            },
            typeRelations: {}
          }),
          (xt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              targetEntityID: { typeRes: Me },
              targetEntityType: { typeRes: Me },
              config: {
                typeRes: _e,
                duration: { typeRes: Ee, defaultRes: 2e3 },
                easing: {
                  typeRes: we,
                  enumValuesRes: [
                    "LinearNone",
                    "QuadraticIn",
                    "QuadraticOut",
                    "QuadraticInOut",
                    "CubicIn",
                    "CubicOut",
                    "CubicInOut",
                    "QuarticIn",
                    "QuarticOut",
                    "QuarticInOut",
                    "QuinticIn",
                    "QuinticOut",
                    "QuinticInOut",
                    "SinusoidalIn",
                    "SinusoidalOut",
                    "SinusoidalInOut",
                    "ExponentialIn",
                    "ExponentialOut",
                    "ExponentialInOut",
                    "CircularIn",
                    "CircularOut",
                    "CircularInOut",
                    "ElasticIn",
                    "ElasticOut",
                    "ElasticInOut",
                    "BackIn",
                    "BackOut",
                    "BackInOut",
                    "BounceIn",
                    "BounceOut",
                    "BounceInOut"
                  ],
                  defaultRes: "LinearNone"
                },
                valueExp: {
                  typeRes: we,
                  enumValuesRes: ["Set", "Add", "Multiply"],
                  defaultRes: "Set"
                },
                delay: { typeRes: Ee, defaultRes: 0 },
                repeat: { typeRes: Ee, defaultRes: 0 },
                repeatDelay: { typeRes: Ee, defaultRes: 0 },
                yoyo: { typeRes: Te, defaultRes: !1 }
              }
            },
            typeRules: { BasicTransition: { config: {} } }
          });
        var wt = xt;
        class _t extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (_t._entity = "transitionType"),
          (_t._entityType = W),
          (_t._relations = {
            commonRelations: {
              transitions: {
                field: he,
                fieldType: z,
                referenceEntity: g,
                referenceOn: "transitionTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (_t._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: { BasicTransition: { config: {} } }
          });
        var Mt = _t;
        class Tt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (Tt._entity = b),
          (Tt._entityType = W),
          (Tt._defaultType = "MeshNodeState"),
          (Tt._typeRelation = "stateType"),
          (Tt._relations = {
            commonRelations: {
              stateType: {
                field: "stateDataTypeID",
                fieldType: z,
                referenceEntity: "stateType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              transitions: {
                field: he,
                fieldType: z,
                referenceEntity: g,
                relationReferenceName: b,
                active: !0,
                referenceOn: "targetStateID",
                referenceType: X
              }
            },
            typeRelations: {}
          }),
          (Tt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: {
                typeRes: Me,
                requiredRes: !0,
                uniqueRes: !0,
                generateUniqueRes: !0
              },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {}
            },
            typeRules: {
              AnnotationState: {
                config: {
                  typeRes: _e,
                  position: { typeRes: me, defaultRes: [0, 0, 0] },
                  scale: { typeRes: me, defaultRes: [1, 1, 1] },
                  quaternion: { typeRes: ve, defaultRes: [0, 0, 0, 1] }
                }
              },
              CameraState: {
                config: {
                  typeRes: _e,
                  position: { typeRes: me, defaultRes: [1, 1, 1] },
                  direction: { typeRes: me, defaultRes: [0, 0, 0] },
                  fov: { typeRes: Ae, defaultRes: 50 }
                }
              },
              CameraControlState: {
                config: {
                  typeRes: _e,
                  target: { typeRes: me, defaultRes: [0, 0, 0] },
                  polarAngle: { typeRes: Ae, defaultRes: null },
                  azimuthalAngle: { typeRes: Ae, defaultRes: null },
                  radius: { typeRes: Ae, defaultRes: null }
                }
              },
              LightState: {
                config: {
                  typeRes: _e,
                  position: { typeRes: me, defaultRes: [0, 1, 0] },
                  target: { typeRes: me, defaultRes: [0, 0, 0] }
                }
              },
              MaterialState: {
                config: {
                  typeRes: _e,
                  opacity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 1
                  },
                  aoMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  color: { typeRes: ge, defaultRes: "#ffffff" },
                  lightMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  reflectivity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 1
                  },
                  refractionRatio: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.98
                  },
                  bumpScale: {
                    typeRes: Se,
                    minRangeRes: -100,
                    maxRangeRes: 100,
                    defaultRes: 1
                  },
                  displacementScale: { typeRes: Ae, defaultRes: 1 },
                  displacementBias: { typeRes: Ae, defaultRes: 0 },
                  emissive: { typeRes: ge, defaultRes: "#000000" },
                  emissiveIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  envMapIntensity: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1e4,
                    defaultRes: 1
                  },
                  metalness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0
                  },
                  normalScale: { typeRes: fe, defaultRes: [1, 1] },
                  roughness: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 1,
                    defaultRes: 0.5
                  },
                  shininess: {
                    typeRes: Se,
                    minRangeRes: -1e3,
                    maxRangeRes: 1e3,
                    defaultRes: 30
                  },
                  rotation: { typeRes: Ae, defaultRes: 0 }
                }
              },
              MeshNodeState: {
                config: {
                  typeRes: _e,
                  position: { typeRes: me, defaultRes: [0, 0, 0] },
                  scale: { typeRes: me, defaultRes: [1, 1, 1] },
                  quaternion: { typeRes: ve, defaultRes: [0, 0, 0, 1] }
                }
              },
              TextureState: {
                config: {
                  typeRes: _e,
                  rotation: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 6.28,
                    defaultRes: 0
                  },
                  center: { typeRes: fe, defaultRes: [0, 0] }
                }
              }
            }
          });
        var At = Tt;
        class St extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (St._entity = "stateType"),
          (St._entityType = W),
          (St._relations = {
            commonRelations: {
              states: {
                field: he,
                fieldType: z,
                referenceEntity: b,
                referenceOn: "stateTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (St._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var Et = St;
        class Rt extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
          isSceneActive() {
            return null !== this.relActive.scene();
          }
          isSceneDefault() {
            return null !== this.rel.scene();
          }
        }
        (Rt._entity = x),
          (Rt._entityType = W),
          (Rt._defaultType = "ObjectControls"),
          (Rt._typeRelation = "controlsType"),
          (Rt._relations = {
            commonRelations: {
              controlsType: {
                field: "controlsTypeID",
                fieldType: z,
                referenceEntity: "controlsType",
                referenceOn: he,
                referenceType: G,
                notChangeable: !0
              },
              scene: {
                field: he,
                fieldType: z,
                referenceEntity: f,
                relationReferenceName: "controls",
                referenceOn: "controls",
                referenceType: H,
                active: !0
              }
            },
            typeRelations: {
              ObjectControls: {},
              OrbitControls: {
                target: {
                  field: "targetID",
                  fieldType: z,
                  referenceEntity: v,
                  referenceOn: he,
                  referenceType: G,
                  notChangeable: !1,
                  defaultValue: null
                }
              }
            }
          }),
          (Rt._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, generateUniqueRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: {
                typeRes: _e,
                enabled: { typeRes: Te, defaultRes: !0, activeRes: !0 }
              }
            },
            typeRules: {
              OrbitControls: {
                config: {
                  typeRes: _e,
                  minDistance: { typeRes: Ae, defaultRes: 0 },
                  maxDistance: { typeRes: Ae, defaultRes: 300 },
                  minZoom: { typeRes: Ae, defaultRes: 0 },
                  maxZoom: { typeRes: Ae, defaultRes: "Infinity" },
                  minPolarAngle: { typeRes: Ae, defaultRes: 0 },
                  maxPolarAngle: { typeRes: Ae, defaultRes: Math.PI },
                  minAzimuthAngle: { typeRes: Ae, defaultRes: "-Infinity" },
                  maxAzimuthAngle: { typeRes: Ae, defaultRes: "Infinity" },
                  dampingFactor: {
                    typeRes: Se,
                    minRangeRes: 0.001,
                    maxRangeRes: 1,
                    defaultRes: 0.05
                  },
                  draggingDampingFactor: {
                    typeRes: Se,
                    minRangeRes: 0.001,
                    maxRangeRes: 1,
                    defaultRes: 0.25
                  },
                  polarRotateSpeed: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 5,
                    defaultRes: 1
                  },
                  azimuthRotateSpeed: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 5,
                    defaultRes: 1
                  },
                  dollySpeed: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 5,
                    defaultRes: 1
                  },
                  truckSpeed: {
                    typeRes: Se,
                    minRangeRes: 0,
                    maxRangeRes: 5,
                    defaultRes: 2
                  },
                  verticalDragToForward: { typeRes: Te, defaultRes: !1 },
                  dollyToCursor: { typeRes: Te, defaultRes: !1 },
                  updateDelay: { typeRes: Ee, defaultRes: 150 },
                  transitionEnabled: { typeRes: Te, defaultRes: !1 },
                  autoRotate: { typeRes: Te, defaultRes: !1 },
                  autoRotateSpeed: {
                    typeRes: Se,
                    minRangeRes: -5,
                    maxRangeRes: 5,
                    defaultRes: -0.05
                  },
                  lockTarget: { typeRes: Te, defaultRes: !0 },
                  target: { typeRes: me, defaultRes: null, activeRes: !0 },
                  polarAngle: { typeRes: Ae, defaultRes: null, activeRes: !0 },
                  azimuthalAngle: {
                    typeRes: Ae,
                    defaultRes: null,
                    activeRes: !0
                  },
                  radius: { typeRes: Ae, defaultRes: null, activeRes: !0 },
                  state: {
                    typeRes: we,
                    enumValuesRes: ["idle", "dragging"],
                    defaultRes: "idle",
                    activeRes: !0
                  }
                }
              },
              ObjectControls: {
                config: {
                  typeRes: _e,
                  mode: {
                    typeRes: "enum",
                    enumValuesRes: ["Translate", "Rotate"],
                    defaultRes: "Rotate"
                  },
                  maxDistance: { typeRes: Ae, defaultRes: 1e3 },
                  minDistance: { typeRes: Ae, defaultRes: 1 },
                  zoomEnabled: { typeRes: Te, defaultRes: !1 },
                  zoomSpeed: { typeRes: Ae, defaultRes: 0.5 },
                  rotationSpeed: { typeRes: Ae, defaultRes: 0.05 },
                  rotationSpeedTouch: { typeRes: Ae, defaultRes: 0.05 },
                  horizontalRotationEnabled: { typeRes: Te, defaultRes: !0 },
                  verticalRotationEnabled: { typeRes: Te, defaultRes: !0 }
                }
              },
              TransformControls: {
                config: {
                  typeRes: _e,
                  mode: {
                    typeRes: "enum",
                    enumValuesRes: ["translate", "rotate", "scale"],
                    defaultRes: "translate"
                  },
                  space: {
                    typeRes: "enum",
                    enumValuesRes: ["local", "world"],
                    defaultRes: "local"
                  },
                  size: { typeRes: Ae, defaultRes: 1 },
                  showX: { typeRes: Te, defaultRes: !0 },
                  showY: { typeRes: Te, defaultRes: !0 },
                  showZ: { typeRes: Te, defaultRes: !0 },
                  translationSnap: { typeRes: Ae, defaultRes: null },
                  rotationSnap: { typeRes: Ae, defaultRes: null },
                  state: {
                    typeRes: we,
                    enumValuesRes: ["idle", "dragging"],
                    defaultRes: "idle",
                    activeRes: !0
                  },
                  updateDelay: { typeRes: Ee, defaultRes: 150, activeRes: !0 }
                }
              }
            }
          });
        var Pt = Rt;
        class It extends ue {
          constructor() {
            arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
              super();
          }
        }
        (It._entity = "controlsType"),
          (It._entityType = W),
          (It._relations = {
            commonRelations: {
              controls: {
                field: he,
                fieldType: z,
                referenceEntity: x,
                referenceOn: "controlsTypeID",
                referenceType: "has"
              }
            },
            typeRelations: {}
          }),
          (It._rules = {
            commonRules: {
              id: { typeRes: he },
              nameUQ: { typeRes: Me, requiredRes: !0, uniqueRes: !0 },
              entity: { typeRes: de },
              editorData: { typeRes: be, defaultRes: {} },
              showData: { typeRes: be, defaultRes: {} },
              config: { typeRes: _e }
            },
            typeRules: {}
          });
        var Dt = It,
          Ot = {
            mapFields: {
              alphaMapID: { field: "alphaMapID", type: "alphaMap" },
              aoMapID: { field: "aoMapID", type: "aoMap" },
              bumpMapID: { field: "bumpMapID", type: "bumpMap" },
              displacementMapID: {
                field: "displacementMapID",
                type: "displacementMap"
              },
              emissiveMapID: { field: "emissiveMapID", type: "emissiveMap" },
              envMapID: { field: "envMapID", type: "envMap" },
              lightMapID: { field: "lightMapID", type: "lightMap" },
              diffuseMapID: { field: "diffuseMapID", type: "diffuseMap" },
              metalnessMapID: { field: "metalnessMapID", type: "metalnessMap" },
              normalMapID: { field: "normalMapID", type: "normalMap" },
              roughnessMapID: { field: "roughnessMapID", type: "roughnessMap" },
              specularMapID: { field: "specularMapID", type: "specularMap" },
              gradientMapID: { field: "gradientMapID", type: "gradientMap" },
              clearcoatNormalMapID: {
                field: "clearcoatNormalMapID",
                type: "clearcoatNormalMap"
              }
            },
            getEntity(e, t) {
              var n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : { returnType: "instance" },
                r = C.getState();
              try {
                return void 0 === r.TUF[e].byId[t]
                  ? null
                  : "reference" === n.returnType
                  ? r.TUF[e].byId[t]
                  : this._createEntityInstance(r.TUF[e].byId[t]);
              } catch (e) {
                return null;
              }
            },
            _createEntityInstance(e) {
              var t = new (this.getTUFModelForEntity(e.entity))();
              return t.setFromData(e), t;
            },
            _createGroupEntityInstance(e) {
              for (
                var t = { byId: {}, allIds: [] }, n = 0;
                n < e.allIds.length;
                n++
              ) {
                var r = e.allIds[n];
                (t.byId[r] = this._createEntityInstance(e.byId[r])),
                  t.allIds.push(r);
              }
              return t;
            },
            getEntityByNameUQ(e, t) {
              var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : { returnType: "instance" };
              try {
                for (
                  var r = this.getEntityGroup(e), i = null, a = 0;
                  a < r.allIds.length;
                  a += 1
                ) {
                  var o = r.allIds[a];
                  if (r.byId[o].nameUQ && r.byId[o].nameUQ === t) {
                    i = r.byId[o];
                    break;
                  }
                }
                return "reference" === n.returnType
                  ? i
                  : this._createEntityInstance(i);
              } catch (e) {
                return null;
              }
            },
            getEntityGroup(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { returnType: "instance" },
                n = C.getState();
              try {
                return void 0 === n.TUF[e]
                  ? null
                  : "reference" === t.returnType
                  ? n.TUF[e]
                  : this._createGroupEntityInstance(n.TUF[e]);
              } catch (e) {
                return null;
              }
            },
            getSingle(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { returnType: "instance" },
                n = C.getState();
              try {
                return "reference" === t.returnType
                  ? n.TUF[e]
                  : this._createEntityInstance(n.TUF[e]);
              } catch (e) {
                return null;
              }
            },
            subscribeOnGroupEntity(e, t) {
              var n = n => t({ [e]: this._createGroupEntityInstance(n) });
              return (
                "reference" ===
                  (arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : { returnType: "instance" }
                  ).returnType && (n = n => t({ [e]: n })),
                L(t => t.TUF[e], n)
              );
            },
            subscribeOnSingle(e, t) {
              var n = n => t({ [e]: this._createEntityInstance(n) });
              return (
                "reference" ===
                  (arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : { returnType: "instance" }
                  ).returnType && (n = n => t({ [e]: n })),
                L(t => t.TUF[e], n)
              );
            },
            isMapField(e) {
              return !(!this.mapFields[e] || !this.mapFields[e].type);
            },
            getMapFieldType(e) {
              return this.mapFields[e] && this.mapFields[e].type
                ? this.mapFields[e].type
                : null;
            },
            getTUFModelForEntity(e) {
              var t = this.getTUFInfoForEntity(e);
              return null !== t ? t.model : null;
            },
            getTUFInfoForEntity(e) {
              var t = this.getTUFInfo();
              return t[e] && t[e].model ? t[e] : null;
            },
            getTUFInfo: () => ({
              asset: { model: Pe },
              texture: { model: De },
              textureType: { model: Ce },
              model: { model: Ne },
              meshNode: { model: ke },
              meshNodeType: { model: je },
              material: { model: Xe },
              materialType: { model: Ye },
              renderer: { model: Qe },
              camera: { model: Je },
              cameraType: { model: $e },
              light: { model: tt },
              lightType: { model: rt },
              info: { model: at },
              scene: { model: st },
              environment: { model: ct },
              editorData: { model: ht },
              node: { model: pt },
              nodeType: { model: mt },
              annotation: { model: gt },
              annotationType: { model: bt },
              transition: { model: wt },
              transitionType: { model: Mt },
              state: { model: At },
              stateType: { model: Et },
              controls: { model: Pt },
              controlsType: { model: Dt }
            })
          };
        void 0 === Number.EPSILON && (Number.EPSILON = Math.pow(2, -52)),
          void 0 === Number.isInteger &&
            (Number.isInteger = function(e) {
              return "number" == typeof e && isFinite(e) && Math.floor(e) === e;
            }),
          void 0 === Math.sign &&
            (Math.sign = function(e) {
              return e < 0 ? -1 : e > 0 ? 1 : +e;
            }),
          "name" in Function.prototype == 0 &&
            Object.defineProperty(Function.prototype, "name", {
              get: function() {
                return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1];
              }
            }),
          void 0 === Object.assign &&
            (Object.assign = function(e) {
              if (null == e)
                throw new TypeError(
                  "Cannot convert undefined or null to object"
                );
              for (var t = Object(e), n = 1; n < arguments.length; n++) {
                var r = arguments[n];
                if (null != r)
                  for (var i in r)
                    Object.prototype.hasOwnProperty.call(r, i) && (t[i] = r[i]);
              }
              return t;
            });
        var Ct = "111",
          Lt = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 },
          Nt = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 },
          Ft = 0,
          kt = 1,
          Ut = 2,
          jt = 3,
          Bt = 0,
          zt = 1,
          Vt = 0,
          Gt = 1,
          Ht = 2,
          Xt = 3,
          Wt = 0,
          Yt = 1,
          qt = 2,
          Qt = 1,
          Zt = 2,
          Jt = 0,
          Kt = 1,
          $t = 2,
          en = 0,
          tn = 1,
          nn = 2,
          rn = 3,
          an = 4,
          on = 5,
          sn = 100,
          ln = 101,
          cn = 102,
          un = 103,
          hn = 104,
          dn = 200,
          pn = 201,
          fn = 202,
          mn = 203,
          vn = 204,
          gn = 205,
          yn = 206,
          bn = 207,
          xn = 208,
          wn = 209,
          _n = 210,
          Mn = 0,
          Tn = 1,
          An = 2,
          Sn = 3,
          En = 4,
          Rn = 5,
          Pn = 6,
          In = 7,
          Dn = 0,
          On = 1,
          Cn = 2,
          Ln = 0,
          Nn = 1,
          Fn = 2,
          kn = 3,
          Un = 4,
          jn = 5,
          Bn = 300,
          zn = 301,
          Vn = 302,
          Gn = 303,
          Hn = 304,
          Xn = 305,
          Wn = 306,
          Yn = 307,
          qn = 1e3,
          Qn = 1001,
          Zn = 1002,
          Jn = 1003,
          Kn = 1004,
          $n = 1004,
          er = 1005,
          tr = 1005,
          nr = 1006,
          rr = 1007,
          ir = 1007,
          ar = 1008,
          or = 1008,
          sr = 1009,
          lr = 1010,
          cr = 1011,
          ur = 1012,
          hr = 1013,
          dr = 1014,
          pr = 1015,
          fr = 1016,
          mr = 1017,
          vr = 1018,
          gr = 1019,
          yr = 1020,
          br = 1021,
          xr = 1022,
          wr = 1023,
          _r = 1024,
          Mr = 1025,
          Tr = wr,
          Ar = 1026,
          Sr = 1027,
          Er = 1028,
          Rr = 33776,
          Pr = 33777,
          Ir = 33778,
          Dr = 33779,
          Or = 35840,
          Cr = 35841,
          Lr = 35842,
          Nr = 35843,
          Fr = 36196,
          kr = 37808,
          Ur = 37809,
          jr = 37810,
          Br = 37811,
          zr = 37812,
          Vr = 37813,
          Gr = 37814,
          Hr = 37815,
          Xr = 37816,
          Wr = 37817,
          Yr = 37818,
          qr = 37819,
          Qr = 37820,
          Zr = 37821,
          Jr = 2200,
          Kr = 2201,
          $r = 2202,
          ei = 2300,
          ti = 2301,
          ni = 2302,
          ri = 2400,
          ii = 2401,
          ai = 2402,
          oi = 0,
          si = 1,
          li = 2,
          ci = 3e3,
          ui = 3001,
          hi = 3007,
          di = 3002,
          pi = 3003,
          fi = 3004,
          mi = 3005,
          vi = 3006,
          gi = 3200,
          yi = 3201,
          bi = 0,
          xi = 1,
          wi = 0,
          _i = 7680,
          Mi = 7681,
          Ti = 7682,
          Ai = 7683,
          Si = 34055,
          Ei = 34056,
          Ri = 5386,
          Pi = 512,
          Ii = 513,
          Di = 514,
          Oi = 515,
          Ci = 516,
          Li = 517,
          Ni = 518,
          Fi = 519,
          ki = 35044,
          Ui = 35048,
          ji = 35040,
          Bi = 35045,
          zi = 35049,
          Vi = 35041,
          Gi = 35046,
          Hi = 35050,
          Xi = 35042;
        function Wi() {}
        Object.assign(Wi.prototype, {
          addEventListener: function(e, t) {
            void 0 === this._listeners && (this._listeners = {});
            var n = this._listeners;
            void 0 === n[e] && (n[e] = []),
              -1 === n[e].indexOf(t) && n[e].push(t);
          },
          hasEventListener: function(e, t) {
            if (void 0 === this._listeners) return !1;
            var n = this._listeners;
            return void 0 !== n[e] && -1 !== n[e].indexOf(t);
          },
          removeEventListener: function(e, t) {
            if (void 0 !== this._listeners) {
              var n = this._listeners[e];
              if (void 0 !== n) {
                var r = n.indexOf(t);
                -1 !== r && n.splice(r, 1);
              }
            }
          },
          dispatchEvent: function(e) {
            if (void 0 !== this._listeners) {
              var t = this._listeners[e.type];
              if (void 0 !== t) {
                e.target = this;
                for (var n = t.slice(0), r = 0, i = n.length; r < i; r++)
                  n[r].call(this, e);
              }
            }
          }
        });
        for (var Yi = [], qi = 0; qi < 256; qi++)
          Yi[qi] = (qi < 16 ? "0" : "") + qi.toString(16);
        var Qi = {
          DEG2RAD: Math.PI / 180,
          RAD2DEG: 180 / Math.PI,
          generateUUID: function() {
            var e = (4294967295 * Math.random()) | 0,
              t = (4294967295 * Math.random()) | 0,
              n = (4294967295 * Math.random()) | 0,
              r = (4294967295 * Math.random()) | 0;
            return (
              Yi[255 & e] +
              Yi[(e >> 8) & 255] +
              Yi[(e >> 16) & 255] +
              Yi[(e >> 24) & 255] +
              "-" +
              Yi[255 & t] +
              Yi[(t >> 8) & 255] +
              "-" +
              Yi[((t >> 16) & 15) | 64] +
              Yi[(t >> 24) & 255] +
              "-" +
              Yi[(63 & n) | 128] +
              Yi[(n >> 8) & 255] +
              "-" +
              Yi[(n >> 16) & 255] +
              Yi[(n >> 24) & 255] +
              Yi[255 & r] +
              Yi[(r >> 8) & 255] +
              Yi[(r >> 16) & 255] +
              Yi[(r >> 24) & 255]
            ).toUpperCase();
          },
          clamp: function(e, t, n) {
            return Math.max(t, Math.min(n, e));
          },
          euclideanModulo: function(e, t) {
            return ((e % t) + t) % t;
          },
          mapLinear: function(e, t, n, r, i) {
            return r + ((e - t) * (i - r)) / (n - t);
          },
          lerp: function(e, t, n) {
            return (1 - n) * e + n * t;
          },
          smoothstep: function(e, t, n) {
            return e <= t
              ? 0
              : e >= n
              ? 1
              : (e = (e - t) / (n - t)) * e * (3 - 2 * e);
          },
          smootherstep: function(e, t, n) {
            return e <= t
              ? 0
              : e >= n
              ? 1
              : (e = (e - t) / (n - t)) * e * e * (e * (6 * e - 15) + 10);
          },
          randInt: function(e, t) {
            return e + Math.floor(Math.random() * (t - e + 1));
          },
          randFloat: function(e, t) {
            return e + Math.random() * (t - e);
          },
          randFloatSpread: function(e) {
            return e * (0.5 - Math.random());
          },
          degToRad: function(e) {
            return e * Qi.DEG2RAD;
          },
          radToDeg: function(e) {
            return e * Qi.RAD2DEG;
          },
          isPowerOfTwo: function(e) {
            return 0 == (e & (e - 1)) && 0 !== e;
          },
          ceilPowerOfTwo: function(e) {
            return Math.pow(2, Math.ceil(Math.log(e) / Math.LN2));
          },
          floorPowerOfTwo: function(e) {
            return Math.pow(2, Math.floor(Math.log(e) / Math.LN2));
          }
        };
        function Zi(e, t) {
          (this.x = e || 0), (this.y = t || 0);
        }
        function Ji(e, t, n, r) {
          (this._x = e || 0),
            (this._y = t || 0),
            (this._z = n || 0),
            (this._w = void 0 !== r ? r : 1);
        }
        Object.defineProperties(Zi.prototype, {
          width: {
            get: function() {
              return this.x;
            },
            set: function(e) {
              this.x = e;
            }
          },
          height: {
            get: function() {
              return this.y;
            },
            set: function(e) {
              this.y = e;
            }
          }
        }),
          Object.assign(Zi.prototype, {
            isVector2: !0,
            set: function(e, t) {
              return (this.x = e), (this.y = t), this;
            },
            setScalar: function(e) {
              return (this.x = e), (this.y = e), this;
            },
            setX: function(e) {
              return (this.x = e), this;
            },
            setY: function(e) {
              return (this.y = e), this;
            },
            setComponent: function(e, t) {
              switch (e) {
                case 0:
                  this.x = t;
                  break;
                case 1:
                  this.y = t;
                  break;
                default:
                  throw new Error("index is out of range: " + e);
              }
              return this;
            },
            getComponent: function(e) {
              switch (e) {
                case 0:
                  return this.x;
                case 1:
                  return this.y;
                default:
                  throw new Error("index is out of range: " + e);
              }
            },
            clone: function() {
              return new this.constructor(this.x, this.y);
            },
            copy: function(e) {
              return (this.x = e.x), (this.y = e.y), this;
            },
            add: function(e, t) {
              return void 0 !== t
                ? this.addVectors(e, t)
                : ((this.x += e.x), (this.y += e.y), this);
            },
            addScalar: function(e) {
              return (this.x += e), (this.y += e), this;
            },
            addVectors: function(e, t) {
              return (this.x = e.x + t.x), (this.y = e.y + t.y), this;
            },
            addScaledVector: function(e, t) {
              return (this.x += e.x * t), (this.y += e.y * t), this;
            },
            sub: function(e, t) {
              return void 0 !== t
                ? this.subVectors(e, t)
                : ((this.x -= e.x), (this.y -= e.y), this);
            },
            subScalar: function(e) {
              return (this.x -= e), (this.y -= e), this;
            },
            subVectors: function(e, t) {
              return (this.x = e.x - t.x), (this.y = e.y - t.y), this;
            },
            multiply: function(e) {
              return (this.x *= e.x), (this.y *= e.y), this;
            },
            multiplyScalar: function(e) {
              return (this.x *= e), (this.y *= e), this;
            },
            divide: function(e) {
              return (this.x /= e.x), (this.y /= e.y), this;
            },
            divideScalar: function(e) {
              return this.multiplyScalar(1 / e);
            },
            applyMatrix3: function(e) {
              var t = this.x,
                n = this.y,
                r = e.elements;
              return (
                (this.x = r[0] * t + r[3] * n + r[6]),
                (this.y = r[1] * t + r[4] * n + r[7]),
                this
              );
            },
            min: function(e) {
              return (
                (this.x = Math.min(this.x, e.x)),
                (this.y = Math.min(this.y, e.y)),
                this
              );
            },
            max: function(e) {
              return (
                (this.x = Math.max(this.x, e.x)),
                (this.y = Math.max(this.y, e.y)),
                this
              );
            },
            clamp: function(e, t) {
              return (
                (this.x = Math.max(e.x, Math.min(t.x, this.x))),
                (this.y = Math.max(e.y, Math.min(t.y, this.y))),
                this
              );
            },
            clampScalar: function(e, t) {
              return (
                (this.x = Math.max(e, Math.min(t, this.x))),
                (this.y = Math.max(e, Math.min(t, this.y))),
                this
              );
            },
            clampLength: function(e, t) {
              var n = this.length();
              return this.divideScalar(n || 1).multiplyScalar(
                Math.max(e, Math.min(t, n))
              );
            },
            floor: function() {
              return (
                (this.x = Math.floor(this.x)),
                (this.y = Math.floor(this.y)),
                this
              );
            },
            ceil: function() {
              return (
                (this.x = Math.ceil(this.x)), (this.y = Math.ceil(this.y)), this
              );
            },
            round: function() {
              return (
                (this.x = Math.round(this.x)),
                (this.y = Math.round(this.y)),
                this
              );
            },
            roundToZero: function() {
              return (
                (this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x)),
                (this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y)),
                this
              );
            },
            negate: function() {
              return (this.x = -this.x), (this.y = -this.y), this;
            },
            dot: function(e) {
              return this.x * e.x + this.y * e.y;
            },
            cross: function(e) {
              return this.x * e.y - this.y * e.x;
            },
            lengthSq: function() {
              return this.x * this.x + this.y * this.y;
            },
            length: function() {
              return Math.sqrt(this.x * this.x + this.y * this.y);
            },
            manhattanLength: function() {
              return Math.abs(this.x) + Math.abs(this.y);
            },
            normalize: function() {
              return this.divideScalar(this.length() || 1);
            },
            angle: function() {
              var e = Math.atan2(this.y, this.x);
              return e < 0 && (e += 2 * Math.PI), e;
            },
            distanceTo: function(e) {
              return Math.sqrt(this.distanceToSquared(e));
            },
            distanceToSquared: function(e) {
              var t = this.x - e.x,
                n = this.y - e.y;
              return t * t + n * n;
            },
            manhattanDistanceTo: function(e) {
              return Math.abs(this.x - e.x) + Math.abs(this.y - e.y);
            },
            setLength: function(e) {
              return this.normalize().multiplyScalar(e);
            },
            lerp: function(e, t) {
              return (
                (this.x += (e.x - this.x) * t),
                (this.y += (e.y - this.y) * t),
                this
              );
            },
            lerpVectors: function(e, t, n) {
              return this.subVectors(t, e)
                .multiplyScalar(n)
                .add(e);
            },
            equals: function(e) {
              return e.x === this.x && e.y === this.y;
            },
            fromArray: function(e, t) {
              return (
                void 0 === t && (t = 0),
                (this.x = e[t]),
                (this.y = e[t + 1]),
                this
              );
            },
            toArray: function(e, t) {
              return (
                void 0 === e && (e = []),
                void 0 === t && (t = 0),
                (e[t] = this.x),
                (e[t + 1] = this.y),
                e
              );
            },
            fromBufferAttribute: function(e, t, n) {
              return (this.x = e.getX(t)), (this.y = e.getY(t)), this;
            },
            rotateAround: function(e, t) {
              var n = Math.cos(t),
                r = Math.sin(t),
                i = this.x - e.x,
                a = this.y - e.y;
              return (
                (this.x = i * n - a * r + e.x),
                (this.y = i * r + a * n + e.y),
                this
              );
            }
          }),
          Object.assign(Ji, {
            slerp: function(e, t, n, r) {
              return n.copy(e).slerp(t, r);
            },
            slerpFlat: function(e, t, n, r, i, a, o) {
              var s = n[r + 0],
                l = n[r + 1],
                c = n[r + 2],
                u = n[r + 3],
                h = i[a + 0],
                d = i[a + 1],
                p = i[a + 2],
                f = i[a + 3];
              if (u !== f || s !== h || l !== d || c !== p) {
                var m = 1 - o,
                  v = s * h + l * d + c * p + u * f,
                  g = v >= 0 ? 1 : -1,
                  y = 1 - v * v;
                if (y > Number.EPSILON) {
                  var b = Math.sqrt(y),
                    x = Math.atan2(b, v * g);
                  (m = Math.sin(m * x) / b), (o = Math.sin(o * x) / b);
                }
                var w = o * g;
                if (
                  ((s = s * m + h * w),
                  (l = l * m + d * w),
                  (c = c * m + p * w),
                  (u = u * m + f * w),
                  m === 1 - o)
                ) {
                  var _ = 1 / Math.sqrt(s * s + l * l + c * c + u * u);
                  (s *= _), (l *= _), (c *= _), (u *= _);
                }
              }
              (e[t] = s), (e[t + 1] = l), (e[t + 2] = c), (e[t + 3] = u);
            }
          }),
          Object.defineProperties(Ji.prototype, {
            x: {
              get: function() {
                return this._x;
              },
              set: function(e) {
                (this._x = e), this._onChangeCallback();
              }
            },
            y: {
              get: function() {
                return this._y;
              },
              set: function(e) {
                (this._y = e), this._onChangeCallback();
              }
            },
            z: {
              get: function() {
                return this._z;
              },
              set: function(e) {
                (this._z = e), this._onChangeCallback();
              }
            },
            w: {
              get: function() {
                return this._w;
              },
              set: function(e) {
                (this._w = e), this._onChangeCallback();
              }
            }
          }),
          Object.assign(Ji.prototype, {
            isQuaternion: !0,
            set: function(e, t, n, r) {
              return (
                (this._x = e),
                (this._y = t),
                (this._z = n),
                (this._w = r),
                this._onChangeCallback(),
                this
              );
            },
            clone: function() {
              return new this.constructor(this._x, this._y, this._z, this._w);
            },
            copy: function(e) {
              return (
                (this._x = e.x),
                (this._y = e.y),
                (this._z = e.z),
                (this._w = e.w),
                this._onChangeCallback(),
                this
              );
            },
            setFromEuler: function(e, t) {
              if (!e || !e.isEuler)
                throw new Error(
                  "THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order."
                );
              var n = e._x,
                r = e._y,
                i = e._z,
                a = e.order,
                o = Math.cos,
                s = Math.sin,
                l = o(n / 2),
                c = o(r / 2),
                u = o(i / 2),
                h = s(n / 2),
                d = s(r / 2),
                p = s(i / 2);
              return (
                "XYZ" === a
                  ? ((this._x = h * c * u + l * d * p),
                    (this._y = l * d * u - h * c * p),
                    (this._z = l * c * p + h * d * u),
                    (this._w = l * c * u - h * d * p))
                  : "YXZ" === a
                  ? ((this._x = h * c * u + l * d * p),
                    (this._y = l * d * u - h * c * p),
                    (this._z = l * c * p - h * d * u),
                    (this._w = l * c * u + h * d * p))
                  : "ZXY" === a
                  ? ((this._x = h * c * u - l * d * p),
                    (this._y = l * d * u + h * c * p),
                    (this._z = l * c * p + h * d * u),
                    (this._w = l * c * u - h * d * p))
                  : "ZYX" === a
                  ? ((this._x = h * c * u - l * d * p),
                    (this._y = l * d * u + h * c * p),
                    (this._z = l * c * p - h * d * u),
                    (this._w = l * c * u + h * d * p))
                  : "YZX" === a
                  ? ((this._x = h * c * u + l * d * p),
                    (this._y = l * d * u + h * c * p),
                    (this._z = l * c * p - h * d * u),
                    (this._w = l * c * u - h * d * p))
                  : "XZY" === a &&
                    ((this._x = h * c * u - l * d * p),
                    (this._y = l * d * u - h * c * p),
                    (this._z = l * c * p + h * d * u),
                    (this._w = l * c * u + h * d * p)),
                !1 !== t && this._onChangeCallback(),
                this
              );
            },
            setFromAxisAngle: function(e, t) {
              var n = t / 2,
                r = Math.sin(n);
              return (
                (this._x = e.x * r),
                (this._y = e.y * r),
                (this._z = e.z * r),
                (this._w = Math.cos(n)),
                this._onChangeCallback(),
                this
              );
            },
            setFromRotationMatrix: function(e) {
              var t,
                n = e.elements,
                r = n[0],
                i = n[4],
                a = n[8],
                o = n[1],
                s = n[5],
                l = n[9],
                c = n[2],
                u = n[6],
                h = n[10],
                d = r + s + h;
              return (
                d > 0
                  ? ((t = 0.5 / Math.sqrt(d + 1)),
                    (this._w = 0.25 / t),
                    (this._x = (u - l) * t),
                    (this._y = (a - c) * t),
                    (this._z = (o - i) * t))
                  : r > s && r > h
                  ? ((t = 2 * Math.sqrt(1 + r - s - h)),
                    (this._w = (u - l) / t),
                    (this._x = 0.25 * t),
                    (this._y = (i + o) / t),
                    (this._z = (a + c) / t))
                  : s > h
                  ? ((t = 2 * Math.sqrt(1 + s - r - h)),
                    (this._w = (a - c) / t),
                    (this._x = (i + o) / t),
                    (this._y = 0.25 * t),
                    (this._z = (l + u) / t))
                  : ((t = 2 * Math.sqrt(1 + h - r - s)),
                    (this._w = (o - i) / t),
                    (this._x = (a + c) / t),
                    (this._y = (l + u) / t),
                    (this._z = 0.25 * t)),
                this._onChangeCallback(),
                this
              );
            },
            setFromUnitVectors: function(e, t) {
              var n = e.dot(t) + 1;
              return (
                n < 1e-6
                  ? ((n = 0),
                    Math.abs(e.x) > Math.abs(e.z)
                      ? ((this._x = -e.y),
                        (this._y = e.x),
                        (this._z = 0),
                        (this._w = n))
                      : ((this._x = 0),
                        (this._y = -e.z),
                        (this._z = e.y),
                        (this._w = n)))
                  : ((this._x = e.y * t.z - e.z * t.y),
                    (this._y = e.z * t.x - e.x * t.z),
                    (this._z = e.x * t.y - e.y * t.x),
                    (this._w = n)),
                this.normalize()
              );
            },
            angleTo: function(e) {
              return 2 * Math.acos(Math.abs(Qi.clamp(this.dot(e), -1, 1)));
            },
            rotateTowards: function(e, t) {
              var n = this.angleTo(e);
              if (0 === n) return this;
              var r = Math.min(1, t / n);
              return this.slerp(e, r), this;
            },
            inverse: function() {
              return this.conjugate();
            },
            conjugate: function() {
              return (
                (this._x *= -1),
                (this._y *= -1),
                (this._z *= -1),
                this._onChangeCallback(),
                this
              );
            },
            dot: function(e) {
              return (
                this._x * e._x +
                this._y * e._y +
                this._z * e._z +
                this._w * e._w
              );
            },
            lengthSq: function() {
              return (
                this._x * this._x +
                this._y * this._y +
                this._z * this._z +
                this._w * this._w
              );
            },
            length: function() {
              return Math.sqrt(
                this._x * this._x +
                  this._y * this._y +
                  this._z * this._z +
                  this._w * this._w
              );
            },
            normalize: function() {
              var e = this.length();
              return (
                0 === e
                  ? ((this._x = 0), (this._y = 0), (this._z = 0), (this._w = 1))
                  : ((e = 1 / e),
                    (this._x = this._x * e),
                    (this._y = this._y * e),
                    (this._z = this._z * e),
                    (this._w = this._w * e)),
                this._onChangeCallback(),
                this
              );
            },
            multiply: function(e, t) {
              return void 0 !== t
                ? this.multiplyQuaternions(e, t)
                : this.multiplyQuaternions(this, e);
            },
            premultiply: function(e) {
              return this.multiplyQuaternions(e, this);
            },
            multiplyQuaternions: function(e, t) {
              var n = e._x,
                r = e._y,
                i = e._z,
                a = e._w,
                o = t._x,
                s = t._y,
                l = t._z,
                c = t._w;
              return (
                (this._x = n * c + a * o + r * l - i * s),
                (this._y = r * c + a * s + i * o - n * l),
                (this._z = i * c + a * l + n * s - r * o),
                (this._w = a * c - n * o - r * s - i * l),
                this._onChangeCallback(),
                this
              );
            },
            slerp: function(e, t) {
              if (0 === t) return this;
              if (1 === t) return this.copy(e);
              var n = this._x,
                r = this._y,
                i = this._z,
                a = this._w,
                o = a * e._w + n * e._x + r * e._y + i * e._z;
              if (
                (o < 0
                  ? ((this._w = -e._w),
                    (this._x = -e._x),
                    (this._y = -e._y),
                    (this._z = -e._z),
                    (o = -o))
                  : this.copy(e),
                o >= 1)
              )
                return (
                  (this._w = a),
                  (this._x = n),
                  (this._y = r),
                  (this._z = i),
                  this
                );
              var s = 1 - o * o;
              if (s <= Number.EPSILON) {
                var l = 1 - t;
                return (
                  (this._w = l * a + t * this._w),
                  (this._x = l * n + t * this._x),
                  (this._y = l * r + t * this._y),
                  (this._z = l * i + t * this._z),
                  this.normalize(),
                  this._onChangeCallback(),
                  this
                );
              }
              var c = Math.sqrt(s),
                u = Math.atan2(c, o),
                h = Math.sin((1 - t) * u) / c,
                d = Math.sin(t * u) / c;
              return (
                (this._w = a * h + this._w * d),
                (this._x = n * h + this._x * d),
                (this._y = r * h + this._y * d),
                (this._z = i * h + this._z * d),
                this._onChangeCallback(),
                this
              );
            },
            equals: function(e) {
              return (
                e._x === this._x &&
                e._y === this._y &&
                e._z === this._z &&
                e._w === this._w
              );
            },
            fromArray: function(e, t) {
              return (
                void 0 === t && (t = 0),
                (this._x = e[t]),
                (this._y = e[t + 1]),
                (this._z = e[t + 2]),
                (this._w = e[t + 3]),
                this._onChangeCallback(),
                this
              );
            },
            toArray: function(e, t) {
              return (
                void 0 === e && (e = []),
                void 0 === t && (t = 0),
                (e[t] = this._x),
                (e[t + 1] = this._y),
                (e[t + 2] = this._z),
                (e[t + 3] = this._w),
                e
              );
            },
            _onChange: function(e) {
              return (this._onChangeCallback = e), this;
            },
            _onChangeCallback: function() {}
          });
        var Ki = new ea(),
          $i = new Ji();
        function ea(e, t, n) {
          (this.x = e || 0), (this.y = t || 0), (this.z = n || 0);
        }
        Object.assign(ea.prototype, {
          isVector3: !0,
          set: function(e, t, n) {
            return (this.x = e), (this.y = t), (this.z = n), this;
          },
          setScalar: function(e) {
            return (this.x = e), (this.y = e), (this.z = e), this;
          },
          setX: function(e) {
            return (this.x = e), this;
          },
          setY: function(e) {
            return (this.y = e), this;
          },
          setZ: function(e) {
            return (this.z = e), this;
          },
          setComponent: function(e, t) {
            switch (e) {
              case 0:
                this.x = t;
                break;
              case 1:
                this.y = t;
                break;
              case 2:
                this.z = t;
                break;
              default:
                throw new Error("index is out of range: " + e);
            }
            return this;
          },
          getComponent: function(e) {
            switch (e) {
              case 0:
                return this.x;
              case 1:
                return this.y;
              case 2:
                return this.z;
              default:
                throw new Error("index is out of range: " + e);
            }
          },
          clone: function() {
            return new this.constructor(this.x, this.y, this.z);
          },
          copy: function(e) {
            return (this.x = e.x), (this.y = e.y), (this.z = e.z), this;
          },
          add: function(e, t) {
            return void 0 !== t
              ? this.addVectors(e, t)
              : ((this.x += e.x), (this.y += e.y), (this.z += e.z), this);
          },
          addScalar: function(e) {
            return (this.x += e), (this.y += e), (this.z += e), this;
          },
          addVectors: function(e, t) {
            return (
              (this.x = e.x + t.x),
              (this.y = e.y + t.y),
              (this.z = e.z + t.z),
              this
            );
          },
          addScaledVector: function(e, t) {
            return (
              (this.x += e.x * t),
              (this.y += e.y * t),
              (this.z += e.z * t),
              this
            );
          },
          sub: function(e, t) {
            return void 0 !== t
              ? this.subVectors(e, t)
              : ((this.x -= e.x), (this.y -= e.y), (this.z -= e.z), this);
          },
          subScalar: function(e) {
            return (this.x -= e), (this.y -= e), (this.z -= e), this;
          },
          subVectors: function(e, t) {
            return (
              (this.x = e.x - t.x),
              (this.y = e.y - t.y),
              (this.z = e.z - t.z),
              this
            );
          },
          multiply: function(e, t) {
            return void 0 !== t
              ? this.multiplyVectors(e, t)
              : ((this.x *= e.x), (this.y *= e.y), (this.z *= e.z), this);
          },
          multiplyScalar: function(e) {
            return (this.x *= e), (this.y *= e), (this.z *= e), this;
          },
          multiplyVectors: function(e, t) {
            return (
              (this.x = e.x * t.x),
              (this.y = e.y * t.y),
              (this.z = e.z * t.z),
              this
            );
          },
          applyEuler: function(e) {
            return !e || e.isEuler, this.applyQuaternion($i.setFromEuler(e));
          },
          applyAxisAngle: function(e, t) {
            return this.applyQuaternion($i.setFromAxisAngle(e, t));
          },
          applyMatrix3: function(e) {
            var t = this.x,
              n = this.y,
              r = this.z,
              i = e.elements;
            return (
              (this.x = i[0] * t + i[3] * n + i[6] * r),
              (this.y = i[1] * t + i[4] * n + i[7] * r),
              (this.z = i[2] * t + i[5] * n + i[8] * r),
              this
            );
          },
          applyNormalMatrix: function(e) {
            return this.applyMatrix3(e).normalize();
          },
          applyMatrix4: function(e) {
            var t = this.x,
              n = this.y,
              r = this.z,
              i = e.elements,
              a = 1 / (i[3] * t + i[7] * n + i[11] * r + i[15]);
            return (
              (this.x = (i[0] * t + i[4] * n + i[8] * r + i[12]) * a),
              (this.y = (i[1] * t + i[5] * n + i[9] * r + i[13]) * a),
              (this.z = (i[2] * t + i[6] * n + i[10] * r + i[14]) * a),
              this
            );
          },
          applyQuaternion: function(e) {
            var t = this.x,
              n = this.y,
              r = this.z,
              i = e.x,
              a = e.y,
              o = e.z,
              s = e.w,
              l = s * t + a * r - o * n,
              c = s * n + o * t - i * r,
              u = s * r + i * n - a * t,
              h = -i * t - a * n - o * r;
            return (
              (this.x = l * s + h * -i + c * -o - u * -a),
              (this.y = c * s + h * -a + u * -i - l * -o),
              (this.z = u * s + h * -o + l * -a - c * -i),
              this
            );
          },
          project: function(e) {
            return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(
              e.projectionMatrix
            );
          },
          unproject: function(e) {
            return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(
              e.matrixWorld
            );
          },
          transformDirection: function(e) {
            var t = this.x,
              n = this.y,
              r = this.z,
              i = e.elements;
            return (
              (this.x = i[0] * t + i[4] * n + i[8] * r),
              (this.y = i[1] * t + i[5] * n + i[9] * r),
              (this.z = i[2] * t + i[6] * n + i[10] * r),
              this.normalize()
            );
          },
          divide: function(e) {
            return (this.x /= e.x), (this.y /= e.y), (this.z /= e.z), this;
          },
          divideScalar: function(e) {
            return this.multiplyScalar(1 / e);
          },
          min: function(e) {
            return (
              (this.x = Math.min(this.x, e.x)),
              (this.y = Math.min(this.y, e.y)),
              (this.z = Math.min(this.z, e.z)),
              this
            );
          },
          max: function(e) {
            return (
              (this.x = Math.max(this.x, e.x)),
              (this.y = Math.max(this.y, e.y)),
              (this.z = Math.max(this.z, e.z)),
              this
            );
          },
          clamp: function(e, t) {
            return (
              (this.x = Math.max(e.x, Math.min(t.x, this.x))),
              (this.y = Math.max(e.y, Math.min(t.y, this.y))),
              (this.z = Math.max(e.z, Math.min(t.z, this.z))),
              this
            );
          },
          clampScalar: function(e, t) {
            return (
              (this.x = Math.max(e, Math.min(t, this.x))),
              (this.y = Math.max(e, Math.min(t, this.y))),
              (this.z = Math.max(e, Math.min(t, this.z))),
              this
            );
          },
          clampLength: function(e, t) {
            var n = this.length();
            return this.divideScalar(n || 1).multiplyScalar(
              Math.max(e, Math.min(t, n))
            );
          },
          floor: function() {
            return (
              (this.x = Math.floor(this.x)),
              (this.y = Math.floor(this.y)),
              (this.z = Math.floor(this.z)),
              this
            );
          },
          ceil: function() {
            return (
              (this.x = Math.ceil(this.x)),
              (this.y = Math.ceil(this.y)),
              (this.z = Math.ceil(this.z)),
              this
            );
          },
          round: function() {
            return (
              (this.x = Math.round(this.x)),
              (this.y = Math.round(this.y)),
              (this.z = Math.round(this.z)),
              this
            );
          },
          roundToZero: function() {
            return (
              (this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x)),
              (this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y)),
              (this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z)),
              this
            );
          },
          negate: function() {
            return (
              (this.x = -this.x), (this.y = -this.y), (this.z = -this.z), this
            );
          },
          dot: function(e) {
            return this.x * e.x + this.y * e.y + this.z * e.z;
          },
          lengthSq: function() {
            return this.x * this.x + this.y * this.y + this.z * this.z;
          },
          length: function() {
            return Math.sqrt(
              this.x * this.x + this.y * this.y + this.z * this.z
            );
          },
          manhattanLength: function() {
            return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);
          },
          normalize: function() {
            return this.divideScalar(this.length() || 1);
          },
          setLength: function(e) {
            return this.normalize().multiplyScalar(e);
          },
          lerp: function(e, t) {
            return (
              (this.x += (e.x - this.x) * t),
              (this.y += (e.y - this.y) * t),
              (this.z += (e.z - this.z) * t),
              this
            );
          },
          lerpVectors: function(e, t, n) {
            return this.subVectors(t, e)
              .multiplyScalar(n)
              .add(e);
          },
          cross: function(e, t) {
            return void 0 !== t
              ? this.crossVectors(e, t)
              : this.crossVectors(this, e);
          },
          crossVectors: function(e, t) {
            var n = e.x,
              r = e.y,
              i = e.z,
              a = t.x,
              o = t.y,
              s = t.z;
            return (
              (this.x = r * s - i * o),
              (this.y = i * a - n * s),
              (this.z = n * o - r * a),
              this
            );
          },
          projectOnVector: function(e) {
            var t = e.dot(this) / e.lengthSq();
            return this.copy(e).multiplyScalar(t);
          },
          projectOnPlane: function(e) {
            return Ki.copy(this).projectOnVector(e), this.sub(Ki);
          },
          reflect: function(e) {
            return this.sub(Ki.copy(e).multiplyScalar(2 * this.dot(e)));
          },
          angleTo: function(e) {
            var t = Math.sqrt(this.lengthSq() * e.lengthSq()),
              n = this.dot(e) / t;
            return Math.acos(Qi.clamp(n, -1, 1));
          },
          distanceTo: function(e) {
            return Math.sqrt(this.distanceToSquared(e));
          },
          distanceToSquared: function(e) {
            var t = this.x - e.x,
              n = this.y - e.y,
              r = this.z - e.z;
            return t * t + n * n + r * r;
          },
          manhattanDistanceTo: function(e) {
            return (
              Math.abs(this.x - e.x) +
              Math.abs(this.y - e.y) +
              Math.abs(this.z - e.z)
            );
          },
          setFromSpherical: function(e) {
            return this.setFromSphericalCoords(e.radius, e.phi, e.theta);
          },
          setFromSphericalCoords: function(e, t, n) {
            var r = Math.sin(t) * e;
            return (
              (this.x = r * Math.sin(n)),
              (this.y = Math.cos(t) * e),
              (this.z = r * Math.cos(n)),
              this
            );
          },
          setFromCylindrical: function(e) {
            return this.setFromCylindricalCoords(e.radius, e.theta, e.y);
          },
          setFromCylindricalCoords: function(e, t, n) {
            return (
              (this.x = e * Math.sin(t)),
              (this.y = n),
              (this.z = e * Math.cos(t)),
              this
            );
          },
          setFromMatrixPosition: function(e) {
            var t = e.elements;
            return (this.x = t[12]), (this.y = t[13]), (this.z = t[14]), this;
          },
          setFromMatrixScale: function(e) {
            var t = this.setFromMatrixColumn(e, 0).length(),
              n = this.setFromMatrixColumn(e, 1).length(),
              r = this.setFromMatrixColumn(e, 2).length();
            return (this.x = t), (this.y = n), (this.z = r), this;
          },
          setFromMatrixColumn: function(e, t) {
            return this.fromArray(e.elements, 4 * t);
          },
          equals: function(e) {
            return e.x === this.x && e.y === this.y && e.z === this.z;
          },
          fromArray: function(e, t) {
            return (
              void 0 === t && (t = 0),
              (this.x = e[t]),
              (this.y = e[t + 1]),
              (this.z = e[t + 2]),
              this
            );
          },
          toArray: function(e, t) {
            return (
              void 0 === e && (e = []),
              void 0 === t && (t = 0),
              (e[t] = this.x),
              (e[t + 1] = this.y),
              (e[t + 2] = this.z),
              e
            );
          },
          fromBufferAttribute: function(e, t, n) {
            return (
              (this.x = e.getX(t)),
              (this.y = e.getY(t)),
              (this.z = e.getZ(t)),
              this
            );
          }
        });
        var ta,
          na = new ea();
        function ra() {
          (this.elements = [1, 0, 0, 0, 1, 0, 0, 0, 1]), arguments.length;
        }
        Object.assign(ra.prototype, {
          isMatrix3: !0,
          set: function(e, t, n, r, i, a, o, s, l) {
            var c = this.elements;
            return (
              (c[0] = e),
              (c[1] = r),
              (c[2] = o),
              (c[3] = t),
              (c[4] = i),
              (c[5] = s),
              (c[6] = n),
              (c[7] = a),
              (c[8] = l),
              this
            );
          },
          identity: function() {
            return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this;
          },
          clone: function() {
            return new this.constructor().fromArray(this.elements);
          },
          copy: function(e) {
            var t = this.elements,
              n = e.elements;
            return (
              (t[0] = n[0]),
              (t[1] = n[1]),
              (t[2] = n[2]),
              (t[3] = n[3]),
              (t[4] = n[4]),
              (t[5] = n[5]),
              (t[6] = n[6]),
              (t[7] = n[7]),
              (t[8] = n[8]),
              this
            );
          },
          setFromMatrix4: function(e) {
            var t = e.elements;
            return (
              this.set(t[0], t[4], t[8], t[1], t[5], t[9], t[2], t[6], t[10]),
              this
            );
          },
          applyToBufferAttribute: function(e) {
            for (var t = 0, n = e.count; t < n; t++)
              (na.x = e.getX(t)),
                (na.y = e.getY(t)),
                (na.z = e.getZ(t)),
                na.applyMatrix3(this),
                e.setXYZ(t, na.x, na.y, na.z);
            return e;
          },
          multiply: function(e) {
            return this.multiplyMatrices(this, e);
          },
          premultiply: function(e) {
            return this.multiplyMatrices(e, this);
          },
          multiplyMatrices: function(e, t) {
            var n = e.elements,
              r = t.elements,
              i = this.elements,
              a = n[0],
              o = n[3],
              s = n[6],
              l = n[1],
              c = n[4],
              u = n[7],
              h = n[2],
              d = n[5],
              p = n[8],
              f = r[0],
              m = r[3],
              v = r[6],
              g = r[1],
              y = r[4],
              b = r[7],
              x = r[2],
              w = r[5],
              _ = r[8];
            return (
              (i[0] = a * f + o * g + s * x),
              (i[3] = a * m + o * y + s * w),
              (i[6] = a * v + o * b + s * _),
              (i[1] = l * f + c * g + u * x),
              (i[4] = l * m + c * y + u * w),
              (i[7] = l * v + c * b + u * _),
              (i[2] = h * f + d * g + p * x),
              (i[5] = h * m + d * y + p * w),
              (i[8] = h * v + d * b + p * _),
              this
            );
          },
          multiplyScalar: function(e) {
            var t = this.elements;
            return (
              (t[0] *= e),
              (t[3] *= e),
              (t[6] *= e),
              (t[1] *= e),
              (t[4] *= e),
              (t[7] *= e),
              (t[2] *= e),
              (t[5] *= e),
              (t[8] *= e),
              this
            );
          },
          determinant: function() {
            var e = this.elements,
              t = e[0],
              n = e[1],
              r = e[2],
              i = e[3],
              a = e[4],
              o = e[5],
              s = e[6],
              l = e[7],
              c = e[8];
            return (
              t * a * c -
              t * o * l -
              n * i * c +
              n * o * s +
              r * i * l -
              r * a * s
            );
          },
          getInverse: function(e, t) {
            e && e.isMatrix4;
            var n = e.elements,
              r = this.elements,
              i = n[0],
              a = n[1],
              o = n[2],
              s = n[3],
              l = n[4],
              c = n[5],
              u = n[6],
              h = n[7],
              d = n[8],
              p = d * l - c * h,
              f = c * u - d * s,
              m = h * s - l * u,
              v = i * p + a * f + o * m;
            if (0 === v) {
              if (!0 === t)
                throw new Error(
                  "THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"
                );
              return this.identity();
            }
            var g = 1 / v;
            return (
              (r[0] = p * g),
              (r[1] = (o * h - d * a) * g),
              (r[2] = (c * a - o * l) * g),
              (r[3] = f * g),
              (r[4] = (d * i - o * u) * g),
              (r[5] = (o * s - c * i) * g),
              (r[6] = m * g),
              (r[7] = (a * u - h * i) * g),
              (r[8] = (l * i - a * s) * g),
              this
            );
          },
          transpose: function() {
            var e,
              t = this.elements;
            return (
              (e = t[1]),
              (t[1] = t[3]),
              (t[3] = e),
              (e = t[2]),
              (t[2] = t[6]),
              (t[6] = e),
              (e = t[5]),
              (t[5] = t[7]),
              (t[7] = e),
              this
            );
          },
          getNormalMatrix: function(e) {
            return this.setFromMatrix4(e)
              .getInverse(this)
              .transpose();
          },
          transposeIntoArray: function(e) {
            var t = this.elements;
            return (
              (e[0] = t[0]),
              (e[1] = t[3]),
              (e[2] = t[6]),
              (e[3] = t[1]),
              (e[4] = t[4]),
              (e[5] = t[7]),
              (e[6] = t[2]),
              (e[7] = t[5]),
              (e[8] = t[8]),
              this
            );
          },
          setUvTransform: function(e, t, n, r, i, a, o) {
            var s = Math.cos(i),
              l = Math.sin(i);
            this.set(
              n * s,
              n * l,
              -n * (s * a + l * o) + a + e,
              -r * l,
              r * s,
              -r * (-l * a + s * o) + o + t,
              0,
              0,
              1
            );
          },
          scale: function(e, t) {
            var n = this.elements;
            return (
              (n[0] *= e),
              (n[3] *= e),
              (n[6] *= e),
              (n[1] *= t),
              (n[4] *= t),
              (n[7] *= t),
              this
            );
          },
          rotate: function(e) {
            var t = Math.cos(e),
              n = Math.sin(e),
              r = this.elements,
              i = r[0],
              a = r[3],
              o = r[6],
              s = r[1],
              l = r[4],
              c = r[7];
            return (
              (r[0] = t * i + n * s),
              (r[3] = t * a + n * l),
              (r[6] = t * o + n * c),
              (r[1] = -n * i + t * s),
              (r[4] = -n * a + t * l),
              (r[7] = -n * o + t * c),
              this
            );
          },
          translate: function(e, t) {
            var n = this.elements;
            return (
              (n[0] += e * n[2]),
              (n[3] += e * n[5]),
              (n[6] += e * n[8]),
              (n[1] += t * n[2]),
              (n[4] += t * n[5]),
              (n[7] += t * n[8]),
              this
            );
          },
          equals: function(e) {
            for (var t = this.elements, n = e.elements, r = 0; r < 9; r++)
              if (t[r] !== n[r]) return !1;
            return !0;
          },
          fromArray: function(e, t) {
            void 0 === t && (t = 0);
            for (var n = 0; n < 9; n++) this.elements[n] = e[n + t];
            return this;
          },
          toArray: function(e, t) {
            void 0 === e && (e = []), void 0 === t && (t = 0);
            var n = this.elements;
            return (
              (e[t] = n[0]),
              (e[t + 1] = n[1]),
              (e[t + 2] = n[2]),
              (e[t + 3] = n[3]),
              (e[t + 4] = n[4]),
              (e[t + 5] = n[5]),
              (e[t + 6] = n[6]),
              (e[t + 7] = n[7]),
              (e[t + 8] = n[8]),
              e
            );
          }
        });
        var ia = {
            getDataURL: function(e) {
              var t;
              if ("undefined" == typeof HTMLCanvasElement) return e.src;
              if (e instanceof HTMLCanvasElement) t = e;
              else {
                void 0 === ta &&
                  (ta = document.createElementNS(
                    "http://www.w3.org/1999/xhtml",
                    "canvas"
                  )),
                  (ta.width = e.width),
                  (ta.height = e.height);
                var n = ta.getContext("2d");
                e instanceof ImageData
                  ? n.putImageData(e, 0, 0)
                  : n.drawImage(e, 0, 0, e.width, e.height),
                  (t = ta);
              }
              return t.width > 2048 || t.height > 2048
                ? t.toDataURL("image/jpeg", 0.6)
                : t.toDataURL("image/png");
            }
          },
          aa = 0;
        function oa(e, t, n, r, i, a, o, s, l, c) {
          Object.defineProperty(this, "id", { value: aa++ }),
            (this.uuid = Qi.generateUUID()),
            (this.name = ""),
            (this.image = void 0 !== e ? e : oa.DEFAULT_IMAGE),
            (this.mipmaps = []),
            (this.mapping = void 0 !== t ? t : oa.DEFAULT_MAPPING),
            (this.wrapS = void 0 !== n ? n : Qn),
            (this.wrapT = void 0 !== r ? r : Qn),
            (this.magFilter = void 0 !== i ? i : nr),
            (this.minFilter = void 0 !== a ? a : ar),
            (this.anisotropy = void 0 !== l ? l : 1),
            (this.format = void 0 !== o ? o : wr),
            (this.type = void 0 !== s ? s : sr),
            (this.offset = new Zi(0, 0)),
            (this.repeat = new Zi(1, 1)),
            (this.center = new Zi(0, 0)),
            (this.rotation = 0),
            (this.matrixAutoUpdate = !0),
            (this.matrix = new ra()),
            (this.generateMipmaps = !0),
            (this.premultiplyAlpha = !1),
            (this.flipY = !0),
            (this.unpackAlignment = 4),
            (this.encoding = void 0 !== c ? c : ci),
            (this.version = 0),
            (this.onUpdate = null);
        }
        function sa(e, t, n, r) {
          (this.x = e || 0),
            (this.y = t || 0),
            (this.z = n || 0),
            (this.w = void 0 !== r ? r : 1);
        }
        function la(e, t, n) {
          (this.width = e),
            (this.height = t),
            (this.scissor = new sa(0, 0, e, t)),
            (this.scissorTest = !1),
            (this.viewport = new sa(0, 0, e, t)),
            (n = n || {}),
            (this.texture = new oa(
              void 0,
              void 0,
              n.wrapS,
              n.wrapT,
              n.magFilter,
              n.minFilter,
              n.format,
              n.type,
              n.anisotropy,
              n.encoding
            )),
            (this.texture.image = {}),
            (this.texture.image.width = e),
            (this.texture.image.height = t),
            (this.texture.generateMipmaps =
              void 0 !== n.generateMipmaps && n.generateMipmaps),
            (this.texture.minFilter =
              void 0 !== n.minFilter ? n.minFilter : nr),
            (this.depthBuffer = void 0 === n.depthBuffer || n.depthBuffer),
            (this.stencilBuffer =
              void 0 === n.stencilBuffer || n.stencilBuffer),
            (this.depthTexture =
              void 0 !== n.depthTexture ? n.depthTexture : null);
        }
        function ca(e, t, n) {
          la.call(this, e, t, n), (this.samples = 4);
        }
        (oa.DEFAULT_IMAGE = void 0),
          (oa.DEFAULT_MAPPING = Bn),
          (oa.prototype = Object.assign(Object.create(Wi.prototype), {
            constructor: oa,
            isTexture: !0,
            updateMatrix: function() {
              this.matrix.setUvTransform(
                this.offset.x,
                this.offset.y,
                this.repeat.x,
                this.repeat.y,
                this.rotation,
                this.center.x,
                this.center.y
              );
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return (
                (this.name = e.name),
                (this.image = e.image),
                (this.mipmaps = e.mipmaps.slice(0)),
                (this.mapping = e.mapping),
                (this.wrapS = e.wrapS),
                (this.wrapT = e.wrapT),
                (this.magFilter = e.magFilter),
                (this.minFilter = e.minFilter),
                (this.anisotropy = e.anisotropy),
                (this.format = e.format),
                (this.type = e.type),
                this.offset.copy(e.offset),
                this.repeat.copy(e.repeat),
                this.center.copy(e.center),
                (this.rotation = e.rotation),
                (this.matrixAutoUpdate = e.matrixAutoUpdate),
                this.matrix.copy(e.matrix),
                (this.generateMipmaps = e.generateMipmaps),
                (this.premultiplyAlpha = e.premultiplyAlpha),
                (this.flipY = e.flipY),
                (this.unpackAlignment = e.unpackAlignment),
                (this.encoding = e.encoding),
                this
              );
            },
            toJSON: function(e) {
              var t = void 0 === e || "string" == typeof e;
              if (!t && void 0 !== e.textures[this.uuid])
                return e.textures[this.uuid];
              var n = {
                metadata: {
                  version: 4.5,
                  type: "Texture",
                  generator: "Texture.toJSON"
                },
                uuid: this.uuid,
                name: this.name,
                mapping: this.mapping,
                repeat: [this.repeat.x, this.repeat.y],
                offset: [this.offset.x, this.offset.y],
                center: [this.center.x, this.center.y],
                rotation: this.rotation,
                wrap: [this.wrapS, this.wrapT],
                format: this.format,
                type: this.type,
                encoding: this.encoding,
                minFilter: this.minFilter,
                magFilter: this.magFilter,
                anisotropy: this.anisotropy,
                flipY: this.flipY,
                premultiplyAlpha: this.premultiplyAlpha,
                unpackAlignment: this.unpackAlignment
              };
              if (void 0 !== this.image) {
                var r = this.image;
                if (
                  (void 0 === r.uuid && (r.uuid = Qi.generateUUID()),
                  !t && void 0 === e.images[r.uuid])
                ) {
                  var i;
                  if (Array.isArray(r)) {
                    i = [];
                    for (var a = 0, o = r.length; a < o; a++)
                      i.push(ia.getDataURL(r[a]));
                  } else i = ia.getDataURL(r);
                  e.images[r.uuid] = { uuid: r.uuid, url: i };
                }
                n.image = r.uuid;
              }
              return t || (e.textures[this.uuid] = n), n;
            },
            dispose: function() {
              this.dispatchEvent({ type: "dispose" });
            },
            transformUv: function(e) {
              if (this.mapping !== Bn) return e;
              if ((e.applyMatrix3(this.matrix), e.x < 0 || e.x > 1))
                switch (this.wrapS) {
                  case qn:
                    e.x = e.x - Math.floor(e.x);
                    break;
                  case Qn:
                    e.x = e.x < 0 ? 0 : 1;
                    break;
                  case Zn:
                    1 === Math.abs(Math.floor(e.x) % 2)
                      ? (e.x = Math.ceil(e.x) - e.x)
                      : (e.x = e.x - Math.floor(e.x));
                }
              if (e.y < 0 || e.y > 1)
                switch (this.wrapT) {
                  case qn:
                    e.y = e.y - Math.floor(e.y);
                    break;
                  case Qn:
                    e.y = e.y < 0 ? 0 : 1;
                    break;
                  case Zn:
                    1 === Math.abs(Math.floor(e.y) % 2)
                      ? (e.y = Math.ceil(e.y) - e.y)
                      : (e.y = e.y - Math.floor(e.y));
                }
              return this.flipY && (e.y = 1 - e.y), e;
            }
          })),
          Object.defineProperty(oa.prototype, "needsUpdate", {
            set: function(e) {
              !0 === e && this.version++;
            }
          }),
          Object.defineProperties(sa.prototype, {
            width: {
              get: function() {
                return this.z;
              },
              set: function(e) {
                this.z = e;
              }
            },
            height: {
              get: function() {
                return this.w;
              },
              set: function(e) {
                this.w = e;
              }
            }
          }),
          Object.assign(sa.prototype, {
            isVector4: !0,
            set: function(e, t, n, r) {
              return (
                (this.x = e), (this.y = t), (this.z = n), (this.w = r), this
              );
            },
            setScalar: function(e) {
              return (
                (this.x = e), (this.y = e), (this.z = e), (this.w = e), this
              );
            },
            setX: function(e) {
              return (this.x = e), this;
            },
            setY: function(e) {
              return (this.y = e), this;
            },
            setZ: function(e) {
              return (this.z = e), this;
            },
            setW: function(e) {
              return (this.w = e), this;
            },
            setComponent: function(e, t) {
              switch (e) {
                case 0:
                  this.x = t;
                  break;
                case 1:
                  this.y = t;
                  break;
                case 2:
                  this.z = t;
                  break;
                case 3:
                  this.w = t;
                  break;
                default:
                  throw new Error("index is out of range: " + e);
              }
              return this;
            },
            getComponent: function(e) {
              switch (e) {
                case 0:
                  return this.x;
                case 1:
                  return this.y;
                case 2:
                  return this.z;
                case 3:
                  return this.w;
                default:
                  throw new Error("index is out of range: " + e);
              }
            },
            clone: function() {
              return new this.constructor(this.x, this.y, this.z, this.w);
            },
            copy: function(e) {
              return (
                (this.x = e.x),
                (this.y = e.y),
                (this.z = e.z),
                (this.w = void 0 !== e.w ? e.w : 1),
                this
              );
            },
            add: function(e, t) {
              return void 0 !== t
                ? this.addVectors(e, t)
                : ((this.x += e.x),
                  (this.y += e.y),
                  (this.z += e.z),
                  (this.w += e.w),
                  this);
            },
            addScalar: function(e) {
              return (
                (this.x += e), (this.y += e), (this.z += e), (this.w += e), this
              );
            },
            addVectors: function(e, t) {
              return (
                (this.x = e.x + t.x),
                (this.y = e.y + t.y),
                (this.z = e.z + t.z),
                (this.w = e.w + t.w),
                this
              );
            },
            addScaledVector: function(e, t) {
              return (
                (this.x += e.x * t),
                (this.y += e.y * t),
                (this.z += e.z * t),
                (this.w += e.w * t),
                this
              );
            },
            sub: function(e, t) {
              return void 0 !== t
                ? this.subVectors(e, t)
                : ((this.x -= e.x),
                  (this.y -= e.y),
                  (this.z -= e.z),
                  (this.w -= e.w),
                  this);
            },
            subScalar: function(e) {
              return (
                (this.x -= e), (this.y -= e), (this.z -= e), (this.w -= e), this
              );
            },
            subVectors: function(e, t) {
              return (
                (this.x = e.x - t.x),
                (this.y = e.y - t.y),
                (this.z = e.z - t.z),
                (this.w = e.w - t.w),
                this
              );
            },
            multiplyScalar: function(e) {
              return (
                (this.x *= e), (this.y *= e), (this.z *= e), (this.w *= e), this
              );
            },
            applyMatrix4: function(e) {
              var t = this.x,
                n = this.y,
                r = this.z,
                i = this.w,
                a = e.elements;
              return (
                (this.x = a[0] * t + a[4] * n + a[8] * r + a[12] * i),
                (this.y = a[1] * t + a[5] * n + a[9] * r + a[13] * i),
                (this.z = a[2] * t + a[6] * n + a[10] * r + a[14] * i),
                (this.w = a[3] * t + a[7] * n + a[11] * r + a[15] * i),
                this
              );
            },
            divideScalar: function(e) {
              return this.multiplyScalar(1 / e);
            },
            setAxisAngleFromQuaternion: function(e) {
              this.w = 2 * Math.acos(e.w);
              var t = Math.sqrt(1 - e.w * e.w);
              return (
                t < 1e-4
                  ? ((this.x = 1), (this.y = 0), (this.z = 0))
                  : ((this.x = e.x / t),
                    (this.y = e.y / t),
                    (this.z = e.z / t)),
                this
              );
            },
            setAxisAngleFromRotationMatrix: function(e) {
              var t,
                n,
                r,
                i,
                a = e.elements,
                o = a[0],
                s = a[4],
                l = a[8],
                c = a[1],
                u = a[5],
                h = a[9],
                d = a[2],
                p = a[6],
                f = a[10];
              if (
                Math.abs(s - c) < 0.01 &&
                Math.abs(l - d) < 0.01 &&
                Math.abs(h - p) < 0.01
              ) {
                if (
                  Math.abs(s + c) < 0.1 &&
                  Math.abs(l + d) < 0.1 &&
                  Math.abs(h + p) < 0.1 &&
                  Math.abs(o + u + f - 3) < 0.1
                )
                  return this.set(1, 0, 0, 0), this;
                t = Math.PI;
                var m = (o + 1) / 2,
                  v = (u + 1) / 2,
                  g = (f + 1) / 2,
                  y = (s + c) / 4,
                  b = (l + d) / 4,
                  x = (h + p) / 4;
                return (
                  m > v && m > g
                    ? m < 0.01
                      ? ((n = 0), (r = 0.707106781), (i = 0.707106781))
                      : ((r = y / (n = Math.sqrt(m))), (i = b / n))
                    : v > g
                    ? v < 0.01
                      ? ((n = 0.707106781), (r = 0), (i = 0.707106781))
                      : ((n = y / (r = Math.sqrt(v))), (i = x / r))
                    : g < 0.01
                    ? ((n = 0.707106781), (r = 0.707106781), (i = 0))
                    : ((n = b / (i = Math.sqrt(g))), (r = x / i)),
                  this.set(n, r, i, t),
                  this
                );
              }
              var w = Math.sqrt(
                (p - h) * (p - h) + (l - d) * (l - d) + (c - s) * (c - s)
              );
              return (
                Math.abs(w) < 0.001 && (w = 1),
                (this.x = (p - h) / w),
                (this.y = (l - d) / w),
                (this.z = (c - s) / w),
                (this.w = Math.acos((o + u + f - 1) / 2)),
                this
              );
            },
            min: function(e) {
              return (
                (this.x = Math.min(this.x, e.x)),
                (this.y = Math.min(this.y, e.y)),
                (this.z = Math.min(this.z, e.z)),
                (this.w = Math.min(this.w, e.w)),
                this
              );
            },
            max: function(e) {
              return (
                (this.x = Math.max(this.x, e.x)),
                (this.y = Math.max(this.y, e.y)),
                (this.z = Math.max(this.z, e.z)),
                (this.w = Math.max(this.w, e.w)),
                this
              );
            },
            clamp: function(e, t) {
              return (
                (this.x = Math.max(e.x, Math.min(t.x, this.x))),
                (this.y = Math.max(e.y, Math.min(t.y, this.y))),
                (this.z = Math.max(e.z, Math.min(t.z, this.z))),
                (this.w = Math.max(e.w, Math.min(t.w, this.w))),
                this
              );
            },
            clampScalar: function(e, t) {
              return (
                (this.x = Math.max(e, Math.min(t, this.x))),
                (this.y = Math.max(e, Math.min(t, this.y))),
                (this.z = Math.max(e, Math.min(t, this.z))),
                (this.w = Math.max(e, Math.min(t, this.w))),
                this
              );
            },
            clampLength: function(e, t) {
              var n = this.length();
              return this.divideScalar(n || 1).multiplyScalar(
                Math.max(e, Math.min(t, n))
              );
            },
            floor: function() {
              return (
                (this.x = Math.floor(this.x)),
                (this.y = Math.floor(this.y)),
                (this.z = Math.floor(this.z)),
                (this.w = Math.floor(this.w)),
                this
              );
            },
            ceil: function() {
              return (
                (this.x = Math.ceil(this.x)),
                (this.y = Math.ceil(this.y)),
                (this.z = Math.ceil(this.z)),
                (this.w = Math.ceil(this.w)),
                this
              );
            },
            round: function() {
              return (
                (this.x = Math.round(this.x)),
                (this.y = Math.round(this.y)),
                (this.z = Math.round(this.z)),
                (this.w = Math.round(this.w)),
                this
              );
            },
            roundToZero: function() {
              return (
                (this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x)),
                (this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y)),
                (this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z)),
                (this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w)),
                this
              );
            },
            negate: function() {
              return (
                (this.x = -this.x),
                (this.y = -this.y),
                (this.z = -this.z),
                (this.w = -this.w),
                this
              );
            },
            dot: function(e) {
              return this.x * e.x + this.y * e.y + this.z * e.z + this.w * e.w;
            },
            lengthSq: function() {
              return (
                this.x * this.x +
                this.y * this.y +
                this.z * this.z +
                this.w * this.w
              );
            },
            length: function() {
              return Math.sqrt(
                this.x * this.x +
                  this.y * this.y +
                  this.z * this.z +
                  this.w * this.w
              );
            },
            manhattanLength: function() {
              return (
                Math.abs(this.x) +
                Math.abs(this.y) +
                Math.abs(this.z) +
                Math.abs(this.w)
              );
            },
            normalize: function() {
              return this.divideScalar(this.length() || 1);
            },
            setLength: function(e) {
              return this.normalize().multiplyScalar(e);
            },
            lerp: function(e, t) {
              return (
                (this.x += (e.x - this.x) * t),
                (this.y += (e.y - this.y) * t),
                (this.z += (e.z - this.z) * t),
                (this.w += (e.w - this.w) * t),
                this
              );
            },
            lerpVectors: function(e, t, n) {
              return this.subVectors(t, e)
                .multiplyScalar(n)
                .add(e);
            },
            equals: function(e) {
              return (
                e.x === this.x &&
                e.y === this.y &&
                e.z === this.z &&
                e.w === this.w
              );
            },
            fromArray: function(e, t) {
              return (
                void 0 === t && (t = 0),
                (this.x = e[t]),
                (this.y = e[t + 1]),
                (this.z = e[t + 2]),
                (this.w = e[t + 3]),
                this
              );
            },
            toArray: function(e, t) {
              return (
                void 0 === e && (e = []),
                void 0 === t && (t = 0),
                (e[t] = this.x),
                (e[t + 1] = this.y),
                (e[t + 2] = this.z),
                (e[t + 3] = this.w),
                e
              );
            },
            fromBufferAttribute: function(e, t, n) {
              return (
                (this.x = e.getX(t)),
                (this.y = e.getY(t)),
                (this.z = e.getZ(t)),
                (this.w = e.getW(t)),
                this
              );
            }
          }),
          (la.prototype = Object.assign(Object.create(Wi.prototype), {
            constructor: la,
            isWebGLRenderTarget: !0,
            setSize: function(e, t) {
              (this.width === e && this.height === t) ||
                ((this.width = e),
                (this.height = t),
                (this.texture.image.width = e),
                (this.texture.image.height = t),
                this.dispose()),
                this.viewport.set(0, 0, e, t),
                this.scissor.set(0, 0, e, t);
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return (
                (this.width = e.width),
                (this.height = e.height),
                this.viewport.copy(e.viewport),
                (this.texture = e.texture.clone()),
                (this.depthBuffer = e.depthBuffer),
                (this.stencilBuffer = e.stencilBuffer),
                (this.depthTexture = e.depthTexture),
                this
              );
            },
            dispose: function() {
              this.dispatchEvent({ type: "dispose" });
            }
          })),
          (ca.prototype = Object.assign(Object.create(la.prototype), {
            constructor: ca,
            isWebGLMultisampleRenderTarget: !0,
            copy: function(e) {
              return (
                la.prototype.copy.call(this, e),
                (this.samples = e.samples),
                this
              );
            }
          }));
        var ua = new ea(),
          ha = new ga(),
          da = new ea(0, 0, 0),
          pa = new ea(1, 1, 1),
          fa = new ea(),
          ma = new ea(),
          va = new ea();
        function ga() {
          (this.elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]),
            arguments.length;
        }
        Object.assign(ga.prototype, {
          isMatrix4: !0,
          set: function(e, t, n, r, i, a, o, s, l, c, u, h, d, p, f, m) {
            var v = this.elements;
            return (
              (v[0] = e),
              (v[4] = t),
              (v[8] = n),
              (v[12] = r),
              (v[1] = i),
              (v[5] = a),
              (v[9] = o),
              (v[13] = s),
              (v[2] = l),
              (v[6] = c),
              (v[10] = u),
              (v[14] = h),
              (v[3] = d),
              (v[7] = p),
              (v[11] = f),
              (v[15] = m),
              this
            );
          },
          identity: function() {
            return (
              this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            );
          },
          clone: function() {
            return new ga().fromArray(this.elements);
          },
          copy: function(e) {
            var t = this.elements,
              n = e.elements;
            return (
              (t[0] = n[0]),
              (t[1] = n[1]),
              (t[2] = n[2]),
              (t[3] = n[3]),
              (t[4] = n[4]),
              (t[5] = n[5]),
              (t[6] = n[6]),
              (t[7] = n[7]),
              (t[8] = n[8]),
              (t[9] = n[9]),
              (t[10] = n[10]),
              (t[11] = n[11]),
              (t[12] = n[12]),
              (t[13] = n[13]),
              (t[14] = n[14]),
              (t[15] = n[15]),
              this
            );
          },
          copyPosition: function(e) {
            var t = this.elements,
              n = e.elements;
            return (t[12] = n[12]), (t[13] = n[13]), (t[14] = n[14]), this;
          },
          extractBasis: function(e, t, n) {
            return (
              e.setFromMatrixColumn(this, 0),
              t.setFromMatrixColumn(this, 1),
              n.setFromMatrixColumn(this, 2),
              this
            );
          },
          makeBasis: function(e, t, n) {
            return (
              this.set(
                e.x,
                t.x,
                n.x,
                0,
                e.y,
                t.y,
                n.y,
                0,
                e.z,
                t.z,
                n.z,
                0,
                0,
                0,
                0,
                1
              ),
              this
            );
          },
          extractRotation: function(e) {
            var t = this.elements,
              n = e.elements,
              r = 1 / ua.setFromMatrixColumn(e, 0).length(),
              i = 1 / ua.setFromMatrixColumn(e, 1).length(),
              a = 1 / ua.setFromMatrixColumn(e, 2).length();
            return (
              (t[0] = n[0] * r),
              (t[1] = n[1] * r),
              (t[2] = n[2] * r),
              (t[3] = 0),
              (t[4] = n[4] * i),
              (t[5] = n[5] * i),
              (t[6] = n[6] * i),
              (t[7] = 0),
              (t[8] = n[8] * a),
              (t[9] = n[9] * a),
              (t[10] = n[10] * a),
              (t[11] = 0),
              (t[12] = 0),
              (t[13] = 0),
              (t[14] = 0),
              (t[15] = 1),
              this
            );
          },
          makeRotationFromEuler: function(e) {
            !e || e.isEuler;
            var t = this.elements,
              n = e.x,
              r = e.y,
              i = e.z,
              a = Math.cos(n),
              o = Math.sin(n),
              s = Math.cos(r),
              l = Math.sin(r),
              c = Math.cos(i),
              u = Math.sin(i);
            if ("XYZ" === e.order) {
              var h = a * c,
                d = a * u,
                p = o * c,
                f = o * u;
              (t[0] = s * c),
                (t[4] = -s * u),
                (t[8] = l),
                (t[1] = d + p * l),
                (t[5] = h - f * l),
                (t[9] = -o * s),
                (t[2] = f - h * l),
                (t[6] = p + d * l),
                (t[10] = a * s);
            } else if ("YXZ" === e.order) {
              var m = s * c,
                v = s * u,
                g = l * c,
                y = l * u;
              (t[0] = m + y * o),
                (t[4] = g * o - v),
                (t[8] = a * l),
                (t[1] = a * u),
                (t[5] = a * c),
                (t[9] = -o),
                (t[2] = v * o - g),
                (t[6] = y + m * o),
                (t[10] = a * s);
            } else if ("ZXY" === e.order)
              (m = s * c),
                (v = s * u),
                (g = l * c),
                (y = l * u),
                (t[0] = m - y * o),
                (t[4] = -a * u),
                (t[8] = g + v * o),
                (t[1] = v + g * o),
                (t[5] = a * c),
                (t[9] = y - m * o),
                (t[2] = -a * l),
                (t[6] = o),
                (t[10] = a * s);
            else if ("ZYX" === e.order)
              (h = a * c),
                (d = a * u),
                (p = o * c),
                (f = o * u),
                (t[0] = s * c),
                (t[4] = p * l - d),
                (t[8] = h * l + f),
                (t[1] = s * u),
                (t[5] = f * l + h),
                (t[9] = d * l - p),
                (t[2] = -l),
                (t[6] = o * s),
                (t[10] = a * s);
            else if ("YZX" === e.order) {
              var b = a * s,
                x = a * l,
                w = o * s,
                _ = o * l;
              (t[0] = s * c),
                (t[4] = _ - b * u),
                (t[8] = w * u + x),
                (t[1] = u),
                (t[5] = a * c),
                (t[9] = -o * c),
                (t[2] = -l * c),
                (t[6] = x * u + w),
                (t[10] = b - _ * u);
            } else
              "XZY" === e.order &&
                ((b = a * s),
                (x = a * l),
                (w = o * s),
                (_ = o * l),
                (t[0] = s * c),
                (t[4] = -u),
                (t[8] = l * c),
                (t[1] = b * u + _),
                (t[5] = a * c),
                (t[9] = x * u - w),
                (t[2] = w * u - x),
                (t[6] = o * c),
                (t[10] = _ * u + b));
            return (
              (t[3] = 0),
              (t[7] = 0),
              (t[11] = 0),
              (t[12] = 0),
              (t[13] = 0),
              (t[14] = 0),
              (t[15] = 1),
              this
            );
          },
          makeRotationFromQuaternion: function(e) {
            return this.compose(da, e, pa);
          },
          lookAt: function(e, t, n) {
            var r = this.elements;
            return (
              va.subVectors(e, t),
              0 === va.lengthSq() && (va.z = 1),
              va.normalize(),
              fa.crossVectors(n, va),
              0 === fa.lengthSq() &&
                (1 === Math.abs(n.z) ? (va.x += 1e-4) : (va.z += 1e-4),
                va.normalize(),
                fa.crossVectors(n, va)),
              fa.normalize(),
              ma.crossVectors(va, fa),
              (r[0] = fa.x),
              (r[4] = ma.x),
              (r[8] = va.x),
              (r[1] = fa.y),
              (r[5] = ma.y),
              (r[9] = va.y),
              (r[2] = fa.z),
              (r[6] = ma.z),
              (r[10] = va.z),
              this
            );
          },
          multiply: function(e, t) {
            return void 0 !== t
              ? this.multiplyMatrices(e, t)
              : this.multiplyMatrices(this, e);
          },
          premultiply: function(e) {
            return this.multiplyMatrices(e, this);
          },
          multiplyMatrices: function(e, t) {
            var n = e.elements,
              r = t.elements,
              i = this.elements,
              a = n[0],
              o = n[4],
              s = n[8],
              l = n[12],
              c = n[1],
              u = n[5],
              h = n[9],
              d = n[13],
              p = n[2],
              f = n[6],
              m = n[10],
              v = n[14],
              g = n[3],
              y = n[7],
              b = n[11],
              x = n[15],
              w = r[0],
              _ = r[4],
              M = r[8],
              T = r[12],
              A = r[1],
              S = r[5],
              E = r[9],
              R = r[13],
              P = r[2],
              I = r[6],
              D = r[10],
              O = r[14],
              C = r[3],
              L = r[7],
              N = r[11],
              F = r[15];
            return (
              (i[0] = a * w + o * A + s * P + l * C),
              (i[4] = a * _ + o * S + s * I + l * L),
              (i[8] = a * M + o * E + s * D + l * N),
              (i[12] = a * T + o * R + s * O + l * F),
              (i[1] = c * w + u * A + h * P + d * C),
              (i[5] = c * _ + u * S + h * I + d * L),
              (i[9] = c * M + u * E + h * D + d * N),
              (i[13] = c * T + u * R + h * O + d * F),
              (i[2] = p * w + f * A + m * P + v * C),
              (i[6] = p * _ + f * S + m * I + v * L),
              (i[10] = p * M + f * E + m * D + v * N),
              (i[14] = p * T + f * R + m * O + v * F),
              (i[3] = g * w + y * A + b * P + x * C),
              (i[7] = g * _ + y * S + b * I + x * L),
              (i[11] = g * M + y * E + b * D + x * N),
              (i[15] = g * T + y * R + b * O + x * F),
              this
            );
          },
          multiplyScalar: function(e) {
            var t = this.elements;
            return (
              (t[0] *= e),
              (t[4] *= e),
              (t[8] *= e),
              (t[12] *= e),
              (t[1] *= e),
              (t[5] *= e),
              (t[9] *= e),
              (t[13] *= e),
              (t[2] *= e),
              (t[6] *= e),
              (t[10] *= e),
              (t[14] *= e),
              (t[3] *= e),
              (t[7] *= e),
              (t[11] *= e),
              (t[15] *= e),
              this
            );
          },
          applyToBufferAttribute: function(e) {
            for (var t = 0, n = e.count; t < n; t++)
              (ua.x = e.getX(t)),
                (ua.y = e.getY(t)),
                (ua.z = e.getZ(t)),
                ua.applyMatrix4(this),
                e.setXYZ(t, ua.x, ua.y, ua.z);
            return e;
          },
          determinant: function() {
            var e = this.elements,
              t = e[0],
              n = e[4],
              r = e[8],
              i = e[12],
              a = e[1],
              o = e[5],
              s = e[9],
              l = e[13],
              c = e[2],
              u = e[6],
              h = e[10],
              d = e[14];
            return (
              e[3] *
                (+i * s * u -
                  r * l * u -
                  i * o * h +
                  n * l * h +
                  r * o * d -
                  n * s * d) +
              e[7] *
                (+t * s * d -
                  t * l * h +
                  i * a * h -
                  r * a * d +
                  r * l * c -
                  i * s * c) +
              e[11] *
                (+t * l * u -
                  t * o * d -
                  i * a * u +
                  n * a * d +
                  i * o * c -
                  n * l * c) +
              e[15] *
                (-r * o * c -
                  t * s * u +
                  t * o * h +
                  r * a * u -
                  n * a * h +
                  n * s * c)
            );
          },
          transpose: function() {
            var e,
              t = this.elements;
            return (
              (e = t[1]),
              (t[1] = t[4]),
              (t[4] = e),
              (e = t[2]),
              (t[2] = t[8]),
              (t[8] = e),
              (e = t[6]),
              (t[6] = t[9]),
              (t[9] = e),
              (e = t[3]),
              (t[3] = t[12]),
              (t[12] = e),
              (e = t[7]),
              (t[7] = t[13]),
              (t[13] = e),
              (e = t[11]),
              (t[11] = t[14]),
              (t[14] = e),
              this
            );
          },
          setPosition: function(e, t, n) {
            var r = this.elements;
            return (
              e.isVector3
                ? ((r[12] = e.x), (r[13] = e.y), (r[14] = e.z))
                : ((r[12] = e), (r[13] = t), (r[14] = n)),
              this
            );
          },
          getInverse: function(e, t) {
            var n = this.elements,
              r = e.elements,
              i = r[0],
              a = r[1],
              o = r[2],
              s = r[3],
              l = r[4],
              c = r[5],
              u = r[6],
              h = r[7],
              d = r[8],
              p = r[9],
              f = r[10],
              m = r[11],
              v = r[12],
              g = r[13],
              y = r[14],
              b = r[15],
              x =
                p * y * h -
                g * f * h +
                g * u * m -
                c * y * m -
                p * u * b +
                c * f * b,
              w =
                v * f * h -
                d * y * h -
                v * u * m +
                l * y * m +
                d * u * b -
                l * f * b,
              _ =
                d * g * h -
                v * p * h +
                v * c * m -
                l * g * m -
                d * c * b +
                l * p * b,
              M =
                v * p * u -
                d * g * u -
                v * c * f +
                l * g * f +
                d * c * y -
                l * p * y,
              T = i * x + a * w + o * _ + s * M;
            if (0 === T) {
              if (!0 === t)
                throw new Error(
                  "THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"
                );
              return this.identity();
            }
            var A = 1 / T;
            return (
              (n[0] = x * A),
              (n[1] =
                (g * f * s -
                  p * y * s -
                  g * o * m +
                  a * y * m +
                  p * o * b -
                  a * f * b) *
                A),
              (n[2] =
                (c * y * s -
                  g * u * s +
                  g * o * h -
                  a * y * h -
                  c * o * b +
                  a * u * b) *
                A),
              (n[3] =
                (p * u * s -
                  c * f * s -
                  p * o * h +
                  a * f * h +
                  c * o * m -
                  a * u * m) *
                A),
              (n[4] = w * A),
              (n[5] =
                (d * y * s -
                  v * f * s +
                  v * o * m -
                  i * y * m -
                  d * o * b +
                  i * f * b) *
                A),
              (n[6] =
                (v * u * s -
                  l * y * s -
                  v * o * h +
                  i * y * h +
                  l * o * b -
                  i * u * b) *
                A),
              (n[7] =
                (l * f * s -
                  d * u * s +
                  d * o * h -
                  i * f * h -
                  l * o * m +
                  i * u * m) *
                A),
              (n[8] = _ * A),
              (n[9] =
                (v * p * s -
                  d * g * s -
                  v * a * m +
                  i * g * m +
                  d * a * b -
                  i * p * b) *
                A),
              (n[10] =
                (l * g * s -
                  v * c * s +
                  v * a * h -
                  i * g * h -
                  l * a * b +
                  i * c * b) *
                A),
              (n[11] =
                (d * c * s -
                  l * p * s -
                  d * a * h +
                  i * p * h +
                  l * a * m -
                  i * c * m) *
                A),
              (n[12] = M * A),
              (n[13] =
                (d * g * o -
                  v * p * o +
                  v * a * f -
                  i * g * f -
                  d * a * y +
                  i * p * y) *
                A),
              (n[14] =
                (v * c * o -
                  l * g * o -
                  v * a * u +
                  i * g * u +
                  l * a * y -
                  i * c * y) *
                A),
              (n[15] =
                (l * p * o -
                  d * c * o +
                  d * a * u -
                  i * p * u -
                  l * a * f +
                  i * c * f) *
                A),
              this
            );
          },
          scale: function(e) {
            var t = this.elements,
              n = e.x,
              r = e.y,
              i = e.z;
            return (
              (t[0] *= n),
              (t[4] *= r),
              (t[8] *= i),
              (t[1] *= n),
              (t[5] *= r),
              (t[9] *= i),
              (t[2] *= n),
              (t[6] *= r),
              (t[10] *= i),
              (t[3] *= n),
              (t[7] *= r),
              (t[11] *= i),
              this
            );
          },
          getMaxScaleOnAxis: function() {
            var e = this.elements,
              t = e[0] * e[0] + e[1] * e[1] + e[2] * e[2],
              n = e[4] * e[4] + e[5] * e[5] + e[6] * e[6],
              r = e[8] * e[8] + e[9] * e[9] + e[10] * e[10];
            return Math.sqrt(Math.max(t, n, r));
          },
          makeTranslation: function(e, t, n) {
            return (
              this.set(1, 0, 0, e, 0, 1, 0, t, 0, 0, 1, n, 0, 0, 0, 1), this
            );
          },
          makeRotationX: function(e) {
            var t = Math.cos(e),
              n = Math.sin(e);
            return (
              this.set(1, 0, 0, 0, 0, t, -n, 0, 0, n, t, 0, 0, 0, 0, 1), this
            );
          },
          makeRotationY: function(e) {
            var t = Math.cos(e),
              n = Math.sin(e);
            return (
              this.set(t, 0, n, 0, 0, 1, 0, 0, -n, 0, t, 0, 0, 0, 0, 1), this
            );
          },
          makeRotationZ: function(e) {
            var t = Math.cos(e),
              n = Math.sin(e);
            return (
              this.set(t, -n, 0, 0, n, t, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            );
          },
          makeRotationAxis: function(e, t) {
            var n = Math.cos(t),
              r = Math.sin(t),
              i = 1 - n,
              a = e.x,
              o = e.y,
              s = e.z,
              l = i * a,
              c = i * o;
            return (
              this.set(
                l * a + n,
                l * o - r * s,
                l * s + r * o,
                0,
                l * o + r * s,
                c * o + n,
                c * s - r * a,
                0,
                l * s - r * o,
                c * s + r * a,
                i * s * s + n,
                0,
                0,
                0,
                0,
                1
              ),
              this
            );
          },
          makeScale: function(e, t, n) {
            return (
              this.set(e, 0, 0, 0, 0, t, 0, 0, 0, 0, n, 0, 0, 0, 0, 1), this
            );
          },
          makeShear: function(e, t, n) {
            return (
              this.set(1, t, n, 0, e, 1, n, 0, e, t, 1, 0, 0, 0, 0, 1), this
            );
          },
          compose: function(e, t, n) {
            var r = this.elements,
              i = t._x,
              a = t._y,
              o = t._z,
              s = t._w,
              l = i + i,
              c = a + a,
              u = o + o,
              h = i * l,
              d = i * c,
              p = i * u,
              f = a * c,
              m = a * u,
              v = o * u,
              g = s * l,
              y = s * c,
              b = s * u,
              x = n.x,
              w = n.y,
              _ = n.z;
            return (
              (r[0] = (1 - (f + v)) * x),
              (r[1] = (d + b) * x),
              (r[2] = (p - y) * x),
              (r[3] = 0),
              (r[4] = (d - b) * w),
              (r[5] = (1 - (h + v)) * w),
              (r[6] = (m + g) * w),
              (r[7] = 0),
              (r[8] = (p + y) * _),
              (r[9] = (m - g) * _),
              (r[10] = (1 - (h + f)) * _),
              (r[11] = 0),
              (r[12] = e.x),
              (r[13] = e.y),
              (r[14] = e.z),
              (r[15] = 1),
              this
            );
          },
          decompose: function(e, t, n) {
            var r = this.elements,
              i = ua.set(r[0], r[1], r[2]).length(),
              a = ua.set(r[4], r[5], r[6]).length(),
              o = ua.set(r[8], r[9], r[10]).length();
            this.determinant() < 0 && (i = -i),
              (e.x = r[12]),
              (e.y = r[13]),
              (e.z = r[14]),
              ha.copy(this);
            var s = 1 / i,
              l = 1 / a,
              c = 1 / o;
            return (
              (ha.elements[0] *= s),
              (ha.elements[1] *= s),
              (ha.elements[2] *= s),
              (ha.elements[4] *= l),
              (ha.elements[5] *= l),
              (ha.elements[6] *= l),
              (ha.elements[8] *= c),
              (ha.elements[9] *= c),
              (ha.elements[10] *= c),
              t.setFromRotationMatrix(ha),
              (n.x = i),
              (n.y = a),
              (n.z = o),
              this
            );
          },
          makePerspective: function(e, t, n, r, i, a) {
            var o = this.elements,
              s = (2 * i) / (t - e),
              l = (2 * i) / (n - r),
              c = (t + e) / (t - e),
              u = (n + r) / (n - r),
              h = -(a + i) / (a - i),
              d = (-2 * a * i) / (a - i);
            return (
              (o[0] = s),
              (o[4] = 0),
              (o[8] = c),
              (o[12] = 0),
              (o[1] = 0),
              (o[5] = l),
              (o[9] = u),
              (o[13] = 0),
              (o[2] = 0),
              (o[6] = 0),
              (o[10] = h),
              (o[14] = d),
              (o[3] = 0),
              (o[7] = 0),
              (o[11] = -1),
              (o[15] = 0),
              this
            );
          },
          makeOrthographic: function(e, t, n, r, i, a) {
            var o = this.elements,
              s = 1 / (t - e),
              l = 1 / (n - r),
              c = 1 / (a - i),
              u = (t + e) * s,
              h = (n + r) * l,
              d = (a + i) * c;
            return (
              (o[0] = 2 * s),
              (o[4] = 0),
              (o[8] = 0),
              (o[12] = -u),
              (o[1] = 0),
              (o[5] = 2 * l),
              (o[9] = 0),
              (o[13] = -h),
              (o[2] = 0),
              (o[6] = 0),
              (o[10] = -2 * c),
              (o[14] = -d),
              (o[3] = 0),
              (o[7] = 0),
              (o[11] = 0),
              (o[15] = 1),
              this
            );
          },
          equals: function(e) {
            for (var t = this.elements, n = e.elements, r = 0; r < 16; r++)
              if (t[r] !== n[r]) return !1;
            return !0;
          },
          fromArray: function(e, t) {
            void 0 === t && (t = 0);
            for (var n = 0; n < 16; n++) this.elements[n] = e[n + t];
            return this;
          },
          toArray: function(e, t) {
            void 0 === e && (e = []), void 0 === t && (t = 0);
            var n = this.elements;
            return (
              (e[t] = n[0]),
              (e[t + 1] = n[1]),
              (e[t + 2] = n[2]),
              (e[t + 3] = n[3]),
              (e[t + 4] = n[4]),
              (e[t + 5] = n[5]),
              (e[t + 6] = n[6]),
              (e[t + 7] = n[7]),
              (e[t + 8] = n[8]),
              (e[t + 9] = n[9]),
              (e[t + 10] = n[10]),
              (e[t + 11] = n[11]),
              (e[t + 12] = n[12]),
              (e[t + 13] = n[13]),
              (e[t + 14] = n[14]),
              (e[t + 15] = n[15]),
              e
            );
          }
        });
        var ya = new ga(),
          ba = new Ji();
        function xa(e, t, n, r) {
          (this._x = e || 0),
            (this._y = t || 0),
            (this._z = n || 0),
            (this._order = r || xa.DefaultOrder);
        }
        function wa() {
          this.mask = 1;
        }
        (xa.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"]),
          (xa.DefaultOrder = "XYZ"),
          Object.defineProperties(xa.prototype, {
            x: {
              get: function() {
                return this._x;
              },
              set: function(e) {
                (this._x = e), this._onChangeCallback();
              }
            },
            y: {
              get: function() {
                return this._y;
              },
              set: function(e) {
                (this._y = e), this._onChangeCallback();
              }
            },
            z: {
              get: function() {
                return this._z;
              },
              set: function(e) {
                (this._z = e), this._onChangeCallback();
              }
            },
            order: {
              get: function() {
                return this._order;
              },
              set: function(e) {
                (this._order = e), this._onChangeCallback();
              }
            }
          }),
          Object.assign(xa.prototype, {
            isEuler: !0,
            set: function(e, t, n, r) {
              return (
                (this._x = e),
                (this._y = t),
                (this._z = n),
                (this._order = r || this._order),
                this._onChangeCallback(),
                this
              );
            },
            clone: function() {
              return new this.constructor(
                this._x,
                this._y,
                this._z,
                this._order
              );
            },
            copy: function(e) {
              return (
                (this._x = e._x),
                (this._y = e._y),
                (this._z = e._z),
                (this._order = e._order),
                this._onChangeCallback(),
                this
              );
            },
            setFromRotationMatrix: function(e, t, n) {
              var r = Qi.clamp,
                i = e.elements,
                a = i[0],
                o = i[4],
                s = i[8],
                l = i[1],
                c = i[5],
                u = i[9],
                h = i[2],
                d = i[6],
                p = i[10];
              return (
                "XYZ" === (t = t || this._order)
                  ? ((this._y = Math.asin(r(s, -1, 1))),
                    Math.abs(s) < 0.9999999
                      ? ((this._x = Math.atan2(-u, p)),
                        (this._z = Math.atan2(-o, a)))
                      : ((this._x = Math.atan2(d, c)), (this._z = 0)))
                  : "YXZ" === t
                  ? ((this._x = Math.asin(-r(u, -1, 1))),
                    Math.abs(u) < 0.9999999
                      ? ((this._y = Math.atan2(s, p)),
                        (this._z = Math.atan2(l, c)))
                      : ((this._y = Math.atan2(-h, a)), (this._z = 0)))
                  : "ZXY" === t
                  ? ((this._x = Math.asin(r(d, -1, 1))),
                    Math.abs(d) < 0.9999999
                      ? ((this._y = Math.atan2(-h, p)),
                        (this._z = Math.atan2(-o, c)))
                      : ((this._y = 0), (this._z = Math.atan2(l, a))))
                  : "ZYX" === t
                  ? ((this._y = Math.asin(-r(h, -1, 1))),
                    Math.abs(h) < 0.9999999
                      ? ((this._x = Math.atan2(d, p)),
                        (this._z = Math.atan2(l, a)))
                      : ((this._x = 0), (this._z = Math.atan2(-o, c))))
                  : "YZX" === t
                  ? ((this._z = Math.asin(r(l, -1, 1))),
                    Math.abs(l) < 0.9999999
                      ? ((this._x = Math.atan2(-u, c)),
                        (this._y = Math.atan2(-h, a)))
                      : ((this._x = 0), (this._y = Math.atan2(s, p))))
                  : "XZY" === t &&
                    ((this._z = Math.asin(-r(o, -1, 1))),
                    Math.abs(o) < 0.9999999
                      ? ((this._x = Math.atan2(d, c)),
                        (this._y = Math.atan2(s, a)))
                      : ((this._x = Math.atan2(-u, p)), (this._y = 0))),
                (this._order = t),
                !1 !== n && this._onChangeCallback(),
                this
              );
            },
            setFromQuaternion: function(e, t, n) {
              return (
                ya.makeRotationFromQuaternion(e),
                this.setFromRotationMatrix(ya, t, n)
              );
            },
            setFromVector3: function(e, t) {
              return this.set(e.x, e.y, e.z, t || this._order);
            },
            reorder: function(e) {
              return ba.setFromEuler(this), this.setFromQuaternion(ba, e);
            },
            equals: function(e) {
              return (
                e._x === this._x &&
                e._y === this._y &&
                e._z === this._z &&
                e._order === this._order
              );
            },
            fromArray: function(e) {
              return (
                (this._x = e[0]),
                (this._y = e[1]),
                (this._z = e[2]),
                void 0 !== e[3] && (this._order = e[3]),
                this._onChangeCallback(),
                this
              );
            },
            toArray: function(e, t) {
              return (
                void 0 === e && (e = []),
                void 0 === t && (t = 0),
                (e[t] = this._x),
                (e[t + 1] = this._y),
                (e[t + 2] = this._z),
                (e[t + 3] = this._order),
                e
              );
            },
            toVector3: function(e) {
              return e
                ? e.set(this._x, this._y, this._z)
                : new ea(this._x, this._y, this._z);
            },
            _onChange: function(e) {
              return (this._onChangeCallback = e), this;
            },
            _onChangeCallback: function() {}
          }),
          Object.assign(wa.prototype, {
            set: function(e) {
              this.mask = (1 << e) | 0;
            },
            enable: function(e) {
              this.mask |= (1 << e) | 0;
            },
            enableAll: function() {
              this.mask = -1;
            },
            toggle: function(e) {
              this.mask ^= (1 << e) | 0;
            },
            disable: function(e) {
              this.mask &= ~((1 << e) | 0);
            },
            disableAll: function() {
              this.mask = 0;
            },
            test: function(e) {
              return 0 != (this.mask & e.mask);
            }
          });
        var _a = 0,
          Ma = new ea(),
          Ta = new Ji(),
          Aa = new ga(),
          Sa = new ea(),
          Ea = new ea(),
          Ra = new ea(),
          Pa = new Ji(),
          Ia = new ea(1, 0, 0),
          Da = new ea(0, 1, 0),
          Oa = new ea(0, 0, 1),
          Ca = { type: "added" },
          La = { type: "removed" };
        function Na() {
          Object.defineProperty(this, "id", { value: _a++ }),
            (this.uuid = Qi.generateUUID()),
            (this.name = ""),
            (this.type = "Object3D"),
            (this.parent = null),
            (this.children = []),
            (this.up = Na.DefaultUp.clone());
          var e = new ea(),
            t = new xa(),
            n = new Ji(),
            r = new ea(1, 1, 1);
          t._onChange(function() {
            n.setFromEuler(t, !1);
          }),
            n._onChange(function() {
              t.setFromQuaternion(n, void 0, !1);
            }),
            Object.defineProperties(this, {
              position: { configurable: !0, enumerable: !0, value: e },
              rotation: { configurable: !0, enumerable: !0, value: t },
              quaternion: { configurable: !0, enumerable: !0, value: n },
              scale: { configurable: !0, enumerable: !0, value: r },
              modelViewMatrix: { value: new ga() },
              normalMatrix: { value: new ra() }
            }),
            (this.matrix = new ga()),
            (this.matrixWorld = new ga()),
            (this.matrixAutoUpdate = Na.DefaultMatrixAutoUpdate),
            (this.matrixWorldNeedsUpdate = !1),
            (this.layers = new wa()),
            (this.visible = !0),
            (this.castShadow = !1),
            (this.receiveShadow = !1),
            (this.frustumCulled = !0),
            (this.renderOrder = 0),
            (this.userData = {});
        }
        function Fa() {
          Na.call(this),
            (this.type = "Scene"),
            (this.background = null),
            (this.fog = null),
            (this.overrideMaterial = null),
            (this.autoUpdate = !0),
            "undefined" != typeof __THREE_DEVTOOLS__ &&
              __THREE_DEVTOOLS__.dispatchEvent(
                new CustomEvent("observe", { detail: this })
              );
        }
        (Na.DefaultUp = new ea(0, 1, 0)),
          (Na.DefaultMatrixAutoUpdate = !0),
          (Na.prototype = Object.assign(Object.create(Wi.prototype), {
            constructor: Na,
            isObject3D: !0,
            onBeforeRender: function() {},
            onAfterRender: function() {},
            applyMatrix: function(e) {
              this.matrixAutoUpdate && this.updateMatrix(),
                this.matrix.premultiply(e),
                this.matrix.decompose(
                  this.position,
                  this.quaternion,
                  this.scale
                );
            },
            applyQuaternion: function(e) {
              return this.quaternion.premultiply(e), this;
            },
            setRotationFromAxisAngle: function(e, t) {
              this.quaternion.setFromAxisAngle(e, t);
            },
            setRotationFromEuler: function(e) {
              this.quaternion.setFromEuler(e, !0);
            },
            setRotationFromMatrix: function(e) {
              this.quaternion.setFromRotationMatrix(e);
            },
            setRotationFromQuaternion: function(e) {
              this.quaternion.copy(e);
            },
            rotateOnAxis: function(e, t) {
              return (
                Ta.setFromAxisAngle(e, t), this.quaternion.multiply(Ta), this
              );
            },
            rotateOnWorldAxis: function(e, t) {
              return (
                Ta.setFromAxisAngle(e, t), this.quaternion.premultiply(Ta), this
              );
            },
            rotateX: function(e) {
              return this.rotateOnAxis(Ia, e);
            },
            rotateY: function(e) {
              return this.rotateOnAxis(Da, e);
            },
            rotateZ: function(e) {
              return this.rotateOnAxis(Oa, e);
            },
            translateOnAxis: function(e, t) {
              return (
                Ma.copy(e).applyQuaternion(this.quaternion),
                this.position.add(Ma.multiplyScalar(t)),
                this
              );
            },
            translateX: function(e) {
              return this.translateOnAxis(Ia, e);
            },
            translateY: function(e) {
              return this.translateOnAxis(Da, e);
            },
            translateZ: function(e) {
              return this.translateOnAxis(Oa, e);
            },
            localToWorld: function(e) {
              return e.applyMatrix4(this.matrixWorld);
            },
            worldToLocal: function(e) {
              return e.applyMatrix4(Aa.getInverse(this.matrixWorld));
            },
            lookAt: function(e, t, n) {
              e.isVector3 ? Sa.copy(e) : Sa.set(e, t, n);
              var r = this.parent;
              this.updateWorldMatrix(!0, !1),
                Ea.setFromMatrixPosition(this.matrixWorld),
                this.isCamera || this.isLight
                  ? Aa.lookAt(Ea, Sa, this.up)
                  : Aa.lookAt(Sa, Ea, this.up),
                this.quaternion.setFromRotationMatrix(Aa),
                r &&
                  (Aa.extractRotation(r.matrixWorld),
                  Ta.setFromRotationMatrix(Aa),
                  this.quaternion.premultiply(Ta.inverse()));
            },
            add: function(e) {
              if (arguments.length > 1) {
                for (var t = 0; t < arguments.length; t++)
                  this.add(arguments[t]);
                return this;
              }
              return e === this
                ? this
                : (e &&
                    e.isObject3D &&
                    (null !== e.parent && e.parent.remove(e),
                    (e.parent = this),
                    this.children.push(e),
                    e.dispatchEvent(Ca)),
                  this);
            },
            remove: function(e) {
              if (arguments.length > 1) {
                for (var t = 0; t < arguments.length; t++)
                  this.remove(arguments[t]);
                return this;
              }
              var n = this.children.indexOf(e);
              return (
                -1 !== n &&
                  ((e.parent = null),
                  this.children.splice(n, 1),
                  e.dispatchEvent(La)),
                this
              );
            },
            attach: function(e) {
              return (
                this.updateWorldMatrix(!0, !1),
                Aa.getInverse(this.matrixWorld),
                null !== e.parent &&
                  (e.parent.updateWorldMatrix(!0, !1),
                  Aa.multiply(e.parent.matrixWorld)),
                e.applyMatrix(Aa),
                e.updateWorldMatrix(!1, !1),
                this.add(e),
                this
              );
            },
            getObjectById: function(e) {
              return this.getObjectByProperty("id", e);
            },
            getObjectByName: function(e) {
              return this.getObjectByProperty("name", e);
            },
            getObjectByProperty: function(e, t) {
              if (this[e] === t) return this;
              for (var n = 0, r = this.children.length; n < r; n++) {
                var i = this.children[n].getObjectByProperty(e, t);
                if (void 0 !== i) return i;
              }
            },
            getWorldPosition: function(e) {
              return (
                void 0 === e && (e = new ea()),
                this.updateMatrixWorld(!0),
                e.setFromMatrixPosition(this.matrixWorld)
              );
            },
            getWorldQuaternion: function(e) {
              return (
                void 0 === e && (e = new Ji()),
                this.updateMatrixWorld(!0),
                this.matrixWorld.decompose(Ea, e, Ra),
                e
              );
            },
            getWorldScale: function(e) {
              return (
                void 0 === e && (e = new ea()),
                this.updateMatrixWorld(!0),
                this.matrixWorld.decompose(Ea, Pa, e),
                e
              );
            },
            getWorldDirection: function(e) {
              void 0 === e && (e = new ea()), this.updateMatrixWorld(!0);
              var t = this.matrixWorld.elements;
              return e.set(t[8], t[9], t[10]).normalize();
            },
            raycast: function() {},
            traverse: function(e) {
              e(this);
              for (var t = this.children, n = 0, r = t.length; n < r; n++)
                t[n].traverse(e);
            },
            traverseVisible: function(e) {
              if (!1 !== this.visible) {
                e(this);
                for (var t = this.children, n = 0, r = t.length; n < r; n++)
                  t[n].traverseVisible(e);
              }
            },
            traverseAncestors: function(e) {
              var t = this.parent;
              null !== t && (e(t), t.traverseAncestors(e));
            },
            updateMatrix: function() {
              this.matrix.compose(this.position, this.quaternion, this.scale),
                (this.matrixWorldNeedsUpdate = !0);
            },
            updateMatrixWorld: function(e) {
              this.matrixAutoUpdate && this.updateMatrix(),
                (this.matrixWorldNeedsUpdate || e) &&
                  (null === this.parent
                    ? this.matrixWorld.copy(this.matrix)
                    : this.matrixWorld.multiplyMatrices(
                        this.parent.matrixWorld,
                        this.matrix
                      ),
                  (this.matrixWorldNeedsUpdate = !1),
                  (e = !0));
              for (var t = this.children, n = 0, r = t.length; n < r; n++)
                t[n].updateMatrixWorld(e);
            },
            updateWorldMatrix: function(e, t) {
              var n = this.parent;
              if (
                (!0 === e && null !== n && n.updateWorldMatrix(!0, !1),
                this.matrixAutoUpdate && this.updateMatrix(),
                null === this.parent
                  ? this.matrixWorld.copy(this.matrix)
                  : this.matrixWorld.multiplyMatrices(
                      this.parent.matrixWorld,
                      this.matrix
                    ),
                !0 === t)
              )
                for (var r = this.children, i = 0, a = r.length; i < a; i++)
                  r[i].updateWorldMatrix(!1, !0);
            },
            toJSON: function(e) {
              var t = void 0 === e || "string" == typeof e,
                n = {};
              t &&
                ((e = {
                  geometries: {},
                  materials: {},
                  textures: {},
                  images: {},
                  shapes: {}
                }),
                (n.metadata = {
                  version: 4.5,
                  type: "Object",
                  generator: "Object3D.toJSON"
                }));
              var r = {};
              function i(t, n) {
                return (
                  void 0 === t[n.uuid] && (t[n.uuid] = n.toJSON(e)), n.uuid
                );
              }
              if (
                ((r.uuid = this.uuid),
                (r.type = this.type),
                "" !== this.name && (r.name = this.name),
                !0 === this.castShadow && (r.castShadow = !0),
                !0 === this.receiveShadow && (r.receiveShadow = !0),
                !1 === this.visible && (r.visible = !1),
                !1 === this.frustumCulled && (r.frustumCulled = !1),
                0 !== this.renderOrder && (r.renderOrder = this.renderOrder),
                "{}" !== JSON.stringify(this.userData) &&
                  (r.userData = this.userData),
                (r.layers = this.layers.mask),
                (r.matrix = this.matrix.toArray()),
                !1 === this.matrixAutoUpdate && (r.matrixAutoUpdate = !1),
                this.isMesh &&
                  this.drawMode !== oi &&
                  (r.drawMode = this.drawMode),
                this.isInstancedMesh &&
                  ((r.type = "InstancedMesh"),
                  (r.count = this.count),
                  (r.instanceMatrix = this.instanceMatrix.toJSON())),
                this.isMesh || this.isLine || this.isPoints)
              ) {
                r.geometry = i(e.geometries, this.geometry);
                var a = this.geometry.parameters;
                if (void 0 !== a && void 0 !== a.shapes) {
                  var o = a.shapes;
                  if (Array.isArray(o))
                    for (var s = 0, l = o.length; s < l; s++) {
                      var c = o[s];
                      i(e.shapes, c);
                    }
                  else i(e.shapes, o);
                }
              }
              if (void 0 !== this.material)
                if (Array.isArray(this.material)) {
                  var u = [];
                  for (s = 0, l = this.material.length; s < l; s++)
                    u.push(i(e.materials, this.material[s]));
                  r.material = u;
                } else r.material = i(e.materials, this.material);
              if (this.children.length > 0)
                for (r.children = [], s = 0; s < this.children.length; s++)
                  r.children.push(this.children[s].toJSON(e).object);
              if (t) {
                var h = m(e.geometries),
                  d = m(e.materials),
                  p = m(e.textures),
                  f = m(e.images);
                (o = m(e.shapes)),
                  h.length > 0 && (n.geometries = h),
                  d.length > 0 && (n.materials = d),
                  p.length > 0 && (n.textures = p),
                  f.length > 0 && (n.images = f),
                  o.length > 0 && (n.shapes = o);
              }
              return (n.object = r), n;
              function m(e) {
                var t = [];
                for (var n in e) {
                  var r = e[n];
                  delete r.metadata, t.push(r);
                }
                return t;
              }
            },
            clone: function(e) {
              return new this.constructor().copy(this, e);
            },
            copy: function(e, t) {
              if (
                (void 0 === t && (t = !0),
                (this.name = e.name),
                this.up.copy(e.up),
                this.position.copy(e.position),
                this.quaternion.copy(e.quaternion),
                this.scale.copy(e.scale),
                this.matrix.copy(e.matrix),
                this.matrixWorld.copy(e.matrixWorld),
                (this.matrixAutoUpdate = e.matrixAutoUpdate),
                (this.matrixWorldNeedsUpdate = e.matrixWorldNeedsUpdate),
                (this.layers.mask = e.layers.mask),
                (this.visible = e.visible),
                (this.castShadow = e.castShadow),
                (this.receiveShadow = e.receiveShadow),
                (this.frustumCulled = e.frustumCulled),
                (this.renderOrder = e.renderOrder),
                (this.userData = JSON.parse(JSON.stringify(e.userData))),
                !0 === t)
              )
                for (var n = 0; n < e.children.length; n++) {
                  var r = e.children[n];
                  this.add(r.clone());
                }
              return this;
            }
          })),
          (Fa.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: Fa,
            isScene: !0,
            copy: function(e, t) {
              return (
                Na.prototype.copy.call(this, e, t),
                null !== e.background &&
                  (this.background = e.background.clone()),
                null !== e.fog && (this.fog = e.fog.clone()),
                null !== e.overrideMaterial &&
                  (this.overrideMaterial = e.overrideMaterial.clone()),
                (this.autoUpdate = e.autoUpdate),
                (this.matrixAutoUpdate = e.matrixAutoUpdate),
                this
              );
            },
            toJSON: function(e) {
              var t = Na.prototype.toJSON.call(this, e);
              return (
                null !== this.background &&
                  (t.object.background = this.background.toJSON(e)),
                null !== this.fog && (t.object.fog = this.fog.toJSON()),
                t
              );
            },
            dispose: function() {
              this.dispatchEvent({ type: "dispose" });
            }
          }));
        var ka = [
            new ea(),
            new ea(),
            new ea(),
            new ea(),
            new ea(),
            new ea(),
            new ea(),
            new ea()
          ],
          Ua = new ea(),
          ja = new Za(),
          Ba = new ea(),
          za = new ea(),
          Va = new ea(),
          Ga = new ea(),
          Ha = new ea(),
          Xa = new ea(),
          Wa = new ea(),
          Ya = new ea(),
          qa = new ea(),
          Qa = new ea();
        function Za(e, t) {
          (this.min = void 0 !== e ? e : new ea(1 / 0, 1 / 0, 1 / 0)),
            (this.max = void 0 !== t ? t : new ea(-1 / 0, -1 / 0, -1 / 0));
        }
        function Ja(e, t, n, r, i) {
          var a, o;
          for (a = 0, o = e.length - 3; a <= o; a += 3) {
            Qa.fromArray(e, a);
            var s =
                i.x * Math.abs(Qa.x) +
                i.y * Math.abs(Qa.y) +
                i.z * Math.abs(Qa.z),
              l = t.dot(Qa),
              c = n.dot(Qa),
              u = r.dot(Qa);
            if (Math.max(-Math.max(l, c, u), Math.min(l, c, u)) > s) return !1;
          }
          return !0;
        }
        Object.assign(Za.prototype, {
          isBox3: !0,
          set: function(e, t) {
            return this.min.copy(e), this.max.copy(t), this;
          },
          setFromArray: function(e) {
            for (
              var t = 1 / 0,
                n = 1 / 0,
                r = 1 / 0,
                i = -1 / 0,
                a = -1 / 0,
                o = -1 / 0,
                s = 0,
                l = e.length;
              s < l;
              s += 3
            ) {
              var c = e[s],
                u = e[s + 1],
                h = e[s + 2];
              c < t && (t = c),
                u < n && (n = u),
                h < r && (r = h),
                c > i && (i = c),
                u > a && (a = u),
                h > o && (o = h);
            }
            return this.min.set(t, n, r), this.max.set(i, a, o), this;
          },
          setFromBufferAttribute: function(e) {
            for (
              var t = 1 / 0,
                n = 1 / 0,
                r = 1 / 0,
                i = -1 / 0,
                a = -1 / 0,
                o = -1 / 0,
                s = 0,
                l = e.count;
              s < l;
              s++
            ) {
              var c = e.getX(s),
                u = e.getY(s),
                h = e.getZ(s);
              c < t && (t = c),
                u < n && (n = u),
                h < r && (r = h),
                c > i && (i = c),
                u > a && (a = u),
                h > o && (o = h);
            }
            return this.min.set(t, n, r), this.max.set(i, a, o), this;
          },
          setFromPoints: function(e) {
            this.makeEmpty();
            for (var t = 0, n = e.length; t < n; t++) this.expandByPoint(e[t]);
            return this;
          },
          setFromCenterAndSize: function(e, t) {
            var n = Ua.copy(t).multiplyScalar(0.5);
            return this.min.copy(e).sub(n), this.max.copy(e).add(n), this;
          },
          setFromObject: function(e) {
            return this.makeEmpty(), this.expandByObject(e);
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return this.min.copy(e.min), this.max.copy(e.max), this;
          },
          makeEmpty: function() {
            return (
              (this.min.x = this.min.y = this.min.z = 1 / 0),
              (this.max.x = this.max.y = this.max.z = -1 / 0),
              this
            );
          },
          isEmpty: function() {
            return (
              this.max.x < this.min.x ||
              this.max.y < this.min.y ||
              this.max.z < this.min.z
            );
          },
          getCenter: function(e) {
            return (
              void 0 === e && (e = new ea()),
              this.isEmpty()
                ? e.set(0, 0, 0)
                : e.addVectors(this.min, this.max).multiplyScalar(0.5)
            );
          },
          getSize: function(e) {
            return (
              void 0 === e && (e = new ea()),
              this.isEmpty() ? e.set(0, 0, 0) : e.subVectors(this.max, this.min)
            );
          },
          expandByPoint: function(e) {
            return this.min.min(e), this.max.max(e), this;
          },
          expandByVector: function(e) {
            return this.min.sub(e), this.max.add(e), this;
          },
          expandByScalar: function(e) {
            return this.min.addScalar(-e), this.max.addScalar(e), this;
          },
          expandByObject: function(e) {
            e.updateWorldMatrix(!1, !1);
            var t = e.geometry;
            void 0 !== t &&
              (null === t.boundingBox && t.computeBoundingBox(),
              ja.copy(t.boundingBox),
              ja.applyMatrix4(e.matrixWorld),
              this.expandByPoint(ja.min),
              this.expandByPoint(ja.max));
            for (var n = e.children, r = 0, i = n.length; r < i; r++)
              this.expandByObject(n[r]);
            return this;
          },
          containsPoint: function(e) {
            return !(
              e.x < this.min.x ||
              e.x > this.max.x ||
              e.y < this.min.y ||
              e.y > this.max.y ||
              e.z < this.min.z ||
              e.z > this.max.z
            );
          },
          containsBox: function(e) {
            return (
              this.min.x <= e.min.x &&
              e.max.x <= this.max.x &&
              this.min.y <= e.min.y &&
              e.max.y <= this.max.y &&
              this.min.z <= e.min.z &&
              e.max.z <= this.max.z
            );
          },
          getParameter: function(e, t) {
            return (
              void 0 === t && (t = new ea()),
              t.set(
                (e.x - this.min.x) / (this.max.x - this.min.x),
                (e.y - this.min.y) / (this.max.y - this.min.y),
                (e.z - this.min.z) / (this.max.z - this.min.z)
              )
            );
          },
          intersectsBox: function(e) {
            return !(
              e.max.x < this.min.x ||
              e.min.x > this.max.x ||
              e.max.y < this.min.y ||
              e.min.y > this.max.y ||
              e.max.z < this.min.z ||
              e.min.z > this.max.z
            );
          },
          intersectsSphere: function(e) {
            return (
              this.clampPoint(e.center, Ua),
              Ua.distanceToSquared(e.center) <= e.radius * e.radius
            );
          },
          intersectsPlane: function(e) {
            var t, n;
            return (
              e.normal.x > 0
                ? ((t = e.normal.x * this.min.x), (n = e.normal.x * this.max.x))
                : ((t = e.normal.x * this.max.x),
                  (n = e.normal.x * this.min.x)),
              e.normal.y > 0
                ? ((t += e.normal.y * this.min.y),
                  (n += e.normal.y * this.max.y))
                : ((t += e.normal.y * this.max.y),
                  (n += e.normal.y * this.min.y)),
              e.normal.z > 0
                ? ((t += e.normal.z * this.min.z),
                  (n += e.normal.z * this.max.z))
                : ((t += e.normal.z * this.max.z),
                  (n += e.normal.z * this.min.z)),
              t <= -e.constant && n >= -e.constant
            );
          },
          intersectsTriangle: function(e) {
            if (this.isEmpty()) return !1;
            this.getCenter(Wa),
              Ya.subVectors(this.max, Wa),
              Ba.subVectors(e.a, Wa),
              za.subVectors(e.b, Wa),
              Va.subVectors(e.c, Wa),
              Ga.subVectors(za, Ba),
              Ha.subVectors(Va, za),
              Xa.subVectors(Ba, Va);
            var t = [
              0,
              -Ga.z,
              Ga.y,
              0,
              -Ha.z,
              Ha.y,
              0,
              -Xa.z,
              Xa.y,
              Ga.z,
              0,
              -Ga.x,
              Ha.z,
              0,
              -Ha.x,
              Xa.z,
              0,
              -Xa.x,
              -Ga.y,
              Ga.x,
              0,
              -Ha.y,
              Ha.x,
              0,
              -Xa.y,
              Xa.x,
              0
            ];
            return (
              !!Ja(t, Ba, za, Va, Ya) &&
              !!Ja((t = [1, 0, 0, 0, 1, 0, 0, 0, 1]), Ba, za, Va, Ya) &&
              (qa.crossVectors(Ga, Ha),
              Ja((t = [qa.x, qa.y, qa.z]), Ba, za, Va, Ya))
            );
          },
          clampPoint: function(e, t) {
            return (
              void 0 === t && (t = new ea()),
              t.copy(e).clamp(this.min, this.max)
            );
          },
          distanceToPoint: function(e) {
            return Ua.copy(e)
              .clamp(this.min, this.max)
              .sub(e)
              .length();
          },
          getBoundingSphere: function(e) {
            return (
              this.getCenter(e.center),
              (e.radius = 0.5 * this.getSize(Ua).length()),
              e
            );
          },
          intersect: function(e) {
            return (
              this.min.max(e.min),
              this.max.min(e.max),
              this.isEmpty() && this.makeEmpty(),
              this
            );
          },
          union: function(e) {
            return this.min.min(e.min), this.max.max(e.max), this;
          },
          applyMatrix4: function(e) {
            return this.isEmpty()
              ? this
              : (ka[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(e),
                ka[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(e),
                ka[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(e),
                ka[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(e),
                ka[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(e),
                ka[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(e),
                ka[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(e),
                ka[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(e),
                this.setFromPoints(ka),
                this);
          },
          translate: function(e) {
            return this.min.add(e), this.max.add(e), this;
          },
          equals: function(e) {
            return e.min.equals(this.min) && e.max.equals(this.max);
          }
        });
        var Ka = new Za();
        function $a(e, t) {
          (this.center = void 0 !== e ? e : new ea()),
            (this.radius = void 0 !== t ? t : 0);
        }
        Object.assign($a.prototype, {
          set: function(e, t) {
            return this.center.copy(e), (this.radius = t), this;
          },
          setFromPoints: function(e, t) {
            var n = this.center;
            void 0 !== t ? n.copy(t) : Ka.setFromPoints(e).getCenter(n);
            for (var r = 0, i = 0, a = e.length; i < a; i++)
              r = Math.max(r, n.distanceToSquared(e[i]));
            return (this.radius = Math.sqrt(r)), this;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return this.center.copy(e.center), (this.radius = e.radius), this;
          },
          empty: function() {
            return this.radius <= 0;
          },
          containsPoint: function(e) {
            return (
              e.distanceToSquared(this.center) <= this.radius * this.radius
            );
          },
          distanceToPoint: function(e) {
            return e.distanceTo(this.center) - this.radius;
          },
          intersectsSphere: function(e) {
            var t = this.radius + e.radius;
            return e.center.distanceToSquared(this.center) <= t * t;
          },
          intersectsBox: function(e) {
            return e.intersectsSphere(this);
          },
          intersectsPlane: function(e) {
            return Math.abs(e.distanceToPoint(this.center)) <= this.radius;
          },
          clampPoint: function(e, t) {
            var n = this.center.distanceToSquared(e);
            return (
              void 0 === t && (t = new ea()),
              t.copy(e),
              n > this.radius * this.radius &&
                (t.sub(this.center).normalize(),
                t.multiplyScalar(this.radius).add(this.center)),
              t
            );
          },
          getBoundingBox: function(e) {
            return (
              void 0 === e && (e = new Za()),
              e.set(this.center, this.center),
              e.expandByScalar(this.radius),
              e
            );
          },
          applyMatrix4: function(e) {
            return (
              this.center.applyMatrix4(e),
              (this.radius = this.radius * e.getMaxScaleOnAxis()),
              this
            );
          },
          translate: function(e) {
            return this.center.add(e), this;
          },
          equals: function(e) {
            return e.center.equals(this.center) && e.radius === this.radius;
          }
        });
        var eo = new ea(),
          to = new ea(),
          no = new ea(),
          ro = new ea(),
          io = new ea(),
          ao = new ea(),
          oo = new ea();
        function so(e, t) {
          (this.origin = void 0 !== e ? e : new ea()),
            (this.direction = void 0 !== t ? t : new ea(0, 0, -1));
        }
        Object.assign(so.prototype, {
          set: function(e, t) {
            return this.origin.copy(e), this.direction.copy(t), this;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return (
              this.origin.copy(e.origin), this.direction.copy(e.direction), this
            );
          },
          at: function(e, t) {
            return (
              void 0 === t && (t = new ea()),
              t
                .copy(this.direction)
                .multiplyScalar(e)
                .add(this.origin)
            );
          },
          lookAt: function(e) {
            return (
              this.direction
                .copy(e)
                .sub(this.origin)
                .normalize(),
              this
            );
          },
          recast: function(e) {
            return this.origin.copy(this.at(e, eo)), this;
          },
          closestPointToPoint: function(e, t) {
            void 0 === t && (t = new ea()), t.subVectors(e, this.origin);
            var n = t.dot(this.direction);
            return n < 0
              ? t.copy(this.origin)
              : t
                  .copy(this.direction)
                  .multiplyScalar(n)
                  .add(this.origin);
          },
          distanceToPoint: function(e) {
            return Math.sqrt(this.distanceSqToPoint(e));
          },
          distanceSqToPoint: function(e) {
            var t = eo.subVectors(e, this.origin).dot(this.direction);
            return t < 0
              ? this.origin.distanceToSquared(e)
              : (eo
                  .copy(this.direction)
                  .multiplyScalar(t)
                  .add(this.origin),
                eo.distanceToSquared(e));
          },
          distanceSqToSegment: function(e, t, n, r) {
            to
              .copy(e)
              .add(t)
              .multiplyScalar(0.5),
              no
                .copy(t)
                .sub(e)
                .normalize(),
              ro.copy(this.origin).sub(to);
            var i,
              a,
              o,
              s,
              l = 0.5 * e.distanceTo(t),
              c = -this.direction.dot(no),
              u = ro.dot(this.direction),
              h = -ro.dot(no),
              d = ro.lengthSq(),
              p = Math.abs(1 - c * c);
            if (p > 0)
              if (((a = c * u - h), (s = l * p), (i = c * h - u) >= 0))
                if (a >= -s)
                  if (a <= s) {
                    var f = 1 / p;
                    o =
                      (i *= f) * (i + c * (a *= f) + 2 * u) +
                      a * (c * i + a + 2 * h) +
                      d;
                  } else
                    (a = l),
                      (o =
                        -(i = Math.max(0, -(c * a + u))) * i +
                        a * (a + 2 * h) +
                        d);
                else
                  (a = -l),
                    (o =
                      -(i = Math.max(0, -(c * a + u))) * i +
                      a * (a + 2 * h) +
                      d);
              else
                a <= -s
                  ? (o =
                      -(i = Math.max(0, -(-c * l + u))) * i +
                      (a = i > 0 ? -l : Math.min(Math.max(-l, -h), l)) *
                        (a + 2 * h) +
                      d)
                  : a <= s
                  ? ((i = 0),
                    (o = (a = Math.min(Math.max(-l, -h), l)) * (a + 2 * h) + d))
                  : (o =
                      -(i = Math.max(0, -(c * l + u))) * i +
                      (a = i > 0 ? l : Math.min(Math.max(-l, -h), l)) *
                        (a + 2 * h) +
                      d);
            else
              (a = c > 0 ? -l : l),
                (o =
                  -(i = Math.max(0, -(c * a + u))) * i + a * (a + 2 * h) + d);
            return (
              n &&
                n
                  .copy(this.direction)
                  .multiplyScalar(i)
                  .add(this.origin),
              r &&
                r
                  .copy(no)
                  .multiplyScalar(a)
                  .add(to),
              o
            );
          },
          intersectSphere: function(e, t) {
            eo.subVectors(e.center, this.origin);
            var n = eo.dot(this.direction),
              r = eo.dot(eo) - n * n,
              i = e.radius * e.radius;
            if (r > i) return null;
            var a = Math.sqrt(i - r),
              o = n - a,
              s = n + a;
            return o < 0 && s < 0
              ? null
              : o < 0
              ? this.at(s, t)
              : this.at(o, t);
          },
          intersectsSphere: function(e) {
            return this.distanceSqToPoint(e.center) <= e.radius * e.radius;
          },
          distanceToPlane: function(e) {
            var t = e.normal.dot(this.direction);
            if (0 === t) return 0 === e.distanceToPoint(this.origin) ? 0 : null;
            var n = -(this.origin.dot(e.normal) + e.constant) / t;
            return n >= 0 ? n : null;
          },
          intersectPlane: function(e, t) {
            var n = this.distanceToPlane(e);
            return null === n ? null : this.at(n, t);
          },
          intersectsPlane: function(e) {
            var t = e.distanceToPoint(this.origin);
            return 0 === t || e.normal.dot(this.direction) * t < 0;
          },
          intersectBox: function(e, t) {
            var n,
              r,
              i,
              a,
              o,
              s,
              l = 1 / this.direction.x,
              c = 1 / this.direction.y,
              u = 1 / this.direction.z,
              h = this.origin;
            return (
              l >= 0
                ? ((n = (e.min.x - h.x) * l), (r = (e.max.x - h.x) * l))
                : ((n = (e.max.x - h.x) * l), (r = (e.min.x - h.x) * l)),
              c >= 0
                ? ((i = (e.min.y - h.y) * c), (a = (e.max.y - h.y) * c))
                : ((i = (e.max.y - h.y) * c), (a = (e.min.y - h.y) * c)),
              n > a || i > r
                ? null
                : ((i > n || n != n) && (n = i),
                  (a < r || r != r) && (r = a),
                  u >= 0
                    ? ((o = (e.min.z - h.z) * u), (s = (e.max.z - h.z) * u))
                    : ((o = (e.max.z - h.z) * u), (s = (e.min.z - h.z) * u)),
                  n > s || o > r
                    ? null
                    : ((o > n || n != n) && (n = o),
                      (s < r || r != r) && (r = s),
                      r < 0 ? null : this.at(n >= 0 ? n : r, t)))
            );
          },
          intersectsBox: function(e) {
            return null !== this.intersectBox(e, eo);
          },
          intersectTriangle: function(e, t, n, r, i) {
            io.subVectors(t, e), ao.subVectors(n, e), oo.crossVectors(io, ao);
            var a,
              o = this.direction.dot(oo);
            if (o > 0) {
              if (r) return null;
              a = 1;
            } else {
              if (!(o < 0)) return null;
              (a = -1), (o = -o);
            }
            ro.subVectors(this.origin, e);
            var s = a * this.direction.dot(ao.crossVectors(ro, ao));
            if (s < 0) return null;
            var l = a * this.direction.dot(io.cross(ro));
            if (l < 0) return null;
            if (s + l > o) return null;
            var c = -a * ro.dot(oo);
            return c < 0 ? null : this.at(c / o, i);
          },
          applyMatrix4: function(e) {
            return (
              this.origin.applyMatrix4(e),
              this.direction.transformDirection(e),
              this
            );
          },
          equals: function(e) {
            return (
              e.origin.equals(this.origin) && e.direction.equals(this.direction)
            );
          }
        });
        var lo = new ea(),
          co = new ea(),
          uo = new ra();
        function ho(e, t) {
          (this.normal = void 0 !== e ? e : new ea(1, 0, 0)),
            (this.constant = void 0 !== t ? t : 0);
        }
        Object.assign(ho.prototype, {
          isPlane: !0,
          set: function(e, t) {
            return this.normal.copy(e), (this.constant = t), this;
          },
          setComponents: function(e, t, n, r) {
            return this.normal.set(e, t, n), (this.constant = r), this;
          },
          setFromNormalAndCoplanarPoint: function(e, t) {
            return (
              this.normal.copy(e), (this.constant = -t.dot(this.normal)), this
            );
          },
          setFromCoplanarPoints: function(e, t, n) {
            var r = lo
              .subVectors(n, t)
              .cross(co.subVectors(e, t))
              .normalize();
            return this.setFromNormalAndCoplanarPoint(r, e), this;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return (
              this.normal.copy(e.normal), (this.constant = e.constant), this
            );
          },
          normalize: function() {
            var e = 1 / this.normal.length();
            return this.normal.multiplyScalar(e), (this.constant *= e), this;
          },
          negate: function() {
            return (this.constant *= -1), this.normal.negate(), this;
          },
          distanceToPoint: function(e) {
            return this.normal.dot(e) + this.constant;
          },
          distanceToSphere: function(e) {
            return this.distanceToPoint(e.center) - e.radius;
          },
          projectPoint: function(e, t) {
            return (
              void 0 === t && (t = new ea()),
              t
                .copy(this.normal)
                .multiplyScalar(-this.distanceToPoint(e))
                .add(e)
            );
          },
          intersectLine: function(e, t) {
            void 0 === t && (t = new ea());
            var n = e.delta(lo),
              r = this.normal.dot(n);
            if (0 === r)
              return 0 === this.distanceToPoint(e.start)
                ? t.copy(e.start)
                : void 0;
            var i = -(e.start.dot(this.normal) + this.constant) / r;
            return i < 0 || i > 1
              ? void 0
              : t
                  .copy(n)
                  .multiplyScalar(i)
                  .add(e.start);
          },
          intersectsLine: function(e) {
            var t = this.distanceToPoint(e.start),
              n = this.distanceToPoint(e.end);
            return (t < 0 && n > 0) || (n < 0 && t > 0);
          },
          intersectsBox: function(e) {
            return e.intersectsPlane(this);
          },
          intersectsSphere: function(e) {
            return e.intersectsPlane(this);
          },
          coplanarPoint: function(e) {
            return (
              void 0 === e && (e = new ea()),
              e.copy(this.normal).multiplyScalar(-this.constant)
            );
          },
          applyMatrix4: function(e, t) {
            var n = t || uo.getNormalMatrix(e),
              r = this.coplanarPoint(lo).applyMatrix4(e),
              i = this.normal.applyMatrix3(n).normalize();
            return (this.constant = -r.dot(i)), this;
          },
          translate: function(e) {
            return (this.constant -= e.dot(this.normal)), this;
          },
          equals: function(e) {
            return e.normal.equals(this.normal) && e.constant === this.constant;
          }
        });
        var po = new ea(),
          fo = new ea(),
          mo = new ea(),
          vo = new ea(),
          go = new ea(),
          yo = new ea(),
          bo = new ea(),
          xo = new ea(),
          wo = new ea(),
          _o = new ea();
        function Mo(e, t, n) {
          (this.a = void 0 !== e ? e : new ea()),
            (this.b = void 0 !== t ? t : new ea()),
            (this.c = void 0 !== n ? n : new ea());
        }
        Object.assign(Mo, {
          getNormal: function(e, t, n, r) {
            void 0 === r && (r = new ea()),
              r.subVectors(n, t),
              po.subVectors(e, t),
              r.cross(po);
            var i = r.lengthSq();
            return i > 0 ? r.multiplyScalar(1 / Math.sqrt(i)) : r.set(0, 0, 0);
          },
          getBarycoord: function(e, t, n, r, i) {
            po.subVectors(r, t), fo.subVectors(n, t), mo.subVectors(e, t);
            var a = po.dot(po),
              o = po.dot(fo),
              s = po.dot(mo),
              l = fo.dot(fo),
              c = fo.dot(mo),
              u = a * l - o * o;
            if ((void 0 === i && (i = new ea()), 0 === u))
              return i.set(-2, -1, -1);
            var h = 1 / u,
              d = (l * s - o * c) * h,
              p = (a * c - o * s) * h;
            return i.set(1 - d - p, p, d);
          },
          containsPoint: function(e, t, n, r) {
            return (
              Mo.getBarycoord(e, t, n, r, vo),
              vo.x >= 0 && vo.y >= 0 && vo.x + vo.y <= 1
            );
          },
          getUV: function(e, t, n, r, i, a, o, s) {
            return (
              this.getBarycoord(e, t, n, r, vo),
              s.set(0, 0),
              s.addScaledVector(i, vo.x),
              s.addScaledVector(a, vo.y),
              s.addScaledVector(o, vo.z),
              s
            );
          },
          isFrontFacing: function(e, t, n, r) {
            return (
              po.subVectors(n, t), fo.subVectors(e, t), po.cross(fo).dot(r) < 0
            );
          }
        }),
          Object.assign(Mo.prototype, {
            set: function(e, t, n) {
              return this.a.copy(e), this.b.copy(t), this.c.copy(n), this;
            },
            setFromPointsAndIndices: function(e, t, n, r) {
              return (
                this.a.copy(e[t]), this.b.copy(e[n]), this.c.copy(e[r]), this
              );
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return this.a.copy(e.a), this.b.copy(e.b), this.c.copy(e.c), this;
            },
            getArea: function() {
              return (
                po.subVectors(this.c, this.b),
                fo.subVectors(this.a, this.b),
                0.5 * po.cross(fo).length()
              );
            },
            getMidpoint: function(e) {
              return (
                void 0 === e && (e = new ea()),
                e
                  .addVectors(this.a, this.b)
                  .add(this.c)
                  .multiplyScalar(1 / 3)
              );
            },
            getNormal: function(e) {
              return Mo.getNormal(this.a, this.b, this.c, e);
            },
            getPlane: function(e) {
              return (
                void 0 === e && (e = new ho()),
                e.setFromCoplanarPoints(this.a, this.b, this.c)
              );
            },
            getBarycoord: function(e, t) {
              return Mo.getBarycoord(e, this.a, this.b, this.c, t);
            },
            getUV: function(e, t, n, r, i) {
              return Mo.getUV(e, this.a, this.b, this.c, t, n, r, i);
            },
            containsPoint: function(e) {
              return Mo.containsPoint(e, this.a, this.b, this.c);
            },
            isFrontFacing: function(e) {
              return Mo.isFrontFacing(this.a, this.b, this.c, e);
            },
            intersectsBox: function(e) {
              return e.intersectsTriangle(this);
            },
            closestPointToPoint: function(e, t) {
              void 0 === t && (t = new ea());
              var n,
                r,
                i = this.a,
                a = this.b,
                o = this.c;
              go.subVectors(a, i), yo.subVectors(o, i), xo.subVectors(e, i);
              var s = go.dot(xo),
                l = yo.dot(xo);
              if (s <= 0 && l <= 0) return t.copy(i);
              wo.subVectors(e, a);
              var c = go.dot(wo),
                u = yo.dot(wo);
              if (c >= 0 && u <= c) return t.copy(a);
              var h = s * u - c * l;
              if (h <= 0 && s >= 0 && c <= 0)
                return (n = s / (s - c)), t.copy(i).addScaledVector(go, n);
              _o.subVectors(e, o);
              var d = go.dot(_o),
                p = yo.dot(_o);
              if (p >= 0 && d <= p) return t.copy(o);
              var f = d * l - s * p;
              if (f <= 0 && l >= 0 && p <= 0)
                return (r = l / (l - p)), t.copy(i).addScaledVector(yo, r);
              var m = c * p - d * u;
              if (m <= 0 && u - c >= 0 && d - p >= 0)
                return (
                  bo.subVectors(o, a),
                  (r = (u - c) / (u - c + (d - p))),
                  t.copy(a).addScaledVector(bo, r)
                );
              var v = 1 / (m + f + h);
              return (
                (n = f * v),
                (r = h * v),
                t
                  .copy(i)
                  .addScaledVector(go, n)
                  .addScaledVector(yo, r)
              );
            },
            equals: function(e) {
              return (
                e.a.equals(this.a) && e.b.equals(this.b) && e.c.equals(this.c)
              );
            }
          });
        var To = {
            aliceblue: 15792383,
            antiquewhite: 16444375,
            aqua: 65535,
            aquamarine: 8388564,
            azure: 15794175,
            beige: 16119260,
            bisque: 16770244,
            black: 0,
            blanchedalmond: 16772045,
            blue: 255,
            blueviolet: 9055202,
            brown: 10824234,
            burlywood: 14596231,
            cadetblue: 6266528,
            chartreuse: 8388352,
            chocolate: 13789470,
            coral: 16744272,
            cornflowerblue: 6591981,
            cornsilk: 16775388,
            crimson: 14423100,
            cyan: 65535,
            darkblue: 139,
            darkcyan: 35723,
            darkgoldenrod: 12092939,
            darkgray: 11119017,
            darkgreen: 25600,
            darkgrey: 11119017,
            darkkhaki: 12433259,
            darkmagenta: 9109643,
            darkolivegreen: 5597999,
            darkorange: 16747520,
            darkorchid: 10040012,
            darkred: 9109504,
            darksalmon: 15308410,
            darkseagreen: 9419919,
            darkslateblue: 4734347,
            darkslategray: 3100495,
            darkslategrey: 3100495,
            darkturquoise: 52945,
            darkviolet: 9699539,
            deeppink: 16716947,
            deepskyblue: 49151,
            dimgray: 6908265,
            dimgrey: 6908265,
            dodgerblue: 2003199,
            firebrick: 11674146,
            floralwhite: 16775920,
            forestgreen: 2263842,
            fuchsia: 16711935,
            gainsboro: 14474460,
            ghostwhite: 16316671,
            gold: 16766720,
            goldenrod: 14329120,
            gray: 8421504,
            green: 32768,
            greenyellow: 11403055,
            grey: 8421504,
            honeydew: 15794160,
            hotpink: 16738740,
            indianred: 13458524,
            indigo: 4915330,
            ivory: 16777200,
            khaki: 15787660,
            lavender: 15132410,
            lavenderblush: 16773365,
            lawngreen: 8190976,
            lemonchiffon: 16775885,
            lightblue: 11393254,
            lightcoral: 15761536,
            lightcyan: 14745599,
            lightgoldenrodyellow: 16448210,
            lightgray: 13882323,
            lightgreen: 9498256,
            lightgrey: 13882323,
            lightpink: 16758465,
            lightsalmon: 16752762,
            lightseagreen: 2142890,
            lightskyblue: 8900346,
            lightslategray: 7833753,
            lightslategrey: 7833753,
            lightsteelblue: 11584734,
            lightyellow: 16777184,
            lime: 65280,
            limegreen: 3329330,
            linen: 16445670,
            magenta: 16711935,
            maroon: 8388608,
            mediumaquamarine: 6737322,
            mediumblue: 205,
            mediumorchid: 12211667,
            mediumpurple: 9662683,
            mediumseagreen: 3978097,
            mediumslateblue: 8087790,
            mediumspringgreen: 64154,
            mediumturquoise: 4772300,
            mediumvioletred: 13047173,
            midnightblue: 1644912,
            mintcream: 16121850,
            mistyrose: 16770273,
            moccasin: 16770229,
            navajowhite: 16768685,
            navy: 128,
            oldlace: 16643558,
            olive: 8421376,
            olivedrab: 7048739,
            orange: 16753920,
            orangered: 16729344,
            orchid: 14315734,
            palegoldenrod: 15657130,
            palegreen: 10025880,
            paleturquoise: 11529966,
            palevioletred: 14381203,
            papayawhip: 16773077,
            peachpuff: 16767673,
            peru: 13468991,
            pink: 16761035,
            plum: 14524637,
            powderblue: 11591910,
            purple: 8388736,
            rebeccapurple: 6697881,
            red: 16711680,
            rosybrown: 12357519,
            royalblue: 4286945,
            saddlebrown: 9127187,
            salmon: 16416882,
            sandybrown: 16032864,
            seagreen: 3050327,
            seashell: 16774638,
            sienna: 10506797,
            silver: 12632256,
            skyblue: 8900331,
            slateblue: 6970061,
            slategray: 7372944,
            slategrey: 7372944,
            snow: 16775930,
            springgreen: 65407,
            steelblue: 4620980,
            tan: 13808780,
            teal: 32896,
            thistle: 14204888,
            tomato: 16737095,
            turquoise: 4251856,
            violet: 15631086,
            wheat: 16113331,
            white: 16777215,
            whitesmoke: 16119285,
            yellow: 16776960,
            yellowgreen: 10145074
          },
          Ao = { h: 0, s: 0, l: 0 },
          So = { h: 0, s: 0, l: 0 };
        function Eo(e, t, n) {
          return void 0 === t && void 0 === n
            ? this.set(e)
            : this.setRGB(e, t, n);
        }
        function Ro(e, t, n) {
          return (
            n < 0 && (n += 1),
            n > 1 && (n -= 1),
            n < 1 / 6
              ? e + 6 * (t - e) * n
              : n < 0.5
              ? t
              : n < 2 / 3
              ? e + 6 * (t - e) * (2 / 3 - n)
              : e
          );
        }
        function Po(e) {
          return e < 0.04045
            ? 0.0773993808 * e
            : Math.pow(0.9478672986 * e + 0.0521327014, 2.4);
        }
        function Io(e) {
          return e < 0.0031308
            ? 12.92 * e
            : 1.055 * Math.pow(e, 0.41666) - 0.055;
        }
        function Do(e, t, n, r, i, a) {
          (this.a = e),
            (this.b = t),
            (this.c = n),
            (this.normal = r && r.isVector3 ? r : new ea()),
            (this.vertexNormals = Array.isArray(r) ? r : []),
            (this.color = i && i.isColor ? i : new Eo()),
            (this.vertexColors = Array.isArray(i) ? i : []),
            (this.materialIndex = void 0 !== a ? a : 0);
        }
        Object.assign(Eo.prototype, {
          isColor: !0,
          r: 1,
          g: 1,
          b: 1,
          set: function(e) {
            return (
              e && e.isColor
                ? this.copy(e)
                : "number" == typeof e
                ? this.setHex(e)
                : "string" == typeof e && this.setStyle(e),
              this
            );
          },
          setScalar: function(e) {
            return (this.r = e), (this.g = e), (this.b = e), this;
          },
          setHex: function(e) {
            return (
              (e = Math.floor(e)),
              (this.r = ((e >> 16) & 255) / 255),
              (this.g = ((e >> 8) & 255) / 255),
              (this.b = (255 & e) / 255),
              this
            );
          },
          setRGB: function(e, t, n) {
            return (this.r = e), (this.g = t), (this.b = n), this;
          },
          setHSL: function(e, t, n) {
            if (
              ((e = Qi.euclideanModulo(e, 1)),
              (t = Qi.clamp(t, 0, 1)),
              (n = Qi.clamp(n, 0, 1)),
              0 === t)
            )
              this.r = this.g = this.b = n;
            else {
              var r = n <= 0.5 ? n * (1 + t) : n + t - n * t,
                i = 2 * n - r;
              (this.r = Ro(i, r, e + 1 / 3)),
                (this.g = Ro(i, r, e)),
                (this.b = Ro(i, r, e - 1 / 3));
            }
            return this;
          },
          setStyle: function(e) {
            function t(e) {
              void 0 !== e && parseFloat(e);
            }
            var n;
            if ((n = /^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e))) {
              var r,
                i = n[1],
                a = n[2];
              switch (i) {
                case "rgb":
                case "rgba":
                  if (
                    (r = /^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(
                      a
                    ))
                  )
                    return (
                      (this.r = Math.min(255, parseInt(r[1], 10)) / 255),
                      (this.g = Math.min(255, parseInt(r[2], 10)) / 255),
                      (this.b = Math.min(255, parseInt(r[3], 10)) / 255),
                      t(r[5]),
                      this
                    );
                  if (
                    (r = /^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(
                      a
                    ))
                  )
                    return (
                      (this.r = Math.min(100, parseInt(r[1], 10)) / 100),
                      (this.g = Math.min(100, parseInt(r[2], 10)) / 100),
                      (this.b = Math.min(100, parseInt(r[3], 10)) / 100),
                      t(r[5]),
                      this
                    );
                  break;
                case "hsl":
                case "hsla":
                  if (
                    (r = /^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(
                      a
                    ))
                  ) {
                    var o = parseFloat(r[1]) / 360,
                      s = parseInt(r[2], 10) / 100,
                      l = parseInt(r[3], 10) / 100;
                    return t(r[5]), this.setHSL(o, s, l);
                  }
              }
            } else if ((n = /^\#([A-Fa-f0-9]+)$/.exec(e))) {
              var c = n[1],
                u = c.length;
              if (3 === u)
                return (
                  (this.r = parseInt(c.charAt(0) + c.charAt(0), 16) / 255),
                  (this.g = parseInt(c.charAt(1) + c.charAt(1), 16) / 255),
                  (this.b = parseInt(c.charAt(2) + c.charAt(2), 16) / 255),
                  this
                );
              if (6 === u)
                return (
                  (this.r = parseInt(c.charAt(0) + c.charAt(1), 16) / 255),
                  (this.g = parseInt(c.charAt(2) + c.charAt(3), 16) / 255),
                  (this.b = parseInt(c.charAt(4) + c.charAt(5), 16) / 255),
                  this
                );
            }
            return e && e.length > 0 ? this.setColorName(e) : this;
          },
          setColorName: function(e) {
            var t = To[e];
            return void 0 !== t && this.setHex(t), this;
          },
          clone: function() {
            return new this.constructor(this.r, this.g, this.b);
          },
          copy: function(e) {
            return (this.r = e.r), (this.g = e.g), (this.b = e.b), this;
          },
          copyGammaToLinear: function(e, t) {
            return (
              void 0 === t && (t = 2),
              (this.r = Math.pow(e.r, t)),
              (this.g = Math.pow(e.g, t)),
              (this.b = Math.pow(e.b, t)),
              this
            );
          },
          copyLinearToGamma: function(e, t) {
            void 0 === t && (t = 2);
            var n = t > 0 ? 1 / t : 1;
            return (
              (this.r = Math.pow(e.r, n)),
              (this.g = Math.pow(e.g, n)),
              (this.b = Math.pow(e.b, n)),
              this
            );
          },
          convertGammaToLinear: function(e) {
            return this.copyGammaToLinear(this, e), this;
          },
          convertLinearToGamma: function(e) {
            return this.copyLinearToGamma(this, e), this;
          },
          copySRGBToLinear: function(e) {
            return (
              (this.r = Po(e.r)), (this.g = Po(e.g)), (this.b = Po(e.b)), this
            );
          },
          copyLinearToSRGB: function(e) {
            return (
              (this.r = Io(e.r)), (this.g = Io(e.g)), (this.b = Io(e.b)), this
            );
          },
          convertSRGBToLinear: function() {
            return this.copySRGBToLinear(this), this;
          },
          convertLinearToSRGB: function() {
            return this.copyLinearToSRGB(this), this;
          },
          getHex: function() {
            return (
              ((255 * this.r) << 16) ^
              ((255 * this.g) << 8) ^
              ((255 * this.b) << 0)
            );
          },
          getHexString: function() {
            return ("000000" + this.getHex().toString(16)).slice(-6);
          },
          getHSL: function(e) {
            void 0 === e && (e = { h: 0, s: 0, l: 0 });
            var t,
              n,
              r = this.r,
              i = this.g,
              a = this.b,
              o = Math.max(r, i, a),
              s = Math.min(r, i, a),
              l = (s + o) / 2;
            if (s === o) (t = 0), (n = 0);
            else {
              var c = o - s;
              switch (((n = l <= 0.5 ? c / (o + s) : c / (2 - o - s)), o)) {
                case r:
                  t = (i - a) / c + (i < a ? 6 : 0);
                  break;
                case i:
                  t = (a - r) / c + 2;
                  break;
                case a:
                  t = (r - i) / c + 4;
              }
              t /= 6;
            }
            return (e.h = t), (e.s = n), (e.l = l), e;
          },
          getStyle: function() {
            return (
              "rgb(" +
              ((255 * this.r) | 0) +
              "," +
              ((255 * this.g) | 0) +
              "," +
              ((255 * this.b) | 0) +
              ")"
            );
          },
          offsetHSL: function(e, t, n) {
            return (
              this.getHSL(Ao),
              (Ao.h += e),
              (Ao.s += t),
              (Ao.l += n),
              this.setHSL(Ao.h, Ao.s, Ao.l),
              this
            );
          },
          add: function(e) {
            return (this.r += e.r), (this.g += e.g), (this.b += e.b), this;
          },
          addColors: function(e, t) {
            return (
              (this.r = e.r + t.r),
              (this.g = e.g + t.g),
              (this.b = e.b + t.b),
              this
            );
          },
          addScalar: function(e) {
            return (this.r += e), (this.g += e), (this.b += e), this;
          },
          sub: function(e) {
            return (
              (this.r = Math.max(0, this.r - e.r)),
              (this.g = Math.max(0, this.g - e.g)),
              (this.b = Math.max(0, this.b - e.b)),
              this
            );
          },
          multiply: function(e) {
            return (this.r *= e.r), (this.g *= e.g), (this.b *= e.b), this;
          },
          multiplyScalar: function(e) {
            return (this.r *= e), (this.g *= e), (this.b *= e), this;
          },
          lerp: function(e, t) {
            return (
              (this.r += (e.r - this.r) * t),
              (this.g += (e.g - this.g) * t),
              (this.b += (e.b - this.b) * t),
              this
            );
          },
          lerpHSL: function(e, t) {
            this.getHSL(Ao), e.getHSL(So);
            var n = Qi.lerp(Ao.h, So.h, t),
              r = Qi.lerp(Ao.s, So.s, t),
              i = Qi.lerp(Ao.l, So.l, t);
            return this.setHSL(n, r, i), this;
          },
          equals: function(e) {
            return e.r === this.r && e.g === this.g && e.b === this.b;
          },
          fromArray: function(e, t) {
            return (
              void 0 === t && (t = 0),
              (this.r = e[t]),
              (this.g = e[t + 1]),
              (this.b = e[t + 2]),
              this
            );
          },
          toArray: function(e, t) {
            return (
              void 0 === e && (e = []),
              void 0 === t && (t = 0),
              (e[t] = this.r),
              (e[t + 1] = this.g),
              (e[t + 2] = this.b),
              e
            );
          },
          toJSON: function() {
            return this.getHex();
          }
        }),
          (Eo.NAMES = To),
          Object.assign(Do.prototype, {
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              (this.a = e.a),
                (this.b = e.b),
                (this.c = e.c),
                this.normal.copy(e.normal),
                this.color.copy(e.color),
                (this.materialIndex = e.materialIndex);
              for (var t = 0, n = e.vertexNormals.length; t < n; t++)
                this.vertexNormals[t] = e.vertexNormals[t].clone();
              for (t = 0, n = e.vertexColors.length; t < n; t++)
                this.vertexColors[t] = e.vertexColors[t].clone();
              return this;
            }
          });
        var Oo = 0;
        function Co() {
          Object.defineProperty(this, "id", { value: Oo++ }),
            (this.uuid = Qi.generateUUID()),
            (this.name = ""),
            (this.type = "Material"),
            (this.fog = !0),
            (this.blending = tn),
            (this.side = Wt),
            (this.flatShading = !1),
            (this.vertexTangents = !1),
            (this.vertexColors = Jt),
            (this.opacity = 1),
            (this.transparent = !1),
            (this.blendSrc = vn),
            (this.blendDst = gn),
            (this.blendEquation = sn),
            (this.blendSrcAlpha = null),
            (this.blendDstAlpha = null),
            (this.blendEquationAlpha = null),
            (this.depthFunc = Sn),
            (this.depthTest = !0),
            (this.depthWrite = !0),
            (this.stencilWriteMask = 255),
            (this.stencilFunc = Fi),
            (this.stencilRef = 0),
            (this.stencilFuncMask = 255),
            (this.stencilFail = _i),
            (this.stencilZFail = _i),
            (this.stencilZPass = _i),
            (this.stencilWrite = !1),
            (this.clippingPlanes = null),
            (this.clipIntersection = !1),
            (this.clipShadows = !1),
            (this.shadowSide = null),
            (this.colorWrite = !0),
            (this.precision = null),
            (this.polygonOffset = !1),
            (this.polygonOffsetFactor = 0),
            (this.polygonOffsetUnits = 0),
            (this.dithering = !1),
            (this.alphaTest = 0),
            (this.premultipliedAlpha = !1),
            (this.visible = !0),
            (this.toneMapped = !0),
            (this.userData = {}),
            (this.version = 0);
        }
        function Lo(e) {
          Co.call(this),
            (this.type = "MeshBasicMaterial"),
            (this.color = new Eo(16777215)),
            (this.map = null),
            (this.lightMap = null),
            (this.lightMapIntensity = 1),
            (this.aoMap = null),
            (this.aoMapIntensity = 1),
            (this.specularMap = null),
            (this.alphaMap = null),
            (this.envMap = null),
            (this.combine = Dn),
            (this.reflectivity = 1),
            (this.refractionRatio = 0.98),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.wireframeLinecap = "round"),
            (this.wireframeLinejoin = "round"),
            (this.skinning = !1),
            (this.morphTargets = !1),
            this.setValues(e);
        }
        function No(e, t, n) {
          if (Array.isArray(e))
            throw new TypeError(
              "THREE.BufferAttribute: array should be a Typed Array."
            );
          (this.name = ""),
            (this.array = e),
            (this.itemSize = t),
            (this.count = void 0 !== e ? e.length / t : 0),
            (this.normalized = !0 === n),
            (this.usage = ki),
            (this.updateRange = { offset: 0, count: -1 }),
            (this.version = 0);
        }
        function Fo(e, t, n) {
          No.call(this, new Int8Array(e), t, n);
        }
        function ko(e, t, n) {
          No.call(this, new Uint8Array(e), t, n);
        }
        function Uo(e, t, n) {
          No.call(this, new Uint8ClampedArray(e), t, n);
        }
        function jo(e, t, n) {
          No.call(this, new Int16Array(e), t, n);
        }
        function Bo(e, t, n) {
          No.call(this, new Uint16Array(e), t, n);
        }
        function zo(e, t, n) {
          No.call(this, new Int32Array(e), t, n);
        }
        function Vo(e, t, n) {
          No.call(this, new Uint32Array(e), t, n);
        }
        function Go(e, t, n) {
          No.call(this, new Float32Array(e), t, n);
        }
        function Ho(e, t, n) {
          No.call(this, new Float64Array(e), t, n);
        }
        function Xo() {
          (this.vertices = []),
            (this.normals = []),
            (this.colors = []),
            (this.uvs = []),
            (this.uvs2 = []),
            (this.groups = []),
            (this.morphTargets = {}),
            (this.skinWeights = []),
            (this.skinIndices = []),
            (this.boundingBox = null),
            (this.boundingSphere = null),
            (this.verticesNeedUpdate = !1),
            (this.normalsNeedUpdate = !1),
            (this.colorsNeedUpdate = !1),
            (this.uvsNeedUpdate = !1),
            (this.groupsNeedUpdate = !1);
        }
        function Wo(e) {
          if (0 === e.length) return -1 / 0;
          for (var t = e[0], n = 1, r = e.length; n < r; ++n)
            e[n] > t && (t = e[n]);
          return t;
        }
        (Co.prototype = Object.assign(Object.create(Wi.prototype), {
          constructor: Co,
          isMaterial: !0,
          onBeforeCompile: function() {},
          setValues: function(e) {
            if (void 0 !== e)
              for (var t in e) {
                var n = e[t];
                if (void 0 !== n)
                  if ("shading" !== t) {
                    var r = this[t];
                    void 0 !== r &&
                      (r && r.isColor
                        ? r.set(n)
                        : r && r.isVector3 && n && n.isVector3
                        ? r.copy(n)
                        : (this[t] = n));
                  } else this.flatShading = n === Qt;
              }
          },
          toJSON: function(e) {
            var t = void 0 === e || "string" == typeof e;
            t && (e = { textures: {}, images: {} });
            var n = {
              metadata: {
                version: 4.5,
                type: "Material",
                generator: "Material.toJSON"
              }
            };
            function r(e) {
              var t = [];
              for (var n in e) {
                var r = e[n];
                delete r.metadata, t.push(r);
              }
              return t;
            }
            if (
              ((n.uuid = this.uuid),
              (n.type = this.type),
              "" !== this.name && (n.name = this.name),
              this.color &&
                this.color.isColor &&
                (n.color = this.color.getHex()),
              void 0 !== this.roughness && (n.roughness = this.roughness),
              void 0 !== this.metalness && (n.metalness = this.metalness),
              this.sheen &&
                this.sheen.isColor &&
                (n.sheen = this.sheen.getHex()),
              this.emissive &&
                this.emissive.isColor &&
                (n.emissive = this.emissive.getHex()),
              this.emissiveIntensity &&
                1 !== this.emissiveIntensity &&
                (n.emissiveIntensity = this.emissiveIntensity),
              this.specular &&
                this.specular.isColor &&
                (n.specular = this.specular.getHex()),
              void 0 !== this.shininess && (n.shininess = this.shininess),
              void 0 !== this.clearcoat && (n.clearcoat = this.clearcoat),
              void 0 !== this.clearcoatRoughness &&
                (n.clearcoatRoughness = this.clearcoatRoughness),
              this.clearcoatNormalMap &&
                this.clearcoatNormalMap.isTexture &&
                ((n.clearcoatNormalMap = this.clearcoatNormalMap.toJSON(
                  e
                ).uuid),
                (n.clearcoatNormalScale = this.clearcoatNormalScale.toArray())),
              this.map &&
                this.map.isTexture &&
                (n.map = this.map.toJSON(e).uuid),
              this.matcap &&
                this.matcap.isTexture &&
                (n.matcap = this.matcap.toJSON(e).uuid),
              this.alphaMap &&
                this.alphaMap.isTexture &&
                (n.alphaMap = this.alphaMap.toJSON(e).uuid),
              this.lightMap &&
                this.lightMap.isTexture &&
                (n.lightMap = this.lightMap.toJSON(e).uuid),
              this.aoMap &&
                this.aoMap.isTexture &&
                ((n.aoMap = this.aoMap.toJSON(e).uuid),
                (n.aoMapIntensity = this.aoMapIntensity)),
              this.bumpMap &&
                this.bumpMap.isTexture &&
                ((n.bumpMap = this.bumpMap.toJSON(e).uuid),
                (n.bumpScale = this.bumpScale)),
              this.normalMap &&
                this.normalMap.isTexture &&
                ((n.normalMap = this.normalMap.toJSON(e).uuid),
                (n.normalMapType = this.normalMapType),
                (n.normalScale = this.normalScale.toArray())),
              this.displacementMap &&
                this.displacementMap.isTexture &&
                ((n.displacementMap = this.displacementMap.toJSON(e).uuid),
                (n.displacementScale = this.displacementScale),
                (n.displacementBias = this.displacementBias)),
              this.roughnessMap &&
                this.roughnessMap.isTexture &&
                (n.roughnessMap = this.roughnessMap.toJSON(e).uuid),
              this.metalnessMap &&
                this.metalnessMap.isTexture &&
                (n.metalnessMap = this.metalnessMap.toJSON(e).uuid),
              this.emissiveMap &&
                this.emissiveMap.isTexture &&
                (n.emissiveMap = this.emissiveMap.toJSON(e).uuid),
              this.specularMap &&
                this.specularMap.isTexture &&
                (n.specularMap = this.specularMap.toJSON(e).uuid),
              this.envMap &&
                this.envMap.isTexture &&
                ((n.envMap = this.envMap.toJSON(e).uuid),
                (n.reflectivity = this.reflectivity),
                (n.refractionRatio = this.refractionRatio),
                void 0 !== this.combine && (n.combine = this.combine),
                void 0 !== this.envMapIntensity &&
                  (n.envMapIntensity = this.envMapIntensity)),
              this.gradientMap &&
                this.gradientMap.isTexture &&
                (n.gradientMap = this.gradientMap.toJSON(e).uuid),
              void 0 !== this.size && (n.size = this.size),
              void 0 !== this.sizeAttenuation &&
                (n.sizeAttenuation = this.sizeAttenuation),
              this.blending !== tn && (n.blending = this.blending),
              !0 === this.flatShading && (n.flatShading = this.flatShading),
              this.side !== Wt && (n.side = this.side),
              this.vertexColors !== Jt && (n.vertexColors = this.vertexColors),
              this.opacity < 1 && (n.opacity = this.opacity),
              !0 === this.transparent && (n.transparent = this.transparent),
              (n.depthFunc = this.depthFunc),
              (n.depthTest = this.depthTest),
              (n.depthWrite = this.depthWrite),
              (n.stencilWrite = this.stencilWrite),
              (n.stencilWriteMask = this.stencilWriteMask),
              (n.stencilFunc = this.stencilFunc),
              (n.stencilRef = this.stencilRef),
              (n.stencilFuncMask = this.stencilFuncMask),
              (n.stencilFail = this.stencilFail),
              (n.stencilZFail = this.stencilZFail),
              (n.stencilZPass = this.stencilZPass),
              this.rotation &&
                0 !== this.rotation &&
                (n.rotation = this.rotation),
              !0 === this.polygonOffset && (n.polygonOffset = !0),
              0 !== this.polygonOffsetFactor &&
                (n.polygonOffsetFactor = this.polygonOffsetFactor),
              0 !== this.polygonOffsetUnits &&
                (n.polygonOffsetUnits = this.polygonOffsetUnits),
              this.linewidth &&
                1 !== this.linewidth &&
                (n.linewidth = this.linewidth),
              void 0 !== this.dashSize && (n.dashSize = this.dashSize),
              void 0 !== this.gapSize && (n.gapSize = this.gapSize),
              void 0 !== this.scale && (n.scale = this.scale),
              !0 === this.dithering && (n.dithering = !0),
              this.alphaTest > 0 && (n.alphaTest = this.alphaTest),
              !0 === this.premultipliedAlpha &&
                (n.premultipliedAlpha = this.premultipliedAlpha),
              !0 === this.wireframe && (n.wireframe = this.wireframe),
              this.wireframeLinewidth > 1 &&
                (n.wireframeLinewidth = this.wireframeLinewidth),
              "round" !== this.wireframeLinecap &&
                (n.wireframeLinecap = this.wireframeLinecap),
              "round" !== this.wireframeLinejoin &&
                (n.wireframeLinejoin = this.wireframeLinejoin),
              !0 === this.morphTargets && (n.morphTargets = !0),
              !0 === this.morphNormals && (n.morphNormals = !0),
              !0 === this.skinning && (n.skinning = !0),
              !1 === this.visible && (n.visible = !1),
              !1 === this.toneMapped && (n.toneMapped = !1),
              "{}" !== JSON.stringify(this.userData) &&
                (n.userData = this.userData),
              t)
            ) {
              var i = r(e.textures),
                a = r(e.images);
              i.length > 0 && (n.textures = i), a.length > 0 && (n.images = a);
            }
            return n;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            (this.name = e.name),
              (this.fog = e.fog),
              (this.blending = e.blending),
              (this.side = e.side),
              (this.flatShading = e.flatShading),
              (this.vertexTangents = e.vertexTangents),
              (this.vertexColors = e.vertexColors),
              (this.opacity = e.opacity),
              (this.transparent = e.transparent),
              (this.blendSrc = e.blendSrc),
              (this.blendDst = e.blendDst),
              (this.blendEquation = e.blendEquation),
              (this.blendSrcAlpha = e.blendSrcAlpha),
              (this.blendDstAlpha = e.blendDstAlpha),
              (this.blendEquationAlpha = e.blendEquationAlpha),
              (this.depthFunc = e.depthFunc),
              (this.depthTest = e.depthTest),
              (this.depthWrite = e.depthWrite),
              (this.stencilWriteMask = e.stencilWriteMask),
              (this.stencilFunc = e.stencilFunc),
              (this.stencilRef = e.stencilRef),
              (this.stencilFuncMask = e.stencilFuncMask),
              (this.stencilFail = e.stencilFail),
              (this.stencilZFail = e.stencilZFail),
              (this.stencilZPass = e.stencilZPass),
              (this.stencilWrite = e.stencilWrite);
            var t = e.clippingPlanes,
              n = null;
            if (null !== t) {
              var r = t.length;
              n = new Array(r);
              for (var i = 0; i !== r; ++i) n[i] = t[i].clone();
            }
            return (
              (this.clippingPlanes = n),
              (this.clipIntersection = e.clipIntersection),
              (this.clipShadows = e.clipShadows),
              (this.shadowSide = e.shadowSide),
              (this.colorWrite = e.colorWrite),
              (this.precision = e.precision),
              (this.polygonOffset = e.polygonOffset),
              (this.polygonOffsetFactor = e.polygonOffsetFactor),
              (this.polygonOffsetUnits = e.polygonOffsetUnits),
              (this.dithering = e.dithering),
              (this.alphaTest = e.alphaTest),
              (this.premultipliedAlpha = e.premultipliedAlpha),
              (this.visible = e.visible),
              (this.toneMapped = e.toneMapped),
              (this.userData = JSON.parse(JSON.stringify(e.userData))),
              this
            );
          },
          dispose: function() {
            this.dispatchEvent({ type: "dispose" });
          }
        })),
          Object.defineProperty(Co.prototype, "needsUpdate", {
            set: function(e) {
              !0 === e && this.version++;
            }
          }),
          (Lo.prototype = Object.create(Co.prototype)),
          (Lo.prototype.constructor = Lo),
          (Lo.prototype.isMeshBasicMaterial = !0),
          (Lo.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              (this.map = e.map),
              (this.lightMap = e.lightMap),
              (this.lightMapIntensity = e.lightMapIntensity),
              (this.aoMap = e.aoMap),
              (this.aoMapIntensity = e.aoMapIntensity),
              (this.specularMap = e.specularMap),
              (this.alphaMap = e.alphaMap),
              (this.envMap = e.envMap),
              (this.combine = e.combine),
              (this.reflectivity = e.reflectivity),
              (this.refractionRatio = e.refractionRatio),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.wireframeLinecap = e.wireframeLinecap),
              (this.wireframeLinejoin = e.wireframeLinejoin),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              this
            );
          }),
          Object.defineProperty(No.prototype, "needsUpdate", {
            set: function(e) {
              !0 === e && this.version++;
            }
          }),
          Object.assign(No.prototype, {
            isBufferAttribute: !0,
            onUploadCallback: function() {},
            setUsage: function(e) {
              return (this.usage = e), this;
            },
            copy: function(e) {
              return (
                (this.name = e.name),
                (this.array = new e.array.constructor(e.array)),
                (this.itemSize = e.itemSize),
                (this.count = e.count),
                (this.normalized = e.normalized),
                (this.usage = e.usage),
                this
              );
            },
            copyAt: function(e, t, n) {
              (e *= this.itemSize), (n *= t.itemSize);
              for (var r = 0, i = this.itemSize; r < i; r++)
                this.array[e + r] = t.array[n + r];
              return this;
            },
            copyArray: function(e) {
              return this.array.set(e), this;
            },
            copyColorsArray: function(e) {
              for (var t = this.array, n = 0, r = 0, i = e.length; r < i; r++) {
                var a = e[r];
                void 0 === a && (a = new Eo()),
                  (t[n++] = a.r),
                  (t[n++] = a.g),
                  (t[n++] = a.b);
              }
              return this;
            },
            copyVector2sArray: function(e) {
              for (var t = this.array, n = 0, r = 0, i = e.length; r < i; r++) {
                var a = e[r];
                void 0 === a && (a = new Zi()), (t[n++] = a.x), (t[n++] = a.y);
              }
              return this;
            },
            copyVector3sArray: function(e) {
              for (var t = this.array, n = 0, r = 0, i = e.length; r < i; r++) {
                var a = e[r];
                void 0 === a && (a = new ea()),
                  (t[n++] = a.x),
                  (t[n++] = a.y),
                  (t[n++] = a.z);
              }
              return this;
            },
            copyVector4sArray: function(e) {
              for (var t = this.array, n = 0, r = 0, i = e.length; r < i; r++) {
                var a = e[r];
                void 0 === a && (a = new sa()),
                  (t[n++] = a.x),
                  (t[n++] = a.y),
                  (t[n++] = a.z),
                  (t[n++] = a.w);
              }
              return this;
            },
            set: function(e, t) {
              return void 0 === t && (t = 0), this.array.set(e, t), this;
            },
            getX: function(e) {
              return this.array[e * this.itemSize];
            },
            setX: function(e, t) {
              return (this.array[e * this.itemSize] = t), this;
            },
            getY: function(e) {
              return this.array[e * this.itemSize + 1];
            },
            setY: function(e, t) {
              return (this.array[e * this.itemSize + 1] = t), this;
            },
            getZ: function(e) {
              return this.array[e * this.itemSize + 2];
            },
            setZ: function(e, t) {
              return (this.array[e * this.itemSize + 2] = t), this;
            },
            getW: function(e) {
              return this.array[e * this.itemSize + 3];
            },
            setW: function(e, t) {
              return (this.array[e * this.itemSize + 3] = t), this;
            },
            setXY: function(e, t, n) {
              return (
                (e *= this.itemSize),
                (this.array[e + 0] = t),
                (this.array[e + 1] = n),
                this
              );
            },
            setXYZ: function(e, t, n, r) {
              return (
                (e *= this.itemSize),
                (this.array[e + 0] = t),
                (this.array[e + 1] = n),
                (this.array[e + 2] = r),
                this
              );
            },
            setXYZW: function(e, t, n, r, i) {
              return (
                (e *= this.itemSize),
                (this.array[e + 0] = t),
                (this.array[e + 1] = n),
                (this.array[e + 2] = r),
                (this.array[e + 3] = i),
                this
              );
            },
            onUpload: function(e) {
              return (this.onUploadCallback = e), this;
            },
            clone: function() {
              return new this.constructor(this.array, this.itemSize).copy(this);
            },
            toJSON: function() {
              return {
                itemSize: this.itemSize,
                type: this.array.constructor.name,
                array: Array.prototype.slice.call(this.array),
                normalized: this.normalized
              };
            }
          }),
          (Fo.prototype = Object.create(No.prototype)),
          (Fo.prototype.constructor = Fo),
          (ko.prototype = Object.create(No.prototype)),
          (ko.prototype.constructor = ko),
          (Uo.prototype = Object.create(No.prototype)),
          (Uo.prototype.constructor = Uo),
          (jo.prototype = Object.create(No.prototype)),
          (jo.prototype.constructor = jo),
          (Bo.prototype = Object.create(No.prototype)),
          (Bo.prototype.constructor = Bo),
          (zo.prototype = Object.create(No.prototype)),
          (zo.prototype.constructor = zo),
          (Vo.prototype = Object.create(No.prototype)),
          (Vo.prototype.constructor = Vo),
          (Go.prototype = Object.create(No.prototype)),
          (Go.prototype.constructor = Go),
          (Ho.prototype = Object.create(No.prototype)),
          (Ho.prototype.constructor = Ho),
          Object.assign(Xo.prototype, {
            computeGroups: function(e) {
              for (
                var t, n = [], r = void 0, i = e.faces, a = 0;
                a < i.length;
                a++
              ) {
                var o = i[a];
                o.materialIndex !== r &&
                  ((r = o.materialIndex),
                  void 0 !== t && ((t.count = 3 * a - t.start), n.push(t)),
                  (t = { start: 3 * a, materialIndex: r }));
              }
              void 0 !== t && ((t.count = 3 * a - t.start), n.push(t)),
                (this.groups = n);
            },
            fromGeometry: function(e) {
              var t,
                n = e.faces,
                r = e.vertices,
                i = e.faceVertexUvs,
                a = i[0] && i[0].length > 0,
                o = i[1] && i[1].length > 0,
                s = e.morphTargets,
                l = s.length;
              if (l > 0) {
                t = [];
                for (var c = 0; c < l; c++)
                  t[c] = { name: s[c].name, data: [] };
                this.morphTargets.position = t;
              }
              var u,
                h = e.morphNormals,
                d = h.length;
              if (d > 0) {
                for (u = [], c = 0; c < d; c++)
                  u[c] = { name: h[c].name, data: [] };
                this.morphTargets.normal = u;
              }
              var p = e.skinIndices,
                f = e.skinWeights,
                m = p.length === r.length,
                v = f.length === r.length;
              for (r.length > 0 && n.length, c = 0; c < n.length; c++) {
                var g = n[c];
                this.vertices.push(r[g.a], r[g.b], r[g.c]);
                var y = g.vertexNormals;
                if (3 === y.length) this.normals.push(y[0], y[1], y[2]);
                else {
                  var b = g.normal;
                  this.normals.push(b, b, b);
                }
                var x,
                  w = g.vertexColors;
                if (3 === w.length) this.colors.push(w[0], w[1], w[2]);
                else {
                  var _ = g.color;
                  this.colors.push(_, _, _);
                }
                !0 === a &&
                  (void 0 !== (x = i[0][c])
                    ? this.uvs.push(x[0], x[1], x[2])
                    : this.uvs.push(new Zi(), new Zi(), new Zi())),
                  !0 === o &&
                    (void 0 !== (x = i[1][c])
                      ? this.uvs2.push(x[0], x[1], x[2])
                      : this.uvs2.push(new Zi(), new Zi(), new Zi()));
                for (var M = 0; M < l; M++) {
                  var T = s[M].vertices;
                  t[M].data.push(T[g.a], T[g.b], T[g.c]);
                }
                for (M = 0; M < d; M++) {
                  var A = h[M].vertexNormals[c];
                  u[M].data.push(A.a, A.b, A.c);
                }
                m && this.skinIndices.push(p[g.a], p[g.b], p[g.c]),
                  v && this.skinWeights.push(f[g.a], f[g.b], f[g.c]);
              }
              return (
                this.computeGroups(e),
                (this.verticesNeedUpdate = e.verticesNeedUpdate),
                (this.normalsNeedUpdate = e.normalsNeedUpdate),
                (this.colorsNeedUpdate = e.colorsNeedUpdate),
                (this.uvsNeedUpdate = e.uvsNeedUpdate),
                (this.groupsNeedUpdate = e.groupsNeedUpdate),
                null !== e.boundingSphere &&
                  (this.boundingSphere = e.boundingSphere.clone()),
                null !== e.boundingBox &&
                  (this.boundingBox = e.boundingBox.clone()),
                this
              );
            }
          });
        var Yo = 1,
          qo = new ga(),
          Qo = new Na(),
          Zo = new ea(),
          Jo = new Za(),
          Ko = new Za(),
          $o = new ea();
        function es() {
          Object.defineProperty(this, "id", { value: (Yo += 2) }),
            (this.uuid = Qi.generateUUID()),
            (this.name = ""),
            (this.type = "BufferGeometry"),
            (this.index = null),
            (this.attributes = {}),
            (this.morphAttributes = {}),
            (this.morphTargetsRelative = !1),
            (this.groups = []),
            (this.boundingBox = null),
            (this.boundingSphere = null),
            (this.drawRange = { start: 0, count: 1 / 0 }),
            (this.userData = {});
        }
        es.prototype = Object.assign(Object.create(Wi.prototype), {
          constructor: es,
          isBufferGeometry: !0,
          getIndex: function() {
            return this.index;
          },
          setIndex: function(e) {
            Array.isArray(e)
              ? (this.index = new (Wo(e) > 65535 ? Vo : Bo)(e, 1))
              : (this.index = e);
          },
          getAttribute: function(e) {
            return this.attributes[e];
          },
          setAttribute: function(e, t) {
            return (this.attributes[e] = t), this;
          },
          deleteAttribute: function(e) {
            return delete this.attributes[e], this;
          },
          addGroup: function(e, t, n) {
            this.groups.push({
              start: e,
              count: t,
              materialIndex: void 0 !== n ? n : 0
            });
          },
          clearGroups: function() {
            this.groups = [];
          },
          setDrawRange: function(e, t) {
            (this.drawRange.start = e), (this.drawRange.count = t);
          },
          applyMatrix: function(e) {
            var t = this.attributes.position;
            void 0 !== t && (e.applyToBufferAttribute(t), (t.needsUpdate = !0));
            var n = this.attributes.normal;
            void 0 !== n &&
              (new ra().getNormalMatrix(e).applyToBufferAttribute(n),
              (n.needsUpdate = !0));
            var r = this.attributes.tangent;
            return (
              void 0 !== r &&
                (new ra().getNormalMatrix(e).applyToBufferAttribute(r),
                (r.needsUpdate = !0)),
              null !== this.boundingBox && this.computeBoundingBox(),
              null !== this.boundingSphere && this.computeBoundingSphere(),
              this
            );
          },
          rotateX: function(e) {
            return qo.makeRotationX(e), this.applyMatrix(qo), this;
          },
          rotateY: function(e) {
            return qo.makeRotationY(e), this.applyMatrix(qo), this;
          },
          rotateZ: function(e) {
            return qo.makeRotationZ(e), this.applyMatrix(qo), this;
          },
          translate: function(e, t, n) {
            return qo.makeTranslation(e, t, n), this.applyMatrix(qo), this;
          },
          scale: function(e, t, n) {
            return qo.makeScale(e, t, n), this.applyMatrix(qo), this;
          },
          lookAt: function(e) {
            return (
              Qo.lookAt(e), Qo.updateMatrix(), this.applyMatrix(Qo.matrix), this
            );
          },
          center: function() {
            return (
              this.computeBoundingBox(),
              this.boundingBox.getCenter(Zo).negate(),
              this.translate(Zo.x, Zo.y, Zo.z),
              this
            );
          },
          setFromObject: function(e) {
            var t = e.geometry;
            if (e.isPoints || e.isLine) {
              var n = new Go(3 * t.vertices.length, 3),
                r = new Go(3 * t.colors.length, 3);
              if (
                (this.setAttribute("position", n.copyVector3sArray(t.vertices)),
                this.setAttribute("color", r.copyColorsArray(t.colors)),
                t.lineDistances && t.lineDistances.length === t.vertices.length)
              ) {
                var i = new Go(t.lineDistances.length, 1);
                this.setAttribute("lineDistance", i.copyArray(t.lineDistances));
              }
              null !== t.boundingSphere &&
                (this.boundingSphere = t.boundingSphere.clone()),
                null !== t.boundingBox &&
                  (this.boundingBox = t.boundingBox.clone());
            } else e.isMesh && t && t.isGeometry && this.fromGeometry(t);
            return this;
          },
          setFromPoints: function(e) {
            for (var t = [], n = 0, r = e.length; n < r; n++) {
              var i = e[n];
              t.push(i.x, i.y, i.z || 0);
            }
            return this.setAttribute("position", new Go(t, 3)), this;
          },
          updateFromObject: function(e) {
            var t,
              n = e.geometry;
            if (e.isMesh) {
              var r = n.__directGeometry;
              if (
                (!0 === n.elementsNeedUpdate &&
                  ((r = void 0), (n.elementsNeedUpdate = !1)),
                void 0 === r)
              )
                return this.fromGeometry(n);
              (r.verticesNeedUpdate = n.verticesNeedUpdate),
                (r.normalsNeedUpdate = n.normalsNeedUpdate),
                (r.colorsNeedUpdate = n.colorsNeedUpdate),
                (r.uvsNeedUpdate = n.uvsNeedUpdate),
                (r.groupsNeedUpdate = n.groupsNeedUpdate),
                (n.verticesNeedUpdate = !1),
                (n.normalsNeedUpdate = !1),
                (n.colorsNeedUpdate = !1),
                (n.uvsNeedUpdate = !1),
                (n.groupsNeedUpdate = !1),
                (n = r);
            }
            return (
              !0 === n.verticesNeedUpdate &&
                (void 0 !== (t = this.attributes.position) &&
                  (t.copyVector3sArray(n.vertices), (t.needsUpdate = !0)),
                (n.verticesNeedUpdate = !1)),
              !0 === n.normalsNeedUpdate &&
                (void 0 !== (t = this.attributes.normal) &&
                  (t.copyVector3sArray(n.normals), (t.needsUpdate = !0)),
                (n.normalsNeedUpdate = !1)),
              !0 === n.colorsNeedUpdate &&
                (void 0 !== (t = this.attributes.color) &&
                  (t.copyColorsArray(n.colors), (t.needsUpdate = !0)),
                (n.colorsNeedUpdate = !1)),
              n.uvsNeedUpdate &&
                (void 0 !== (t = this.attributes.uv) &&
                  (t.copyVector2sArray(n.uvs), (t.needsUpdate = !0)),
                (n.uvsNeedUpdate = !1)),
              n.lineDistancesNeedUpdate &&
                (void 0 !== (t = this.attributes.lineDistance) &&
                  (t.copyArray(n.lineDistances), (t.needsUpdate = !0)),
                (n.lineDistancesNeedUpdate = !1)),
              n.groupsNeedUpdate &&
                (n.computeGroups(e.geometry),
                (this.groups = n.groups),
                (n.groupsNeedUpdate = !1)),
              this
            );
          },
          fromGeometry: function(e) {
            return (
              (e.__directGeometry = new Xo().fromGeometry(e)),
              this.fromDirectGeometry(e.__directGeometry)
            );
          },
          fromDirectGeometry: function(e) {
            var t = new Float32Array(3 * e.vertices.length);
            if (
              (this.setAttribute(
                "position",
                new No(t, 3).copyVector3sArray(e.vertices)
              ),
              e.normals.length > 0)
            ) {
              var n = new Float32Array(3 * e.normals.length);
              this.setAttribute(
                "normal",
                new No(n, 3).copyVector3sArray(e.normals)
              );
            }
            if (e.colors.length > 0) {
              var r = new Float32Array(3 * e.colors.length);
              this.setAttribute(
                "color",
                new No(r, 3).copyColorsArray(e.colors)
              );
            }
            if (e.uvs.length > 0) {
              var i = new Float32Array(2 * e.uvs.length);
              this.setAttribute("uv", new No(i, 2).copyVector2sArray(e.uvs));
            }
            if (e.uvs2.length > 0) {
              var a = new Float32Array(2 * e.uvs2.length);
              this.setAttribute("uv2", new No(a, 2).copyVector2sArray(e.uvs2));
            }
            for (var o in ((this.groups = e.groups), e.morphTargets)) {
              for (
                var s = [], l = e.morphTargets[o], c = 0, u = l.length;
                c < u;
                c++
              ) {
                var h = l[c],
                  d = new Go(3 * h.data.length, 3);
                (d.name = h.name), s.push(d.copyVector3sArray(h.data));
              }
              this.morphAttributes[o] = s;
            }
            if (e.skinIndices.length > 0) {
              var p = new Go(4 * e.skinIndices.length, 4);
              this.setAttribute(
                "skinIndex",
                p.copyVector4sArray(e.skinIndices)
              );
            }
            if (e.skinWeights.length > 0) {
              var f = new Go(4 * e.skinWeights.length, 4);
              this.setAttribute(
                "skinWeight",
                f.copyVector4sArray(e.skinWeights)
              );
            }
            return (
              null !== e.boundingSphere &&
                (this.boundingSphere = e.boundingSphere.clone()),
              null !== e.boundingBox &&
                (this.boundingBox = e.boundingBox.clone()),
              this
            );
          },
          computeBoundingBox: function() {
            null === this.boundingBox && (this.boundingBox = new Za());
            var e = this.attributes.position,
              t = this.morphAttributes.position;
            if (void 0 !== e) {
              if ((this.boundingBox.setFromBufferAttribute(e), t))
                for (var n = 0, r = t.length; n < r; n++) {
                  var i = t[n];
                  Jo.setFromBufferAttribute(i),
                    this.morphTargetsRelative
                      ? ($o.addVectors(this.boundingBox.min, Jo.min),
                        this.boundingBox.expandByPoint($o),
                        $o.addVectors(this.boundingBox.max, Jo.max),
                        this.boundingBox.expandByPoint($o))
                      : (this.boundingBox.expandByPoint(Jo.min),
                        this.boundingBox.expandByPoint(Jo.max));
                }
            } else this.boundingBox.makeEmpty();
            isNaN(this.boundingBox.min.x) ||
              isNaN(this.boundingBox.min.y) ||
              isNaN(this.boundingBox.min.z);
          },
          computeBoundingSphere: function() {
            null === this.boundingSphere && (this.boundingSphere = new $a());
            var e = this.attributes.position,
              t = this.morphAttributes.position;
            if (e) {
              var n = this.boundingSphere.center;
              if ((Jo.setFromBufferAttribute(e), t))
                for (var r = 0, i = t.length; r < i; r++) {
                  var a = t[r];
                  Ko.setFromBufferAttribute(a),
                    this.morphTargetsRelative
                      ? ($o.addVectors(Jo.min, Ko.min),
                        Jo.expandByPoint($o),
                        $o.addVectors(Jo.max, Ko.max),
                        Jo.expandByPoint($o))
                      : (Jo.expandByPoint(Ko.min), Jo.expandByPoint(Ko.max));
                }
              Jo.getCenter(n);
              var o = 0;
              for (r = 0, i = e.count; r < i; r++)
                $o.fromBufferAttribute(e, r),
                  (o = Math.max(o, n.distanceToSquared($o)));
              if (t)
                for (r = 0, i = t.length; r < i; r++) {
                  a = t[r];
                  for (
                    var s = this.morphTargetsRelative, l = 0, c = a.count;
                    l < c;
                    l++
                  )
                    $o.fromBufferAttribute(a, l),
                      s && (Zo.fromBufferAttribute(e, l), $o.add(Zo)),
                      (o = Math.max(o, n.distanceToSquared($o)));
                }
              (this.boundingSphere.radius = Math.sqrt(o)),
                isNaN(this.boundingSphere.radius);
            }
          },
          computeFaceNormals: function() {},
          computeVertexNormals: function() {
            var e = this.index,
              t = this.attributes;
            if (t.position) {
              var n = t.position.array;
              if (void 0 === t.normal)
                this.setAttribute(
                  "normal",
                  new No(new Float32Array(n.length), 3)
                );
              else
                for (var r = t.normal.array, i = 0, a = r.length; i < a; i++)
                  r[i] = 0;
              var o,
                s,
                l,
                c = t.normal.array,
                u = new ea(),
                h = new ea(),
                d = new ea(),
                p = new ea(),
                f = new ea();
              if (e) {
                var m = e.array;
                for (i = 0, a = e.count; i < a; i += 3)
                  (o = 3 * m[i + 0]),
                    (s = 3 * m[i + 1]),
                    (l = 3 * m[i + 2]),
                    u.fromArray(n, o),
                    h.fromArray(n, s),
                    d.fromArray(n, l),
                    p.subVectors(d, h),
                    f.subVectors(u, h),
                    p.cross(f),
                    (c[o] += p.x),
                    (c[o + 1] += p.y),
                    (c[o + 2] += p.z),
                    (c[s] += p.x),
                    (c[s + 1] += p.y),
                    (c[s + 2] += p.z),
                    (c[l] += p.x),
                    (c[l + 1] += p.y),
                    (c[l + 2] += p.z);
              } else
                for (i = 0, a = n.length; i < a; i += 9)
                  u.fromArray(n, i),
                    h.fromArray(n, i + 3),
                    d.fromArray(n, i + 6),
                    p.subVectors(d, h),
                    f.subVectors(u, h),
                    p.cross(f),
                    (c[i] = p.x),
                    (c[i + 1] = p.y),
                    (c[i + 2] = p.z),
                    (c[i + 3] = p.x),
                    (c[i + 4] = p.y),
                    (c[i + 5] = p.z),
                    (c[i + 6] = p.x),
                    (c[i + 7] = p.y),
                    (c[i + 8] = p.z);
              this.normalizeNormals(), (t.normal.needsUpdate = !0);
            }
          },
          merge: function(e, t) {
            if (e && e.isBufferGeometry) {
              void 0 === t && (t = 0);
              var n = this.attributes;
              for (var r in n)
                if (void 0 !== e.attributes[r])
                  for (
                    var i = n[r].array,
                      a = e.attributes[r],
                      o = a.array,
                      s = a.itemSize * t,
                      l = Math.min(o.length, i.length - s),
                      c = 0,
                      u = s;
                    c < l;
                    c++, u++
                  )
                    i[u] = o[c];
              return this;
            }
          },
          normalizeNormals: function() {
            for (var e = this.attributes.normal, t = 0, n = e.count; t < n; t++)
              ($o.x = e.getX(t)),
                ($o.y = e.getY(t)),
                ($o.z = e.getZ(t)),
                $o.normalize(),
                e.setXYZ(t, $o.x, $o.y, $o.z);
          },
          toNonIndexed: function() {
            function e(e, t) {
              for (
                var n = e.array,
                  r = e.itemSize,
                  i = new n.constructor(t.length * r),
                  a = 0,
                  o = 0,
                  s = 0,
                  l = t.length;
                s < l;
                s++
              ) {
                a = t[s] * r;
                for (var c = 0; c < r; c++) i[o++] = n[a++];
              }
              return new No(i, r);
            }
            if (null === this.index) return this;
            var t = new es(),
              n = this.index.array,
              r = this.attributes;
            for (var i in r) {
              var a = e(r[i], n);
              t.setAttribute(i, a);
            }
            var o = this.morphAttributes;
            for (i in o) {
              for (var s = [], l = o[i], c = 0, u = l.length; c < u; c++)
                (a = e(l[c], n)), s.push(a);
              t.morphAttributes[i] = s;
            }
            t.morphTargetsRelative = this.morphTargetsRelative;
            for (var h = this.groups, d = ((c = 0), h.length); c < d; c++) {
              var p = h[c];
              t.addGroup(p.start, p.count, p.materialIndex);
            }
            return t;
          },
          toJSON: function() {
            var e = {
              metadata: {
                version: 4.5,
                type: "BufferGeometry",
                generator: "BufferGeometry.toJSON"
              }
            };
            if (
              ((e.uuid = this.uuid),
              (e.type = this.type),
              "" !== this.name && (e.name = this.name),
              Object.keys(this.userData).length > 0 &&
                (e.userData = this.userData),
              void 0 !== this.parameters)
            ) {
              var t = this.parameters;
              for (var n in t) void 0 !== t[n] && (e[n] = t[n]);
              return e;
            }
            e.data = { attributes: {} };
            var r = this.index;
            null !== r &&
              (e.data.index = {
                type: r.array.constructor.name,
                array: Array.prototype.slice.call(r.array)
              });
            var i = this.attributes;
            for (var n in i) {
              var a = (d = i[n]).toJSON();
              "" !== d.name && (a.name = d.name), (e.data.attributes[n] = a);
            }
            var o = {},
              s = !1;
            for (var n in this.morphAttributes) {
              for (
                var l = this.morphAttributes[n], c = [], u = 0, h = l.length;
                u < h;
                u++
              ) {
                var d;
                (a = (d = l[u]).toJSON()),
                  "" !== d.name && (a.name = d.name),
                  c.push(a);
              }
              c.length > 0 && ((o[n] = c), (s = !0));
            }
            s &&
              ((e.data.morphAttributes = o),
              (e.data.morphTargetsRelative = this.morphTargetsRelative));
            var p = this.groups;
            p.length > 0 && (e.data.groups = JSON.parse(JSON.stringify(p)));
            var f = this.boundingSphere;
            return (
              null !== f &&
                (e.data.boundingSphere = {
                  center: f.center.toArray(),
                  radius: f.radius
                }),
              e
            );
          },
          clone: function() {
            return new es().copy(this);
          },
          copy: function(e) {
            var t, n, r;
            (this.index = null),
              (this.attributes = {}),
              (this.morphAttributes = {}),
              (this.groups = []),
              (this.boundingBox = null),
              (this.boundingSphere = null),
              (this.name = e.name);
            var i = e.index;
            null !== i && this.setIndex(i.clone());
            var a = e.attributes;
            for (t in a) {
              var o = a[t];
              this.setAttribute(t, o.clone());
            }
            var s = e.morphAttributes;
            for (t in s) {
              var l = [],
                c = s[t];
              for (n = 0, r = c.length; n < r; n++) l.push(c[n].clone());
              this.morphAttributes[t] = l;
            }
            this.morphTargetsRelative = e.morphTargetsRelative;
            var u = e.groups;
            for (n = 0, r = u.length; n < r; n++) {
              var h = u[n];
              this.addGroup(h.start, h.count, h.materialIndex);
            }
            var d = e.boundingBox;
            null !== d && (this.boundingBox = d.clone());
            var p = e.boundingSphere;
            return (
              null !== p && (this.boundingSphere = p.clone()),
              (this.drawRange.start = e.drawRange.start),
              (this.drawRange.count = e.drawRange.count),
              (this.userData = e.userData),
              this
            );
          },
          dispose: function() {
            this.dispatchEvent({ type: "dispose" });
          }
        });
        var ts = new ga(),
          ns = new so(),
          rs = new $a(),
          is = new ea(),
          as = new ea(),
          os = new ea(),
          ss = new ea(),
          ls = new ea(),
          cs = new ea(),
          us = new ea(),
          hs = new ea(),
          ds = new ea(),
          ps = new Zi(),
          fs = new Zi(),
          ms = new Zi(),
          vs = new ea(),
          gs = new ea();
        function ys(e, t) {
          Na.call(this),
            (this.type = "Mesh"),
            (this.geometry = void 0 !== e ? e : new es()),
            (this.material =
              void 0 !== t ? t : new Lo({ color: 16777215 * Math.random() })),
            (this.drawMode = oi),
            this.updateMorphTargets();
        }
        function bs(e, t, n, r, i, a, o, s) {
          if (
            null ===
            (t.side === Yt
              ? r.intersectTriangle(o, a, i, !0, s)
              : r.intersectTriangle(i, a, o, t.side !== qt, s))
          )
            return null;
          gs.copy(s), gs.applyMatrix4(e.matrixWorld);
          var l = n.ray.origin.distanceTo(gs);
          return l < n.near || l > n.far
            ? null
            : { distance: l, point: gs.clone(), object: e };
        }
        function xs(e, t, n, r, i, a, o, s, l, c, u, h) {
          is.fromBufferAttribute(i, c),
            as.fromBufferAttribute(i, u),
            os.fromBufferAttribute(i, h);
          var d = e.morphTargetInfluences;
          if (t.morphTargets && a && d) {
            us.set(0, 0, 0), hs.set(0, 0, 0), ds.set(0, 0, 0);
            for (var p = 0, f = a.length; p < f; p++) {
              var m = d[p],
                v = a[p];
              0 !== m &&
                (ss.fromBufferAttribute(v, c),
                ls.fromBufferAttribute(v, u),
                cs.fromBufferAttribute(v, h),
                o
                  ? (us.addScaledVector(ss, m),
                    hs.addScaledVector(ls, m),
                    ds.addScaledVector(cs, m))
                  : (us.addScaledVector(ss.sub(is), m),
                    hs.addScaledVector(ls.sub(as), m),
                    ds.addScaledVector(cs.sub(os), m)));
            }
            is.add(us), as.add(hs), os.add(ds);
          }
          var g = bs(e, t, n, r, is, as, os, vs);
          if (g) {
            s &&
              (ps.fromBufferAttribute(s, c),
              fs.fromBufferAttribute(s, u),
              ms.fromBufferAttribute(s, h),
              (g.uv = Mo.getUV(vs, is, as, os, ps, fs, ms, new Zi()))),
              l &&
                (ps.fromBufferAttribute(l, c),
                fs.fromBufferAttribute(l, u),
                ms.fromBufferAttribute(l, h),
                (g.uv2 = Mo.getUV(vs, is, as, os, ps, fs, ms, new Zi())));
            var y = new Do(c, u, h);
            Mo.getNormal(is, as, os, y.normal), (g.face = y);
          }
          return g;
        }
        ys.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: ys,
          isMesh: !0,
          setDrawMode: function(e) {
            this.drawMode = e;
          },
          copy: function(e) {
            return (
              Na.prototype.copy.call(this, e),
              (this.drawMode = e.drawMode),
              void 0 !== e.morphTargetInfluences &&
                (this.morphTargetInfluences = e.morphTargetInfluences.slice()),
              void 0 !== e.morphTargetDictionary &&
                (this.morphTargetDictionary = Object.assign(
                  {},
                  e.morphTargetDictionary
                )),
              this
            );
          },
          updateMorphTargets: function() {
            var e,
              t,
              n,
              r = this.geometry;
            if (r.isBufferGeometry) {
              var i = r.morphAttributes,
                a = Object.keys(i);
              if (a.length > 0) {
                var o = i[a[0]];
                if (void 0 !== o)
                  for (
                    this.morphTargetInfluences = [],
                      this.morphTargetDictionary = {},
                      e = 0,
                      t = o.length;
                    e < t;
                    e++
                  )
                    (n = o[e].name || String(e)),
                      this.morphTargetInfluences.push(0),
                      (this.morphTargetDictionary[n] = e);
              }
            } else {
              var s = r.morphTargets;
              void 0 !== s && s.length;
            }
          },
          raycast: function(e, t) {
            var n,
              r = this.geometry,
              i = this.material,
              a = this.matrixWorld;
            if (
              void 0 !== i &&
              (null === r.boundingSphere && r.computeBoundingSphere(),
              rs.copy(r.boundingSphere),
              rs.applyMatrix4(a),
              !1 !== e.ray.intersectsSphere(rs) &&
                (ts.getInverse(a),
                ns.copy(e.ray).applyMatrix4(ts),
                (null === r.boundingBox ||
                  !1 !== ns.intersectsBox(r.boundingBox)) &&
                  this.drawMode === oi))
            )
              if (r.isBufferGeometry) {
                var o,
                  s,
                  l,
                  c,
                  u,
                  h,
                  d,
                  p,
                  f,
                  m = r.index,
                  v = r.attributes.position,
                  g = r.morphAttributes.position,
                  y = r.morphTargetsRelative,
                  b = r.attributes.uv,
                  x = r.attributes.uv2,
                  w = r.groups,
                  _ = r.drawRange;
                if (null !== m)
                  if (Array.isArray(i))
                    for (c = 0, h = w.length; c < h; c++)
                      for (
                        f = i[(p = w[c]).materialIndex],
                          u = Math.max(p.start, _.start),
                          d = Math.min(p.start + p.count, _.start + _.count);
                        u < d;
                        u += 3
                      )
                        (o = m.getX(u)),
                          (s = m.getX(u + 1)),
                          (l = m.getX(u + 2)),
                          (n = xs(this, f, e, ns, v, g, y, b, x, o, s, l)) &&
                            ((n.faceIndex = Math.floor(u / 3)),
                            (n.face.materialIndex = p.materialIndex),
                            t.push(n));
                  else
                    for (
                      c = Math.max(0, _.start),
                        h = Math.min(m.count, _.start + _.count);
                      c < h;
                      c += 3
                    )
                      (o = m.getX(c)),
                        (s = m.getX(c + 1)),
                        (l = m.getX(c + 2)),
                        (n = xs(this, i, e, ns, v, g, y, b, x, o, s, l)) &&
                          ((n.faceIndex = Math.floor(c / 3)), t.push(n));
                else if (void 0 !== v)
                  if (Array.isArray(i))
                    for (c = 0, h = w.length; c < h; c++)
                      for (
                        f = i[(p = w[c]).materialIndex],
                          u = Math.max(p.start, _.start),
                          d = Math.min(p.start + p.count, _.start + _.count);
                        u < d;
                        u += 3
                      )
                        (n = xs(
                          this,
                          f,
                          e,
                          ns,
                          v,
                          g,
                          y,
                          b,
                          x,
                          (o = u),
                          (s = u + 1),
                          (l = u + 2)
                        )) &&
                          ((n.faceIndex = Math.floor(u / 3)),
                          (n.face.materialIndex = p.materialIndex),
                          t.push(n));
                  else
                    for (
                      c = Math.max(0, _.start),
                        h = Math.min(v.count, _.start + _.count);
                      c < h;
                      c += 3
                    )
                      (n = xs(
                        this,
                        i,
                        e,
                        ns,
                        v,
                        g,
                        y,
                        b,
                        x,
                        (o = c),
                        (s = c + 1),
                        (l = c + 2)
                      )) && ((n.faceIndex = Math.floor(c / 3)), t.push(n));
              } else if (r.isGeometry) {
                var M,
                  T,
                  A,
                  S,
                  E = Array.isArray(i),
                  R = r.vertices,
                  P = r.faces,
                  I = r.faceVertexUvs[0];
                I.length > 0 && (S = I);
                for (var D = 0, O = P.length; D < O; D++) {
                  var C = P[D],
                    L = E ? i[C.materialIndex] : i;
                  if (
                    void 0 !== L &&
                    ((M = R[C.a]),
                    (T = R[C.b]),
                    (A = R[C.c]),
                    (n = bs(this, L, e, ns, M, T, A, vs)))
                  ) {
                    if (S && S[D]) {
                      var N = S[D];
                      ps.copy(N[0]),
                        fs.copy(N[1]),
                        ms.copy(N[2]),
                        (n.uv = Mo.getUV(vs, M, T, A, ps, fs, ms, new Zi()));
                    }
                    (n.face = C), (n.faceIndex = D), t.push(n);
                  }
                }
              }
          },
          clone: function() {
            return new this.constructor(this.geometry, this.material).copy(
              this
            );
          }
        });
        var ws = 0,
          _s = new ga(),
          Ms = new Na(),
          Ts = new ea();
        function As() {
          Object.defineProperty(this, "id", { value: (ws += 2) }),
            (this.uuid = Qi.generateUUID()),
            (this.name = ""),
            (this.type = "Geometry"),
            (this.vertices = []),
            (this.colors = []),
            (this.faces = []),
            (this.faceVertexUvs = [[]]),
            (this.morphTargets = []),
            (this.morphNormals = []),
            (this.skinWeights = []),
            (this.skinIndices = []),
            (this.lineDistances = []),
            (this.boundingBox = null),
            (this.boundingSphere = null),
            (this.elementsNeedUpdate = !1),
            (this.verticesNeedUpdate = !1),
            (this.uvsNeedUpdate = !1),
            (this.normalsNeedUpdate = !1),
            (this.colorsNeedUpdate = !1),
            (this.lineDistancesNeedUpdate = !1),
            (this.groupsNeedUpdate = !1);
        }
        As.prototype = Object.assign(Object.create(Wi.prototype), {
          constructor: As,
          isGeometry: !0,
          applyMatrix: function(e) {
            for (
              var t = new ra().getNormalMatrix(e),
                n = 0,
                r = this.vertices.length;
              n < r;
              n++
            )
              this.vertices[n].applyMatrix4(e);
            for (n = 0, r = this.faces.length; n < r; n++) {
              var i = this.faces[n];
              i.normal.applyMatrix3(t).normalize();
              for (var a = 0, o = i.vertexNormals.length; a < o; a++)
                i.vertexNormals[a].applyMatrix3(t).normalize();
            }
            return (
              null !== this.boundingBox && this.computeBoundingBox(),
              null !== this.boundingSphere && this.computeBoundingSphere(),
              (this.verticesNeedUpdate = !0),
              (this.normalsNeedUpdate = !0),
              this
            );
          },
          rotateX: function(e) {
            return _s.makeRotationX(e), this.applyMatrix(_s), this;
          },
          rotateY: function(e) {
            return _s.makeRotationY(e), this.applyMatrix(_s), this;
          },
          rotateZ: function(e) {
            return _s.makeRotationZ(e), this.applyMatrix(_s), this;
          },
          translate: function(e, t, n) {
            return _s.makeTranslation(e, t, n), this.applyMatrix(_s), this;
          },
          scale: function(e, t, n) {
            return _s.makeScale(e, t, n), this.applyMatrix(_s), this;
          },
          lookAt: function(e) {
            return (
              Ms.lookAt(e), Ms.updateMatrix(), this.applyMatrix(Ms.matrix), this
            );
          },
          fromBufferGeometry: function(e) {
            var t = this,
              n = null !== e.index ? e.index.array : void 0,
              r = e.attributes;
            if (void 0 === r.position) return this;
            var i = r.position.array,
              a = void 0 !== r.normal ? r.normal.array : void 0,
              o = void 0 !== r.color ? r.color.array : void 0,
              s = void 0 !== r.uv ? r.uv.array : void 0,
              l = void 0 !== r.uv2 ? r.uv2.array : void 0;
            void 0 !== l && (this.faceVertexUvs[1] = []);
            for (var c = 0; c < i.length; c += 3)
              t.vertices.push(new ea().fromArray(i, c)),
                void 0 !== o && t.colors.push(new Eo().fromArray(o, c));
            function u(e, n, r, i) {
              var c =
                  void 0 === o
                    ? []
                    : [
                        t.colors[e].clone(),
                        t.colors[n].clone(),
                        t.colors[r].clone()
                      ],
                u = new Do(
                  e,
                  n,
                  r,
                  void 0 === a
                    ? []
                    : [
                        new ea().fromArray(a, 3 * e),
                        new ea().fromArray(a, 3 * n),
                        new ea().fromArray(a, 3 * r)
                      ],
                  c,
                  i
                );
              t.faces.push(u),
                void 0 !== s &&
                  t.faceVertexUvs[0].push([
                    new Zi().fromArray(s, 2 * e),
                    new Zi().fromArray(s, 2 * n),
                    new Zi().fromArray(s, 2 * r)
                  ]),
                void 0 !== l &&
                  t.faceVertexUvs[1].push([
                    new Zi().fromArray(l, 2 * e),
                    new Zi().fromArray(l, 2 * n),
                    new Zi().fromArray(l, 2 * r)
                  ]);
            }
            var h = e.groups;
            if (h.length > 0)
              for (c = 0; c < h.length; c++)
                for (
                  var d = h[c], p = d.start, f = p, m = p + d.count;
                  f < m;
                  f += 3
                )
                  void 0 !== n
                    ? u(n[f], n[f + 1], n[f + 2], d.materialIndex)
                    : u(f, f + 1, f + 2, d.materialIndex);
            else if (void 0 !== n)
              for (c = 0; c < n.length; c += 3) u(n[c], n[c + 1], n[c + 2]);
            else for (c = 0; c < i.length / 3; c += 3) u(c, c + 1, c + 2);
            return (
              this.computeFaceNormals(),
              null !== e.boundingBox &&
                (this.boundingBox = e.boundingBox.clone()),
              null !== e.boundingSphere &&
                (this.boundingSphere = e.boundingSphere.clone()),
              this
            );
          },
          center: function() {
            return (
              this.computeBoundingBox(),
              this.boundingBox.getCenter(Ts).negate(),
              this.translate(Ts.x, Ts.y, Ts.z),
              this
            );
          },
          normalize: function() {
            this.computeBoundingSphere();
            var e = this.boundingSphere.center,
              t = this.boundingSphere.radius,
              n = 0 === t ? 1 : 1 / t,
              r = new ga();
            return (
              r.set(
                n,
                0,
                0,
                -n * e.x,
                0,
                n,
                0,
                -n * e.y,
                0,
                0,
                n,
                -n * e.z,
                0,
                0,
                0,
                1
              ),
              this.applyMatrix(r),
              this
            );
          },
          computeFaceNormals: function() {
            for (
              var e = new ea(), t = new ea(), n = 0, r = this.faces.length;
              n < r;
              n++
            ) {
              var i = this.faces[n],
                a = this.vertices[i.a],
                o = this.vertices[i.b],
                s = this.vertices[i.c];
              e.subVectors(s, o),
                t.subVectors(a, o),
                e.cross(t),
                e.normalize(),
                i.normal.copy(e);
            }
          },
          computeVertexNormals: function(e) {
            var t, n, r, i, a, o;
            for (
              void 0 === e && (e = !0),
                o = new Array(this.vertices.length),
                t = 0,
                n = this.vertices.length;
              t < n;
              t++
            )
              o[t] = new ea();
            if (e) {
              var s,
                l,
                c,
                u = new ea(),
                h = new ea();
              for (r = 0, i = this.faces.length; r < i; r++)
                (a = this.faces[r]),
                  (s = this.vertices[a.a]),
                  (l = this.vertices[a.b]),
                  (c = this.vertices[a.c]),
                  u.subVectors(c, l),
                  h.subVectors(s, l),
                  u.cross(h),
                  o[a.a].add(u),
                  o[a.b].add(u),
                  o[a.c].add(u);
            } else
              for (
                this.computeFaceNormals(), r = 0, i = this.faces.length;
                r < i;
                r++
              )
                o[(a = this.faces[r]).a].add(a.normal),
                  o[a.b].add(a.normal),
                  o[a.c].add(a.normal);
            for (t = 0, n = this.vertices.length; t < n; t++) o[t].normalize();
            for (r = 0, i = this.faces.length; r < i; r++) {
              var d = (a = this.faces[r]).vertexNormals;
              3 === d.length
                ? (d[0].copy(o[a.a]), d[1].copy(o[a.b]), d[2].copy(o[a.c]))
                : ((d[0] = o[a.a].clone()),
                  (d[1] = o[a.b].clone()),
                  (d[2] = o[a.c].clone()));
            }
            this.faces.length > 0 && (this.normalsNeedUpdate = !0);
          },
          computeFlatVertexNormals: function() {
            var e, t, n;
            for (
              this.computeFaceNormals(), e = 0, t = this.faces.length;
              e < t;
              e++
            ) {
              var r = (n = this.faces[e]).vertexNormals;
              3 === r.length
                ? (r[0].copy(n.normal),
                  r[1].copy(n.normal),
                  r[2].copy(n.normal))
                : ((r[0] = n.normal.clone()),
                  (r[1] = n.normal.clone()),
                  (r[2] = n.normal.clone()));
            }
            this.faces.length > 0 && (this.normalsNeedUpdate = !0);
          },
          computeMorphNormals: function() {
            var e, t, n, r, i;
            for (n = 0, r = this.faces.length; n < r; n++)
              for (
                (i = this.faces[n]).__originalFaceNormal
                  ? i.__originalFaceNormal.copy(i.normal)
                  : (i.__originalFaceNormal = i.normal.clone()),
                  i.__originalVertexNormals || (i.__originalVertexNormals = []),
                  e = 0,
                  t = i.vertexNormals.length;
                e < t;
                e++
              )
                i.__originalVertexNormals[e]
                  ? i.__originalVertexNormals[e].copy(i.vertexNormals[e])
                  : (i.__originalVertexNormals[e] = i.vertexNormals[e].clone());
            var a = new As();
            for (
              a.faces = this.faces, e = 0, t = this.morphTargets.length;
              e < t;
              e++
            ) {
              if (!this.morphNormals[e]) {
                (this.morphNormals[e] = {}),
                  (this.morphNormals[e].faceNormals = []),
                  (this.morphNormals[e].vertexNormals = []);
                var o = this.morphNormals[e].faceNormals,
                  s = this.morphNormals[e].vertexNormals;
                for (n = 0, r = this.faces.length; n < r; n++)
                  (l = new ea()),
                    (c = { a: new ea(), b: new ea(), c: new ea() }),
                    o.push(l),
                    s.push(c);
              }
              var l,
                c,
                u = this.morphNormals[e];
              for (
                a.vertices = this.morphTargets[e].vertices,
                  a.computeFaceNormals(),
                  a.computeVertexNormals(),
                  n = 0,
                  r = this.faces.length;
                n < r;
                n++
              )
                (i = this.faces[n]),
                  (l = u.faceNormals[n]),
                  (c = u.vertexNormals[n]),
                  l.copy(i.normal),
                  c.a.copy(i.vertexNormals[0]),
                  c.b.copy(i.vertexNormals[1]),
                  c.c.copy(i.vertexNormals[2]);
            }
            for (n = 0, r = this.faces.length; n < r; n++)
              ((i = this.faces[n]).normal = i.__originalFaceNormal),
                (i.vertexNormals = i.__originalVertexNormals);
          },
          computeBoundingBox: function() {
            null === this.boundingBox && (this.boundingBox = new Za()),
              this.boundingBox.setFromPoints(this.vertices);
          },
          computeBoundingSphere: function() {
            null === this.boundingSphere && (this.boundingSphere = new $a()),
              this.boundingSphere.setFromPoints(this.vertices);
          },
          merge: function(e, t, n) {
            if (e && e.isGeometry) {
              var r,
                i = this.vertices.length,
                a = this.vertices,
                o = e.vertices,
                s = this.faces,
                l = e.faces,
                c = this.colors,
                u = e.colors;
              void 0 === n && (n = 0),
                void 0 !== t && (r = new ra().getNormalMatrix(t));
              for (var h = 0, d = o.length; h < d; h++) {
                var p = o[h].clone();
                void 0 !== t && p.applyMatrix4(t), a.push(p);
              }
              for (h = 0, d = u.length; h < d; h++) c.push(u[h].clone());
              for (h = 0, d = l.length; h < d; h++) {
                var f,
                  m,
                  v,
                  g = l[h],
                  y = g.vertexNormals,
                  b = g.vertexColors;
                (f = new Do(g.a + i, g.b + i, g.c + i)).normal.copy(g.normal),
                  void 0 !== r && f.normal.applyMatrix3(r).normalize();
                for (var x = 0, w = y.length; x < w; x++)
                  (m = y[x].clone()),
                    void 0 !== r && m.applyMatrix3(r).normalize(),
                    f.vertexNormals.push(m);
                for (f.color.copy(g.color), x = 0, w = b.length; x < w; x++)
                  (v = b[x]), f.vertexColors.push(v.clone());
                (f.materialIndex = g.materialIndex + n), s.push(f);
              }
              for (h = 0, d = e.faceVertexUvs.length; h < d; h++) {
                var _ = e.faceVertexUvs[h];
                for (
                  void 0 === this.faceVertexUvs[h] &&
                    (this.faceVertexUvs[h] = []),
                    x = 0,
                    w = _.length;
                  x < w;
                  x++
                ) {
                  for (var M = _[x], T = [], A = 0, S = M.length; A < S; A++)
                    T.push(M[A].clone());
                  this.faceVertexUvs[h].push(T);
                }
              }
            }
          },
          mergeMesh: function(e) {
            e &&
              e.isMesh &&
              (e.matrixAutoUpdate && e.updateMatrix(),
              this.merge(e.geometry, e.matrix));
          },
          mergeVertices: function() {
            var e,
              t,
              n,
              r,
              i,
              a,
              o,
              s,
              l = {},
              c = [],
              u = [],
              h = Math.pow(10, 4);
            for (n = 0, r = this.vertices.length; n < r; n++)
              (e = this.vertices[n]),
                void 0 ===
                l[
                  (t =
                    Math.round(e.x * h) +
                    "_" +
                    Math.round(e.y * h) +
                    "_" +
                    Math.round(e.z * h))
                ]
                  ? ((l[t] = n),
                    c.push(this.vertices[n]),
                    (u[n] = c.length - 1))
                  : (u[n] = u[l[t]]);
            var d = [];
            for (n = 0, r = this.faces.length; n < r; n++) {
              ((i = this.faces[n]).a = u[i.a]),
                (i.b = u[i.b]),
                (i.c = u[i.c]),
                (a = [i.a, i.b, i.c]);
              for (var p = 0; p < 3; p++)
                if (a[p] === a[(p + 1) % 3]) {
                  d.push(n);
                  break;
                }
            }
            for (n = d.length - 1; n >= 0; n--) {
              var f = d[n];
              for (
                this.faces.splice(f, 1), o = 0, s = this.faceVertexUvs.length;
                o < s;
                o++
              )
                this.faceVertexUvs[o].splice(f, 1);
            }
            var m = this.vertices.length - c.length;
            return (this.vertices = c), m;
          },
          setFromPoints: function(e) {
            this.vertices = [];
            for (var t = 0, n = e.length; t < n; t++) {
              var r = e[t];
              this.vertices.push(new ea(r.x, r.y, r.z || 0));
            }
            return this;
          },
          sortFacesByMaterialIndex: function() {
            for (var e = this.faces, t = e.length, n = 0; n < t; n++)
              e[n]._id = n;
            e.sort(function(e, t) {
              return e.materialIndex - t.materialIndex;
            });
            var r,
              i,
              a = this.faceVertexUvs[0],
              o = this.faceVertexUvs[1];
            for (
              a && a.length === t && (r = []),
                o && o.length === t && (i = []),
                n = 0;
              n < t;
              n++
            ) {
              var s = e[n]._id;
              r && r.push(a[s]), i && i.push(o[s]);
            }
            r && (this.faceVertexUvs[0] = r), i && (this.faceVertexUvs[1] = i);
          },
          toJSON: function() {
            var e = {
              metadata: {
                version: 4.5,
                type: "Geometry",
                generator: "Geometry.toJSON"
              }
            };
            if (
              ((e.uuid = this.uuid),
              (e.type = this.type),
              "" !== this.name && (e.name = this.name),
              void 0 !== this.parameters)
            ) {
              var t = this.parameters;
              for (var n in t) void 0 !== t[n] && (e[n] = t[n]);
              return e;
            }
            for (var r = [], i = 0; i < this.vertices.length; i++) {
              var a = this.vertices[i];
              r.push(a.x, a.y, a.z);
            }
            var o = [],
              s = [],
              l = {},
              c = [],
              u = {},
              h = [],
              d = {};
            for (i = 0; i < this.faces.length; i++) {
              var p = this.faces[i],
                f = void 0 !== this.faceVertexUvs[0][i],
                m = p.normal.length() > 0,
                v = p.vertexNormals.length > 0,
                g = 1 !== p.color.r || 1 !== p.color.g || 1 !== p.color.b,
                y = p.vertexColors.length > 0,
                b = 0;
              if (
                ((b = M(b, 0, 0)),
                (b = M(b, 1, !0)),
                (b = M(b, 2, !1)),
                (b = M(b, 3, f)),
                (b = M(b, 4, m)),
                (b = M(b, 5, v)),
                (b = M(b, 6, g)),
                (b = M(b, 7, y)),
                o.push(b),
                o.push(p.a, p.b, p.c),
                o.push(p.materialIndex),
                f)
              ) {
                var x = this.faceVertexUvs[0][i];
                o.push(S(x[0]), S(x[1]), S(x[2]));
              }
              if ((m && o.push(T(p.normal)), v)) {
                var w = p.vertexNormals;
                o.push(T(w[0]), T(w[1]), T(w[2]));
              }
              if ((g && o.push(A(p.color)), y)) {
                var _ = p.vertexColors;
                o.push(A(_[0]), A(_[1]), A(_[2]));
              }
            }
            function M(e, t, n) {
              return n ? e | (1 << t) : e & ~(1 << t);
            }
            function T(e) {
              var t = e.x.toString() + e.y.toString() + e.z.toString();
              return void 0 !== l[t]
                ? l[t]
                : ((l[t] = s.length / 3), s.push(e.x, e.y, e.z), l[t]);
            }
            function A(e) {
              var t = e.r.toString() + e.g.toString() + e.b.toString();
              return void 0 !== u[t]
                ? u[t]
                : ((u[t] = c.length), c.push(e.getHex()), u[t]);
            }
            function S(e) {
              var t = e.x.toString() + e.y.toString();
              return void 0 !== d[t]
                ? d[t]
                : ((d[t] = h.length / 2), h.push(e.x, e.y), d[t]);
            }
            return (
              (e.data = {}),
              (e.data.vertices = r),
              (e.data.normals = s),
              c.length > 0 && (e.data.colors = c),
              h.length > 0 && (e.data.uvs = [h]),
              (e.data.faces = o),
              e
            );
          },
          clone: function() {
            return new As().copy(this);
          },
          copy: function(e) {
            var t, n, r, i, a, o;
            (this.vertices = []),
              (this.colors = []),
              (this.faces = []),
              (this.faceVertexUvs = [[]]),
              (this.morphTargets = []),
              (this.morphNormals = []),
              (this.skinWeights = []),
              (this.skinIndices = []),
              (this.lineDistances = []),
              (this.boundingBox = null),
              (this.boundingSphere = null),
              (this.name = e.name);
            var s = e.vertices;
            for (t = 0, n = s.length; t < n; t++)
              this.vertices.push(s[t].clone());
            var l = e.colors;
            for (t = 0, n = l.length; t < n; t++)
              this.colors.push(l[t].clone());
            var c = e.faces;
            for (t = 0, n = c.length; t < n; t++) this.faces.push(c[t].clone());
            for (t = 0, n = e.faceVertexUvs.length; t < n; t++) {
              var u = e.faceVertexUvs[t];
              for (
                void 0 === this.faceVertexUvs[t] &&
                  (this.faceVertexUvs[t] = []),
                  r = 0,
                  i = u.length;
                r < i;
                r++
              ) {
                var h = u[r],
                  d = [];
                for (a = 0, o = h.length; a < o; a++) {
                  var p = h[a];
                  d.push(p.clone());
                }
                this.faceVertexUvs[t].push(d);
              }
            }
            var f = e.morphTargets;
            for (t = 0, n = f.length; t < n; t++) {
              var m = {};
              if (((m.name = f[t].name), void 0 !== f[t].vertices))
                for (
                  m.vertices = [], r = 0, i = f[t].vertices.length;
                  r < i;
                  r++
                )
                  m.vertices.push(f[t].vertices[r].clone());
              if (void 0 !== f[t].normals)
                for (m.normals = [], r = 0, i = f[t].normals.length; r < i; r++)
                  m.normals.push(f[t].normals[r].clone());
              this.morphTargets.push(m);
            }
            var v = e.morphNormals;
            for (t = 0, n = v.length; t < n; t++) {
              var g = {};
              if (void 0 !== v[t].vertexNormals)
                for (
                  g.vertexNormals = [], r = 0, i = v[t].vertexNormals.length;
                  r < i;
                  r++
                ) {
                  var y = v[t].vertexNormals[r],
                    b = {};
                  (b.a = y.a.clone()),
                    (b.b = y.b.clone()),
                    (b.c = y.c.clone()),
                    g.vertexNormals.push(b);
                }
              if (void 0 !== v[t].faceNormals)
                for (
                  g.faceNormals = [], r = 0, i = v[t].faceNormals.length;
                  r < i;
                  r++
                )
                  g.faceNormals.push(v[t].faceNormals[r].clone());
              this.morphNormals.push(g);
            }
            var x = e.skinWeights;
            for (t = 0, n = x.length; t < n; t++)
              this.skinWeights.push(x[t].clone());
            var w = e.skinIndices;
            for (t = 0, n = w.length; t < n; t++)
              this.skinIndices.push(w[t].clone());
            var _ = e.lineDistances;
            for (t = 0, n = _.length; t < n; t++) this.lineDistances.push(_[t]);
            var M = e.boundingBox;
            null !== M && (this.boundingBox = M.clone());
            var T = e.boundingSphere;
            return (
              null !== T && (this.boundingSphere = T.clone()),
              (this.elementsNeedUpdate = e.elementsNeedUpdate),
              (this.verticesNeedUpdate = e.verticesNeedUpdate),
              (this.uvsNeedUpdate = e.uvsNeedUpdate),
              (this.normalsNeedUpdate = e.normalsNeedUpdate),
              (this.colorsNeedUpdate = e.colorsNeedUpdate),
              (this.lineDistancesNeedUpdate = e.lineDistancesNeedUpdate),
              (this.groupsNeedUpdate = e.groupsNeedUpdate),
              this
            );
          },
          dispose: function() {
            this.dispatchEvent({ type: "dispose" });
          }
        });
        class Ss extends As {
          constructor(e, t, n, r, i, a) {
            super(),
              (this.type = "BoxGeometry"),
              (this.parameters = {
                width: e,
                height: t,
                depth: n,
                widthSegments: r,
                heightSegments: i,
                depthSegments: a
              }),
              this.fromBufferGeometry(new Es(e, t, n, r, i, a)),
              this.mergeVertices();
          }
        }
        class Es extends es {
          constructor(e, t, n, r, i, a) {
            super(),
              (this.type = "BoxBufferGeometry"),
              (this.parameters = {
                width: e,
                height: t,
                depth: n,
                widthSegments: r,
                heightSegments: i,
                depthSegments: a
              });
            var o = this;
            (e = e || 1),
              (t = t || 1),
              (n = n || 1),
              (r = Math.floor(r) || 1),
              (i = Math.floor(i) || 1),
              (a = Math.floor(a) || 1);
            var s = [],
              l = [],
              c = [],
              u = [],
              h = 0,
              d = 0;
            function p(e, t, n, r, i, a, p, f, m, v, g) {
              var y,
                b,
                x = a / m,
                w = p / v,
                _ = a / 2,
                M = p / 2,
                T = f / 2,
                A = m + 1,
                S = v + 1,
                E = 0,
                R = 0,
                P = new ea();
              for (b = 0; b < S; b++) {
                var I = b * w - M;
                for (y = 0; y < A; y++) {
                  var D = y * x - _;
                  (P[e] = D * r),
                    (P[t] = I * i),
                    (P[n] = T),
                    l.push(P.x, P.y, P.z),
                    (P[e] = 0),
                    (P[t] = 0),
                    (P[n] = f > 0 ? 1 : -1),
                    c.push(P.x, P.y, P.z),
                    u.push(y / m),
                    u.push(1 - b / v),
                    (E += 1);
                }
              }
              for (b = 0; b < v; b++)
                for (y = 0; y < m; y++) {
                  var O = h + y + A * b,
                    C = h + y + A * (b + 1),
                    L = h + (y + 1) + A * (b + 1),
                    N = h + (y + 1) + A * b;
                  s.push(O, C, N), s.push(C, L, N), (R += 6);
                }
              o.addGroup(d, R, g), (d += R), (h += E);
            }
            p("z", "y", "x", -1, -1, n, t, e, a, i, 0),
              p("z", "y", "x", 1, -1, n, t, -e, a, i, 1),
              p("x", "z", "y", 1, 1, e, n, t, r, a, 2),
              p("x", "z", "y", 1, -1, e, n, -t, r, a, 3),
              p("x", "y", "z", 1, -1, e, t, n, r, i, 4),
              p("x", "y", "z", -1, -1, e, t, -n, r, i, 5),
              this.setIndex(s),
              this.setAttribute("position", new Go(l, 3)),
              this.setAttribute("normal", new Go(c, 3)),
              this.setAttribute("uv", new Go(u, 2));
          }
        }
        function Rs(e) {
          var t = {};
          for (var n in e)
            for (var r in ((t[n] = {}), e[n])) {
              var i = e[n][r];
              i &&
              (i.isColor ||
                i.isMatrix3 ||
                i.isMatrix4 ||
                i.isVector2 ||
                i.isVector3 ||
                i.isVector4 ||
                i.isTexture)
                ? (t[n][r] = i.clone())
                : Array.isArray(i)
                ? (t[n][r] = i.slice())
                : (t[n][r] = i);
            }
          return t;
        }
        function Ps(e) {
          for (var t = {}, n = 0; n < e.length; n++) {
            var r = Rs(e[n]);
            for (var i in r) t[i] = r[i];
          }
          return t;
        }
        var Is = { clone: Rs, merge: Ps },
          Ds =
            "void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
          Os = "void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";
        function Cs(e) {
          Co.call(this),
            (this.type = "ShaderMaterial"),
            (this.defines = {}),
            (this.uniforms = {}),
            (this.vertexShader = Ds),
            (this.fragmentShader = Os),
            (this.linewidth = 1),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.fog = !1),
            (this.lights = !1),
            (this.clipping = !1),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            (this.extensions = {
              derivatives: !1,
              fragDepth: !1,
              drawBuffers: !1,
              shaderTextureLOD: !1
            }),
            (this.defaultAttributeValues = {
              color: [1, 1, 1],
              uv: [0, 0],
              uv2: [0, 0]
            }),
            (this.index0AttributeName = void 0),
            (this.uniformsNeedUpdate = !1),
            void 0 !== e && (e.attributes, this.setValues(e));
        }
        function Ls() {
          Na.call(this),
            (this.type = "Camera"),
            (this.matrixWorldInverse = new ga()),
            (this.projectionMatrix = new ga()),
            (this.projectionMatrixInverse = new ga());
        }
        function Ns(e, t, n, r) {
          Ls.call(this),
            (this.type = "PerspectiveCamera"),
            (this.fov = void 0 !== e ? e : 50),
            (this.zoom = 1),
            (this.near = void 0 !== n ? n : 0.1),
            (this.far = void 0 !== r ? r : 2e3),
            (this.focus = 10),
            (this.aspect = void 0 !== t ? t : 1),
            (this.view = null),
            (this.filmGauge = 35),
            (this.filmOffset = 0),
            this.updateProjectionMatrix();
        }
        (Cs.prototype = Object.create(Co.prototype)),
          (Cs.prototype.constructor = Cs),
          (Cs.prototype.isShaderMaterial = !0),
          (Cs.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              (this.fragmentShader = e.fragmentShader),
              (this.vertexShader = e.vertexShader),
              (this.uniforms = Rs(e.uniforms)),
              (this.defines = Object.assign({}, e.defines)),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.lights = e.lights),
              (this.clipping = e.clipping),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              (this.extensions = e.extensions),
              this
            );
          }),
          (Cs.prototype.toJSON = function(e) {
            var t = Co.prototype.toJSON.call(this, e);
            for (var n in ((t.uniforms = {}), this.uniforms)) {
              var r = this.uniforms[n].value;
              r && r.isTexture
                ? (t.uniforms[n] = { type: "t", value: r.toJSON(e).uuid })
                : r && r.isColor
                ? (t.uniforms[n] = { type: "c", value: r.getHex() })
                : r && r.isVector2
                ? (t.uniforms[n] = { type: "v2", value: r.toArray() })
                : r && r.isVector3
                ? (t.uniforms[n] = { type: "v3", value: r.toArray() })
                : r && r.isVector4
                ? (t.uniforms[n] = { type: "v4", value: r.toArray() })
                : r && r.isMatrix3
                ? (t.uniforms[n] = { type: "m3", value: r.toArray() })
                : r && r.isMatrix4
                ? (t.uniforms[n] = { type: "m4", value: r.toArray() })
                : (t.uniforms[n] = { value: r });
            }
            Object.keys(this.defines).length > 0 && (t.defines = this.defines),
              (t.vertexShader = this.vertexShader),
              (t.fragmentShader = this.fragmentShader);
            var i = {};
            for (var a in this.extensions)
              !0 === this.extensions[a] && (i[a] = !0);
            return Object.keys(i).length > 0 && (t.extensions = i), t;
          }),
          (Ls.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: Ls,
            isCamera: !0,
            copy: function(e, t) {
              return (
                Na.prototype.copy.call(this, e, t),
                this.matrixWorldInverse.copy(e.matrixWorldInverse),
                this.projectionMatrix.copy(e.projectionMatrix),
                this.projectionMatrixInverse.copy(e.projectionMatrixInverse),
                this
              );
            },
            getWorldDirection: function(e) {
              void 0 === e && (e = new ea()), this.updateMatrixWorld(!0);
              var t = this.matrixWorld.elements;
              return e.set(-t[8], -t[9], -t[10]).normalize();
            },
            updateMatrixWorld: function(e) {
              Na.prototype.updateMatrixWorld.call(this, e),
                this.matrixWorldInverse.getInverse(this.matrixWorld);
            },
            clone: function() {
              return new this.constructor().copy(this);
            }
          })),
          (Ns.prototype = Object.assign(Object.create(Ls.prototype), {
            constructor: Ns,
            isPerspectiveCamera: !0,
            copy: function(e, t) {
              return (
                Ls.prototype.copy.call(this, e, t),
                (this.fov = e.fov),
                (this.zoom = e.zoom),
                (this.near = e.near),
                (this.far = e.far),
                (this.focus = e.focus),
                (this.aspect = e.aspect),
                (this.view =
                  null === e.view ? null : Object.assign({}, e.view)),
                (this.filmGauge = e.filmGauge),
                (this.filmOffset = e.filmOffset),
                this
              );
            },
            setFocalLength: function(e) {
              var t = (0.5 * this.getFilmHeight()) / e;
              (this.fov = 2 * Qi.RAD2DEG * Math.atan(t)),
                this.updateProjectionMatrix();
            },
            getFocalLength: function() {
              var e = Math.tan(0.5 * Qi.DEG2RAD * this.fov);
              return (0.5 * this.getFilmHeight()) / e;
            },
            getEffectiveFOV: function() {
              return (
                2 *
                Qi.RAD2DEG *
                Math.atan(Math.tan(0.5 * Qi.DEG2RAD * this.fov) / this.zoom)
              );
            },
            getFilmWidth: function() {
              return this.filmGauge * Math.min(this.aspect, 1);
            },
            getFilmHeight: function() {
              return this.filmGauge / Math.max(this.aspect, 1);
            },
            setViewOffset: function(e, t, n, r, i, a) {
              (this.aspect = e / t),
                null === this.view &&
                  (this.view = {
                    enabled: !0,
                    fullWidth: 1,
                    fullHeight: 1,
                    offsetX: 0,
                    offsetY: 0,
                    width: 1,
                    height: 1
                  }),
                (this.view.enabled = !0),
                (this.view.fullWidth = e),
                (this.view.fullHeight = t),
                (this.view.offsetX = n),
                (this.view.offsetY = r),
                (this.view.width = i),
                (this.view.height = a),
                this.updateProjectionMatrix();
            },
            clearViewOffset: function() {
              null !== this.view && (this.view.enabled = !1),
                this.updateProjectionMatrix();
            },
            updateProjectionMatrix: function() {
              var e = this.near,
                t = (e * Math.tan(0.5 * Qi.DEG2RAD * this.fov)) / this.zoom,
                n = 2 * t,
                r = this.aspect * n,
                i = -0.5 * r,
                a = this.view;
              if (null !== this.view && this.view.enabled) {
                var o = a.fullWidth,
                  s = a.fullHeight;
                (i += (a.offsetX * r) / o),
                  (t -= (a.offsetY * n) / s),
                  (r *= a.width / o),
                  (n *= a.height / s);
              }
              var l = this.filmOffset;
              0 !== l && (i += (e * l) / this.getFilmWidth()),
                this.projectionMatrix.makePerspective(
                  i,
                  i + r,
                  t,
                  t - n,
                  e,
                  this.far
                ),
                this.projectionMatrixInverse.getInverse(this.projectionMatrix);
            },
            toJSON: function(e) {
              var t = Na.prototype.toJSON.call(this, e);
              return (
                (t.object.fov = this.fov),
                (t.object.zoom = this.zoom),
                (t.object.near = this.near),
                (t.object.far = this.far),
                (t.object.focus = this.focus),
                (t.object.aspect = this.aspect),
                null !== this.view &&
                  (t.object.view = Object.assign({}, this.view)),
                (t.object.filmGauge = this.filmGauge),
                (t.object.filmOffset = this.filmOffset),
                t
              );
            }
          }));
        var Fs = 90,
          ks = 1;
        function Us(e, t, n, r) {
          Na.call(this), (this.type = "CubeCamera");
          var i = new Ns(Fs, ks, e, t);
          i.up.set(0, -1, 0), i.lookAt(new ea(1, 0, 0)), this.add(i);
          var a = new Ns(Fs, ks, e, t);
          a.up.set(0, -1, 0), a.lookAt(new ea(-1, 0, 0)), this.add(a);
          var o = new Ns(Fs, ks, e, t);
          o.up.set(0, 0, 1), o.lookAt(new ea(0, 1, 0)), this.add(o);
          var s = new Ns(Fs, ks, e, t);
          s.up.set(0, 0, -1), s.lookAt(new ea(0, -1, 0)), this.add(s);
          var l = new Ns(Fs, ks, e, t);
          l.up.set(0, -1, 0), l.lookAt(new ea(0, 0, 1)), this.add(l);
          var c = new Ns(Fs, ks, e, t);
          c.up.set(0, -1, 0),
            c.lookAt(new ea(0, 0, -1)),
            this.add(c),
            (r = r || { format: xr, magFilter: nr, minFilter: nr }),
            (this.renderTarget = new js(n, n, r)),
            (this.renderTarget.texture.name = "CubeCamera"),
            (this.update = function(e, t) {
              null === this.parent && this.updateMatrixWorld();
              var n = e.getRenderTarget(),
                r = this.renderTarget,
                u = r.texture.generateMipmaps;
              (r.texture.generateMipmaps = !1),
                e.setRenderTarget(r, 0),
                e.render(t, i),
                e.setRenderTarget(r, 1),
                e.render(t, a),
                e.setRenderTarget(r, 2),
                e.render(t, o),
                e.setRenderTarget(r, 3),
                e.render(t, s),
                e.setRenderTarget(r, 4),
                e.render(t, l),
                (r.texture.generateMipmaps = u),
                e.setRenderTarget(r, 5),
                e.render(t, c),
                e.setRenderTarget(n);
            }),
            (this.clear = function(e, t, n, r) {
              for (
                var i = e.getRenderTarget(), a = this.renderTarget, o = 0;
                o < 6;
                o++
              )
                e.setRenderTarget(a, o), e.clear(t, n, r);
              e.setRenderTarget(i);
            });
        }
        function js(e, t, n) {
          la.call(this, e, t, n);
        }
        function Bs(e, t, n, r, i, a, o, s, l, c, u, h) {
          oa.call(this, null, a, o, s, l, c, r, i, u, h),
            (this.image = { data: e || null, width: t || 1, height: n || 1 }),
            (this.magFilter = void 0 !== l ? l : Jn),
            (this.minFilter = void 0 !== c ? c : Jn),
            (this.generateMipmaps = !1),
            (this.flipY = !1),
            (this.unpackAlignment = 1),
            (this.needsUpdate = !0);
        }
        (Us.prototype = Object.create(Na.prototype)),
          (Us.prototype.constructor = Us),
          (js.prototype = Object.create(la.prototype)),
          (js.prototype.constructor = js),
          (js.prototype.isWebGLRenderTargetCube = !0),
          (js.prototype.fromEquirectangularTexture = function(e, t) {
            (this.texture.type = t.type),
              (this.texture.format = t.format),
              (this.texture.encoding = t.encoding);
            var n = new Fa(),
              r = {
                uniforms: { tEquirect: { value: null } },
                vertexShader: [
                  "varying vec3 vWorldDirection;",
                  "vec3 transformDirection( in vec3 dir, in mat4 matrix ) {",
                  "\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );",
                  "}",
                  "void main() {",
                  "\tvWorldDirection = transformDirection( position, modelMatrix );",
                  "\t#include <begin_vertex>",
                  "\t#include <project_vertex>",
                  "}"
                ].join("\n"),
                fragmentShader: [
                  "uniform sampler2D tEquirect;",
                  "varying vec3 vWorldDirection;",
                  "#define RECIPROCAL_PI 0.31830988618",
                  "#define RECIPROCAL_PI2 0.15915494",
                  "void main() {",
                  "\tvec3 direction = normalize( vWorldDirection );",
                  "\tvec2 sampleUV;",
                  "\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;",
                  "\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;",
                  "\tgl_FragColor = texture2D( tEquirect, sampleUV );",
                  "}"
                ].join("\n")
              },
              i = new Cs({
                type: "CubemapFromEquirect",
                uniforms: Rs(r.uniforms),
                vertexShader: r.vertexShader,
                fragmentShader: r.fragmentShader,
                side: Yt,
                blending: en
              });
            i.uniforms.tEquirect.value = t;
            var a = new ys(new Es(5, 5, 5), i);
            n.add(a);
            var o = new Us(1, 10, 1);
            return (
              (o.renderTarget = this),
              (o.renderTarget.texture.name = "CubeCameraTexture"),
              o.update(e, n),
              a.geometry.dispose(),
              a.material.dispose(),
              this
            );
          }),
          (Bs.prototype = Object.create(oa.prototype)),
          (Bs.prototype.constructor = Bs),
          (Bs.prototype.isDataTexture = !0);
        var zs = new $a(),
          Vs = new ea();
        function Gs(e, t, n, r, i, a) {
          this.planes = [
            void 0 !== e ? e : new ho(),
            void 0 !== t ? t : new ho(),
            void 0 !== n ? n : new ho(),
            void 0 !== r ? r : new ho(),
            void 0 !== i ? i : new ho(),
            void 0 !== a ? a : new ho()
          ];
        }
        Object.assign(Gs.prototype, {
          set: function(e, t, n, r, i, a) {
            var o = this.planes;
            return (
              o[0].copy(e),
              o[1].copy(t),
              o[2].copy(n),
              o[3].copy(r),
              o[4].copy(i),
              o[5].copy(a),
              this
            );
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            for (var t = this.planes, n = 0; n < 6; n++) t[n].copy(e.planes[n]);
            return this;
          },
          setFromMatrix: function(e) {
            var t = this.planes,
              n = e.elements,
              r = n[0],
              i = n[1],
              a = n[2],
              o = n[3],
              s = n[4],
              l = n[5],
              c = n[6],
              u = n[7],
              h = n[8],
              d = n[9],
              p = n[10],
              f = n[11],
              m = n[12],
              v = n[13],
              g = n[14],
              y = n[15];
            return (
              t[0].setComponents(o - r, u - s, f - h, y - m).normalize(),
              t[1].setComponents(o + r, u + s, f + h, y + m).normalize(),
              t[2].setComponents(o + i, u + l, f + d, y + v).normalize(),
              t[3].setComponents(o - i, u - l, f - d, y - v).normalize(),
              t[4].setComponents(o - a, u - c, f - p, y - g).normalize(),
              t[5].setComponents(o + a, u + c, f + p, y + g).normalize(),
              this
            );
          },
          intersectsObject: function(e) {
            var t = e.geometry;
            return (
              null === t.boundingSphere && t.computeBoundingSphere(),
              zs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),
              this.intersectsSphere(zs)
            );
          },
          intersectsSprite: function(e) {
            return (
              zs.center.set(0, 0, 0),
              (zs.radius = 0.7071067811865476),
              zs.applyMatrix4(e.matrixWorld),
              this.intersectsSphere(zs)
            );
          },
          intersectsSphere: function(e) {
            for (
              var t = this.planes, n = e.center, r = -e.radius, i = 0;
              i < 6;
              i++
            )
              if (t[i].distanceToPoint(n) < r) return !1;
            return !0;
          },
          intersectsBox: function(e) {
            for (var t = this.planes, n = 0; n < 6; n++) {
              var r = t[n];
              if (
                ((Vs.x = r.normal.x > 0 ? e.max.x : e.min.x),
                (Vs.y = r.normal.y > 0 ? e.max.y : e.min.y),
                (Vs.z = r.normal.z > 0 ? e.max.z : e.min.z),
                r.distanceToPoint(Vs) < 0)
              )
                return !1;
            }
            return !0;
          },
          containsPoint: function(e) {
            for (var t = this.planes, n = 0; n < 6; n++)
              if (t[n].distanceToPoint(e) < 0) return !1;
            return !0;
          }
        });
        var Hs = {
            alphamap_fragment:
              "#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",
            alphamap_pars_fragment:
              "#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
            alphatest_fragment:
              "#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",
            aomap_fragment:
              "#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",
            aomap_pars_fragment:
              "#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",
            begin_vertex: "vec3 transformed = vec3( position );",
            beginnormal_vertex:
              "vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",
            bsdfs:
              "vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",
            bumpmap_pars_fragment:
              "#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
            clipping_planes_fragment:
              "#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",
            clipping_planes_pars_fragment:
              "#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",
            clipping_planes_pars_vertex:
              "#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",
            clipping_planes_vertex:
              "#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",
            color_fragment:
              "#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",
            color_pars_fragment:
              "#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",
            color_pars_vertex:
              "#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",
            color_vertex: "#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",
            common:
              "#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",
            cube_uv_reflection_fragment:
              "#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",
            defaultnormal_vertex:
              "vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",
            displacementmap_pars_vertex:
              "#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",
            displacementmap_vertex:
              "#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",
            emissivemap_fragment:
              "#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",
            emissivemap_pars_fragment:
              "#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",
            encodings_fragment:
              "gl_FragColor = linearToOutputTexel( gl_FragColor );",
            encodings_pars_fragment:
              "\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",
            envmap_fragment:
              "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
            envmap_common_pars_fragment:
              "#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",
            envmap_pars_fragment:
              "#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
            envmap_pars_vertex:
              "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",
            envmap_physical_pars_fragment:
              "#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",
            envmap_vertex:
              "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
            fog_vertex: "#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",
            fog_pars_vertex:
              "#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",
            fog_fragment:
              "#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",
            fog_pars_fragment:
              "#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
            gradientmap_pars_fragment:
              "#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",
            lightmap_fragment:
              "#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",
            lightmap_pars_fragment:
              "#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",
            lights_lambert_vertex:
              "vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",
            lights_pars_begin:
              "uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",
            lights_phong_fragment:
              "BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",
            lights_phong_pars_fragment:
              "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",
            lights_physical_fragment:
              "PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = clamp( clearcoatRoughness, 0.04, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",
            lights_physical_pars_fragment:
              "struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
            lights_fragment_begin:
              "\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",
            lights_fragment_maps:
              "#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",
            lights_fragment_end:
              "#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",
            logdepthbuf_fragment:
              "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
            logdepthbuf_pars_fragment:
              "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",
            logdepthbuf_pars_vertex:
              "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",
            logdepthbuf_vertex:
              "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",
            map_fragment:
              "#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",
            map_pars_fragment:
              "#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",
            map_particle_fragment:
              "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",
            map_particle_pars_fragment:
              "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
            metalnessmap_fragment:
              "float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",
            metalnessmap_pars_fragment:
              "#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",
            morphnormal_vertex:
              "#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",
            morphtarget_pars_vertex:
              "#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
            morphtarget_vertex:
              "#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",
            normal_fragment_begin:
              "#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",
            normal_fragment_maps:
              "#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",
            normalmap_pars_fragment:
              "#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",
            clearcoat_normal_fragment_begin:
              "#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",
            clearcoat_normal_fragment_maps:
              "#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",
            clearcoat_normalmap_pars_fragment:
              "#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",
            packing:
              "vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpack2HalfToRGBA( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",
            premultiplied_alpha_fragment:
              "#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",
            project_vertex:
              "vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",
            dithering_fragment:
              "#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",
            dithering_pars_fragment:
              "#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",
            roughnessmap_fragment:
              "float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",
            roughnessmap_pars_fragment:
              "#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",
            shadowmap_pars_fragment:
              "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpack2HalfToRGBA( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
            shadowmap_pars_vertex:
              "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
            shadowmap_vertex:
              "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",
            shadowmask_pars_fragment:
              "float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",
            skinbase_vertex:
              "#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",
            skinning_pars_vertex:
              "#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",
            skinning_vertex:
              "#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",
            skinnormal_vertex:
              "#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
            specularmap_fragment:
              "float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",
            specularmap_pars_fragment:
              "#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",
            tonemapping_fragment:
              "#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",
            tonemapping_pars_fragment:
              "#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",
            uv_pars_fragment:
              "#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",
            uv_pars_vertex:
              "#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",
            uv_vertex:
              "#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",
            uv2_pars_fragment:
              "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",
            uv2_pars_vertex:
              "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
            uv2_vertex:
              "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",
            worldpos_vertex:
              "#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",
            background_frag:
              "uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
            background_vert:
              "varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",
            cube_frag:
              "uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
            cube_vert:
              "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",
            depth_frag:
              "#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",
            depth_vert:
              "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",
            distanceRGBA_frag:
              "#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",
            distanceRGBA_vert:
              "#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",
            equirect_frag:
              "uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
            equirect_vert:
              "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",
            linedashed_frag:
              "uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
            linedashed_vert:
              "uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
            meshbasic_frag:
              "uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
            meshbasic_vert:
              "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",
            meshlambert_frag:
              "uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
            meshlambert_vert:
              "#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
            meshmatcap_frag:
              "#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
            meshmatcap_vert:
              "#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",
            meshphong_frag:
              "#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
            meshphong_vert:
              "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
            meshphysical_frag:
              "#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
            meshphysical_vert:
              "#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
            normal_frag:
              "#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",
            normal_vert:
              "#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",
            points_frag:
              "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
            points_vert:
              "uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",
            shadow_frag:
              "uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",
            shadow_vert:
              "#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
            sprite_frag:
              "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
            sprite_vert:
              "uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"
          },
          Xs = {
            common: {
              diffuse: { value: new Eo(15658734) },
              opacity: { value: 1 },
              map: { value: null },
              uvTransform: { value: new ra() },
              alphaMap: { value: null }
            },
            specularmap: { specularMap: { value: null } },
            envmap: {
              envMap: { value: null },
              flipEnvMap: { value: -1 },
              reflectivity: { value: 1 },
              refractionRatio: { value: 0.98 },
              maxMipLevel: { value: 0 }
            },
            aomap: { aoMap: { value: null }, aoMapIntensity: { value: 1 } },
            lightmap: {
              lightMap: { value: null },
              lightMapIntensity: { value: 1 }
            },
            emissivemap: { emissiveMap: { value: null } },
            bumpmap: { bumpMap: { value: null }, bumpScale: { value: 1 } },
            normalmap: {
              normalMap: { value: null },
              normalScale: { value: new Zi(1, 1) }
            },
            displacementmap: {
              displacementMap: { value: null },
              displacementScale: { value: 1 },
              displacementBias: { value: 0 }
            },
            roughnessmap: { roughnessMap: { value: null } },
            metalnessmap: { metalnessMap: { value: null } },
            gradientmap: { gradientMap: { value: null } },
            fog: {
              fogDensity: { value: 25e-5 },
              fogNear: { value: 1 },
              fogFar: { value: 2e3 },
              fogColor: { value: new Eo(16777215) }
            },
            lights: {
              ambientLightColor: { value: [] },
              lightProbe: { value: [] },
              directionalLights: {
                value: [],
                properties: {
                  direction: {},
                  color: {},
                  shadow: {},
                  shadowBias: {},
                  shadowRadius: {},
                  shadowMapSize: {}
                }
              },
              directionalShadowMap: { value: [] },
              directionalShadowMatrix: { value: [] },
              spotLights: {
                value: [],
                properties: {
                  color: {},
                  position: {},
                  direction: {},
                  distance: {},
                  coneCos: {},
                  penumbraCos: {},
                  decay: {},
                  shadow: {},
                  shadowBias: {},
                  shadowRadius: {},
                  shadowMapSize: {}
                }
              },
              spotShadowMap: { value: [] },
              spotShadowMatrix: { value: [] },
              pointLights: {
                value: [],
                properties: {
                  color: {},
                  position: {},
                  decay: {},
                  distance: {},
                  shadow: {},
                  shadowBias: {},
                  shadowRadius: {},
                  shadowMapSize: {},
                  shadowCameraNear: {},
                  shadowCameraFar: {}
                }
              },
              pointShadowMap: { value: [] },
              pointShadowMatrix: { value: [] },
              hemisphereLights: {
                value: [],
                properties: { direction: {}, skyColor: {}, groundColor: {} }
              },
              rectAreaLights: {
                value: [],
                properties: { color: {}, position: {}, width: {}, height: {} }
              }
            },
            points: {
              diffuse: { value: new Eo(15658734) },
              opacity: { value: 1 },
              size: { value: 1 },
              scale: { value: 1 },
              map: { value: null },
              alphaMap: { value: null },
              uvTransform: { value: new ra() }
            },
            sprite: {
              diffuse: { value: new Eo(15658734) },
              opacity: { value: 1 },
              center: { value: new Zi(0.5, 0.5) },
              rotation: { value: 0 },
              map: { value: null },
              alphaMap: { value: null },
              uvTransform: { value: new ra() }
            }
          },
          Ws = {
            basic: {
              uniforms: Ps([
                Xs.common,
                Xs.specularmap,
                Xs.envmap,
                Xs.aomap,
                Xs.lightmap,
                Xs.fog
              ]),
              vertexShader: Hs.meshbasic_vert,
              fragmentShader: Hs.meshbasic_frag
            },
            lambert: {
              uniforms: Ps([
                Xs.common,
                Xs.specularmap,
                Xs.envmap,
                Xs.aomap,
                Xs.lightmap,
                Xs.emissivemap,
                Xs.fog,
                Xs.lights,
                { emissive: { value: new Eo(0) } }
              ]),
              vertexShader: Hs.meshlambert_vert,
              fragmentShader: Hs.meshlambert_frag
            },
            phong: {
              uniforms: Ps([
                Xs.common,
                Xs.specularmap,
                Xs.envmap,
                Xs.aomap,
                Xs.lightmap,
                Xs.emissivemap,
                Xs.bumpmap,
                Xs.normalmap,
                Xs.displacementmap,
                Xs.gradientmap,
                Xs.fog,
                Xs.lights,
                {
                  emissive: { value: new Eo(0) },
                  specular: { value: new Eo(1118481) },
                  shininess: { value: 30 }
                }
              ]),
              vertexShader: Hs.meshphong_vert,
              fragmentShader: Hs.meshphong_frag
            },
            standard: {
              uniforms: Ps([
                Xs.common,
                Xs.envmap,
                Xs.aomap,
                Xs.lightmap,
                Xs.emissivemap,
                Xs.bumpmap,
                Xs.normalmap,
                Xs.displacementmap,
                Xs.roughnessmap,
                Xs.metalnessmap,
                Xs.fog,
                Xs.lights,
                {
                  emissive: { value: new Eo(0) },
                  roughness: { value: 0.5 },
                  metalness: { value: 0.5 },
                  envMapIntensity: { value: 1 }
                }
              ]),
              vertexShader: Hs.meshphysical_vert,
              fragmentShader: Hs.meshphysical_frag
            },
            matcap: {
              uniforms: Ps([
                Xs.common,
                Xs.bumpmap,
                Xs.normalmap,
                Xs.displacementmap,
                Xs.fog,
                { matcap: { value: null } }
              ]),
              vertexShader: Hs.meshmatcap_vert,
              fragmentShader: Hs.meshmatcap_frag
            },
            points: {
              uniforms: Ps([Xs.points, Xs.fog]),
              vertexShader: Hs.points_vert,
              fragmentShader: Hs.points_frag
            },
            dashed: {
              uniforms: Ps([
                Xs.common,
                Xs.fog,
                {
                  scale: { value: 1 },
                  dashSize: { value: 1 },
                  totalSize: { value: 2 }
                }
              ]),
              vertexShader: Hs.linedashed_vert,
              fragmentShader: Hs.linedashed_frag
            },
            depth: {
              uniforms: Ps([Xs.common, Xs.displacementmap]),
              vertexShader: Hs.depth_vert,
              fragmentShader: Hs.depth_frag
            },
            normal: {
              uniforms: Ps([
                Xs.common,
                Xs.bumpmap,
                Xs.normalmap,
                Xs.displacementmap,
                { opacity: { value: 1 } }
              ]),
              vertexShader: Hs.normal_vert,
              fragmentShader: Hs.normal_frag
            },
            sprite: {
              uniforms: Ps([Xs.sprite, Xs.fog]),
              vertexShader: Hs.sprite_vert,
              fragmentShader: Hs.sprite_frag
            },
            background: {
              uniforms: {
                uvTransform: { value: new ra() },
                t2D: { value: null }
              },
              vertexShader: Hs.background_vert,
              fragmentShader: Hs.background_frag
            },
            cube: {
              uniforms: {
                tCube: { value: null },
                tFlip: { value: -1 },
                opacity: { value: 1 }
              },
              vertexShader: Hs.cube_vert,
              fragmentShader: Hs.cube_frag
            },
            equirect: {
              uniforms: { tEquirect: { value: null } },
              vertexShader: Hs.equirect_vert,
              fragmentShader: Hs.equirect_frag
            },
            distanceRGBA: {
              uniforms: Ps([
                Xs.common,
                Xs.displacementmap,
                {
                  referencePosition: { value: new ea() },
                  nearDistance: { value: 1 },
                  farDistance: { value: 1e3 }
                }
              ]),
              vertexShader: Hs.distanceRGBA_vert,
              fragmentShader: Hs.distanceRGBA_frag
            },
            shadow: {
              uniforms: Ps([
                Xs.lights,
                Xs.fog,
                { color: { value: new Eo(0) }, opacity: { value: 1 } }
              ]),
              vertexShader: Hs.shadow_vert,
              fragmentShader: Hs.shadow_frag
            }
          };
        function Ys() {
          var e = null,
            t = !1,
            n = null;
          function r(i, a) {
            !1 !== t && (n(i, a), e.requestAnimationFrame(r));
          }
          return {
            start: function() {
              !0 !== t && null !== n && (e.requestAnimationFrame(r), (t = !0));
            },
            stop: function() {
              t = !1;
            },
            setAnimationLoop: function(e) {
              n = e;
            },
            setContext: function(t) {
              e = t;
            }
          };
        }
        function qs(e) {
          var t = new WeakMap();
          return {
            get: function(e) {
              return e.isInterleavedBufferAttribute && (e = e.data), t.get(e);
            },
            remove: function(n) {
              n.isInterleavedBufferAttribute && (n = n.data);
              var r = t.get(n);
              r && (e.deleteBuffer(r.buffer), t.delete(n));
            },
            update: function(n, r) {
              n.isInterleavedBufferAttribute && (n = n.data);
              var i = t.get(n);
              void 0 === i
                ? t.set(
                    n,
                    (function(t, n) {
                      var r = t.array,
                        i = t.usage,
                        a = e.createBuffer();
                      e.bindBuffer(n, a),
                        e.bufferData(n, r, i),
                        t.onUploadCallback();
                      var o = 5126;
                      return (
                        r instanceof Float32Array
                          ? (o = 5126)
                          : r instanceof Float64Array ||
                            (r instanceof Uint16Array
                              ? (o = 5123)
                              : r instanceof Int16Array
                              ? (o = 5122)
                              : r instanceof Uint32Array
                              ? (o = 5125)
                              : r instanceof Int32Array
                              ? (o = 5124)
                              : r instanceof Int8Array
                              ? (o = 5120)
                              : r instanceof Uint8Array && (o = 5121)),
                        {
                          buffer: a,
                          type: o,
                          bytesPerElement: r.BYTES_PER_ELEMENT,
                          version: t.version
                        }
                      );
                    })(n, r)
                  )
                : i.version < n.version &&
                  ((function(t, n, r) {
                    var i = n.array,
                      a = n.updateRange;
                    e.bindBuffer(r, t),
                      -1 === a.count
                        ? e.bufferSubData(r, 0, i)
                        : (e.bufferSubData(
                            r,
                            a.offset * i.BYTES_PER_ELEMENT,
                            i.subarray(a.offset, a.offset + a.count)
                          ),
                          (a.count = -1));
                  })(i.buffer, n, r),
                  (i.version = n.version));
            }
          };
        }
        function Qs(e, t, n, r) {
          As.call(this),
            (this.type = "PlaneGeometry"),
            (this.parameters = {
              width: e,
              height: t,
              widthSegments: n,
              heightSegments: r
            }),
            this.fromBufferGeometry(new Zs(e, t, n, r)),
            this.mergeVertices();
        }
        function Zs(e, t, n, r) {
          es.call(this),
            (this.type = "PlaneBufferGeometry"),
            (this.parameters = {
              width: e,
              height: t,
              widthSegments: n,
              heightSegments: r
            });
          var i,
            a,
            o = (e = e || 1) / 2,
            s = (t = t || 1) / 2,
            l = Math.floor(n) || 1,
            c = Math.floor(r) || 1,
            u = l + 1,
            h = c + 1,
            d = e / l,
            p = t / c,
            f = [],
            m = [],
            v = [],
            g = [];
          for (a = 0; a < h; a++) {
            var y = a * p - s;
            for (i = 0; i < u; i++) {
              var b = i * d - o;
              m.push(b, -y, 0),
                v.push(0, 0, 1),
                g.push(i / l),
                g.push(1 - a / c);
            }
          }
          for (a = 0; a < c; a++)
            for (i = 0; i < l; i++) {
              var x = i + u * a,
                w = i + u * (a + 1),
                _ = i + 1 + u * (a + 1),
                M = i + 1 + u * a;
              f.push(x, w, M), f.push(w, _, M);
            }
          this.setIndex(f),
            this.setAttribute("position", new Go(m, 3)),
            this.setAttribute("normal", new Go(v, 3)),
            this.setAttribute("uv", new Go(g, 2));
        }
        function Js(e, t, n, r) {
          var i,
            a,
            o = new Eo(0),
            s = 0,
            l = null,
            c = 0;
          function u(e, n) {
            t.buffers.color.setClear(e.r, e.g, e.b, n, r);
          }
          return {
            getClearColor: function() {
              return o;
            },
            setClearColor: function(e, t) {
              o.set(e), u(o, (s = void 0 !== t ? t : 1));
            },
            getClearAlpha: function() {
              return s;
            },
            setClearAlpha: function(e) {
              u(o, (s = e));
            },
            render: function(t, r, h, d) {
              var p = r.background,
                f = e.vr,
                m = f.getSession && f.getSession();
              if (
                (m && "additive" === m.environmentBlendMode && (p = null),
                null === p
                  ? (u(o, s), (l = null), (c = 0))
                  : p && p.isColor && (u(p, 1), (d = !0), (l = null), (c = 0)),
                (e.autoClear || d) &&
                  e.clear(
                    e.autoClearColor,
                    e.autoClearDepth,
                    e.autoClearStencil
                  ),
                p && (p.isCubeTexture || p.isWebGLRenderTargetCube))
              ) {
                void 0 === a &&
                  ((a = new ys(
                    new Es(1, 1, 1),
                    new Cs({
                      type: "BackgroundCubeMaterial",
                      uniforms: Rs(Ws.cube.uniforms),
                      vertexShader: Ws.cube.vertexShader,
                      fragmentShader: Ws.cube.fragmentShader,
                      side: Yt,
                      depthTest: !1,
                      depthWrite: !1,
                      fog: !1
                    })
                  )).geometry.deleteAttribute("normal"),
                  a.geometry.deleteAttribute("uv"),
                  (a.onBeforeRender = function(e, t, n) {
                    this.matrixWorld.copyPosition(n.matrixWorld);
                  }),
                  Object.defineProperty(a.material, "map", {
                    get: function() {
                      return this.uniforms.tCube.value;
                    }
                  }),
                  n.update(a));
                var v = p.isWebGLRenderTargetCube ? p.texture : p;
                (a.material.uniforms.tCube.value = v),
                  (a.material.uniforms.tFlip.value = p.isWebGLRenderTargetCube
                    ? 1
                    : -1),
                  (l === p && c === v.version) ||
                    ((a.material.needsUpdate = !0), (l = p), (c = v.version)),
                  t.unshift(a, a.geometry, a.material, 0, 0, null);
              } else
                p &&
                  p.isTexture &&
                  (void 0 === i &&
                    ((i = new ys(
                      new Zs(2, 2),
                      new Cs({
                        type: "BackgroundMaterial",
                        uniforms: Rs(Ws.background.uniforms),
                        vertexShader: Ws.background.vertexShader,
                        fragmentShader: Ws.background.fragmentShader,
                        side: Wt,
                        depthTest: !1,
                        depthWrite: !1,
                        fog: !1
                      })
                    )).geometry.deleteAttribute("normal"),
                    Object.defineProperty(i.material, "map", {
                      get: function() {
                        return this.uniforms.t2D.value;
                      }
                    }),
                    n.update(i)),
                  (i.material.uniforms.t2D.value = p),
                  !0 === p.matrixAutoUpdate && p.updateMatrix(),
                  i.material.uniforms.uvTransform.value.copy(p.matrix),
                  (l === p && c === p.version) ||
                    ((i.material.needsUpdate = !0), (l = p), (c = p.version)),
                  t.unshift(i, i.geometry, i.material, 0, 0, null));
            }
          };
        }
        function Ks(e, t, n, r) {
          var i,
            a = r.isWebGL2;
          (this.setMode = function(e) {
            i = e;
          }),
            (this.render = function(t, r) {
              e.drawArrays(i, t, r), n.update(r, i);
            }),
            (this.renderInstances = function(r, o, s, l) {
              if (0 !== l) {
                var c, u;
                if (a) (c = e), (u = "drawArraysInstanced");
                else if (
                  ((u = "drawArraysInstancedANGLE"),
                  null === (c = t.get("ANGLE_instanced_arrays")))
                )
                  return;
                c[u](i, o, s, l), n.update(s, i, l);
              }
            });
        }
        function $s(e, t, n) {
          var r;
          function i(t) {
            if ("highp" === t) {
              if (
                e.getShaderPrecisionFormat(35633, 36338).precision > 0 &&
                e.getShaderPrecisionFormat(35632, 36338).precision > 0
              )
                return "highp";
              t = "mediump";
            }
            return "mediump" === t &&
              e.getShaderPrecisionFormat(35633, 36337).precision > 0 &&
              e.getShaderPrecisionFormat(35632, 36337).precision > 0
              ? "mediump"
              : "lowp";
          }
          var a =
              ("undefined" != typeof WebGL2RenderingContext &&
                e instanceof WebGL2RenderingContext) ||
              ("undefined" != typeof WebGL2ComputeRenderingContext &&
                e instanceof WebGL2ComputeRenderingContext),
            o = void 0 !== n.precision ? n.precision : "highp",
            s = i(o);
          s !== o && (o = s);
          var l = !0 === n.logarithmicDepthBuffer,
            c = e.getParameter(34930),
            u = e.getParameter(35660),
            h = e.getParameter(3379),
            d = e.getParameter(34076),
            p = e.getParameter(34921),
            f = e.getParameter(36347),
            m = e.getParameter(36348),
            v = e.getParameter(36349),
            g = u > 0,
            y = a || !!t.get("OES_texture_float");
          return {
            isWebGL2: a,
            getMaxAnisotropy: function() {
              if (void 0 !== r) return r;
              var n = t.get("EXT_texture_filter_anisotropic");
              return (r =
                null !== n
                  ? e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)
                  : 0);
            },
            getMaxPrecision: i,
            precision: o,
            logarithmicDepthBuffer: l,
            maxTextures: c,
            maxVertexTextures: u,
            maxTextureSize: h,
            maxCubemapSize: d,
            maxAttributes: p,
            maxVertexUniforms: f,
            maxVaryings: m,
            maxFragmentUniforms: v,
            vertexTextures: g,
            floatFragmentTextures: y,
            floatVertexTextures: g && y,
            maxSamples: a ? e.getParameter(36183) : 0
          };
        }
        function el() {
          var e = this,
            t = null,
            n = 0,
            r = !1,
            i = !1,
            a = new ho(),
            o = new ra(),
            s = { value: null, needsUpdate: !1 };
          function l() {
            s.value !== t && ((s.value = t), (s.needsUpdate = n > 0)),
              (e.numPlanes = n),
              (e.numIntersection = 0);
          }
          function c(t, n, r, i) {
            var l = null !== t ? t.length : 0,
              c = null;
            if (0 !== l) {
              if (((c = s.value), !0 !== i || null === c)) {
                var u = r + 4 * l,
                  h = n.matrixWorldInverse;
                o.getNormalMatrix(h),
                  (null === c || c.length < u) && (c = new Float32Array(u));
                for (var d = 0, p = r; d !== l; ++d, p += 4)
                  a.copy(t[d]).applyMatrix4(h, o),
                    a.normal.toArray(c, p),
                    (c[p + 3] = a.constant);
              }
              (s.value = c), (s.needsUpdate = !0);
            }
            return (e.numPlanes = l), c;
          }
          (this.uniform = s),
            (this.numPlanes = 0),
            (this.numIntersection = 0),
            (this.init = function(e, i, a) {
              var o = 0 !== e.length || i || 0 !== n || r;
              return (r = i), (t = c(e, a, 0)), (n = e.length), o;
            }),
            (this.beginShadows = function() {
              (i = !0), c(null);
            }),
            (this.endShadows = function() {
              (i = !1), l();
            }),
            (this.setState = function(e, a, o, u, h, d) {
              if (!r || null === e || 0 === e.length || (i && !o))
                i ? c(null) : l();
              else {
                var p = i ? 0 : n,
                  f = 4 * p,
                  m = h.clippingState || null;
                (s.value = m), (m = c(e, u, f, d));
                for (var v = 0; v !== f; ++v) m[v] = t[v];
                (h.clippingState = m),
                  (this.numIntersection = a ? this.numPlanes : 0),
                  (this.numPlanes += p);
              }
            });
        }
        function tl(e) {
          var t = {};
          return {
            get: function(n) {
              if (void 0 !== t[n]) return t[n];
              var r;
              switch (n) {
                case "WEBGL_depth_texture":
                  r =
                    e.getExtension("WEBGL_depth_texture") ||
                    e.getExtension("MOZ_WEBGL_depth_texture") ||
                    e.getExtension("WEBKIT_WEBGL_depth_texture");
                  break;
                case "EXT_texture_filter_anisotropic":
                  r =
                    e.getExtension("EXT_texture_filter_anisotropic") ||
                    e.getExtension("MOZ_EXT_texture_filter_anisotropic") ||
                    e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                  break;
                case "WEBGL_compressed_texture_s3tc":
                  r =
                    e.getExtension("WEBGL_compressed_texture_s3tc") ||
                    e.getExtension("MOZ_WEBGL_compressed_texture_s3tc") ||
                    e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                  break;
                case "WEBGL_compressed_texture_pvrtc":
                  r =
                    e.getExtension("WEBGL_compressed_texture_pvrtc") ||
                    e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                  break;
                default:
                  r = e.getExtension(n);
              }
              return (t[n] = r), r;
            }
          };
        }
        function nl(e, t, n) {
          var r = new WeakMap(),
            i = new WeakMap();
          function a(e) {
            var o = e.target,
              s = r.get(o);
            for (var l in (null !== s.index && t.remove(s.index), s.attributes))
              t.remove(s.attributes[l]);
            o.removeEventListener("dispose", a), r.delete(o);
            var c = i.get(s);
            c && (t.remove(c), i.delete(s)), n.memory.geometries--;
          }
          function o(e) {
            var n = [],
              r = e.index,
              a = e.attributes.position,
              o = 0;
            if (null !== r) {
              var s = r.array;
              o = r.version;
              for (var l = 0, c = s.length; l < c; l += 3) {
                var u = s[l + 0],
                  h = s[l + 1],
                  d = s[l + 2];
                n.push(u, h, h, d, d, u);
              }
            } else
              for (
                s = a.array, o = a.version, l = 0, c = s.length / 3 - 1;
                l < c;
                l += 3
              )
                (u = l + 0), (h = l + 1), (d = l + 2), n.push(u, h, h, d, d, u);
            var p = new (Wo(n) > 65535 ? Vo : Bo)(n, 1);
            (p.version = o), t.update(p, 34963);
            var f = i.get(e);
            f && t.remove(f), i.set(e, p);
          }
          return {
            get: function(e, t) {
              var i = r.get(t);
              return (
                i ||
                (t.addEventListener("dispose", a),
                t.isBufferGeometry
                  ? (i = t)
                  : t.isGeometry &&
                    (void 0 === t._bufferGeometry &&
                      (t._bufferGeometry = new es().setFromObject(e)),
                    (i = t._bufferGeometry)),
                r.set(t, i),
                n.memory.geometries++,
                i)
              );
            },
            update: function(e) {
              var n = e.index,
                r = e.attributes;
              for (var i in (null !== n && t.update(n, 34963), r))
                t.update(r[i], 34962);
              var a = e.morphAttributes;
              for (var i in a)
                for (var o = a[i], s = 0, l = o.length; s < l; s++)
                  t.update(o[s], 34962);
            },
            getWireframeAttribute: function(e) {
              var t = i.get(e);
              if (t) {
                var n = e.index;
                null !== n && t.version < n.version && o(e);
              } else o(e);
              return i.get(e);
            }
          };
        }
        function rl(e, t, n, r) {
          var i,
            a,
            o,
            s = r.isWebGL2;
          (this.setMode = function(e) {
            i = e;
          }),
            (this.setIndex = function(e) {
              (a = e.type), (o = e.bytesPerElement);
            }),
            (this.render = function(t, r) {
              e.drawElements(i, r, a, t * o), n.update(r, i);
            }),
            (this.renderInstances = function(r, l, c, u) {
              if (0 !== u) {
                var h, d;
                if (s) (h = e), (d = "drawElementsInstanced");
                else if (
                  ((d = "drawElementsInstancedANGLE"),
                  null === (h = t.get("ANGLE_instanced_arrays")))
                )
                  return;
                h[d](i, c, a, l * o, u), n.update(c, i, u);
              }
            });
        }
        function il(e) {
          var t = { frame: 0, calls: 0, triangles: 0, points: 0, lines: 0 };
          return {
            memory: { geometries: 0, textures: 0 },
            render: t,
            programs: null,
            autoReset: !0,
            reset: function() {
              t.frame++,
                (t.calls = 0),
                (t.triangles = 0),
                (t.points = 0),
                (t.lines = 0);
            },
            update: function(e, n, r) {
              switch (((r = r || 1), t.calls++, n)) {
                case 4:
                  t.triangles += r * (e / 3);
                  break;
                case 5:
                case 6:
                  t.triangles += r * (e - 2);
                  break;
                case 1:
                  t.lines += r * (e / 2);
                  break;
                case 3:
                  t.lines += r * (e - 1);
                  break;
                case 2:
                  t.lines += r * e;
                  break;
                case 0:
                  t.points += r * e;
              }
            }
          };
        }
        function al(e, t) {
          return Math.abs(t[1]) - Math.abs(e[1]);
        }
        function ol(e) {
          var t = {},
            n = new Float32Array(8);
          return {
            update: function(r, i, a, o) {
              var s = r.morphTargetInfluences,
                l = s.length,
                c = t[i.id];
              if (void 0 === c) {
                c = [];
                for (var u = 0; u < l; u++) c[u] = [u, 0];
                t[i.id] = c;
              }
              var h = a.morphTargets && i.morphAttributes.position,
                d = a.morphNormals && i.morphAttributes.normal;
              for (u = 0; u < l; u++)
                0 !== (f = c[u])[1] &&
                  (h && i.deleteAttribute("morphTarget" + u),
                  d && i.deleteAttribute("morphNormal" + u));
              for (u = 0; u < l; u++) ((f = c[u])[0] = u), (f[1] = s[u]);
              c.sort(al);
              var p = 0;
              for (u = 0; u < 8; u++) {
                var f;
                if ((f = c[u])) {
                  var m = f[0],
                    v = f[1];
                  if (v) {
                    h && i.setAttribute("morphTarget" + u, h[m]),
                      d && i.setAttribute("morphNormal" + u, d[m]),
                      (n[u] = v),
                      (p += v);
                    continue;
                  }
                }
                n[u] = 0;
              }
              var g = i.morphTargetsRelative ? 1 : 1 - p;
              o.getUniforms().setValue(e, "morphTargetBaseInfluence", g),
                o.getUniforms().setValue(e, "morphTargetInfluences", n);
            }
          };
        }
        function sl(e, t, n, r) {
          var i = {};
          return {
            update: function(e) {
              var a = r.render.frame,
                o = e.geometry,
                s = t.get(e, o);
              return (
                i[s.id] !== a &&
                  (o.isGeometry && s.updateFromObject(e),
                  t.update(s),
                  (i[s.id] = a)),
                e.isInstancedMesh && n.update(e.instanceMatrix, 34962),
                s
              );
            },
            dispose: function() {
              i = {};
            }
          };
        }
        function ll(e, t, n, r, i, a, o, s, l, c) {
          (e = void 0 !== e ? e : []),
            (t = void 0 !== t ? t : zn),
            (o = void 0 !== o ? o : xr),
            oa.call(this, e, t, n, r, i, a, o, s, l, c),
            (this.flipY = !1);
        }
        function cl(e, t, n, r) {
          oa.call(this, null),
            (this.image = {
              data: e || null,
              width: t || 1,
              height: n || 1,
              depth: r || 1
            }),
            (this.magFilter = Jn),
            (this.minFilter = Jn),
            (this.wrapR = Qn),
            (this.generateMipmaps = !1),
            (this.flipY = !1),
            (this.needsUpdate = !0);
        }
        function ul(e, t, n, r) {
          oa.call(this, null),
            (this.image = {
              data: e || null,
              width: t || 1,
              height: n || 1,
              depth: r || 1
            }),
            (this.magFilter = Jn),
            (this.minFilter = Jn),
            (this.wrapR = Qn),
            (this.generateMipmaps = !1),
            (this.flipY = !1),
            (this.needsUpdate = !0);
        }
        (Ws.physical = {
          uniforms: Ps([
            Ws.standard.uniforms,
            {
              transparency: { value: 0 },
              clearcoat: { value: 0 },
              clearcoatRoughness: { value: 0 },
              sheen: { value: new Eo(0) },
              clearcoatNormalScale: { value: new Zi(1, 1) },
              clearcoatNormalMap: { value: null }
            }
          ]),
          vertexShader: Hs.meshphysical_vert,
          fragmentShader: Hs.meshphysical_frag
        }),
          (Qs.prototype = Object.create(As.prototype)),
          (Qs.prototype.constructor = Qs),
          (Zs.prototype = Object.create(es.prototype)),
          (Zs.prototype.constructor = Zs),
          (ll.prototype = Object.create(oa.prototype)),
          (ll.prototype.constructor = ll),
          (ll.prototype.isCubeTexture = !0),
          Object.defineProperty(ll.prototype, "images", {
            get: function() {
              return this.image;
            },
            set: function(e) {
              this.image = e;
            }
          }),
          (cl.prototype = Object.create(oa.prototype)),
          (cl.prototype.constructor = cl),
          (cl.prototype.isDataTexture2DArray = !0),
          (ul.prototype = Object.create(oa.prototype)),
          (ul.prototype.constructor = ul),
          (ul.prototype.isDataTexture3D = !0);
        var hl = new oa(),
          dl = new cl(),
          pl = new ul(),
          fl = new ll(),
          ml = [],
          vl = [],
          gl = new Float32Array(16),
          yl = new Float32Array(9),
          bl = new Float32Array(4);
        function xl(e, t, n) {
          var r = e[0];
          if (r <= 0 || r > 0) return e;
          var i = t * n,
            a = ml[i];
          if (
            (void 0 === a && ((a = new Float32Array(i)), (ml[i] = a)), 0 !== t)
          ) {
            r.toArray(a, 0);
            for (var o = 1, s = 0; o !== t; ++o) (s += n), e[o].toArray(a, s);
          }
          return a;
        }
        function wl(e, t) {
          if (e.length !== t.length) return !1;
          for (var n = 0, r = e.length; n < r; n++)
            if (e[n] !== t[n]) return !1;
          return !0;
        }
        function _l(e, t) {
          for (var n = 0, r = t.length; n < r; n++) e[n] = t[n];
        }
        function Ml(e, t) {
          var n = vl[t];
          void 0 === n && ((n = new Int32Array(t)), (vl[t] = n));
          for (var r = 0; r !== t; ++r) n[r] = e.allocateTextureUnit();
          return n;
        }
        function Tl(e, t) {
          var n = this.cache;
          n[0] !== t && (e.uniform1f(this.addr, t), (n[0] = t));
        }
        function Al(e, t) {
          var n = this.cache;
          if (void 0 !== t.x)
            (n[0] === t.x && n[1] === t.y) ||
              (e.uniform2f(this.addr, t.x, t.y), (n[0] = t.x), (n[1] = t.y));
          else {
            if (wl(n, t)) return;
            e.uniform2fv(this.addr, t), _l(n, t);
          }
        }
        function Sl(e, t) {
          var n = this.cache;
          if (void 0 !== t.x)
            (n[0] === t.x && n[1] === t.y && n[2] === t.z) ||
              (e.uniform3f(this.addr, t.x, t.y, t.z),
              (n[0] = t.x),
              (n[1] = t.y),
              (n[2] = t.z));
          else if (void 0 !== t.r)
            (n[0] === t.r && n[1] === t.g && n[2] === t.b) ||
              (e.uniform3f(this.addr, t.r, t.g, t.b),
              (n[0] = t.r),
              (n[1] = t.g),
              (n[2] = t.b));
          else {
            if (wl(n, t)) return;
            e.uniform3fv(this.addr, t), _l(n, t);
          }
        }
        function El(e, t) {
          var n = this.cache;
          if (void 0 !== t.x)
            (n[0] === t.x && n[1] === t.y && n[2] === t.z && n[3] === t.w) ||
              (e.uniform4f(this.addr, t.x, t.y, t.z, t.w),
              (n[0] = t.x),
              (n[1] = t.y),
              (n[2] = t.z),
              (n[3] = t.w));
          else {
            if (wl(n, t)) return;
            e.uniform4fv(this.addr, t), _l(n, t);
          }
        }
        function Rl(e, t) {
          var n = this.cache,
            r = t.elements;
          if (void 0 === r) {
            if (wl(n, t)) return;
            e.uniformMatrix2fv(this.addr, !1, t), _l(n, t);
          } else {
            if (wl(n, r)) return;
            bl.set(r), e.uniformMatrix2fv(this.addr, !1, bl), _l(n, r);
          }
        }
        function Pl(e, t) {
          var n = this.cache,
            r = t.elements;
          if (void 0 === r) {
            if (wl(n, t)) return;
            e.uniformMatrix3fv(this.addr, !1, t), _l(n, t);
          } else {
            if (wl(n, r)) return;
            yl.set(r), e.uniformMatrix3fv(this.addr, !1, yl), _l(n, r);
          }
        }
        function Il(e, t) {
          var n = this.cache,
            r = t.elements;
          if (void 0 === r) {
            if (wl(n, t)) return;
            e.uniformMatrix4fv(this.addr, !1, t), _l(n, t);
          } else {
            if (wl(n, r)) return;
            gl.set(r), e.uniformMatrix4fv(this.addr, !1, gl), _l(n, r);
          }
        }
        function Dl(e, t, n) {
          var r = this.cache,
            i = n.allocateTextureUnit();
          r[0] !== i && (e.uniform1i(this.addr, i), (r[0] = i)),
            n.safeSetTexture2D(t || hl, i);
        }
        function Ol(e, t, n) {
          var r = this.cache,
            i = n.allocateTextureUnit();
          r[0] !== i && (e.uniform1i(this.addr, i), (r[0] = i)),
            n.setTexture2DArray(t || dl, i);
        }
        function Cl(e, t, n) {
          var r = this.cache,
            i = n.allocateTextureUnit();
          r[0] !== i && (e.uniform1i(this.addr, i), (r[0] = i)),
            n.setTexture3D(t || pl, i);
        }
        function Ll(e, t, n) {
          var r = this.cache,
            i = n.allocateTextureUnit();
          r[0] !== i && (e.uniform1i(this.addr, i), (r[0] = i)),
            n.safeSetTextureCube(t || fl, i);
        }
        function Nl(e, t) {
          var n = this.cache;
          n[0] !== t && (e.uniform1i(this.addr, t), (n[0] = t));
        }
        function Fl(e, t) {
          var n = this.cache;
          wl(n, t) || (e.uniform2iv(this.addr, t), _l(n, t));
        }
        function kl(e, t) {
          var n = this.cache;
          wl(n, t) || (e.uniform3iv(this.addr, t), _l(n, t));
        }
        function Ul(e, t) {
          var n = this.cache;
          wl(n, t) || (e.uniform4iv(this.addr, t), _l(n, t));
        }
        function jl(e, t) {
          e.uniform1fv(this.addr, t);
        }
        function Bl(e, t) {
          e.uniform1iv(this.addr, t);
        }
        function zl(e, t) {
          e.uniform2iv(this.addr, t);
        }
        function Vl(e, t) {
          e.uniform3iv(this.addr, t);
        }
        function Gl(e, t) {
          e.uniform4iv(this.addr, t);
        }
        function Hl(e, t) {
          var n = xl(t, this.size, 2);
          e.uniform2fv(this.addr, n);
        }
        function Xl(e, t) {
          var n = xl(t, this.size, 3);
          e.uniform3fv(this.addr, n);
        }
        function Wl(e, t) {
          var n = xl(t, this.size, 4);
          e.uniform4fv(this.addr, n);
        }
        function Yl(e, t) {
          var n = xl(t, this.size, 4);
          e.uniformMatrix2fv(this.addr, !1, n);
        }
        function ql(e, t) {
          var n = xl(t, this.size, 9);
          e.uniformMatrix3fv(this.addr, !1, n);
        }
        function Ql(e, t) {
          var n = xl(t, this.size, 16);
          e.uniformMatrix4fv(this.addr, !1, n);
        }
        function Zl(e, t, n) {
          var r = t.length,
            i = Ml(n, r);
          e.uniform1iv(this.addr, i);
          for (var a = 0; a !== r; ++a) n.safeSetTexture2D(t[a] || hl, i[a]);
        }
        function Jl(e, t, n) {
          var r = t.length,
            i = Ml(n, r);
          e.uniform1iv(this.addr, i);
          for (var a = 0; a !== r; ++a) n.safeSetTextureCube(t[a] || fl, i[a]);
        }
        function Kl(e, t, n) {
          (this.id = e),
            (this.addr = n),
            (this.cache = []),
            (this.setValue = (function(e) {
              switch (e) {
                case 5126:
                  return Tl;
                case 35664:
                  return Al;
                case 35665:
                  return Sl;
                case 35666:
                  return El;
                case 35674:
                  return Rl;
                case 35675:
                  return Pl;
                case 35676:
                  return Il;
                case 35678:
                case 36198:
                  return Dl;
                case 35679:
                  return Cl;
                case 35680:
                  return Ll;
                case 36289:
                  return Ol;
                case 5124:
                case 35670:
                  return Nl;
                case 35667:
                case 35671:
                  return Fl;
                case 35668:
                case 35672:
                  return kl;
                case 35669:
                case 35673:
                  return Ul;
              }
            })(t.type));
        }
        function $l(e, t, n) {
          (this.id = e),
            (this.addr = n),
            (this.cache = []),
            (this.size = t.size),
            (this.setValue = (function(e) {
              switch (e) {
                case 5126:
                  return jl;
                case 35664:
                  return Hl;
                case 35665:
                  return Xl;
                case 35666:
                  return Wl;
                case 35674:
                  return Yl;
                case 35675:
                  return ql;
                case 35676:
                  return Ql;
                case 35678:
                  return Zl;
                case 35680:
                  return Jl;
                case 5124:
                case 35670:
                  return Bl;
                case 35667:
                case 35671:
                  return zl;
                case 35668:
                case 35672:
                  return Vl;
                case 35669:
                case 35673:
                  return Gl;
              }
            })(t.type));
        }
        function ec(e) {
          (this.id = e), (this.seq = []), (this.map = {});
        }
        ($l.prototype.updateCache = function(e) {
          var t = this.cache;
          e instanceof Float32Array &&
            t.length !== e.length &&
            (this.cache = new Float32Array(e.length)),
            _l(t, e);
        }),
          (ec.prototype.setValue = function(e, t, n) {
            for (var r = this.seq, i = 0, a = r.length; i !== a; ++i) {
              var o = r[i];
              o.setValue(e, t[o.id], n);
            }
          });
        var tc = /([\w\d_]+)(\])?(\[|\.)?/g;
        function nc(e, t) {
          e.seq.push(t), (e.map[t.id] = t);
        }
        function rc(e, t, n) {
          var r = e.name,
            i = r.length;
          for (tc.lastIndex = 0; ; ) {
            var a = tc.exec(r),
              o = tc.lastIndex,
              s = a[1],
              l = "]" === a[2],
              c = a[3];
            if ((l && (s |= 0), void 0 === c || ("[" === c && o + 2 === i))) {
              nc(n, void 0 === c ? new Kl(s, e, t) : new $l(s, e, t));
              break;
            }
            var u = n.map[s];
            void 0 === u && nc(n, (u = new ec(s))), (n = u);
          }
        }
        function ic(e, t) {
          (this.seq = []), (this.map = {});
          for (var n = e.getProgramParameter(t, 35718), r = 0; r < n; ++r) {
            var i = e.getActiveUniform(t, r);
            rc(i, e.getUniformLocation(t, i.name), this);
          }
        }
        function ac(e, t, n) {
          var r = e.createShader(t);
          return e.shaderSource(r, n), e.compileShader(r), r;
        }
        (ic.prototype.setValue = function(e, t, n, r) {
          var i = this.map[t];
          void 0 !== i && i.setValue(e, n, r);
        }),
          (ic.prototype.setOptional = function(e, t, n) {
            var r = t[n];
            void 0 !== r && this.setValue(e, n, r);
          }),
          (ic.upload = function(e, t, n, r) {
            for (var i = 0, a = t.length; i !== a; ++i) {
              var o = t[i],
                s = n[o.id];
              !1 !== s.needsUpdate && o.setValue(e, s.value, r);
            }
          }),
          (ic.seqWithValue = function(e, t) {
            for (var n = [], r = 0, i = e.length; r !== i; ++r) {
              var a = e[r];
              a.id in t && n.push(a);
            }
            return n;
          });
        var oc = 0;
        function sc(e) {
          switch (e) {
            case ci:
              return ["Linear", "( value )"];
            case ui:
              return ["sRGB", "( value )"];
            case di:
              return ["RGBE", "( value )"];
            case fi:
              return ["RGBM", "( value, 7.0 )"];
            case mi:
              return ["RGBM", "( value, 16.0 )"];
            case vi:
              return ["RGBD", "( value, 256.0 )"];
            case hi:
              return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
            case pi:
              return ["LogLuv", "( value )"];
            default:
              throw new Error("unsupported encoding: " + e);
          }
        }
        function lc(e, t, n) {
          var r = e.getShaderParameter(t, 35713),
            i = e.getShaderInfoLog(t).trim();
          return r && "" === i
            ? ""
            : "THREE.WebGLShader: gl.getShaderInfoLog() " +
                n +
                "\n" +
                i +
                (function(e) {
                  for (var t = e.split("\n"), n = 0; n < t.length; n++)
                    t[n] = n + 1 + ": " + t[n];
                  return t.join("\n");
                })(e.getShaderSource(t));
        }
        function cc(e, t) {
          var n = sc(t);
          return (
            "vec4 " +
            e +
            "( vec4 value ) { return " +
            n[0] +
            "ToLinear" +
            n[1] +
            "; }"
          );
        }
        function uc(e, t) {
          var n;
          switch (t) {
            case Nn:
              n = "Linear";
              break;
            case Fn:
              n = "Reinhard";
              break;
            case kn:
              n = "Uncharted2";
              break;
            case Un:
              n = "OptimizedCineon";
              break;
            case jn:
              n = "ACESFilmic";
              break;
            default:
              throw new Error("unsupported toneMapping: " + t);
          }
          return (
            "vec3 " +
            e +
            "( vec3 color ) { return " +
            n +
            "ToneMapping( color ); }"
          );
        }
        function hc(e) {
          return "" !== e;
        }
        function dc(e, t) {
          return e
            .replace(/NUM_DIR_LIGHTS/g, t.numDirLights)
            .replace(/NUM_SPOT_LIGHTS/g, t.numSpotLights)
            .replace(/NUM_RECT_AREA_LIGHTS/g, t.numRectAreaLights)
            .replace(/NUM_POINT_LIGHTS/g, t.numPointLights)
            .replace(/NUM_HEMI_LIGHTS/g, t.numHemiLights)
            .replace(/NUM_DIR_LIGHT_SHADOWS/g, t.numDirLightShadows)
            .replace(/NUM_SPOT_LIGHT_SHADOWS/g, t.numSpotLightShadows)
            .replace(/NUM_POINT_LIGHT_SHADOWS/g, t.numPointLightShadows);
        }
        function pc(e, t) {
          return e
            .replace(/NUM_CLIPPING_PLANES/g, t.numClippingPlanes)
            .replace(
              /UNION_CLIPPING_PLANES/g,
              t.numClippingPlanes - t.numClipIntersection
            );
        }
        var fc = /^[ \t]*#include +<([\w\d./]+)>/gm;
        function mc(e) {
          return e.replace(fc, vc);
        }
        function vc(e, t) {
          var n = Hs[t];
          if (void 0 === n)
            throw new Error("Can not resolve #include <" + t + ">");
          return mc(n);
        }
        var gc = /#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;
        function yc(e) {
          return e.replace(gc, bc);
        }
        function bc(e, t, n, r) {
          for (var i = "", a = parseInt(t); a < parseInt(n); a++)
            i += r
              .replace(/\[ i \]/g, "[ " + a + " ]")
              .replace(/UNROLLED_LOOP_INDEX/g, a);
          return i;
        }
        function xc(e) {
          var t =
            "precision " +
            e.precision +
            " float;\nprecision " +
            e.precision +
            " int;";
          return (
            "highp" === e.precision
              ? (t += "\n#define HIGH_PRECISION")
              : "mediump" === e.precision
              ? (t += "\n#define MEDIUM_PRECISION")
              : "lowp" === e.precision && (t += "\n#define LOW_PRECISION"),
            t
          );
        }
        function wc(e, t, n, r, i, a) {
          var o,
            s,
            l,
            c,
            u,
            h = e.getContext(),
            d = r.defines,
            p = i.vertexShader,
            f = i.fragmentShader,
            m = (function(e) {
              var t = "SHADOWMAP_TYPE_BASIC";
              return (
                e.shadowMapType === Gt
                  ? (t = "SHADOWMAP_TYPE_PCF")
                  : e.shadowMapType === Ht
                  ? (t = "SHADOWMAP_TYPE_PCF_SOFT")
                  : e.shadowMapType === Xt && (t = "SHADOWMAP_TYPE_VSM"),
                t
              );
            })(a),
            v = (function(e) {
              var t = "ENVMAP_TYPE_CUBE";
              if (e.envMap)
                switch (e.envMapMode) {
                  case zn:
                  case Vn:
                    t = "ENVMAP_TYPE_CUBE";
                    break;
                  case Wn:
                  case Yn:
                    t = "ENVMAP_TYPE_CUBE_UV";
                    break;
                  case Gn:
                  case Hn:
                    t = "ENVMAP_TYPE_EQUIREC";
                    break;
                  case Xn:
                    t = "ENVMAP_TYPE_SPHERE";
                }
              return t;
            })(a),
            g = (function(e) {
              var t = "ENVMAP_MODE_REFLECTION";
              if (e.envMap)
                switch (e.envMapMode) {
                  case Vn:
                  case Hn:
                    t = "ENVMAP_MODE_REFRACTION";
                }
              return t;
            })(a),
            y = (function(e) {
              var t = "ENVMAP_BLENDING_MULTIPLY";
              if (e.envMap)
                switch (e.combine) {
                  case Dn:
                    t = "ENVMAP_BLENDING_MULTIPLY";
                    break;
                  case On:
                    t = "ENVMAP_BLENDING_MIX";
                    break;
                  case Cn:
                    t = "ENVMAP_BLENDING_ADD";
                }
              return t;
            })(a),
            b = e.gammaFactor > 0 ? e.gammaFactor : 1,
            x = a.isWebGL2
              ? ""
              : (function(e, t, n) {
                  return [
                    (e = e || {}).derivatives ||
                    t.envMapCubeUV ||
                    t.bumpMap ||
                    t.tangentSpaceNormalMap ||
                    t.clearcoatNormalMap ||
                    t.flatShading
                      ? "#extension GL_OES_standard_derivatives : enable"
                      : "",
                    (e.fragDepth || t.logarithmicDepthBuffer) &&
                    n.get("EXT_frag_depth")
                      ? "#extension GL_EXT_frag_depth : enable"
                      : "",
                    e.drawBuffers && n.get("WEBGL_draw_buffers")
                      ? "#extension GL_EXT_draw_buffers : require"
                      : "",
                    (e.shaderTextureLOD || t.envMap) &&
                    n.get("EXT_shader_texture_lod")
                      ? "#extension GL_EXT_shader_texture_lod : enable"
                      : ""
                  ]
                    .filter(hc)
                    .join("\n");
                })(r.extensions, a, t),
            w = (function(e) {
              var t = [];
              for (var n in e) {
                var r = e[n];
                !1 !== r && t.push("#define " + n + " " + r);
              }
              return t.join("\n");
            })(d),
            _ = h.createProgram(),
            M = a.numMultiviewViews;
          if (
            (r.isRawShaderMaterial
              ? ((o = [w].filter(hc).join("\n")).length > 0 && (o += "\n"),
                (s = [x, w].filter(hc).join("\n")).length > 0 && (s += "\n"))
              : ((o = [
                  xc(a),
                  "#define SHADER_NAME " + i.name,
                  w,
                  a.instancing ? "#define USE_INSTANCING" : "",
                  a.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "",
                  "#define GAMMA_FACTOR " + b,
                  "#define MAX_BONES " + a.maxBones,
                  a.useFog && a.fog ? "#define USE_FOG" : "",
                  a.useFog && a.fogExp2 ? "#define FOG_EXP2" : "",
                  a.map ? "#define USE_MAP" : "",
                  a.envMap ? "#define USE_ENVMAP" : "",
                  a.envMap ? "#define " + g : "",
                  a.lightMap ? "#define USE_LIGHTMAP" : "",
                  a.aoMap ? "#define USE_AOMAP" : "",
                  a.emissiveMap ? "#define USE_EMISSIVEMAP" : "",
                  a.bumpMap ? "#define USE_BUMPMAP" : "",
                  a.normalMap ? "#define USE_NORMALMAP" : "",
                  a.normalMap && a.objectSpaceNormalMap
                    ? "#define OBJECTSPACE_NORMALMAP"
                    : "",
                  a.normalMap && a.tangentSpaceNormalMap
                    ? "#define TANGENTSPACE_NORMALMAP"
                    : "",
                  a.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "",
                  a.displacementMap && a.supportsVertexTextures
                    ? "#define USE_DISPLACEMENTMAP"
                    : "",
                  a.specularMap ? "#define USE_SPECULARMAP" : "",
                  a.roughnessMap ? "#define USE_ROUGHNESSMAP" : "",
                  a.metalnessMap ? "#define USE_METALNESSMAP" : "",
                  a.alphaMap ? "#define USE_ALPHAMAP" : "",
                  a.vertexTangents ? "#define USE_TANGENT" : "",
                  a.vertexColors ? "#define USE_COLOR" : "",
                  a.vertexUvs ? "#define USE_UV" : "",
                  a.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "",
                  a.flatShading ? "#define FLAT_SHADED" : "",
                  a.skinning ? "#define USE_SKINNING" : "",
                  a.useVertexTexture ? "#define BONE_TEXTURE" : "",
                  a.morphTargets ? "#define USE_MORPHTARGETS" : "",
                  a.morphNormals && !1 === a.flatShading
                    ? "#define USE_MORPHNORMALS"
                    : "",
                  a.doubleSided ? "#define DOUBLE_SIDED" : "",
                  a.flipSided ? "#define FLIP_SIDED" : "",
                  a.shadowMapEnabled ? "#define USE_SHADOWMAP" : "",
                  a.shadowMapEnabled ? "#define " + m : "",
                  a.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "",
                  a.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "",
                  a.logarithmicDepthBuffer &&
                  (a.isWebGL2 || t.get("EXT_frag_depth"))
                    ? "#define USE_LOGDEPTHBUF_EXT"
                    : "",
                  "uniform mat4 modelMatrix;",
                  "uniform mat4 modelViewMatrix;",
                  "uniform mat4 projectionMatrix;",
                  "uniform mat4 viewMatrix;",
                  "uniform mat3 normalMatrix;",
                  "uniform vec3 cameraPosition;",
                  "uniform bool isOrthographic;",
                  "#ifdef USE_INSTANCING",
                  " attribute mat4 instanceMatrix;",
                  "#endif",
                  "attribute vec3 position;",
                  "attribute vec3 normal;",
                  "attribute vec2 uv;",
                  "#ifdef USE_TANGENT",
                  "\tattribute vec4 tangent;",
                  "#endif",
                  "#ifdef USE_COLOR",
                  "\tattribute vec3 color;",
                  "#endif",
                  "#ifdef USE_MORPHTARGETS",
                  "\tattribute vec3 morphTarget0;",
                  "\tattribute vec3 morphTarget1;",
                  "\tattribute vec3 morphTarget2;",
                  "\tattribute vec3 morphTarget3;",
                  "\t#ifdef USE_MORPHNORMALS",
                  "\t\tattribute vec3 morphNormal0;",
                  "\t\tattribute vec3 morphNormal1;",
                  "\t\tattribute vec3 morphNormal2;",
                  "\t\tattribute vec3 morphNormal3;",
                  "\t#else",
                  "\t\tattribute vec3 morphTarget4;",
                  "\t\tattribute vec3 morphTarget5;",
                  "\t\tattribute vec3 morphTarget6;",
                  "\t\tattribute vec3 morphTarget7;",
                  "\t#endif",
                  "#endif",
                  "#ifdef USE_SKINNING",
                  "\tattribute vec4 skinIndex;",
                  "\tattribute vec4 skinWeight;",
                  "#endif",
                  "\n"
                ]
                  .filter(hc)
                  .join("\n")),
                (s = [
                  x,
                  xc(a),
                  "#define SHADER_NAME " + i.name,
                  w,
                  a.alphaTest
                    ? "#define ALPHATEST " +
                      a.alphaTest +
                      (a.alphaTest % 1 ? "" : ".0")
                    : "",
                  "#define GAMMA_FACTOR " + b,
                  a.useFog && a.fog ? "#define USE_FOG" : "",
                  a.useFog && a.fogExp2 ? "#define FOG_EXP2" : "",
                  a.map ? "#define USE_MAP" : "",
                  a.matcap ? "#define USE_MATCAP" : "",
                  a.envMap ? "#define USE_ENVMAP" : "",
                  a.envMap ? "#define " + v : "",
                  a.envMap ? "#define " + g : "",
                  a.envMap ? "#define " + y : "",
                  a.lightMap ? "#define USE_LIGHTMAP" : "",
                  a.aoMap ? "#define USE_AOMAP" : "",
                  a.emissiveMap ? "#define USE_EMISSIVEMAP" : "",
                  a.bumpMap ? "#define USE_BUMPMAP" : "",
                  a.normalMap ? "#define USE_NORMALMAP" : "",
                  a.normalMap && a.objectSpaceNormalMap
                    ? "#define OBJECTSPACE_NORMALMAP"
                    : "",
                  a.normalMap && a.tangentSpaceNormalMap
                    ? "#define TANGENTSPACE_NORMALMAP"
                    : "",
                  a.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "",
                  a.specularMap ? "#define USE_SPECULARMAP" : "",
                  a.roughnessMap ? "#define USE_ROUGHNESSMAP" : "",
                  a.metalnessMap ? "#define USE_METALNESSMAP" : "",
                  a.alphaMap ? "#define USE_ALPHAMAP" : "",
                  a.sheen ? "#define USE_SHEEN" : "",
                  a.vertexTangents ? "#define USE_TANGENT" : "",
                  a.vertexColors ? "#define USE_COLOR" : "",
                  a.vertexUvs ? "#define USE_UV" : "",
                  a.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "",
                  a.gradientMap ? "#define USE_GRADIENTMAP" : "",
                  a.flatShading ? "#define FLAT_SHADED" : "",
                  a.doubleSided ? "#define DOUBLE_SIDED" : "",
                  a.flipSided ? "#define FLIP_SIDED" : "",
                  a.shadowMapEnabled ? "#define USE_SHADOWMAP" : "",
                  a.shadowMapEnabled ? "#define " + m : "",
                  a.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "",
                  a.physicallyCorrectLights
                    ? "#define PHYSICALLY_CORRECT_LIGHTS"
                    : "",
                  a.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "",
                  a.logarithmicDepthBuffer &&
                  (a.isWebGL2 || t.get("EXT_frag_depth"))
                    ? "#define USE_LOGDEPTHBUF_EXT"
                    : "",
                  ((r.extensions && r.extensions.shaderTextureLOD) ||
                    a.envMap) &&
                  (a.isWebGL2 || t.get("EXT_shader_texture_lod"))
                    ? "#define TEXTURE_LOD_EXT"
                    : "",
                  "uniform mat4 viewMatrix;",
                  "uniform vec3 cameraPosition;",
                  "uniform bool isOrthographic;",
                  a.toneMapping !== Ln ? "#define TONE_MAPPING" : "",
                  a.toneMapping !== Ln ? Hs.tonemapping_pars_fragment : "",
                  a.toneMapping !== Ln ? uc("toneMapping", a.toneMapping) : "",
                  a.dithering ? "#define DITHERING" : "",
                  a.outputEncoding ||
                  a.mapEncoding ||
                  a.matcapEncoding ||
                  a.envMapEncoding ||
                  a.emissiveMapEncoding
                    ? Hs.encodings_pars_fragment
                    : "",
                  a.mapEncoding ? cc("mapTexelToLinear", a.mapEncoding) : "",
                  a.matcapEncoding
                    ? cc("matcapTexelToLinear", a.matcapEncoding)
                    : "",
                  a.envMapEncoding
                    ? cc("envMapTexelToLinear", a.envMapEncoding)
                    : "",
                  a.emissiveMapEncoding
                    ? cc("emissiveMapTexelToLinear", a.emissiveMapEncoding)
                    : "",
                  a.outputEncoding
                    ? ((l = "linearToOutputTexel"),
                      (c = a.outputEncoding),
                      (u = sc(c)),
                      "vec4 " +
                        l +
                        "( vec4 value ) { return LinearTo" +
                        u[0] +
                        u[1] +
                        "; }")
                    : "",
                  a.depthPacking
                    ? "#define DEPTH_PACKING " + r.depthPacking
                    : "",
                  "\n"
                ]
                  .filter(hc)
                  .join("\n"))),
            (p = pc((p = dc((p = mc(p)), a)), a)),
            (f = pc((f = dc((f = mc(f)), a)), a)),
            (p = yc(p)),
            (f = yc(f)),
            a.isWebGL2 && !r.isRawShaderMaterial)
          ) {
            var T = !1,
              A = /^\s*#version\s+300\s+es\s*\n/;
            r.isShaderMaterial &&
              null !== p.match(A) &&
              null !== f.match(A) &&
              ((T = !0), (p = p.replace(A, "")), (f = f.replace(A, ""))),
              (o =
                [
                  "#version 300 es\n",
                  "#define attribute in",
                  "#define varying out",
                  "#define texture2D texture"
                ].join("\n") +
                "\n" +
                o),
              (s =
                [
                  "#version 300 es\n",
                  "#define varying in",
                  T ? "" : "out highp vec4 pc_fragColor;",
                  T ? "" : "#define gl_FragColor pc_fragColor",
                  "#define gl_FragDepthEXT gl_FragDepth",
                  "#define texture2D texture",
                  "#define textureCube texture",
                  "#define texture2DProj textureProj",
                  "#define texture2DLodEXT textureLod",
                  "#define texture2DProjLodEXT textureProjLod",
                  "#define textureCubeLodEXT textureLod",
                  "#define texture2DGradEXT textureGrad",
                  "#define texture2DProjGradEXT textureProjGrad",
                  "#define textureCubeGradEXT textureGrad"
                ].join("\n") +
                "\n" +
                s),
              M > 0 &&
                ((o = (o = o.replace(
                  "#version 300 es\n",
                  [
                    "#version 300 es\n",
                    "#extension GL_OVR_multiview2 : require",
                    "layout(num_views = " + M + ") in;",
                    "#define VIEW_ID gl_ViewID_OVR"
                  ].join("\n")
                )).replace(
                  [
                    "uniform mat4 modelViewMatrix;",
                    "uniform mat4 projectionMatrix;",
                    "uniform mat4 viewMatrix;",
                    "uniform mat3 normalMatrix;"
                  ].join("\n"),
                  [
                    "uniform mat4 modelViewMatrices[" + M + "];",
                    "uniform mat4 projectionMatrices[" + M + "];",
                    "uniform mat4 viewMatrices[" + M + "];",
                    "uniform mat3 normalMatrices[" + M + "];",
                    "#define modelViewMatrix modelViewMatrices[VIEW_ID]",
                    "#define projectionMatrix projectionMatrices[VIEW_ID]",
                    "#define viewMatrix viewMatrices[VIEW_ID]",
                    "#define normalMatrix normalMatrices[VIEW_ID]"
                  ].join("\n")
                )),
                (s = (s = s.replace(
                  "#version 300 es\n",
                  [
                    "#version 300 es\n",
                    "#extension GL_OVR_multiview2 : require",
                    "#define VIEW_ID gl_ViewID_OVR"
                  ].join("\n")
                )).replace(
                  "uniform mat4 viewMatrix;",
                  [
                    "uniform mat4 viewMatrices[" + M + "];",
                    "#define viewMatrix viewMatrices[VIEW_ID]"
                  ].join("\n")
                )));
          }
          var S,
            E,
            R = s + f,
            P = ac(h, 35633, o + p),
            I = ac(h, 35632, R);
          if (
            (h.attachShader(_, P),
            h.attachShader(_, I),
            void 0 !== r.index0AttributeName
              ? h.bindAttribLocation(_, 0, r.index0AttributeName)
              : !0 === a.morphTargets && h.bindAttribLocation(_, 0, "position"),
            h.linkProgram(_),
            e.debug.checkShaderErrors)
          ) {
            var D = h.getProgramInfoLog(_).trim(),
              O = h.getShaderInfoLog(P).trim(),
              C = h.getShaderInfoLog(I).trim(),
              L = !0,
              N = !0;
            !1 === h.getProgramParameter(_, 35714)
              ? ((L = !1), lc(h, P, "vertex"), lc(h, I, "fragment"))
              : "" !== D || ("" !== O && "" !== C) || (N = !1),
              N &&
                (this.diagnostics = {
                  runnable: L,
                  material: r,
                  programLog: D,
                  vertexShader: { log: O, prefix: o },
                  fragmentShader: { log: C, prefix: s }
                });
          }
          return (
            h.deleteShader(P),
            h.deleteShader(I),
            (this.getUniforms = function() {
              return void 0 === S && (S = new ic(h, _)), S;
            }),
            (this.getAttributes = function() {
              return (
                void 0 === E &&
                  (E = (function(e, t) {
                    for (
                      var n = {}, r = e.getProgramParameter(t, 35721), i = 0;
                      i < r;
                      i++
                    ) {
                      var a = e.getActiveAttrib(t, i).name;
                      n[a] = e.getAttribLocation(t, a);
                    }
                    return n;
                  })(h, _)),
                E
              );
            }),
            (this.destroy = function() {
              h.deleteProgram(_), (this.program = void 0);
            }),
            (this.name = i.name),
            (this.id = oc++),
            (this.cacheKey = n),
            (this.usedTimes = 1),
            (this.program = _),
            (this.vertexShader = P),
            (this.fragmentShader = I),
            (this.numMultiviewViews = M),
            this
          );
        }
        function _c(e, t, n) {
          var r = [],
            i = n.isWebGL2,
            a = n.logarithmicDepthBuffer,
            o = n.floatVertexTextures,
            s = n.precision,
            l = n.maxVertexUniforms,
            c = n.vertexTextures,
            u = {
              MeshDepthMaterial: "depth",
              MeshDistanceMaterial: "distanceRGBA",
              MeshNormalMaterial: "normal",
              MeshBasicMaterial: "basic",
              MeshLambertMaterial: "lambert",
              MeshPhongMaterial: "phong",
              MeshToonMaterial: "phong",
              MeshStandardMaterial: "physical",
              MeshPhysicalMaterial: "physical",
              MeshMatcapMaterial: "matcap",
              LineBasicMaterial: "basic",
              LineDashedMaterial: "dashed",
              PointsMaterial: "points",
              ShadowMaterial: "shadow",
              SpriteMaterial: "sprite"
            },
            h = [
              "precision",
              "isWebGL2",
              "supportsVertexTextures",
              "outputEncoding",
              "instancing",
              "numMultiviewViews",
              "map",
              "mapEncoding",
              "matcap",
              "matcapEncoding",
              "envMap",
              "envMapMode",
              "envMapEncoding",
              "envMapCubeUV",
              "lightMap",
              "aoMap",
              "emissiveMap",
              "emissiveMapEncoding",
              "bumpMap",
              "normalMap",
              "objectSpaceNormalMap",
              "tangentSpaceNormalMap",
              "clearcoatNormalMap",
              "displacementMap",
              "specularMap",
              "roughnessMap",
              "metalnessMap",
              "gradientMap",
              "alphaMap",
              "combine",
              "vertexColors",
              "vertexTangents",
              "vertexUvs",
              "uvsVertexOnly",
              "fog",
              "useFog",
              "fogExp2",
              "flatShading",
              "sizeAttenuation",
              "logarithmicDepthBuffer",
              "skinning",
              "maxBones",
              "useVertexTexture",
              "morphTargets",
              "morphNormals",
              "maxMorphTargets",
              "maxMorphNormals",
              "premultipliedAlpha",
              "numDirLights",
              "numPointLights",
              "numSpotLights",
              "numHemiLights",
              "numRectAreaLights",
              "numDirLightShadows",
              "numPointLightShadows",
              "numSpotLightShadows",
              "shadowMapEnabled",
              "shadowMapType",
              "toneMapping",
              "physicallyCorrectLights",
              "alphaTest",
              "doubleSided",
              "flipSided",
              "numClippingPlanes",
              "numClipIntersection",
              "depthPacking",
              "dithering",
              "sheen"
            ];
          function d(e, t) {
            var n;
            return (
              e
                ? e.isTexture
                  ? (n = e.encoding)
                  : e.isWebGLRenderTarget && (n = e.texture.encoding)
                : (n = ci),
              n === ci && t && (n = hi),
              n
            );
          }
          (this.getParameters = function(t, r, h, p, f, m, v) {
            var g = u[t.type],
              y = v.isSkinnedMesh
                ? (function(e) {
                    var t = e.skeleton.bones;
                    if (o) return 1024;
                    var n = l,
                      r = Math.floor((n - 20) / 4),
                      i = Math.min(r, t.length);
                    return i < t.length ? 0 : i;
                  })(v)
                : 0;
            null !== t.precision &&
              ((s = n.getMaxPrecision(t.precision)), t.precision);
            var b = e.getRenderTarget(),
              x = b && b.isWebGLMultiviewRenderTarget ? b.numViews : 0;
            return {
              isWebGL2: i,
              shaderID: g,
              precision: s,
              instancing: !0 === v.isInstancedMesh,
              supportsVertexTextures: c,
              numMultiviewViews: x,
              outputEncoding: d(b ? b.texture : null, e.gammaOutput),
              map: !!t.map,
              mapEncoding: d(t.map, e.gammaInput),
              matcap: !!t.matcap,
              matcapEncoding: d(t.matcap, e.gammaInput),
              envMap: !!t.envMap,
              envMapMode: t.envMap && t.envMap.mapping,
              envMapEncoding: d(t.envMap, e.gammaInput),
              envMapCubeUV:
                !!t.envMap &&
                (t.envMap.mapping === Wn || t.envMap.mapping === Yn),
              lightMap: !!t.lightMap,
              aoMap: !!t.aoMap,
              emissiveMap: !!t.emissiveMap,
              emissiveMapEncoding: d(t.emissiveMap, e.gammaInput),
              bumpMap: !!t.bumpMap,
              normalMap: !!t.normalMap,
              objectSpaceNormalMap: t.normalMapType === xi,
              tangentSpaceNormalMap: t.normalMapType === bi,
              clearcoatNormalMap: !!t.clearcoatNormalMap,
              displacementMap: !!t.displacementMap,
              roughnessMap: !!t.roughnessMap,
              metalnessMap: !!t.metalnessMap,
              specularMap: !!t.specularMap,
              alphaMap: !!t.alphaMap,
              gradientMap: !!t.gradientMap,
              sheen: !!t.sheen,
              combine: t.combine,
              vertexTangents: t.normalMap && t.vertexTangents,
              vertexColors: t.vertexColors,
              vertexUvs: !!(
                t.map ||
                t.bumpMap ||
                t.normalMap ||
                t.specularMap ||
                t.alphaMap ||
                t.emissiveMap ||
                t.roughnessMap ||
                t.metalnessMap ||
                t.clearcoatNormalMap ||
                t.displacementMap
              ),
              uvsVertexOnly: !(
                t.map ||
                t.bumpMap ||
                t.normalMap ||
                t.specularMap ||
                t.alphaMap ||
                t.emissiveMap ||
                t.roughnessMap ||
                t.metalnessMap ||
                t.clearcoatNormalMap ||
                !t.displacementMap
              ),
              fog: !!p,
              useFog: t.fog,
              fogExp2: p && p.isFogExp2,
              flatShading: t.flatShading,
              sizeAttenuation: t.sizeAttenuation,
              logarithmicDepthBuffer: a,
              skinning: t.skinning && y > 0,
              maxBones: y,
              useVertexTexture: o,
              morphTargets: t.morphTargets,
              morphNormals: t.morphNormals,
              maxMorphTargets: e.maxMorphTargets,
              maxMorphNormals: e.maxMorphNormals,
              numDirLights: r.directional.length,
              numPointLights: r.point.length,
              numSpotLights: r.spot.length,
              numRectAreaLights: r.rectArea.length,
              numHemiLights: r.hemi.length,
              numDirLightShadows: r.directionalShadowMap.length,
              numPointLightShadows: r.pointShadowMap.length,
              numSpotLightShadows: r.spotShadowMap.length,
              numClippingPlanes: f,
              numClipIntersection: m,
              dithering: t.dithering,
              shadowMapEnabled: e.shadowMap.enabled && h.length > 0,
              shadowMapType: e.shadowMap.type,
              toneMapping: t.toneMapped ? e.toneMapping : Ln,
              physicallyCorrectLights: e.physicallyCorrectLights,
              premultipliedAlpha: t.premultipliedAlpha,
              alphaTest: t.alphaTest,
              doubleSided: t.side === qt,
              flipSided: t.side === Yt,
              depthPacking: void 0 !== t.depthPacking && t.depthPacking
            };
          }),
            (this.getProgramCacheKey = function(t, n) {
              var r = [];
              if (
                (n.shaderID
                  ? r.push(n.shaderID)
                  : (r.push(t.fragmentShader), r.push(t.vertexShader)),
                void 0 !== t.defines)
              )
                for (var i in t.defines) r.push(i), r.push(t.defines[i]);
              for (var a = 0; a < h.length; a++) r.push(n[h[a]]);
              return (
                r.push(t.onBeforeCompile.toString()),
                r.push(e.gammaOutput),
                r.push(e.gammaFactor),
                r.join()
              );
            }),
            (this.acquireProgram = function(n, i, a, o) {
              for (var s, l = 0, c = r.length; l < c; l++) {
                var u = r[l];
                if (u.cacheKey === o) {
                  ++(s = u).usedTimes;
                  break;
                }
              }
              return (
                void 0 === s && ((s = new wc(e, t, o, n, i, a)), r.push(s)), s
              );
            }),
            (this.releaseProgram = function(e) {
              if (0 == --e.usedTimes) {
                var t = r.indexOf(e);
                (r[t] = r[r.length - 1]), r.pop(), e.destroy();
              }
            }),
            (this.programs = r);
        }
        function Mc() {
          var e = new WeakMap();
          return {
            get: function(t) {
              var n = e.get(t);
              return void 0 === n && ((n = {}), e.set(t, n)), n;
            },
            remove: function(t) {
              e.delete(t);
            },
            update: function(t, n, r) {
              e.get(t)[n] = r;
            },
            dispose: function() {
              e = new WeakMap();
            }
          };
        }
        function Tc(e, t) {
          return e.groupOrder !== t.groupOrder
            ? e.groupOrder - t.groupOrder
            : e.renderOrder !== t.renderOrder
            ? e.renderOrder - t.renderOrder
            : e.program !== t.program
            ? e.program.id - t.program.id
            : e.material.id !== t.material.id
            ? e.material.id - t.material.id
            : e.z !== t.z
            ? e.z - t.z
            : e.id - t.id;
        }
        function Ac(e, t) {
          return e.groupOrder !== t.groupOrder
            ? e.groupOrder - t.groupOrder
            : e.renderOrder !== t.renderOrder
            ? e.renderOrder - t.renderOrder
            : e.z !== t.z
            ? t.z - e.z
            : e.id - t.id;
        }
        function Sc() {
          var e = [],
            t = 0,
            n = [],
            r = [],
            i = { id: -1 };
          function a(n, r, a, o, s, l) {
            var c = e[t];
            return (
              void 0 === c
                ? ((c = {
                    id: n.id,
                    object: n,
                    geometry: r,
                    material: a,
                    program: a.program || i,
                    groupOrder: o,
                    renderOrder: n.renderOrder,
                    z: s,
                    group: l
                  }),
                  (e[t] = c))
                : ((c.id = n.id),
                  (c.object = n),
                  (c.geometry = r),
                  (c.material = a),
                  (c.program = a.program || i),
                  (c.groupOrder = o),
                  (c.renderOrder = n.renderOrder),
                  (c.z = s),
                  (c.group = l)),
              t++,
              c
            );
          }
          return {
            opaque: n,
            transparent: r,
            init: function() {
              (t = 0), (n.length = 0), (r.length = 0);
            },
            push: function(e, t, i, o, s, l) {
              var c = a(e, t, i, o, s, l);
              (!0 === i.transparent ? r : n).push(c);
            },
            unshift: function(e, t, i, o, s, l) {
              var c = a(e, t, i, o, s, l);
              (!0 === i.transparent ? r : n).unshift(c);
            },
            sort: function() {
              n.length > 1 && n.sort(Tc), r.length > 1 && r.sort(Ac);
            }
          };
        }
        function Ec() {
          var e = new WeakMap();
          function t(n) {
            var r = n.target;
            r.removeEventListener("dispose", t), e.delete(r);
          }
          return {
            get: function(n, r) {
              var i,
                a = e.get(n);
              return (
                void 0 === a
                  ? ((i = new Sc()),
                    e.set(n, new WeakMap()),
                    e.get(n).set(r, i),
                    n.addEventListener("dispose", t))
                  : void 0 === (i = a.get(r)) && ((i = new Sc()), a.set(r, i)),
                i
              );
            },
            dispose: function() {
              e = new WeakMap();
            }
          };
        }
        function Rc() {
          var e = {};
          return {
            get: function(t) {
              if (void 0 !== e[t.id]) return e[t.id];
              var n;
              switch (t.type) {
                case "DirectionalLight":
                  n = {
                    direction: new ea(),
                    color: new Eo(),
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new Zi()
                  };
                  break;
                case "SpotLight":
                  n = {
                    position: new ea(),
                    direction: new ea(),
                    color: new Eo(),
                    distance: 0,
                    coneCos: 0,
                    penumbraCos: 0,
                    decay: 0,
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new Zi()
                  };
                  break;
                case "PointLight":
                  n = {
                    position: new ea(),
                    color: new Eo(),
                    distance: 0,
                    decay: 0,
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new Zi(),
                    shadowCameraNear: 1,
                    shadowCameraFar: 1e3
                  };
                  break;
                case "HemisphereLight":
                  n = {
                    direction: new ea(),
                    skyColor: new Eo(),
                    groundColor: new Eo()
                  };
                  break;
                case "RectAreaLight":
                  n = {
                    color: new Eo(),
                    position: new ea(),
                    halfWidth: new ea(),
                    halfHeight: new ea()
                  };
              }
              return (e[t.id] = n), n;
            }
          };
        }
        var Pc = 0;
        function Ic(e, t) {
          return (t.castShadow ? 1 : 0) - (e.castShadow ? 1 : 0);
        }
        function Dc() {
          for (
            var e = new Rc(),
              t = {
                version: 0,
                hash: {
                  directionalLength: -1,
                  pointLength: -1,
                  spotLength: -1,
                  rectAreaLength: -1,
                  hemiLength: -1,
                  numDirectionalShadows: -1,
                  numPointShadows: -1,
                  numSpotShadows: -1
                },
                ambient: [0, 0, 0],
                probe: [],
                directional: [],
                directionalShadowMap: [],
                directionalShadowMatrix: [],
                spot: [],
                spotShadowMap: [],
                spotShadowMatrix: [],
                rectArea: [],
                point: [],
                pointShadowMap: [],
                pointShadowMatrix: [],
                hemi: [],
                numDirectionalShadows: -1,
                numPointShadows: -1,
                numSpotShadows: -1
              },
              n = 0;
            n < 9;
            n++
          )
            t.probe.push(new ea());
          var r = new ea(),
            i = new ga(),
            a = new ga();
          return {
            setup: function(n, o, s) {
              for (var l = 0, c = 0, u = 0, h = 0; h < 9; h++)
                t.probe[h].set(0, 0, 0);
              var d = 0,
                p = 0,
                f = 0,
                m = 0,
                v = 0,
                g = 0,
                y = 0,
                b = 0,
                x = s.matrixWorldInverse;
              n.sort(Ic), (h = 0);
              for (var w = n.length; h < w; h++) {
                var _ = n[h],
                  M = _.color,
                  T = _.intensity,
                  A = _.distance,
                  S = _.shadow && _.shadow.map ? _.shadow.map.texture : null;
                if (_.isAmbientLight)
                  (l += M.r * T), (c += M.g * T), (u += M.b * T);
                else if (_.isLightProbe)
                  for (var E = 0; E < 9; E++)
                    t.probe[E].addScaledVector(_.sh.coefficients[E], T);
                else if (_.isDirectionalLight) {
                  if (
                    ((P = e.get(_)).color
                      .copy(_.color)
                      .multiplyScalar(_.intensity),
                    P.direction.setFromMatrixPosition(_.matrixWorld),
                    r.setFromMatrixPosition(_.target.matrixWorld),
                    P.direction.sub(r),
                    P.direction.transformDirection(x),
                    (P.shadow = _.castShadow),
                    _.castShadow)
                  ) {
                    var R = _.shadow;
                    (P.shadowBias = R.bias),
                      (P.shadowRadius = R.radius),
                      (P.shadowMapSize = R.mapSize),
                      (t.directionalShadowMap[d] = S),
                      (t.directionalShadowMatrix[d] = _.shadow.matrix),
                      g++;
                  }
                  (t.directional[d] = P), d++;
                } else if (_.isSpotLight)
                  (P = e.get(_)).position.setFromMatrixPosition(_.matrixWorld),
                    P.position.applyMatrix4(x),
                    P.color.copy(M).multiplyScalar(T),
                    (P.distance = A),
                    P.direction.setFromMatrixPosition(_.matrixWorld),
                    r.setFromMatrixPosition(_.target.matrixWorld),
                    P.direction.sub(r),
                    P.direction.transformDirection(x),
                    (P.coneCos = Math.cos(_.angle)),
                    (P.penumbraCos = Math.cos(_.angle * (1 - _.penumbra))),
                    (P.decay = _.decay),
                    (P.shadow = _.castShadow),
                    _.castShadow &&
                      ((R = _.shadow),
                      (P.shadowBias = R.bias),
                      (P.shadowRadius = R.radius),
                      (P.shadowMapSize = R.mapSize),
                      (t.spotShadowMap[f] = S),
                      (t.spotShadowMatrix[f] = _.shadow.matrix),
                      b++),
                    (t.spot[f] = P),
                    f++;
                else if (_.isRectAreaLight)
                  (P = e.get(_)).color.copy(M).multiplyScalar(T),
                    P.position.setFromMatrixPosition(_.matrixWorld),
                    P.position.applyMatrix4(x),
                    a.identity(),
                    i.copy(_.matrixWorld),
                    i.premultiply(x),
                    a.extractRotation(i),
                    P.halfWidth.set(0.5 * _.width, 0, 0),
                    P.halfHeight.set(0, 0.5 * _.height, 0),
                    P.halfWidth.applyMatrix4(a),
                    P.halfHeight.applyMatrix4(a),
                    (t.rectArea[m] = P),
                    m++;
                else if (_.isPointLight)
                  (P = e.get(_)).position.setFromMatrixPosition(_.matrixWorld),
                    P.position.applyMatrix4(x),
                    P.color.copy(_.color).multiplyScalar(_.intensity),
                    (P.distance = _.distance),
                    (P.decay = _.decay),
                    (P.shadow = _.castShadow),
                    _.castShadow &&
                      ((R = _.shadow),
                      (P.shadowBias = R.bias),
                      (P.shadowRadius = R.radius),
                      (P.shadowMapSize = R.mapSize),
                      (P.shadowCameraNear = R.camera.near),
                      (P.shadowCameraFar = R.camera.far),
                      (t.pointShadowMap[p] = S),
                      (t.pointShadowMatrix[p] = _.shadow.matrix),
                      y++),
                    (t.point[p] = P),
                    p++;
                else if (_.isHemisphereLight) {
                  var P;
                  (P = e.get(_)).direction.setFromMatrixPosition(_.matrixWorld),
                    P.direction.transformDirection(x),
                    P.direction.normalize(),
                    P.skyColor.copy(_.color).multiplyScalar(T),
                    P.groundColor.copy(_.groundColor).multiplyScalar(T),
                    (t.hemi[v] = P),
                    v++;
                }
              }
              (t.ambient[0] = l), (t.ambient[1] = c), (t.ambient[2] = u);
              var I = t.hash;
              (I.directionalLength === d &&
                I.pointLength === p &&
                I.spotLength === f &&
                I.rectAreaLength === m &&
                I.hemiLength === v &&
                I.numDirectionalShadows === g &&
                I.numPointShadows === y &&
                I.numSpotShadows === b) ||
                ((t.directional.length = d),
                (t.spot.length = f),
                (t.rectArea.length = m),
                (t.point.length = p),
                (t.hemi.length = v),
                (t.directionalShadowMap.length = g),
                (t.pointShadowMap.length = y),
                (t.spotShadowMap.length = b),
                (t.directionalShadowMatrix.length = g),
                (t.pointShadowMatrix.length = y),
                (t.spotShadowMatrix.length = b),
                (I.directionalLength = d),
                (I.pointLength = p),
                (I.spotLength = f),
                (I.rectAreaLength = m),
                (I.hemiLength = v),
                (I.numDirectionalShadows = g),
                (I.numPointShadows = y),
                (I.numSpotShadows = b),
                (t.version = Pc++));
            },
            state: t
          };
        }
        function Oc() {
          var e = new Dc(),
            t = [],
            n = [];
          return {
            init: function() {
              (t.length = 0), (n.length = 0);
            },
            state: { lightsArray: t, shadowsArray: n, lights: e },
            setupLights: function(r) {
              e.setup(t, n, r);
            },
            pushLight: function(e) {
              t.push(e);
            },
            pushShadow: function(e) {
              n.push(e);
            }
          };
        }
        function Cc() {
          var e = new WeakMap();
          function t(n) {
            var r = n.target;
            r.removeEventListener("dispose", t), e.delete(r);
          }
          return {
            get: function(n, r) {
              var i;
              return (
                !1 === e.has(n)
                  ? ((i = new Oc()),
                    e.set(n, new WeakMap()),
                    e.get(n).set(r, i),
                    n.addEventListener("dispose", t))
                  : !1 === e.get(n).has(r)
                  ? ((i = new Oc()), e.get(n).set(r, i))
                  : (i = e.get(n).get(r)),
                i
              );
            },
            dispose: function() {
              e = new WeakMap();
            }
          };
        }
        function Lc(e) {
          Co.call(this),
            (this.type = "MeshDepthMaterial"),
            (this.depthPacking = gi),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.map = null),
            (this.alphaMap = null),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.fog = !1),
            this.setValues(e);
        }
        function Nc(e) {
          Co.call(this),
            (this.type = "MeshDistanceMaterial"),
            (this.referencePosition = new ea()),
            (this.nearDistance = 1),
            (this.farDistance = 1e3),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.map = null),
            (this.alphaMap = null),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.fog = !1),
            this.setValues(e);
        }
        (Lc.prototype = Object.create(Co.prototype)),
          (Lc.prototype.constructor = Lc),
          (Lc.prototype.isMeshDepthMaterial = !0),
          (Lc.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              (this.depthPacking = e.depthPacking),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.map = e.map),
              (this.alphaMap = e.alphaMap),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              this
            );
          }),
          (Nc.prototype = Object.create(Co.prototype)),
          (Nc.prototype.constructor = Nc),
          (Nc.prototype.isMeshDistanceMaterial = !0),
          (Nc.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.referencePosition.copy(e.referencePosition),
              (this.nearDistance = e.nearDistance),
              (this.farDistance = e.farDistance),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.map = e.map),
              (this.alphaMap = e.alphaMap),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              this
            );
          });
        var Fc =
            "uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpack2HalfToRGBA ( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",
          kc = "void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";
        function Uc(e, t, n) {
          var r = new Gs(),
            i = new Zi(),
            a = new Zi(),
            o = new sa(),
            s = [],
            l = [],
            c = {},
            u = { 0: Yt, 1: Wt, 2: qt },
            h = new Cs({
              defines: { SAMPLE_RATE: 0.25, HALF_SAMPLE_RATE: 1 / 8 },
              uniforms: {
                shadow_pass: { value: null },
                resolution: { value: new Zi() },
                radius: { value: 4 }
              },
              vertexShader: kc,
              fragmentShader: Fc
            }),
            d = h.clone();
          d.defines.HORIZONAL_PASS = 1;
          var p = new es();
          p.setAttribute(
            "position",
            new No(new Float32Array([-1, -1, 0.5, 3, -1, 0.5, -1, 3, 0.5]), 3)
          );
          var f = new ys(p, h),
            m = this;
          function v(n, r) {
            var i = t.update(f);
            (h.uniforms.shadow_pass.value = n.map.texture),
              (h.uniforms.resolution.value = n.mapSize),
              (h.uniforms.radius.value = n.radius),
              e.setRenderTarget(n.mapPass),
              e.clear(),
              e.renderBufferDirect(r, null, i, h, f, null),
              (d.uniforms.shadow_pass.value = n.mapPass.texture),
              (d.uniforms.resolution.value = n.mapSize),
              (d.uniforms.radius.value = n.radius),
              e.setRenderTarget(n.map),
              e.clear(),
              e.renderBufferDirect(r, null, i, d, f, null);
          }
          function g(e, t, n) {
            var r = (e << 0) | (t << 1) | (n << 2),
              i = s[r];
            return (
              void 0 === i &&
                ((i = new Lc({
                  depthPacking: yi,
                  morphTargets: e,
                  skinning: t
                })),
                (s[r] = i)),
              i
            );
          }
          function y(e, t, n) {
            var r = (e << 0) | (t << 1) | (n << 2),
              i = l[r];
            return (
              void 0 === i &&
                ((i = new Nc({ morphTargets: e, skinning: t })), (l[r] = i)),
              i
            );
          }
          function b(t, n, r, i, a, o) {
            var s = t.geometry,
              l = null,
              h = g,
              d = t.customDepthMaterial;
            if (
              (!0 === r.isPointLight &&
                ((h = y), (d = t.customDistanceMaterial)),
              void 0 === d)
            ) {
              var p = !1;
              !0 === n.morphTargets &&
                (!0 === s.isBufferGeometry
                  ? (p =
                      s.morphAttributes &&
                      s.morphAttributes.position &&
                      s.morphAttributes.position.length > 0)
                  : !0 === s.isGeometry &&
                    (p = s.morphTargets && s.morphTargets.length > 0));
              var f = !1;
              !0 === t.isSkinnedMesh && !0 === n.skinning && (f = !0),
                (l = h(p, f, !0 === t.isInstancedMesh));
            } else l = d;
            if (
              e.localClippingEnabled &&
              !0 === n.clipShadows &&
              0 !== n.clippingPlanes.length
            ) {
              var m = l.uuid,
                v = n.uuid,
                b = c[m];
              void 0 === b && ((b = {}), (c[m] = b));
              var x = b[v];
              void 0 === x && ((x = l.clone()), (b[v] = x)), (l = x);
            }
            return (
              (l.visible = n.visible),
              (l.wireframe = n.wireframe),
              (l.side =
                o === Xt
                  ? null !== n.shadowSide
                    ? n.shadowSide
                    : n.side
                  : null !== n.shadowSide
                  ? n.shadowSide
                  : u[n.side]),
              (l.clipShadows = n.clipShadows),
              (l.clippingPlanes = n.clippingPlanes),
              (l.clipIntersection = n.clipIntersection),
              (l.wireframeLinewidth = n.wireframeLinewidth),
              (l.linewidth = n.linewidth),
              !0 === r.isPointLight &&
                !0 === l.isMeshDistanceMaterial &&
                (l.referencePosition.setFromMatrixPosition(r.matrixWorld),
                (l.nearDistance = i),
                (l.farDistance = a)),
              l
            );
          }
          function x(n, i, a, o, s) {
            if (!1 !== n.visible) {
              if (
                n.layers.test(i.layers) &&
                (n.isMesh || n.isLine || n.isPoints) &&
                (n.castShadow || (n.receiveShadow && s === Xt)) &&
                (!n.frustumCulled || r.intersectsObject(n))
              ) {
                n.modelViewMatrix.multiplyMatrices(
                  a.matrixWorldInverse,
                  n.matrixWorld
                );
                var l = t.update(n),
                  c = n.material;
                if (Array.isArray(c))
                  for (var u = l.groups, h = 0, d = u.length; h < d; h++) {
                    var p = u[h],
                      f = c[p.materialIndex];
                    if (f && f.visible) {
                      var m = b(n, f, o, a.near, a.far, s);
                      e.renderBufferDirect(a, null, l, m, n, p);
                    }
                  }
                else
                  c.visible &&
                    ((m = b(n, c, o, a.near, a.far, s)),
                    e.renderBufferDirect(a, null, l, m, n, null));
              }
              for (var v = n.children, g = 0, y = v.length; g < y; g++)
                x(v[g], i, a, o, s);
            }
          }
          (this.enabled = !1),
            (this.autoUpdate = !0),
            (this.needsUpdate = !1),
            (this.type = Gt),
            (this.render = function(t, s, l) {
              if (
                !1 !== m.enabled &&
                (!1 !== m.autoUpdate || !1 !== m.needsUpdate) &&
                0 !== t.length
              ) {
                var c = e.getRenderTarget(),
                  u = e.getActiveCubeFace(),
                  h = e.getActiveMipmapLevel(),
                  d = e.state;
                d.setBlending(en),
                  d.buffers.color.setClear(1, 1, 1, 1),
                  d.buffers.depth.setTest(!0),
                  d.setScissorTest(!1);
                for (var p = 0, f = t.length; p < f; p++) {
                  var g = t[p],
                    y = g.shadow;
                  if (void 0 !== y) {
                    i.copy(y.mapSize);
                    var b = y.getFrameExtents();
                    if (
                      (i.multiply(b),
                      a.copy(y.mapSize),
                      (i.x > n || i.y > n) &&
                        (i.x > n &&
                          ((a.x = Math.floor(n / b.x)),
                          (i.x = a.x * b.x),
                          (y.mapSize.x = a.x)),
                        i.y > n &&
                          ((a.y = Math.floor(n / b.y)),
                          (i.y = a.y * b.y),
                          (y.mapSize.y = a.y))),
                      null === y.map &&
                        !y.isPointLightShadow &&
                        this.type === Xt)
                    ) {
                      var w = { minFilter: nr, magFilter: nr, format: wr };
                      (y.map = new la(i.x, i.y, w)),
                        (y.map.texture.name = g.name + ".shadowMap"),
                        (y.mapPass = new la(i.x, i.y, w)),
                        y.camera.updateProjectionMatrix();
                    }
                    null === y.map &&
                      ((w = { minFilter: Jn, magFilter: Jn, format: wr }),
                      (y.map = new la(i.x, i.y, w)),
                      (y.map.texture.name = g.name + ".shadowMap"),
                      y.camera.updateProjectionMatrix()),
                      e.setRenderTarget(y.map),
                      e.clear();
                    for (var _ = y.getViewportCount(), M = 0; M < _; M++) {
                      var T = y.getViewport(M);
                      o.set(a.x * T.x, a.y * T.y, a.x * T.z, a.y * T.w),
                        d.viewport(o),
                        y.updateMatrices(g, M),
                        (r = y.getFrustum()),
                        x(s, l, y.camera, g, this.type);
                    }
                    y.isPointLightShadow || this.type !== Xt || v(y, l);
                  }
                }
                (m.needsUpdate = !1), e.setRenderTarget(c, u, h);
              }
            });
        }
        function jc(e, t, n) {
          var r = n.isWebGL2,
            i = new (function() {
              var t = !1,
                n = new sa(),
                r = null,
                i = new sa(0, 0, 0, 0);
              return {
                setMask: function(n) {
                  r === n || t || (e.colorMask(n, n, n, n), (r = n));
                },
                setLocked: function(e) {
                  t = e;
                },
                setClear: function(t, r, a, o, s) {
                  !0 === s && ((t *= o), (r *= o), (a *= o)),
                    n.set(t, r, a, o),
                    !1 === i.equals(n) && (e.clearColor(t, r, a, o), i.copy(n));
                },
                reset: function() {
                  (t = !1), (r = null), i.set(-1, 0, 0, 0);
                }
              };
            })(),
            a = new (function() {
              var t = !1,
                n = null,
                r = null,
                i = null;
              return {
                setTest: function(e) {
                  e ? U(2929) : j(2929);
                },
                setMask: function(r) {
                  n === r || t || (e.depthMask(r), (n = r));
                },
                setFunc: function(t) {
                  if (r !== t) {
                    if (t)
                      switch (t) {
                        case Mn:
                          e.depthFunc(512);
                          break;
                        case Tn:
                          e.depthFunc(519);
                          break;
                        case An:
                          e.depthFunc(513);
                          break;
                        case Sn:
                          e.depthFunc(515);
                          break;
                        case En:
                          e.depthFunc(514);
                          break;
                        case Rn:
                          e.depthFunc(518);
                          break;
                        case Pn:
                          e.depthFunc(516);
                          break;
                        case In:
                          e.depthFunc(517);
                          break;
                        default:
                          e.depthFunc(515);
                      }
                    else e.depthFunc(515);
                    r = t;
                  }
                },
                setLocked: function(e) {
                  t = e;
                },
                setClear: function(t) {
                  i !== t && (e.clearDepth(t), (i = t));
                },
                reset: function() {
                  (t = !1), (n = null), (r = null), (i = null);
                }
              };
            })(),
            o = new (function() {
              var t = !1,
                n = null,
                r = null,
                i = null,
                a = null,
                o = null,
                s = null,
                l = null,
                c = null;
              return {
                setTest: function(e) {
                  t || (e ? U(2960) : j(2960));
                },
                setMask: function(r) {
                  n === r || t || (e.stencilMask(r), (n = r));
                },
                setFunc: function(t, n, o) {
                  (r === t && i === n && a === o) ||
                    (e.stencilFunc(t, n, o), (r = t), (i = n), (a = o));
                },
                setOp: function(t, n, r) {
                  (o === t && s === n && l === r) ||
                    (e.stencilOp(t, n, r), (o = t), (s = n), (l = r));
                },
                setLocked: function(e) {
                  t = e;
                },
                setClear: function(t) {
                  c !== t && (e.clearStencil(t), (c = t));
                },
                reset: function() {
                  (t = !1),
                    (n = null),
                    (r = null),
                    (i = null),
                    (a = null),
                    (o = null),
                    (s = null),
                    (l = null),
                    (c = null);
                }
              };
            })(),
            s = e.getParameter(34921),
            l = new Uint8Array(s),
            c = new Uint8Array(s),
            u = new Uint8Array(s),
            h = {},
            d = null,
            p = null,
            f = null,
            m = null,
            v = null,
            g = null,
            y = null,
            b = null,
            x = null,
            w = !1,
            _ = null,
            M = null,
            T = null,
            A = null,
            S = null,
            E = e.getParameter(35661),
            R = !1,
            P = 0,
            I = e.getParameter(7938);
          -1 !== I.indexOf("WebGL")
            ? ((P = parseFloat(/^WebGL\ ([0-9])/.exec(I)[1])), (R = P >= 1))
            : -1 !== I.indexOf("OpenGL ES") &&
              ((P = parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(I)[1])),
              (R = P >= 2));
          var D = null,
            O = {},
            C = new sa(),
            L = new sa();
          function N(t, n, r) {
            var i = new Uint8Array(4),
              a = e.createTexture();
            e.bindTexture(t, a),
              e.texParameteri(t, 10241, 9728),
              e.texParameteri(t, 10240, 9728);
            for (var o = 0; o < r; o++)
              e.texImage2D(n + o, 0, 6408, 1, 1, 0, 6408, 5121, i);
            return a;
          }
          var F = {};
          function k(n, i) {
            (l[n] = 1),
              0 === c[n] && (e.enableVertexAttribArray(n), (c[n] = 1)),
              u[n] !== i &&
                ((r ? e : t.get("ANGLE_instanced_arrays"))[
                  r ? "vertexAttribDivisor" : "vertexAttribDivisorANGLE"
                ](n, i),
                (u[n] = i));
          }
          function U(t) {
            !0 !== h[t] && (e.enable(t), (h[t] = !0));
          }
          function j(t) {
            !1 !== h[t] && (e.disable(t), (h[t] = !1));
          }
          (F[3553] = N(3553, 3553, 1)),
            (F[34067] = N(34067, 34069, 6)),
            i.setClear(0, 0, 0, 1),
            a.setClear(1),
            o.setClear(0),
            U(2929),
            a.setFunc(Sn),
            H(!1),
            X(kt),
            U(2884),
            G(en);
          var B = { [sn]: 32774, [ln]: 32778, [cn]: 32779 };
          if (r) (B[un] = 32775), (B[hn] = 32776);
          else {
            var z = t.get("EXT_blend_minmax");
            null !== z && ((B[un] = z.MIN_EXT), (B[hn] = z.MAX_EXT));
          }
          var V = {
            [dn]: 0,
            [pn]: 1,
            [fn]: 768,
            [vn]: 770,
            [_n]: 776,
            [xn]: 774,
            [yn]: 772,
            [mn]: 769,
            [gn]: 771,
            [wn]: 775,
            [bn]: 773
          };
          function G(t, n, r, i, a, o, s, l) {
            if (t !== en) {
              if ((p || (U(3042), (p = !0)), t === on))
                (a = a || n),
                  (o = o || r),
                  (s = s || i),
                  (n === m && a === y) ||
                    (e.blendEquationSeparate(B[n], B[a]), (m = n), (y = a)),
                  (r === v && i === g && o === b && s === x) ||
                    (e.blendFuncSeparate(V[r], V[i], V[o], V[s]),
                    (v = r),
                    (g = i),
                    (b = o),
                    (x = s)),
                  (f = t),
                  (w = null);
              else if (t !== f || l !== w) {
                if (
                  ((m === sn && y === sn) ||
                    (e.blendEquation(32774), (m = sn), (y = sn)),
                  l)
                )
                  switch (t) {
                    case tn:
                      e.blendFuncSeparate(1, 771, 1, 771);
                      break;
                    case nn:
                      e.blendFunc(1, 1);
                      break;
                    case rn:
                      e.blendFuncSeparate(0, 0, 769, 771);
                      break;
                    case an:
                      e.blendFuncSeparate(0, 768, 0, 770);
                  }
                else
                  switch (t) {
                    case tn:
                      e.blendFuncSeparate(770, 771, 1, 771);
                      break;
                    case nn:
                      e.blendFunc(770, 1);
                      break;
                    case rn:
                      e.blendFunc(0, 769);
                      break;
                    case an:
                      e.blendFunc(0, 768);
                  }
                (v = null),
                  (g = null),
                  (b = null),
                  (x = null),
                  (f = t),
                  (w = l);
              }
            } else p && (j(3042), (p = !1));
          }
          function H(t) {
            _ !== t && (t ? e.frontFace(2304) : e.frontFace(2305), (_ = t));
          }
          function X(t) {
            t !== Ft
              ? (U(2884),
                t !== M &&
                  (t === kt
                    ? e.cullFace(1029)
                    : t === Ut
                    ? e.cullFace(1028)
                    : e.cullFace(1032)))
              : j(2884),
              (M = t);
          }
          function W(t, n, r) {
            t
              ? (U(32823),
                (A === n && S === r) ||
                  (e.polygonOffset(n, r), (A = n), (S = r)))
              : j(32823);
          }
          function Y(t) {
            void 0 === t && (t = 33984 + E - 1),
              D !== t && (e.activeTexture(t), (D = t));
          }
          return {
            buffers: { color: i, depth: a, stencil: o },
            initAttributes: function() {
              for (var e = 0, t = l.length; e < t; e++) l[e] = 0;
            },
            enableAttribute: function(e) {
              k(e, 0);
            },
            enableAttributeAndDivisor: k,
            disableUnusedAttributes: function() {
              for (var t = 0, n = c.length; t !== n; ++t)
                c[t] !== l[t] && (e.disableVertexAttribArray(t), (c[t] = 0));
            },
            enable: U,
            disable: j,
            useProgram: function(t) {
              return d !== t && (e.useProgram(t), (d = t), !0);
            },
            setBlending: G,
            setMaterial: function(e, t) {
              e.side === qt ? j(2884) : U(2884);
              var n = e.side === Yt;
              t && (n = !n),
                H(n),
                e.blending === tn && !1 === e.transparent
                  ? G(en)
                  : G(
                      e.blending,
                      e.blendEquation,
                      e.blendSrc,
                      e.blendDst,
                      e.blendEquationAlpha,
                      e.blendSrcAlpha,
                      e.blendDstAlpha,
                      e.premultipliedAlpha
                    ),
                a.setFunc(e.depthFunc),
                a.setTest(e.depthTest),
                a.setMask(e.depthWrite),
                i.setMask(e.colorWrite);
              var r = e.stencilWrite;
              o.setTest(r),
                r &&
                  (o.setMask(e.stencilWriteMask),
                  o.setFunc(e.stencilFunc, e.stencilRef, e.stencilFuncMask),
                  o.setOp(e.stencilFail, e.stencilZFail, e.stencilZPass)),
                W(e.polygonOffset, e.polygonOffsetFactor, e.polygonOffsetUnits);
            },
            setFlipSided: H,
            setCullFace: X,
            setLineWidth: function(t) {
              t !== T && (R && e.lineWidth(t), (T = t));
            },
            setPolygonOffset: W,
            setScissorTest: function(e) {
              e ? U(3089) : j(3089);
            },
            activeTexture: Y,
            bindTexture: function(t, n) {
              null === D && Y();
              var r = O[D];
              void 0 === r &&
                ((r = { type: void 0, texture: void 0 }), (O[D] = r)),
                (r.type === t && r.texture === n) ||
                  (e.bindTexture(t, n || F[t]), (r.type = t), (r.texture = n));
            },
            unbindTexture: function() {
              var t = O[D];
              void 0 !== t &&
                void 0 !== t.type &&
                (e.bindTexture(t.type, null),
                (t.type = void 0),
                (t.texture = void 0));
            },
            compressedTexImage2D: function() {
              try {
                e.compressedTexImage2D.apply(e, arguments);
              } catch (e) {}
            },
            texImage2D: function() {
              try {
                e.texImage2D.apply(e, arguments);
              } catch (e) {}
            },
            texImage3D: function() {
              try {
                e.texImage3D.apply(e, arguments);
              } catch (e) {}
            },
            scissor: function(t) {
              !1 === C.equals(t) && (e.scissor(t.x, t.y, t.z, t.w), C.copy(t));
            },
            viewport: function(t) {
              !1 === L.equals(t) && (e.viewport(t.x, t.y, t.z, t.w), L.copy(t));
            },
            reset: function() {
              for (var t = 0; t < c.length; t++)
                1 === c[t] && (e.disableVertexAttribArray(t), (c[t] = 0));
              (h = {}),
                (D = null),
                (O = {}),
                (d = null),
                (f = null),
                (_ = null),
                (M = null),
                i.reset(),
                a.reset(),
                o.reset();
            }
          };
        }
        function Bc(e, t, n, r, i, a, o) {
          var s,
            l = i.isWebGL2,
            c = (i.maxTextures, i.maxCubemapSize),
            u = i.maxTextureSize,
            h = i.maxSamples,
            d = new WeakMap(),
            p =
              "undefined" != typeof OffscreenCanvas &&
              null !== new OffscreenCanvas(1, 1).getContext("2d");
          function f(e, t) {
            return p
              ? new OffscreenCanvas(e, t)
              : document.createElementNS(
                  "http://www.w3.org/1999/xhtml",
                  "canvas"
                );
          }
          function m(e, t, n, r) {
            var i = 1;
            if (
              ((e.width > r || e.height > r) &&
                (i = r / Math.max(e.width, e.height)),
              i < 1 || !0 === t)
            ) {
              if (
                ("undefined" != typeof HTMLImageElement &&
                  e instanceof HTMLImageElement) ||
                ("undefined" != typeof HTMLCanvasElement &&
                  e instanceof HTMLCanvasElement) ||
                ("undefined" != typeof ImageBitmap && e instanceof ImageBitmap)
              ) {
                var a = t ? Qi.floorPowerOfTwo : Math.floor,
                  o = a(i * e.width),
                  l = a(i * e.height);
                void 0 === s && (s = f(o, l));
                var c = n ? f(o, l) : s;
                return (
                  (c.width = o),
                  (c.height = l),
                  c.getContext("2d").drawImage(e, 0, 0, o, l),
                  c
                );
              }
              return e;
            }
            return e;
          }
          function v(e) {
            return Qi.isPowerOfTwo(e.width) && Qi.isPowerOfTwo(e.height);
          }
          function g(e, t) {
            return (
              e.generateMipmaps && t && e.minFilter !== Jn && e.minFilter !== nr
            );
          }
          function y(t, n, i, a) {
            e.generateMipmap(t),
              (r.get(n).__maxMipLevel = Math.log(Math.max(i, a)) * Math.LOG2E);
          }
          function b(e, n) {
            if (!1 === l) return e;
            var r = e;
            return (
              6403 === e &&
                (5126 === n && (r = 33326),
                5131 === n && (r = 33325),
                5121 === n && (r = 33321)),
              6407 === e &&
                (5126 === n && (r = 34837),
                5131 === n && (r = 34843),
                5121 === n && (r = 32849)),
              6408 === e &&
                (5126 === n && (r = 34836),
                5131 === n && (r = 34842),
                5121 === n && (r = 32856)),
              (33325 !== r && 33326 !== r && 34842 !== r && 34836 !== r) ||
                t.get("EXT_color_buffer_float"),
              r
            );
          }
          function x(e) {
            return e === Jn || e === Kn || e === er ? 9728 : 9729;
          }
          function w(t) {
            var n = t.target;
            n.removeEventListener("dispose", w),
              (function(t) {
                var n = r.get(t);
                void 0 !== n.__webglInit &&
                  (e.deleteTexture(n.__webglTexture), r.remove(t));
              })(n),
              n.isVideoTexture && d.delete(n),
              o.memory.textures--;
          }
          function _(t) {
            var n = t.target;
            n.removeEventListener("dispose", _),
              (function(t) {
                var n = r.get(t),
                  i = r.get(t.texture);
                if (t) {
                  if (
                    (void 0 !== i.__webglTexture &&
                      e.deleteTexture(i.__webglTexture),
                    t.depthTexture && t.depthTexture.dispose(),
                    t.isWebGLRenderTargetCube)
                  )
                    for (var a = 0; a < 6; a++)
                      e.deleteFramebuffer(n.__webglFramebuffer[a]),
                        n.__webglDepthbuffer &&
                          e.deleteRenderbuffer(n.__webglDepthbuffer[a]);
                  else
                    e.deleteFramebuffer(n.__webglFramebuffer),
                      n.__webglDepthbuffer &&
                        e.deleteRenderbuffer(n.__webglDepthbuffer);
                  if (t.isWebGLMultiviewRenderTarget) {
                    e.deleteTexture(n.__webglColorTexture),
                      e.deleteTexture(n.__webglDepthStencilTexture),
                      (o.memory.textures -= 2),
                      (a = 0);
                    for (var s = n.__webglViewFramebuffers.length; a < s; a++)
                      e.deleteFramebuffer(n.__webglViewFramebuffers[a]);
                  }
                  r.remove(t.texture), r.remove(t);
                }
              })(n),
              o.memory.textures--;
          }
          var M = 0;
          function T(e, t) {
            var i = r.get(e);
            if (
              (e.isVideoTexture &&
                (function(e) {
                  var t = o.render.frame;
                  d.get(e) !== t && (d.set(e, t), e.update());
                })(e),
              e.version > 0 && i.__version !== e.version)
            ) {
              var a = e.image;
              if (void 0 === a);
              else if (!1 !== a.complete) return void D(i, e, t);
            }
            n.activeTexture(33984 + t), n.bindTexture(3553, i.__webglTexture);
          }
          function A(t, i) {
            if (6 === t.image.length) {
              var o = r.get(t);
              if (t.version > 0 && o.__version !== t.version) {
                I(o, t),
                  n.activeTexture(33984 + i),
                  n.bindTexture(34067, o.__webglTexture),
                  e.pixelStorei(37440, t.flipY);
                for (
                  var s = t && t.isCompressedTexture,
                    u = t.image[0] && t.image[0].isDataTexture,
                    h = [],
                    d = 0;
                  d < 6;
                  d++
                )
                  h[d] =
                    s || u
                      ? u
                        ? t.image[d].image
                        : t.image[d]
                      : m(t.image[d], !1, !0, c);
                var p,
                  f = h[0],
                  x = v(f) || l,
                  w = a.convert(t.format),
                  _ = a.convert(t.type),
                  M = b(w, _);
                if ((P(34067, t, x), s)) {
                  for (d = 0; d < 6; d++) {
                    p = h[d].mipmaps;
                    for (var T = 0; T < p.length; T++) {
                      var A = p[T];
                      t.format !== wr && t.format !== xr
                        ? null !== w &&
                          n.compressedTexImage2D(
                            34069 + d,
                            T,
                            M,
                            A.width,
                            A.height,
                            0,
                            A.data
                          )
                        : n.texImage2D(
                            34069 + d,
                            T,
                            M,
                            A.width,
                            A.height,
                            0,
                            w,
                            _,
                            A.data
                          );
                    }
                  }
                  o.__maxMipLevel = p.length - 1;
                } else {
                  for (p = t.mipmaps, d = 0; d < 6; d++)
                    if (u)
                      for (
                        n.texImage2D(
                          34069 + d,
                          0,
                          M,
                          h[d].width,
                          h[d].height,
                          0,
                          w,
                          _,
                          h[d].data
                        ),
                          T = 0;
                        T < p.length;
                        T++
                      ) {
                        var S = (A = p[T]).image[d].image;
                        n.texImage2D(
                          34069 + d,
                          T + 1,
                          M,
                          S.width,
                          S.height,
                          0,
                          w,
                          _,
                          S.data
                        );
                      }
                    else
                      for (
                        n.texImage2D(34069 + d, 0, M, w, _, h[d]), T = 0;
                        T < p.length;
                        T++
                      )
                        (A = p[T]),
                          n.texImage2D(34069 + d, T + 1, M, w, _, A.image[d]);
                  o.__maxMipLevel = p.length;
                }
                g(t, x) && y(34067, t, f.width, f.height),
                  (o.__version = t.version),
                  t.onUpdate && t.onUpdate(t);
              } else
                n.activeTexture(33984 + i),
                  n.bindTexture(34067, o.__webglTexture);
            }
          }
          function S(e, t) {
            n.activeTexture(33984 + t),
              n.bindTexture(34067, r.get(e).__webglTexture);
          }
          var E = { [qn]: 10497, [Qn]: 33071, [Zn]: 33648 },
            R = {
              [Jn]: 9728,
              [Kn]: 9984,
              [er]: 9986,
              [nr]: 9729,
              [rr]: 9985,
              [ar]: 9987
            };
          function P(n, a, o) {
            o
              ? (e.texParameteri(n, 10242, E[a.wrapS]),
                e.texParameteri(n, 10243, E[a.wrapT]),
                (32879 !== n && 35866 !== n) ||
                  e.texParameteri(n, 32882, E[a.wrapR]),
                e.texParameteri(n, 10240, R[a.magFilter]),
                e.texParameteri(n, 10241, R[a.minFilter]))
              : (e.texParameteri(n, 10242, 33071),
                e.texParameteri(n, 10243, 33071),
                (32879 !== n && 35866 !== n) ||
                  e.texParameteri(n, 32882, 33071),
                a.wrapS !== Qn || a.wrapT,
                e.texParameteri(n, 10240, x(a.magFilter)),
                e.texParameteri(n, 10241, x(a.minFilter)),
                a.minFilter !== Jn && a.minFilter);
            var s = t.get("EXT_texture_filter_anisotropic");
            if (s) {
              if (a.type === pr && null === t.get("OES_texture_float_linear"))
                return;
              if (
                a.type === fr &&
                null === (l || t.get("OES_texture_half_float_linear"))
              )
                return;
              (a.anisotropy > 1 || r.get(a).__currentAnisotropy) &&
                (e.texParameterf(
                  n,
                  s.TEXTURE_MAX_ANISOTROPY_EXT,
                  Math.min(a.anisotropy, i.getMaxAnisotropy())
                ),
                (r.get(a).__currentAnisotropy = a.anisotropy));
            }
          }
          function I(t, n) {
            void 0 === t.__webglInit &&
              ((t.__webglInit = !0),
              n.addEventListener("dispose", w),
              (t.__webglTexture = e.createTexture()),
              o.memory.textures++);
          }
          function D(t, r, i) {
            var o = 3553;
            r.isDataTexture2DArray && (o = 35866),
              r.isDataTexture3D && (o = 32879),
              I(t, r),
              n.activeTexture(33984 + i),
              n.bindTexture(o, t.__webglTexture),
              e.pixelStorei(37440, r.flipY),
              e.pixelStorei(37441, r.premultiplyAlpha),
              e.pixelStorei(3317, r.unpackAlignment);
            var s =
                (function(e) {
                  return (
                    !l &&
                    (e.wrapS !== Qn ||
                      e.wrapT !== Qn ||
                      (e.minFilter !== Jn && e.minFilter !== nr))
                  );
                })(r) && !1 === v(r.image),
              c = m(r.image, s, !1, u),
              h = v(c) || l,
              d = a.convert(r.format),
              p = a.convert(r.type),
              f = b(d, p);
            P(o, r, h);
            var x,
              w = r.mipmaps;
            if (r.isDepthTexture) {
              if (((f = 6402), r.type === pr)) {
                if (!1 === l)
                  throw new Error(
                    "Float Depth Texture only supported in WebGL2.0"
                  );
                f = 36012;
              } else l && (f = 33189);
              r.format === Ar &&
                6402 === f &&
                r.type !== ur &&
                r.type !== dr &&
                ((r.type = ur), (p = a.convert(r.type))),
                r.format === Sr &&
                  ((f = 34041),
                  r.type !== yr && ((r.type = yr), (p = a.convert(r.type)))),
                n.texImage2D(3553, 0, f, c.width, c.height, 0, d, p, null);
            } else if (r.isDataTexture)
              if (w.length > 0 && h) {
                for (var _ = 0, M = w.length; _ < M; _++)
                  (x = w[_]),
                    n.texImage2D(
                      3553,
                      _,
                      f,
                      x.width,
                      x.height,
                      0,
                      d,
                      p,
                      x.data
                    );
                (r.generateMipmaps = !1), (t.__maxMipLevel = w.length - 1);
              } else
                n.texImage2D(3553, 0, f, c.width, c.height, 0, d, p, c.data),
                  (t.__maxMipLevel = 0);
            else if (r.isCompressedTexture) {
              for (_ = 0, M = w.length; _ < M; _++)
                (x = w[_]),
                  r.format !== wr && r.format !== xr
                    ? null !== d &&
                      n.compressedTexImage2D(
                        3553,
                        _,
                        f,
                        x.width,
                        x.height,
                        0,
                        x.data
                      )
                    : n.texImage2D(
                        3553,
                        _,
                        f,
                        x.width,
                        x.height,
                        0,
                        d,
                        p,
                        x.data
                      );
              t.__maxMipLevel = w.length - 1;
            } else if (r.isDataTexture2DArray)
              n.texImage3D(
                35866,
                0,
                f,
                c.width,
                c.height,
                c.depth,
                0,
                d,
                p,
                c.data
              ),
                (t.__maxMipLevel = 0);
            else if (r.isDataTexture3D)
              n.texImage3D(
                32879,
                0,
                f,
                c.width,
                c.height,
                c.depth,
                0,
                d,
                p,
                c.data
              ),
                (t.__maxMipLevel = 0);
            else if (w.length > 0 && h) {
              for (_ = 0, M = w.length; _ < M; _++)
                (x = w[_]), n.texImage2D(3553, _, f, d, p, x);
              (r.generateMipmaps = !1), (t.__maxMipLevel = w.length - 1);
            } else n.texImage2D(3553, 0, f, d, p, c), (t.__maxMipLevel = 0);
            g(r, h) && y(3553, r, c.width, c.height),
              (t.__version = r.version),
              r.onUpdate && r.onUpdate(r);
          }
          function O(t, i, o, s) {
            var l = a.convert(i.texture.format),
              c = a.convert(i.texture.type),
              u = b(l, c);
            n.texImage2D(s, 0, u, i.width, i.height, 0, l, c, null),
              e.bindFramebuffer(36160, t),
              e.framebufferTexture2D(
                36160,
                o,
                s,
                r.get(i.texture).__webglTexture,
                0
              ),
              e.bindFramebuffer(36160, null);
          }
          function C(t, n, r) {
            if (
              (e.bindRenderbuffer(36161, t), n.depthBuffer && !n.stencilBuffer)
            ) {
              if (r) {
                var i = N(n);
                e.renderbufferStorageMultisample(
                  36161,
                  i,
                  33189,
                  n.width,
                  n.height
                );
              } else e.renderbufferStorage(36161, 33189, n.width, n.height);
              e.framebufferRenderbuffer(36160, 36096, 36161, t);
            } else if (n.depthBuffer && n.stencilBuffer)
              r
                ? ((i = N(n)),
                  e.renderbufferStorageMultisample(
                    36161,
                    i,
                    35056,
                    n.width,
                    n.height
                  ))
                : e.renderbufferStorage(36161, 34041, n.width, n.height),
                e.framebufferRenderbuffer(36160, 33306, 36161, t);
            else {
              var o = b(a.convert(n.texture.format), a.convert(n.texture.type));
              r
                ? ((i = N(n)),
                  e.renderbufferStorageMultisample(
                    36161,
                    i,
                    o,
                    n.width,
                    n.height
                  ))
                : e.renderbufferStorage(36161, o, n.width, n.height);
            }
            e.bindRenderbuffer(36161, null);
          }
          function L(t) {
            var n = r.get(t),
              i = !0 === t.isWebGLRenderTargetCube;
            if (t.depthTexture) {
              if (i)
                throw new Error(
                  "target.depthTexture not supported in Cube render targets"
                );
              !(function(t, n) {
                if (n && n.isWebGLRenderTargetCube)
                  throw new Error(
                    "Depth Texture with cube render targets is not supported"
                  );
                if (
                  (e.bindFramebuffer(36160, t),
                  !n.depthTexture || !n.depthTexture.isDepthTexture)
                )
                  throw new Error(
                    "renderTarget.depthTexture must be an instance of THREE.DepthTexture"
                  );
                (r.get(n.depthTexture).__webglTexture &&
                  n.depthTexture.image.width === n.width &&
                  n.depthTexture.image.height === n.height) ||
                  ((n.depthTexture.image.width = n.width),
                  (n.depthTexture.image.height = n.height),
                  (n.depthTexture.needsUpdate = !0)),
                  T(n.depthTexture, 0);
                var i = r.get(n.depthTexture).__webglTexture;
                if (n.depthTexture.format === Ar)
                  e.framebufferTexture2D(36160, 36096, 3553, i, 0);
                else {
                  if (n.depthTexture.format !== Sr)
                    throw new Error("Unknown depthTexture format");
                  e.framebufferTexture2D(36160, 33306, 3553, i, 0);
                }
              })(n.__webglFramebuffer, t);
            } else if (i) {
              n.__webglDepthbuffer = [];
              for (var a = 0; a < 6; a++)
                e.bindFramebuffer(36160, n.__webglFramebuffer[a]),
                  (n.__webglDepthbuffer[a] = e.createRenderbuffer()),
                  C(n.__webglDepthbuffer[a], t);
            } else
              e.bindFramebuffer(36160, n.__webglFramebuffer),
                (n.__webglDepthbuffer = e.createRenderbuffer()),
                C(n.__webglDepthbuffer, t);
            e.bindFramebuffer(36160, null);
          }
          function N(e) {
            return l && e.isWebGLMultisampleRenderTarget
              ? Math.min(h, e.samples)
              : 0;
          }
          var F = !1,
            k = !1;
          (this.allocateTextureUnit = function() {
            var e = M;
            return (M += 1), e;
          }),
            (this.resetTextureUnits = function() {
              M = 0;
            }),
            (this.setTexture2D = T),
            (this.setTexture2DArray = function(e, t) {
              var i = r.get(e);
              e.version > 0 && i.__version !== e.version
                ? D(i, e, t)
                : (n.activeTexture(33984 + t),
                  n.bindTexture(35866, i.__webglTexture));
            }),
            (this.setTexture3D = function(e, t) {
              var i = r.get(e);
              e.version > 0 && i.__version !== e.version
                ? D(i, e, t)
                : (n.activeTexture(33984 + t),
                  n.bindTexture(32879, i.__webglTexture));
            }),
            (this.setTextureCube = A),
            (this.setTextureCubeDynamic = S),
            (this.setupRenderTarget = function(i) {
              var s = r.get(i),
                c = r.get(i.texture);
              i.addEventListener("dispose", _),
                (c.__webglTexture = e.createTexture()),
                o.memory.textures++;
              var u = !0 === i.isWebGLRenderTargetCube,
                h = !0 === i.isWebGLMultisampleRenderTarget,
                d = !0 === i.isWebGLMultiviewRenderTarget,
                p = v(i) || l;
              if (u) {
                s.__webglFramebuffer = [];
                for (var f = 0; f < 6; f++)
                  s.__webglFramebuffer[f] = e.createFramebuffer();
              } else if (((s.__webglFramebuffer = e.createFramebuffer()), h)) {
                if (l) {
                  (s.__webglMultisampledFramebuffer = e.createFramebuffer()),
                    (s.__webglColorRenderbuffer = e.createRenderbuffer()),
                    e.bindRenderbuffer(36161, s.__webglColorRenderbuffer);
                  var m = b(
                      a.convert(i.texture.format),
                      a.convert(i.texture.type)
                    ),
                    x = N(i);
                  e.renderbufferStorageMultisample(
                    36161,
                    x,
                    m,
                    i.width,
                    i.height
                  ),
                    e.bindFramebuffer(36160, s.__webglMultisampledFramebuffer),
                    e.framebufferRenderbuffer(
                      36160,
                      36064,
                      36161,
                      s.__webglColorRenderbuffer
                    ),
                    e.bindRenderbuffer(36161, null),
                    i.depthBuffer &&
                      ((s.__webglDepthRenderbuffer = e.createRenderbuffer()),
                      C(s.__webglDepthRenderbuffer, i, !0)),
                    e.bindFramebuffer(36160, null);
                }
              } else if (d) {
                var w = i.width,
                  M = i.height,
                  T = i.numViews;
                e.bindFramebuffer(36160, s.__webglFramebuffer);
                var A = t.get("OVR_multiview2");
                o.memory.textures += 2;
                var S = e.createTexture();
                e.bindTexture(35866, S),
                  e.texParameteri(35866, 10240, 9728),
                  e.texParameteri(35866, 10241, 9728),
                  e.texImage3D(35866, 0, 32856, w, M, T, 0, 6408, 5121, null),
                  A.framebufferTextureMultiviewOVR(36160, 36064, S, 0, 0, T);
                var E = e.createTexture();
                e.bindTexture(35866, E),
                  e.texParameteri(35866, 10240, 9728),
                  e.texParameteri(35866, 10241, 9728),
                  e.texImage3D(35866, 0, 35056, w, M, T, 0, 34041, 34042, null),
                  A.framebufferTextureMultiviewOVR(36160, 33306, E, 0, 0, T);
                var R = new Array(T);
                for (f = 0; f < T; ++f)
                  (R[f] = e.createFramebuffer()),
                    e.bindFramebuffer(36160, R[f]),
                    e.framebufferTextureLayer(36160, 36064, S, 0, f);
                (s.__webglColorTexture = S),
                  (s.__webglDepthStencilTexture = E),
                  (s.__webglViewFramebuffers = R),
                  e.bindFramebuffer(36160, null),
                  e.bindTexture(35866, null);
              }
              if (u) {
                for (
                  n.bindTexture(34067, c.__webglTexture),
                    P(34067, i.texture, p),
                    f = 0;
                  f < 6;
                  f++
                )
                  O(s.__webglFramebuffer[f], i, 36064, 34069 + f);
                g(i.texture, p) && y(34067, i.texture, i.width, i.height),
                  n.bindTexture(34067, null);
              } else
                d ||
                  (n.bindTexture(3553, c.__webglTexture),
                  P(3553, i.texture, p),
                  O(s.__webglFramebuffer, i, 36064, 3553),
                  g(i.texture, p) && y(3553, i.texture, i.width, i.height),
                  n.bindTexture(3553, null));
              i.depthBuffer && L(i);
            }),
            (this.updateRenderTargetMipmap = function(e) {
              var t = e.texture;
              if (g(t, v(e) || l)) {
                var i = e.isWebGLRenderTargetCube ? 34067 : 3553,
                  a = r.get(t).__webglTexture;
                n.bindTexture(i, a),
                  y(i, t, e.width, e.height),
                  n.bindTexture(i, null);
              }
            }),
            (this.updateMultisampleRenderTarget = function(t) {
              if (t.isWebGLMultisampleRenderTarget && l) {
                var n = r.get(t);
                e.bindFramebuffer(36008, n.__webglMultisampledFramebuffer),
                  e.bindFramebuffer(36009, n.__webglFramebuffer);
                var i = t.width,
                  a = t.height,
                  o = 16384;
                t.depthBuffer && (o |= 256),
                  t.stencilBuffer && (o |= 1024),
                  e.blitFramebuffer(0, 0, i, a, 0, 0, i, a, o, 9728);
              }
            }),
            (this.safeSetTexture2D = function(e, t) {
              e &&
                e.isWebGLRenderTarget &&
                (!1 === F && (F = !0), (e = e.texture)),
                T(e, t);
            }),
            (this.safeSetTextureCube = function(e, t) {
              e &&
                e.isWebGLRenderTargetCube &&
                (!1 === k && (k = !0), (e = e.texture)),
                (e && e.isCubeTexture) ||
                (Array.isArray(e.image) && 6 === e.image.length)
                  ? A(e, t)
                  : S(e, t);
            });
        }
        function zc(e, t, n) {
          var r = n.isWebGL2;
          return {
            convert: function(e) {
              var n;
              if (e === sr) return 5121;
              if (e === mr) return 32819;
              if (e === vr) return 32820;
              if (e === gr) return 33635;
              if (e === lr) return 5120;
              if (e === cr) return 5122;
              if (e === ur) return 5123;
              if (e === hr) return 5124;
              if (e === dr) return 5125;
              if (e === pr) return 5126;
              if (e === fr)
                return r
                  ? 5131
                  : null !== (n = t.get("OES_texture_half_float"))
                  ? n.HALF_FLOAT_OES
                  : null;
              if (e === br) return 6406;
              if (e === xr) return 6407;
              if (e === wr) return 6408;
              if (e === _r) return 6409;
              if (e === Mr) return 6410;
              if (e === Ar) return 6402;
              if (e === Sr) return 34041;
              if (e === Er) return 6403;
              if (e === Rr || e === Pr || e === Ir || e === Dr) {
                if (null === (n = t.get("WEBGL_compressed_texture_s3tc")))
                  return null;
                if (e === Rr) return n.COMPRESSED_RGB_S3TC_DXT1_EXT;
                if (e === Pr) return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;
                if (e === Ir) return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;
                if (e === Dr) return n.COMPRESSED_RGBA_S3TC_DXT5_EXT;
              }
              if (e === Or || e === Cr || e === Lr || e === Nr) {
                if (null === (n = t.get("WEBGL_compressed_texture_pvrtc")))
                  return null;
                if (e === Or) return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                if (e === Cr) return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                if (e === Lr) return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                if (e === Nr) return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;
              }
              return e === Fr
                ? null !== (n = t.get("WEBGL_compressed_texture_etc1"))
                  ? n.COMPRESSED_RGB_ETC1_WEBGL
                  : null
                : e === kr ||
                  e === Ur ||
                  e === jr ||
                  e === Br ||
                  e === zr ||
                  e === Vr ||
                  e === Gr ||
                  e === Hr ||
                  e === Xr ||
                  e === Wr ||
                  e === Yr ||
                  e === qr ||
                  e === Qr ||
                  e === Zr
                ? null !== (n = t.get("WEBGL_compressed_texture_astc"))
                  ? e
                  : null
                : e === yr
                ? r
                  ? 34042
                  : null !== (n = t.get("WEBGL_depth_texture"))
                  ? n.UNSIGNED_INT_24_8_WEBGL
                  : null
                : void 0;
            }
          };
        }
        function Vc(e, t, n, r) {
          la.call(this, e, t, r),
            (this.depthBuffer = !1),
            (this.stencilBuffer = !1),
            (this.numViews = n);
        }
        function Gc(e, t) {
          var n,
            r,
            i,
            a,
            o,
            s,
            l,
            c = 2,
            u = e.extensions,
            h = e.properties,
            d = 0;
          function p(e) {
            return e.isArrayCamera ? e.cameras : ((o[0] = e), o);
          }
          (this.isAvailable = function() {
            if (void 0 === l) {
              var e = u.get("OVR_multiview2");
              if (
                (l = null !== e && !1 === t.getContextAttributes().antialias)
              ) {
                (d = t.getParameter(e.MAX_VIEWS_OVR)),
                  (n = new Vc(0, 0, c)),
                  (s = new Zi()),
                  (a = []),
                  (i = []),
                  (o = []);
                for (var r = 0; r < d; r++)
                  (a[r] = new ga()), (i[r] = new ra());
              }
            }
            return l;
          }),
            (this.attachCamera = function(t) {
              !1 !==
                (function(e) {
                  if (void 0 === e.isArrayCamera) return !0;
                  var t = e.cameras;
                  if (t.length > d) return !1;
                  for (var n = 1, r = t.length; n < r; n++)
                    if (
                      t[0].viewport.z !== t[n].viewport.z ||
                      t[0].viewport.w !== t[n].viewport.w
                    )
                      return !1;
                  return !0;
                })(t) &&
                ((r = e.getRenderTarget()),
                (function(t) {
                  if (
                    (r ? s.set(r.width, r.height) : e.getDrawingBufferSize(s),
                    t.isArrayCamera)
                  ) {
                    var i = t.cameras[0].viewport;
                    n.setSize(i.z, i.w), n.setNumViews(t.cameras.length);
                  } else n.setSize(s.x, s.y), n.setNumViews(c);
                })(t),
                e.setRenderTarget(n));
            }),
            (this.detachCamera = function(i) {
              n === e.getRenderTarget() &&
                (e.setRenderTarget(r),
                (function(e) {
                  var r = n,
                    i = r.numViews,
                    a = h.get(r).__webglViewFramebuffers,
                    o = r.width,
                    l = r.height;
                  if (e.isArrayCamera)
                    for (var c = 0; c < i; c++) {
                      var u = e.cameras[c].viewport,
                        d = u.x,
                        p = u.y,
                        f = d + u.z,
                        m = p + u.w;
                      t.bindFramebuffer(36008, a[c]),
                        t.blitFramebuffer(0, 0, o, l, d, p, f, m, 16384, 9728);
                    }
                  else
                    t.bindFramebuffer(36008, a[0]),
                      t.blitFramebuffer(
                        0,
                        0,
                        o,
                        l,
                        0,
                        0,
                        s.x,
                        s.y,
                        16384,
                        9728
                      );
                })(i));
            }),
            (this.updateCameraProjectionMatricesUniform = function(e, n) {
              for (var r = p(e), i = 0; i < r.length; i++)
                a[i].copy(r[i].projectionMatrix);
              n.setValue(t, "projectionMatrices", a);
            }),
            (this.updateCameraViewMatricesUniform = function(e, n) {
              for (var r = p(e), i = 0; i < r.length; i++)
                a[i].copy(r[i].matrixWorldInverse);
              n.setValue(t, "viewMatrices", a);
            }),
            (this.updateObjectMatricesUniforms = function(e, n, r) {
              for (var o = p(n), s = 0; s < o.length; s++)
                a[s].multiplyMatrices(o[s].matrixWorldInverse, e.matrixWorld),
                  i[s].getNormalMatrix(a[s]);
              r.setValue(t, "modelViewMatrices", a),
                r.setValue(t, "normalMatrices", i);
            });
        }
        function Hc() {
          Na.call(this), (this.type = "Group");
        }
        function Xc(e) {
          Ns.call(this), (this.cameras = e || []);
        }
        (Vc.prototype = Object.assign(Object.create(la.prototype), {
          constructor: Vc,
          isWebGLMultiviewRenderTarget: !0,
          copy: function(e) {
            return (
              la.prototype.copy.call(this, e),
              (this.numViews = e.numViews),
              this
            );
          },
          setNumViews: function(e) {
            return (
              this.numViews !== e && ((this.numViews = e), this.dispose()), this
            );
          }
        })),
          (Hc.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: Hc,
            isGroup: !0
          })),
          (Xc.prototype = Object.assign(Object.create(Ns.prototype), {
            constructor: Xc,
            isArrayCamera: !0
          }));
        var Wc,
          Yc = new ea(),
          qc = new ea();
        function Qc(e, t, n) {
          Yc.setFromMatrixPosition(t.matrixWorld),
            qc.setFromMatrixPosition(n.matrixWorld);
          var r = Yc.distanceTo(qc),
            i = t.projectionMatrix.elements,
            a = n.projectionMatrix.elements,
            o = i[14] / (i[10] - 1),
            s = i[14] / (i[10] + 1),
            l = (i[9] + 1) / i[5],
            c = (i[9] - 1) / i[5],
            u = (i[8] - 1) / i[0],
            h = (a[8] + 1) / a[0],
            d = o * u,
            p = o * h,
            f = r / (-u + h),
            m = f * -u;
          t.matrixWorld.decompose(e.position, e.quaternion, e.scale),
            e.translateX(m),
            e.translateZ(f),
            e.matrixWorld.compose(e.position, e.quaternion, e.scale),
            e.matrixWorldInverse.getInverse(e.matrixWorld);
          var v = o + f,
            g = s + f,
            y = d - m,
            b = p + (r - m),
            x = ((l * s) / g) * v,
            w = ((c * s) / g) * v;
          e.projectionMatrix.makePerspective(y, b, x, w, v, g);
        }
        function Zc(e) {
          var t,
            n,
            r = this,
            i = null,
            a = null,
            o = [],
            s = new ga(),
            l = new ga(),
            c = 1,
            u = "local-floor";
          "undefined" != typeof window &&
            "VRFrameData" in window &&
            ((a = new window.VRFrameData()),
            window.addEventListener("vrdisplaypresentchange", w, !1));
          var h = new ga(),
            d = new Ji(),
            p = new ea(),
            f = new Ns(),
            m = new Ns();
          (m.viewport = new sa()), m.layers.enable(1);
          var v = new Ns();
          (v.viewport = new sa()), v.layers.enable(2);
          var g = new Xc([m, v]);
          function y() {
            return null !== i && !0 === i.isPresenting;
          }
          g.layers.enable(1), g.layers.enable(2);
          var b,
            x = new Zi();
          function w() {
            if (y()) {
              var a = i.getEyeParameters("left");
              (t = 2 * a.renderWidth * c),
                (n = a.renderHeight * c),
                (b = e.getPixelRatio()),
                e.getSize(x),
                e.setDrawingBufferSize(t, n, 1),
                m.viewport.set(0, 0, t / 2, n),
                v.viewport.set(t / 2, 0, t / 2, n),
                S.start(),
                r.dispatchEvent({ type: "sessionstart" });
            } else
              r.enabled && e.setDrawingBufferSize(x.width, x.height, b),
                S.stop(),
                r.dispatchEvent({ type: "sessionend" });
          }
          var _ = [],
            M = [];
          function T(e) {
            for (
              var t = navigator.getGamepads && navigator.getGamepads(),
                n = 0,
                r = t.length;
              n < r;
              n++
            ) {
              var i = t[n];
              if (
                i &&
                ("Daydream Controller" === i.id ||
                  "Gear VR Controller" === i.id ||
                  "Oculus Go Controller" === i.id ||
                  "OpenVR Gamepad" === i.id ||
                  i.id.startsWith("Oculus Touch") ||
                  i.id.startsWith("HTC Vive Focus") ||
                  i.id.startsWith("Spatial Controller"))
              ) {
                var a = i.hand;
                if (0 === e && ("" === a || "right" === a)) return i;
                if (1 === e && "left" === a) return i;
              }
            }
          }
          function A(e, r) {
            null !== r &&
              4 === r.length &&
              e.set(r[0] * t, r[1] * n, r[2] * t, r[3] * n);
          }
          (this.enabled = !1),
            (this.getController = function(e) {
              var t = o[e];
              return (
                void 0 === t &&
                  (((t = new Hc()).matrixAutoUpdate = !1),
                  (t.visible = !1),
                  (o[e] = t)),
                t
              );
            }),
            (this.getDevice = function() {
              return i;
            }),
            (this.setDevice = function(e) {
              void 0 !== e && (i = e), S.setContext(e);
            }),
            (this.setFramebufferScaleFactor = function(e) {
              c = e;
            }),
            (this.setReferenceSpaceType = function(e) {
              u = e;
            }),
            (this.getCamera = function(e) {
              var t = "local-floor" === u ? 1.6 : 0;
              if (
                ((i.depthNear = e.near),
                (i.depthFar = e.far),
                i.getFrameData(a),
                "local-floor" === u)
              ) {
                var n = i.stageParameters;
                n
                  ? s.fromArray(n.sittingToStandingTransform)
                  : s.makeTranslation(0, t, 0);
              }
              var r = a.pose;
              f.matrix.copy(s),
                f.matrix.decompose(f.position, f.quaternion, f.scale),
                null !== r.orientation &&
                  (d.fromArray(r.orientation), f.quaternion.multiply(d)),
                null !== r.position &&
                  (d.setFromRotationMatrix(s),
                  p.fromArray(r.position),
                  p.applyQuaternion(d),
                  f.position.add(p)),
                f.updateMatrixWorld(),
                e.matrixWorld.copy(f.matrixWorld);
              for (var c = e.children, y = 0, b = c.length; y < b; y++)
                c[y].updateMatrixWorld(!0);
              (m.near = e.near),
                (v.near = e.near),
                (m.far = e.far),
                (v.far = e.far),
                m.matrixWorldInverse.fromArray(a.leftViewMatrix),
                v.matrixWorldInverse.fromArray(a.rightViewMatrix),
                l.getInverse(s),
                "local-floor" === u &&
                  (m.matrixWorldInverse.multiply(l),
                  v.matrixWorldInverse.multiply(l));
              var x = e.parent;
              null !== x &&
                (h.getInverse(x.matrixWorld),
                m.matrixWorldInverse.multiply(h),
                v.matrixWorldInverse.multiply(h)),
                m.matrixWorld.getInverse(m.matrixWorldInverse),
                v.matrixWorld.getInverse(v.matrixWorldInverse),
                m.projectionMatrix.fromArray(a.leftProjectionMatrix),
                v.projectionMatrix.fromArray(a.rightProjectionMatrix),
                Qc(g, m, v);
              var w = i.getLayers();
              if (w.length) {
                var S = w[0];
                A(m.viewport, S.leftBounds), A(v.viewport, S.rightBounds);
              }
              return (
                (function() {
                  for (var e = 0; e < o.length; e++) {
                    var t = o[e],
                      n = T(e);
                    if (void 0 !== n && void 0 !== n.pose) {
                      if (null === n.pose) return;
                      var r = n.pose;
                      !1 === r.hasPosition && t.position.set(0.2, -0.6, -0.05),
                        null !== r.position && t.position.fromArray(r.position),
                        null !== r.orientation &&
                          t.quaternion.fromArray(r.orientation),
                        t.matrix.compose(t.position, t.quaternion, t.scale),
                        t.matrix.premultiply(s),
                        t.matrix.decompose(t.position, t.quaternion, t.scale),
                        (t.matrixWorldNeedsUpdate = !0),
                        (t.visible = !0);
                      var i = "Daydream Controller" === n.id ? 0 : 1;
                      void 0 === _[e] && (_[e] = !1),
                        _[e] !== n.buttons[i].pressed &&
                          ((_[e] = n.buttons[i].pressed),
                          !0 === _[e]
                            ? t.dispatchEvent({ type: "selectstart" })
                            : (t.dispatchEvent({ type: "selectend" }),
                              t.dispatchEvent({ type: "select" }))),
                        (i = 2),
                        void 0 === M[e] && (M[e] = !1),
                        void 0 !== n.buttons[i] &&
                          M[e] !== n.buttons[i].pressed &&
                          ((M[e] = n.buttons[i].pressed),
                          !0 === M[e]
                            ? t.dispatchEvent({ type: "squeezestart" })
                            : (t.dispatchEvent({ type: "squeezeend" }),
                              t.dispatchEvent({ type: "squeeze" })));
                    } else t.visible = !1;
                  }
                })(),
                g
              );
            }),
            (this.getStandingMatrix = function() {
              return s;
            }),
            (this.isPresenting = y);
          var S = new Ys();
          (this.setAnimationLoop = function(e) {
            S.setAnimationLoop(e), y() && S.start();
          }),
            (this.submitFrame = function() {
              y() && i.submitFrame();
            }),
            (this.dispose = function() {
              "undefined" != typeof window &&
                window.removeEventListener("vrdisplaypresentchange", w);
            }),
            (this.setFrameOfReferenceType = function() {});
        }
        function Jc(e, t) {
          var n = this,
            r = null,
            i = null,
            a = "local-floor",
            o = null,
            s = [],
            l = [],
            c = new Ns();
          c.layers.enable(1), (c.viewport = new sa());
          var u = new Ns();
          u.layers.enable(2), (u.viewport = new sa());
          var h = new Xc([c, u]);
          function d(e) {
            for (var t = 0; t < s.length; t++)
              l[t] === e.inputSource && s[t].dispatchEvent({ type: e.type });
          }
          function p() {
            e.setFramebuffer(null),
              e.setRenderTarget(e.getRenderTarget()),
              b.stop(),
              n.dispatchEvent({ type: "sessionend" });
          }
          function f(e) {
            (i = e),
              b.setContext(r),
              b.start(),
              n.dispatchEvent({ type: "sessionstart" });
          }
          function m() {
            for (var e = 0; e < s.length; e++) l[e] = v(e);
          }
          function v(e) {
            for (var t = r.inputSources, n = 0; n < t.length; n++) {
              var i = t[n],
                a = i.handedness;
              if (0 === e && ("none" === a || "right" === a)) return i;
              if (1 === e && "left" === a) return i;
            }
          }
          function g(e, t) {
            null === t
              ? e.matrixWorld.copy(e.matrix)
              : e.matrixWorld.multiplyMatrices(t.matrixWorld, e.matrix),
              e.matrixWorldInverse.getInverse(e.matrixWorld);
          }
          h.layers.enable(1),
            h.layers.enable(2),
            (this.enabled = !1),
            (this.getController = function(e) {
              var t = s[e];
              return (
                void 0 === t &&
                  (((t = new Hc()).matrixAutoUpdate = !1),
                  (t.visible = !1),
                  (s[e] = t)),
                t
              );
            }),
            (this.setFramebufferScaleFactor = function() {}),
            (this.setReferenceSpaceType = function(e) {
              a = e;
            }),
            (this.getSession = function() {
              return r;
            }),
            (this.setSession = function(e) {
              null !== (r = e) &&
                (r.addEventListener("select", d),
                r.addEventListener("selectstart", d),
                r.addEventListener("selectend", d),
                r.addEventListener("squeeze", d),
                r.addEventListener("squeezestart", d),
                r.addEventListener("squeezeend", d),
                r.addEventListener("end", p),
                r.updateRenderState({ baseLayer: new XRWebGLLayer(r, t) }),
                r.requestReferenceSpace(a).then(f),
                r.addEventListener("inputsourceschange", m),
                m());
            }),
            (this.getCamera = function(e) {
              var t = e.parent,
                n = h.cameras;
              g(h, t);
              for (var r = 0; r < n.length; r++) g(n[r], t);
              e.matrixWorld.copy(h.matrixWorld);
              for (var i = e.children, a = ((r = 0), i.length); r < a; r++)
                i[r].updateMatrixWorld(!0);
              return Qc(h, c, u), h;
            }),
            (this.isPresenting = function() {
              return null !== r && null !== i;
            });
          var y = null,
            b = new Ys();
          b.setAnimationLoop(function(t, n) {
            if (null !== (o = n.getViewerPose(i))) {
              var a = o.views,
                c = r.renderState.baseLayer;
              e.setFramebuffer(c.framebuffer);
              for (var u = 0; u < a.length; u++) {
                var d = a[u],
                  p = c.getViewport(d),
                  f = d.transform.inverse.matrix,
                  m = h.cameras[u];
                m.matrix.fromArray(f).getInverse(m.matrix),
                  m.projectionMatrix.fromArray(d.projectionMatrix),
                  m.viewport.set(p.x, p.y, p.width, p.height),
                  0 === u && h.matrix.copy(m.matrix);
              }
            }
            for (u = 0; u < s.length; u++) {
              var v = s[u],
                g = l[u];
              if (g) {
                var b = n.getPose(g.targetRaySpace, i);
                if (null !== b) {
                  v.matrix.fromArray(b.transform.matrix),
                    v.matrix.decompose(v.position, v.rotation, v.scale),
                    (v.visible = !0);
                  continue;
                }
              }
              v.visible = !1;
            }
            y && y(t);
          }),
            (this.setAnimationLoop = function(e) {
              y = e;
            }),
            (this.dispose = function() {}),
            (this.getStandingMatrix = function() {
              return new ga();
            }),
            (this.getDevice = function() {}),
            (this.setDevice = function() {}),
            (this.setFrameOfReferenceType = function() {}),
            (this.submitFrame = function() {});
        }
        function Kc(e) {
          var t =
              void 0 !== (e = e || {}).canvas
                ? e.canvas
                : document.createElementNS(
                    "http://www.w3.org/1999/xhtml",
                    "canvas"
                  ),
            n = void 0 !== e.context ? e.context : null,
            r = void 0 !== e.alpha && e.alpha,
            i = void 0 === e.depth || e.depth,
            a = void 0 === e.stencil || e.stencil,
            o = void 0 !== e.antialias && e.antialias,
            s = void 0 === e.premultipliedAlpha || e.premultipliedAlpha,
            l = void 0 !== e.preserveDrawingBuffer && e.preserveDrawingBuffer,
            c = void 0 !== e.powerPreference ? e.powerPreference : "default",
            u =
              void 0 !== e.failIfMajorPerformanceCaveat &&
              e.failIfMajorPerformanceCaveat,
            h = null,
            d = null;
          (this.domElement = t),
            (this.debug = { checkShaderErrors: !0 }),
            (this.autoClear = !0),
            (this.autoClearColor = !0),
            (this.autoClearDepth = !0),
            (this.autoClearStencil = !0),
            (this.sortObjects = !0),
            (this.clippingPlanes = []),
            (this.localClippingEnabled = !1),
            (this.gammaFactor = 2),
            (this.gammaInput = !1),
            (this.gammaOutput = !1),
            (this.physicallyCorrectLights = !1),
            (this.toneMapping = Nn),
            (this.toneMappingExposure = 1),
            (this.toneMappingWhitePoint = 1),
            (this.maxMorphTargets = 8),
            (this.maxMorphNormals = 4);
          var p,
            f,
            m,
            v,
            g,
            y,
            b,
            x,
            w,
            _,
            M,
            T,
            A,
            S,
            E,
            R,
            P,
            I,
            D = this,
            O = !1,
            C = null,
            L = 0,
            N = 0,
            F = null,
            k = null,
            U = -1,
            j = { geometry: null, program: null, wireframe: !1 },
            B = null,
            z = null,
            V = new sa(),
            G = new sa(),
            H = null,
            X = t.width,
            W = t.height,
            Y = 1,
            q = new sa(0, 0, X, W),
            Q = new sa(0, 0, X, W),
            Z = !1,
            J = new Gs(),
            K = new el(),
            $ = !1,
            ee = !1,
            te = new ga(),
            ne = new ea();
          function re() {
            return null === F ? Y : 1;
          }
          try {
            var ie = {
              alpha: r,
              depth: i,
              stencil: a,
              antialias: o,
              premultipliedAlpha: s,
              preserveDrawingBuffer: l,
              powerPreference: c,
              failIfMajorPerformanceCaveat: u,
              xrCompatible: !0
            };
            if (
              (t.addEventListener("webglcontextlost", ce, !1),
              t.addEventListener("webglcontextrestored", ue, !1),
              null ===
                (p =
                  n ||
                  t.getContext("webgl", ie) ||
                  t.getContext("experimental-webgl", ie)))
            )
              throw null !== t.getContext("webgl")
                ? new Error(
                    "Error creating WebGL context with your selected attributes."
                  )
                : new Error("Error creating WebGL context.");
            void 0 === p.getShaderPrecisionFormat &&
              (p.getShaderPrecisionFormat = function() {
                return { rangeMin: 1, rangeMax: 1, precision: 1 };
              });
          } catch (e) {
            throw e;
          }
          function ae() {
            (f = new tl(p)),
              !1 === (m = new $s(p, f, e)).isWebGL2 &&
                (f.get("WEBGL_depth_texture"),
                f.get("OES_texture_float"),
                f.get("OES_texture_half_float"),
                f.get("OES_texture_half_float_linear"),
                f.get("OES_standard_derivatives"),
                f.get("OES_element_index_uint"),
                f.get("ANGLE_instanced_arrays")),
              f.get("OES_texture_float_linear"),
              (I = new zc(p, f, m)),
              (v = new jc(p, f, m)).scissor(
                G.copy(Q)
                  .multiplyScalar(Y)
                  .floor()
              ),
              v.viewport(
                V.copy(q)
                  .multiplyScalar(Y)
                  .floor()
              ),
              (g = new il(p)),
              (y = new Mc()),
              (b = new Bc(p, f, v, y, m, I, g)),
              (x = new qs(p)),
              (w = new nl(p, x, g)),
              (_ = new sl(p, w, x, g)),
              (E = new ol(p)),
              (M = new _c(D, f, m)),
              (T = new Ec()),
              (A = new Cc()),
              (S = new Js(D, v, _, s)),
              (R = new Ks(p, f, g, m)),
              (P = new rl(p, f, g, m)),
              (g.programs = M.programs),
              (D.capabilities = m),
              (D.extensions = f),
              (D.properties = y),
              (D.renderLists = T),
              (D.state = v),
              (D.info = g);
          }
          ae();
          var oe =
            "undefined" != typeof navigator && "xr" in navigator
              ? new Jc(D, p)
              : new Zc(D);
          this.vr = oe;
          var se = new Gc(D, p),
            le = new Uc(D, _, m.maxTextureSize);
          function ce(e) {
            e.preventDefault(), (O = !0);
          }
          function ue() {
            (O = !1), ae();
          }
          function he(e) {
            var t = e.target;
            t.removeEventListener("dispose", he),
              (function(e) {
                de(e), y.remove(e);
              })(t);
          }
          function de(e) {
            var t = y.get(e).program;
            (e.program = void 0), void 0 !== t && M.releaseProgram(t);
          }
          (this.shadowMap = le),
            (this.getContext = function() {
              return p;
            }),
            (this.getContextAttributes = function() {
              return p.getContextAttributes();
            }),
            (this.forceContextLoss = function() {
              var e = f.get("WEBGL_lose_context");
              e && e.loseContext();
            }),
            (this.forceContextRestore = function() {
              var e = f.get("WEBGL_lose_context");
              e && e.restoreContext();
            }),
            (this.getPixelRatio = function() {
              return Y;
            }),
            (this.setPixelRatio = function(e) {
              void 0 !== e && ((Y = e), this.setSize(X, W, !1));
            }),
            (this.getSize = function(e) {
              return void 0 === e && (e = new Zi()), e.set(X, W);
            }),
            (this.setSize = function(e, n, r) {
              oe.isPresenting() ||
                ((X = e),
                (W = n),
                (t.width = Math.floor(e * Y)),
                (t.height = Math.floor(n * Y)),
                !1 !== r &&
                  ((t.style.width = e + "px"), (t.style.height = n + "px")),
                this.setViewport(0, 0, e, n));
            }),
            (this.getDrawingBufferSize = function(e) {
              return (
                void 0 === e && (e = new Zi()), e.set(X * Y, W * Y).floor()
              );
            }),
            (this.setDrawingBufferSize = function(e, n, r) {
              (X = e),
                (W = n),
                (Y = r),
                (t.width = Math.floor(e * r)),
                (t.height = Math.floor(n * r)),
                this.setViewport(0, 0, e, n);
            }),
            (this.getCurrentViewport = function(e) {
              return void 0 === e && (e = new sa()), e.copy(V);
            }),
            (this.getViewport = function(e) {
              return e.copy(q);
            }),
            (this.setViewport = function(e, t, n, r) {
              e.isVector4 ? q.set(e.x, e.y, e.z, e.w) : q.set(e, t, n, r),
                v.viewport(
                  V.copy(q)
                    .multiplyScalar(Y)
                    .floor()
                );
            }),
            (this.getScissor = function(e) {
              return e.copy(Q);
            }),
            (this.setScissor = function(e, t, n, r) {
              e.isVector4 ? Q.set(e.x, e.y, e.z, e.w) : Q.set(e, t, n, r),
                v.scissor(
                  G.copy(Q)
                    .multiplyScalar(Y)
                    .floor()
                );
            }),
            (this.getScissorTest = function() {
              return Z;
            }),
            (this.setScissorTest = function(e) {
              v.setScissorTest((Z = e));
            }),
            (this.getClearColor = function() {
              return S.getClearColor();
            }),
            (this.setClearColor = function() {
              S.setClearColor.apply(S, arguments);
            }),
            (this.getClearAlpha = function() {
              return S.getClearAlpha();
            }),
            (this.setClearAlpha = function() {
              S.setClearAlpha.apply(S, arguments);
            }),
            (this.clear = function(e, t, n) {
              var r = 0;
              (void 0 === e || e) && (r |= 16384),
                (void 0 === t || t) && (r |= 256),
                (void 0 === n || n) && (r |= 1024),
                p.clear(r);
            }),
            (this.clearColor = function() {
              this.clear(!0, !1, !1);
            }),
            (this.clearDepth = function() {
              this.clear(!1, !0, !1);
            }),
            (this.clearStencil = function() {
              this.clear(!1, !1, !0);
            }),
            (this.dispose = function() {
              t.removeEventListener("webglcontextlost", ce, !1),
                t.removeEventListener("webglcontextrestored", ue, !1),
                T.dispose(),
                A.dispose(),
                y.dispose(),
                _.dispose(),
                oe.dispose(),
                fe.stop();
            }),
            (this.renderBufferImmediate = function(e, t) {
              v.initAttributes();
              var n = y.get(e);
              e.hasPositions && !n.position && (n.position = p.createBuffer()),
                e.hasNormals && !n.normal && (n.normal = p.createBuffer()),
                e.hasUvs && !n.uv && (n.uv = p.createBuffer()),
                e.hasColors && !n.color && (n.color = p.createBuffer());
              var r = t.getAttributes();
              e.hasPositions &&
                (p.bindBuffer(34962, n.position),
                p.bufferData(34962, e.positionArray, 35048),
                v.enableAttribute(r.position),
                p.vertexAttribPointer(r.position, 3, 5126, !1, 0, 0)),
                e.hasNormals &&
                  (p.bindBuffer(34962, n.normal),
                  p.bufferData(34962, e.normalArray, 35048),
                  v.enableAttribute(r.normal),
                  p.vertexAttribPointer(r.normal, 3, 5126, !1, 0, 0)),
                e.hasUvs &&
                  (p.bindBuffer(34962, n.uv),
                  p.bufferData(34962, e.uvArray, 35048),
                  v.enableAttribute(r.uv),
                  p.vertexAttribPointer(r.uv, 2, 5126, !1, 0, 0)),
                e.hasColors &&
                  (p.bindBuffer(34962, n.color),
                  p.bufferData(34962, e.colorArray, 35048),
                  v.enableAttribute(r.color),
                  p.vertexAttribPointer(r.color, 3, 5126, !1, 0, 0)),
                v.disableUnusedAttributes(),
                p.drawArrays(4, 0, e.count),
                (e.count = 0);
            }),
            (this.renderBufferDirect = function(e, t, n, r, i, a) {
              var o = i.isMesh && i.matrixWorld.determinant() < 0;
              v.setMaterial(r, o);
              var s = be(e, t, r, i),
                l = !1;
              (j.geometry === n.id &&
                j.program === s.id &&
                j.wireframe === (!0 === r.wireframe)) ||
                ((j.geometry = n.id),
                (j.program = s.id),
                (j.wireframe = !0 === r.wireframe),
                (l = !0)),
                i.morphTargetInfluences && (E.update(i, n, r, s), (l = !0));
              var c = n.index,
                u = n.attributes.position;
              if (
                (null === c || 0 !== c.count) &&
                void 0 !== u &&
                0 !== u.count
              ) {
                var h,
                  d = 1;
                !0 === r.wireframe &&
                  ((c = w.getWireframeAttribute(n)), (d = 2));
                var g = R;
                null !== c && ((h = x.get(c)), (g = P).setIndex(h)),
                  l &&
                    ((function(e, t, n, r) {
                      if (
                        !1 !== m.isWebGL2 ||
                        (!e.isInstancedMesh && !t.isInstancedBufferGeometry) ||
                        null !== f.get("ANGLE_instanced_arrays")
                      ) {
                        v.initAttributes();
                        var i = t.attributes,
                          a = r.getAttributes(),
                          o = n.defaultAttributeValues;
                        for (var s in a) {
                          var l = a[s];
                          if (l >= 0) {
                            var c = i[s];
                            if (void 0 !== c) {
                              var u = c.normalized,
                                h = c.itemSize;
                              if (void 0 === (M = x.get(c))) continue;
                              var d = M.buffer,
                                g = M.type,
                                y = M.bytesPerElement;
                              if (c.isInterleavedBufferAttribute) {
                                var b = c.data,
                                  w = b.stride,
                                  _ = c.offset;
                                b && b.isInstancedInterleavedBuffer
                                  ? (v.enableAttributeAndDivisor(
                                      l,
                                      b.meshPerAttribute
                                    ),
                                    void 0 === t.maxInstancedCount &&
                                      (t.maxInstancedCount =
                                        b.meshPerAttribute * b.count))
                                  : v.enableAttribute(l),
                                  p.bindBuffer(34962, d),
                                  p.vertexAttribPointer(
                                    l,
                                    h,
                                    g,
                                    u,
                                    w * y,
                                    _ * y
                                  );
                              } else
                                c.isInstancedBufferAttribute
                                  ? (v.enableAttributeAndDivisor(
                                      l,
                                      c.meshPerAttribute
                                    ),
                                    void 0 === t.maxInstancedCount &&
                                      (t.maxInstancedCount =
                                        c.meshPerAttribute * c.count))
                                  : v.enableAttribute(l),
                                  p.bindBuffer(34962, d),
                                  p.vertexAttribPointer(l, h, g, u, 0, 0);
                            } else if ("instanceMatrix" === s) {
                              var M;
                              if (void 0 === (M = x.get(e.instanceMatrix)))
                                continue;
                              (d = M.buffer),
                                (g = M.type),
                                v.enableAttributeAndDivisor(l + 0, 1),
                                v.enableAttributeAndDivisor(l + 1, 1),
                                v.enableAttributeAndDivisor(l + 2, 1),
                                v.enableAttributeAndDivisor(l + 3, 1),
                                p.bindBuffer(34962, d),
                                p.vertexAttribPointer(l + 0, 4, g, !1, 64, 0),
                                p.vertexAttribPointer(l + 1, 4, g, !1, 64, 16),
                                p.vertexAttribPointer(l + 2, 4, g, !1, 64, 32),
                                p.vertexAttribPointer(l + 3, 4, g, !1, 64, 48);
                            } else if (void 0 !== o) {
                              var T = o[s];
                              if (void 0 !== T)
                                switch (T.length) {
                                  case 2:
                                    p.vertexAttrib2fv(l, T);
                                    break;
                                  case 3:
                                    p.vertexAttrib3fv(l, T);
                                    break;
                                  case 4:
                                    p.vertexAttrib4fv(l, T);
                                    break;
                                  default:
                                    p.vertexAttrib1fv(l, T);
                                }
                            }
                          }
                        }
                        v.disableUnusedAttributes();
                      }
                    })(i, n, r, s),
                    null !== c && p.bindBuffer(34963, h.buffer));
                var y = 1 / 0;
                null !== c ? (y = c.count) : void 0 !== u && (y = u.count);
                var b = n.drawRange.start * d,
                  _ = n.drawRange.count * d,
                  M = null !== a ? a.start * d : 0,
                  T = null !== a ? a.count * d : 1 / 0,
                  A = Math.max(b, M),
                  S = Math.min(y, b + _, M + T) - 1,
                  I = Math.max(0, S - A + 1);
                if (0 !== I) {
                  if (i.isMesh)
                    if (!0 === r.wireframe)
                      v.setLineWidth(r.wireframeLinewidth * re()), g.setMode(1);
                    else
                      switch (i.drawMode) {
                        case oi:
                          g.setMode(4);
                          break;
                        case si:
                          g.setMode(5);
                          break;
                        case li:
                          g.setMode(6);
                      }
                  else if (i.isLine) {
                    var D = r.linewidth;
                    void 0 === D && (D = 1),
                      v.setLineWidth(D * re()),
                      i.isLineSegments
                        ? g.setMode(1)
                        : i.isLineLoop
                        ? g.setMode(2)
                        : g.setMode(3);
                  } else i.isPoints ? g.setMode(0) : i.isSprite && g.setMode(4);
                  i.isInstancedMesh
                    ? g.renderInstances(n, A, I, i.count)
                    : n.isInstancedBufferGeometry
                    ? g.renderInstances(n, A, I, n.maxInstancedCount)
                    : g.render(A, I);
                }
              }
            }),
            (this.compile = function(e, t) {
              (d = A.get(e, t)).init(),
                e.traverse(function(e) {
                  e.isLight &&
                    (d.pushLight(e), e.castShadow && d.pushShadow(e));
                }),
                d.setupLights(t),
                e.traverse(function(t) {
                  if (t.material)
                    if (Array.isArray(t.material))
                      for (var n = 0; n < t.material.length; n++)
                        ye(t.material[n], e.fog, t);
                    else ye(t.material, e.fog, t);
                });
            });
          var pe = null,
            fe = new Ys();
          function me(e, t, n, r) {
            if (!1 !== e.visible) {
              if (e.layers.test(t.layers))
                if (e.isGroup) n = e.renderOrder;
                else if (e.isLOD) !0 === e.autoUpdate && e.update(t);
                else if (e.isLight)
                  d.pushLight(e), e.castShadow && d.pushShadow(e);
                else if (e.isSprite) {
                  if (!e.frustumCulled || J.intersectsSprite(e)) {
                    r &&
                      ne.setFromMatrixPosition(e.matrixWorld).applyMatrix4(te);
                    var i = _.update(e);
                    (a = e.material).visible && h.push(e, i, a, n, ne.z, null);
                  }
                } else if (e.isImmediateRenderObject)
                  r && ne.setFromMatrixPosition(e.matrixWorld).applyMatrix4(te),
                    h.push(e, null, e.material, n, ne.z, null);
                else if (
                  (e.isMesh || e.isLine || e.isPoints) &&
                  (e.isSkinnedMesh &&
                    e.skeleton.frame !== g.render.frame &&
                    (e.skeleton.update(), (e.skeleton.frame = g.render.frame)),
                  !e.frustumCulled || J.intersectsObject(e))
                ) {
                  r && ne.setFromMatrixPosition(e.matrixWorld).applyMatrix4(te),
                    (i = _.update(e));
                  var a = e.material;
                  if (Array.isArray(a))
                    for (var o = i.groups, s = 0, l = o.length; s < l; s++) {
                      var c = o[s],
                        u = a[c.materialIndex];
                      u && u.visible && h.push(e, i, u, n, ne.z, c);
                    }
                  else a.visible && h.push(e, i, a, n, ne.z, null);
                }
              var p = e.children;
              for (s = 0, l = p.length; s < l; s++) me(p[s], t, n, r);
            }
          }
          function ve(e, t, n, r) {
            for (var i = 0, a = e.length; i < a; i++) {
              var o = e[i],
                s = o.object,
                l = o.geometry,
                c = void 0 === r ? o.material : r,
                u = o.group;
              if (n.isArrayCamera)
                if (((z = n), oe.enabled && se.isAvailable()))
                  ge(s, t, n, l, c, u);
                else
                  for (var h = n.cameras, p = 0, f = h.length; p < f; p++) {
                    var m = h[p];
                    s.layers.test(m.layers) &&
                      (v.viewport(V.copy(m.viewport)),
                      d.setupLights(m),
                      ge(s, t, m, l, c, u));
                  }
              else (z = null), ge(s, t, n, l, c, u);
            }
          }
          function ge(e, t, n, r, i, a) {
            if (
              (e.onBeforeRender(D, t, n, r, i, a),
              (d = A.get(t, z || n)),
              e.modelViewMatrix.multiplyMatrices(
                n.matrixWorldInverse,
                e.matrixWorld
              ),
              e.normalMatrix.getNormalMatrix(e.modelViewMatrix),
              e.isImmediateRenderObject)
            ) {
              v.setMaterial(i);
              var o = be(n, t.fog, i, e);
              (j.geometry = null),
                (j.program = null),
                (j.wireframe = !1),
                (function(e, t) {
                  e.render(function(e) {
                    D.renderBufferImmediate(e, t);
                  });
                })(e, o);
            } else D.renderBufferDirect(n, t.fog, r, i, e, a);
            e.onAfterRender(D, t, n, r, i, a), (d = A.get(t, z || n));
          }
          function ye(e, t, n) {
            var r = y.get(e),
              i = d.state.lights,
              a = d.state.shadowsArray,
              o = i.state.version,
              s = M.getParameters(
                e,
                i.state,
                a,
                t,
                K.numPlanes,
                K.numIntersection,
                n
              ),
              l = M.getProgramCacheKey(e, s),
              c = r.program,
              u = !0;
            if (void 0 === c) e.addEventListener("dispose", he);
            else if (c.cacheKey !== l) de(e);
            else if (r.lightsStateVersion !== o)
              (r.lightsStateVersion = o), (u = !1);
            else {
              if (void 0 !== s.shaderID) return;
              u = !1;
            }
            if (u) {
              if (s.shaderID) {
                var h = Ws[s.shaderID];
                r.shader = {
                  name: e.type,
                  uniforms: Rs(h.uniforms),
                  vertexShader: h.vertexShader,
                  fragmentShader: h.fragmentShader
                };
              } else
                r.shader = {
                  name: e.type,
                  uniforms: e.uniforms,
                  vertexShader: e.vertexShader,
                  fragmentShader: e.fragmentShader
                };
              e.onBeforeCompile(r.shader, D),
                (l = M.getProgramCacheKey(e, s)),
                (c = M.acquireProgram(e, r.shader, s, l)),
                (r.program = c),
                (e.program = c);
            }
            var p = c.getAttributes();
            if (e.morphTargets) {
              e.numSupportedMorphTargets = 0;
              for (var f = 0; f < D.maxMorphTargets; f++)
                p["morphTarget" + f] >= 0 && e.numSupportedMorphTargets++;
            }
            if (e.morphNormals)
              for (
                e.numSupportedMorphNormals = 0, f = 0;
                f < D.maxMorphNormals;
                f++
              )
                p["morphNormal" + f] >= 0 && e.numSupportedMorphNormals++;
            var m = r.shader.uniforms;
            ((e.isShaderMaterial || e.isRawShaderMaterial) &&
              !0 !== e.clipping) ||
              ((r.numClippingPlanes = K.numPlanes),
              (r.numIntersection = K.numIntersection),
              (m.clippingPlanes = K.uniform)),
              (r.fog = t),
              (r.needsLights = (function(e) {
                return (
                  e.isMeshLambertMaterial ||
                  e.isMeshPhongMaterial ||
                  e.isMeshStandardMaterial ||
                  e.isShadowMaterial ||
                  (e.isShaderMaterial && !0 === e.lights)
                );
              })(e)),
              (r.lightsStateVersion = o),
              r.needsLights &&
                ((m.ambientLightColor.value = i.state.ambient),
                (m.lightProbe.value = i.state.probe),
                (m.directionalLights.value = i.state.directional),
                (m.spotLights.value = i.state.spot),
                (m.rectAreaLights.value = i.state.rectArea),
                (m.pointLights.value = i.state.point),
                (m.hemisphereLights.value = i.state.hemi),
                (m.directionalShadowMap.value = i.state.directionalShadowMap),
                (m.directionalShadowMatrix.value =
                  i.state.directionalShadowMatrix),
                (m.spotShadowMap.value = i.state.spotShadowMap),
                (m.spotShadowMatrix.value = i.state.spotShadowMatrix),
                (m.pointShadowMap.value = i.state.pointShadowMap),
                (m.pointShadowMatrix.value = i.state.pointShadowMatrix));
            var v = r.program.getUniforms(),
              g = ic.seqWithValue(v.seq, m);
            r.uniformsList = g;
          }
          function be(e, t, n, r) {
            b.resetTextureUnits();
            var i = y.get(n),
              a = d.state.lights;
            if ($ && (ee || e !== B)) {
              var o = e === B && n.id === U;
              K.setState(
                n.clippingPlanes,
                n.clipIntersection,
                n.clipShadows,
                e,
                i,
                o
              );
            }
            n.version === i.__version &&
              (void 0 === i.program
                ? (n.needsUpdate = !0)
                : n.fog && i.fog !== t
                ? (n.needsUpdate = !0)
                : i.needsLights && i.lightsStateVersion !== a.state.version
                ? (n.needsUpdate = !0)
                : void 0 === i.numClippingPlanes ||
                  (i.numClippingPlanes === K.numPlanes &&
                    i.numIntersection === K.numIntersection) ||
                  (n.needsUpdate = !0)),
              n.version !== i.__version &&
                (ye(n, t, r), (i.__version = n.version));
            var s,
              l,
              c = !1,
              u = !1,
              h = !1,
              f = i.program,
              g = f.getUniforms(),
              x = i.shader.uniforms;
            if (
              (v.useProgram(f.program) && ((c = !0), (u = !0), (h = !0)),
              n.id !== U && ((U = n.id), (u = !0)),
              c || B !== e)
            ) {
              if (
                (f.numMultiviewViews > 0
                  ? se.updateCameraProjectionMatricesUniform(e, g)
                  : g.setValue(p, "projectionMatrix", e.projectionMatrix),
                m.logarithmicDepthBuffer &&
                  g.setValue(
                    p,
                    "logDepthBufFC",
                    2 / (Math.log(e.far + 1) / Math.LN2)
                  ),
                B !== e && ((B = e), (u = !0), (h = !0)),
                n.isShaderMaterial ||
                  n.isMeshPhongMaterial ||
                  n.isMeshStandardMaterial ||
                  n.envMap)
              ) {
                var w = g.map.cameraPosition;
                void 0 !== w &&
                  w.setValue(p, ne.setFromMatrixPosition(e.matrixWorld));
              }
              (n.isMeshPhongMaterial ||
                n.isMeshLambertMaterial ||
                n.isMeshBasicMaterial ||
                n.isMeshStandardMaterial ||
                n.isShaderMaterial) &&
                g.setValue(p, "isOrthographic", !0 === e.isOrthographicCamera),
                (n.isMeshPhongMaterial ||
                  n.isMeshLambertMaterial ||
                  n.isMeshBasicMaterial ||
                  n.isMeshStandardMaterial ||
                  n.isShaderMaterial ||
                  n.skinning) &&
                  (f.numMultiviewViews > 0
                    ? se.updateCameraViewMatricesUniform(e, g)
                    : g.setValue(p, "viewMatrix", e.matrixWorldInverse));
            }
            if (n.skinning) {
              g.setOptional(p, r, "bindMatrix"),
                g.setOptional(p, r, "bindMatrixInverse");
              var _ = r.skeleton;
              if (_) {
                var M = _.bones;
                if (m.floatVertexTextures) {
                  if (void 0 === _.boneTexture) {
                    var T = Math.sqrt(4 * M.length);
                    (T = Qi.ceilPowerOfTwo(T)), (T = Math.max(T, 4));
                    var A = new Float32Array(T * T * 4);
                    A.set(_.boneMatrices);
                    var S = new Bs(A, T, T, wr, pr);
                    (_.boneMatrices = A),
                      (_.boneTexture = S),
                      (_.boneTextureSize = T);
                  }
                  g.setValue(p, "boneTexture", _.boneTexture, b),
                    g.setValue(p, "boneTextureSize", _.boneTextureSize);
                } else g.setOptional(p, _, "boneMatrices");
              }
            }
            return (
              (u || i.receiveShadow !== r.receiveShadow) &&
                ((i.receiveShadow = r.receiveShadow),
                g.setValue(p, "receiveShadow", r.receiveShadow)),
              u &&
                (g.setValue(p, "toneMappingExposure", D.toneMappingExposure),
                g.setValue(p, "toneMappingWhitePoint", D.toneMappingWhitePoint),
                i.needsLights &&
                  ((l = h),
                  ((s = x).ambientLightColor.needsUpdate = l),
                  (s.lightProbe.needsUpdate = l),
                  (s.directionalLights.needsUpdate = l),
                  (s.pointLights.needsUpdate = l),
                  (s.spotLights.needsUpdate = l),
                  (s.rectAreaLights.needsUpdate = l),
                  (s.hemisphereLights.needsUpdate = l)),
                t &&
                  n.fog &&
                  (function(e, t) {
                    e.fogColor.value.copy(t.color),
                      t.isFog
                        ? ((e.fogNear.value = t.near), (e.fogFar.value = t.far))
                        : t.isFogExp2 && (e.fogDensity.value = t.density);
                  })(x, t),
                n.isMeshBasicMaterial
                  ? xe(x, n)
                  : n.isMeshLambertMaterial
                  ? (xe(x, n),
                    (function(e, t) {
                      t.emissiveMap && (e.emissiveMap.value = t.emissiveMap);
                    })(x, n))
                  : n.isMeshPhongMaterial
                  ? (xe(x, n),
                    n.isMeshToonMaterial
                      ? (function(e, t) {
                          we(e, t),
                            t.gradientMap &&
                              (e.gradientMap.value = t.gradientMap);
                        })(x, n)
                      : we(x, n))
                  : n.isMeshStandardMaterial
                  ? (xe(x, n),
                    n.isMeshPhysicalMaterial
                      ? (function(e, t) {
                          _e(e, t),
                            (e.reflectivity.value = t.reflectivity),
                            (e.clearcoat.value = t.clearcoat),
                            (e.clearcoatRoughness.value = t.clearcoatRoughness),
                            t.sheen && e.sheen.value.copy(t.sheen),
                            t.clearcoatNormalMap &&
                              (e.clearcoatNormalScale.value.copy(
                                t.clearcoatNormalScale
                              ),
                              (e.clearcoatNormalMap.value =
                                t.clearcoatNormalMap),
                              t.side === Yt &&
                                e.clearcoatNormalScale.value.negate()),
                            (e.transparency.value = t.transparency);
                        })(x, n)
                      : _e(x, n))
                  : n.isMeshMatcapMaterial
                  ? (xe(x, n),
                    (function(e, t) {
                      t.matcap && (e.matcap.value = t.matcap),
                        t.bumpMap &&
                          ((e.bumpMap.value = t.bumpMap),
                          (e.bumpScale.value = t.bumpScale),
                          t.side === Yt && (e.bumpScale.value *= -1)),
                        t.normalMap &&
                          ((e.normalMap.value = t.normalMap),
                          e.normalScale.value.copy(t.normalScale),
                          t.side === Yt && e.normalScale.value.negate()),
                        t.displacementMap &&
                          ((e.displacementMap.value = t.displacementMap),
                          (e.displacementScale.value = t.displacementScale),
                          (e.displacementBias.value = t.displacementBias));
                    })(x, n))
                  : n.isMeshDepthMaterial
                  ? (xe(x, n),
                    (function(e, t) {
                      t.displacementMap &&
                        ((e.displacementMap.value = t.displacementMap),
                        (e.displacementScale.value = t.displacementScale),
                        (e.displacementBias.value = t.displacementBias));
                    })(x, n))
                  : n.isMeshDistanceMaterial
                  ? (xe(x, n),
                    (function(e, t) {
                      t.displacementMap &&
                        ((e.displacementMap.value = t.displacementMap),
                        (e.displacementScale.value = t.displacementScale),
                        (e.displacementBias.value = t.displacementBias)),
                        e.referencePosition.value.copy(t.referencePosition),
                        (e.nearDistance.value = t.nearDistance),
                        (e.farDistance.value = t.farDistance);
                    })(x, n))
                  : n.isMeshNormalMaterial
                  ? (xe(x, n),
                    (function(e, t) {
                      t.bumpMap &&
                        ((e.bumpMap.value = t.bumpMap),
                        (e.bumpScale.value = t.bumpScale),
                        t.side === Yt && (e.bumpScale.value *= -1)),
                        t.normalMap &&
                          ((e.normalMap.value = t.normalMap),
                          e.normalScale.value.copy(t.normalScale),
                          t.side === Yt && e.normalScale.value.negate()),
                        t.displacementMap &&
                          ((e.displacementMap.value = t.displacementMap),
                          (e.displacementScale.value = t.displacementScale),
                          (e.displacementBias.value = t.displacementBias));
                    })(x, n))
                  : n.isLineBasicMaterial
                  ? ((function(e, t) {
                      e.diffuse.value.copy(t.color),
                        (e.opacity.value = t.opacity);
                    })(x, n),
                    n.isLineDashedMaterial &&
                      (function(e, t) {
                        (e.dashSize.value = t.dashSize),
                          (e.totalSize.value = t.dashSize + t.gapSize),
                          (e.scale.value = t.scale);
                      })(x, n))
                  : n.isPointsMaterial
                  ? (function(e, t) {
                      var n;
                      e.diffuse.value.copy(t.color),
                        (e.opacity.value = t.opacity),
                        (e.size.value = t.size * Y),
                        (e.scale.value = 0.5 * W),
                        t.map && (e.map.value = t.map),
                        t.alphaMap && (e.alphaMap.value = t.alphaMap),
                        t.map ? (n = t.map) : t.alphaMap && (n = t.alphaMap),
                        void 0 !== n &&
                          (!0 === n.matrixAutoUpdate && n.updateMatrix(),
                          e.uvTransform.value.copy(n.matrix));
                    })(x, n)
                  : n.isSpriteMaterial
                  ? (function(e, t) {
                      var n;
                      e.diffuse.value.copy(t.color),
                        (e.opacity.value = t.opacity),
                        (e.rotation.value = t.rotation),
                        t.map && (e.map.value = t.map),
                        t.alphaMap && (e.alphaMap.value = t.alphaMap),
                        t.map ? (n = t.map) : t.alphaMap && (n = t.alphaMap),
                        void 0 !== n &&
                          (!0 === n.matrixAutoUpdate && n.updateMatrix(),
                          e.uvTransform.value.copy(n.matrix));
                    })(x, n)
                  : n.isShadowMaterial &&
                    (x.color.value.copy(n.color),
                    (x.opacity.value = n.opacity)),
                void 0 !== x.ltc_1 && (x.ltc_1.value = Xs.LTC_1),
                void 0 !== x.ltc_2 && (x.ltc_2.value = Xs.LTC_2),
                ic.upload(p, i.uniformsList, x, b),
                n.isShaderMaterial && (n.uniformsNeedUpdate = !1)),
              n.isShaderMaterial &&
                !0 === n.uniformsNeedUpdate &&
                (ic.upload(p, i.uniformsList, x, b),
                (n.uniformsNeedUpdate = !1)),
              n.isSpriteMaterial && g.setValue(p, "center", r.center),
              f.numMultiviewViews > 0
                ? se.updateObjectMatricesUniforms(r, e, g)
                : (g.setValue(p, "modelViewMatrix", r.modelViewMatrix),
                  g.setValue(p, "normalMatrix", r.normalMatrix)),
              g.setValue(p, "modelMatrix", r.matrixWorld),
              f
            );
          }
          function xe(e, t) {
            var n;
            (e.opacity.value = t.opacity),
              t.color && e.diffuse.value.copy(t.color),
              t.emissive &&
                e.emissive.value
                  .copy(t.emissive)
                  .multiplyScalar(t.emissiveIntensity),
              t.map && (e.map.value = t.map),
              t.alphaMap && (e.alphaMap.value = t.alphaMap),
              t.specularMap && (e.specularMap.value = t.specularMap),
              t.envMap &&
                ((e.envMap.value = t.envMap),
                (e.flipEnvMap.value = t.envMap.isCubeTexture ? -1 : 1),
                (e.reflectivity.value = t.reflectivity),
                (e.refractionRatio.value = t.refractionRatio),
                (e.maxMipLevel.value = y.get(t.envMap).__maxMipLevel)),
              t.lightMap &&
                ((e.lightMap.value = t.lightMap),
                (e.lightMapIntensity.value = t.lightMapIntensity)),
              t.aoMap &&
                ((e.aoMap.value = t.aoMap),
                (e.aoMapIntensity.value = t.aoMapIntensity)),
              t.map
                ? (n = t.map)
                : t.specularMap
                ? (n = t.specularMap)
                : t.displacementMap
                ? (n = t.displacementMap)
                : t.normalMap
                ? (n = t.normalMap)
                : t.bumpMap
                ? (n = t.bumpMap)
                : t.roughnessMap
                ? (n = t.roughnessMap)
                : t.metalnessMap
                ? (n = t.metalnessMap)
                : t.alphaMap
                ? (n = t.alphaMap)
                : t.emissiveMap && (n = t.emissiveMap),
              void 0 !== n &&
                (n.isWebGLRenderTarget && (n = n.texture),
                !0 === n.matrixAutoUpdate && n.updateMatrix(),
                e.uvTransform.value.copy(n.matrix));
          }
          function we(e, t) {
            e.specular.value.copy(t.specular),
              (e.shininess.value = Math.max(t.shininess, 1e-4)),
              t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
              t.bumpMap &&
                ((e.bumpMap.value = t.bumpMap),
                (e.bumpScale.value = t.bumpScale),
                t.side === Yt && (e.bumpScale.value *= -1)),
              t.normalMap &&
                ((e.normalMap.value = t.normalMap),
                e.normalScale.value.copy(t.normalScale),
                t.side === Yt && e.normalScale.value.negate()),
              t.displacementMap &&
                ((e.displacementMap.value = t.displacementMap),
                (e.displacementScale.value = t.displacementScale),
                (e.displacementBias.value = t.displacementBias));
          }
          function _e(e, t) {
            (e.roughness.value = t.roughness),
              (e.metalness.value = t.metalness),
              t.roughnessMap && (e.roughnessMap.value = t.roughnessMap),
              t.metalnessMap && (e.metalnessMap.value = t.metalnessMap),
              t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
              t.bumpMap &&
                ((e.bumpMap.value = t.bumpMap),
                (e.bumpScale.value = t.bumpScale),
                t.side === Yt && (e.bumpScale.value *= -1)),
              t.normalMap &&
                ((e.normalMap.value = t.normalMap),
                e.normalScale.value.copy(t.normalScale),
                t.side === Yt && e.normalScale.value.negate()),
              t.displacementMap &&
                ((e.displacementMap.value = t.displacementMap),
                (e.displacementScale.value = t.displacementScale),
                (e.displacementBias.value = t.displacementBias)),
              t.envMap && (e.envMapIntensity.value = t.envMapIntensity);
          }
          fe.setAnimationLoop(function(e) {
            oe.isPresenting() || (pe && pe(e));
          }),
            "undefined" != typeof window && fe.setContext(window),
            (this.setAnimationLoop = function(e) {
              (pe = e), oe.setAnimationLoop(e), fe.start();
            }),
            (this.render = function(e, t) {
              var n, r;
              if (
                (void 0 !== arguments[2] && (n = arguments[2]),
                void 0 !== arguments[3] && (r = arguments[3]),
                t && t.isCamera && !O)
              ) {
                (j.geometry = null),
                  (j.program = null),
                  (j.wireframe = !1),
                  (U = -1),
                  (B = null),
                  !0 === e.autoUpdate && e.updateMatrixWorld(),
                  null === t.parent && t.updateMatrixWorld(),
                  oe.enabled && oe.isPresenting() && (t = oe.getCamera(t)),
                  (d = A.get(e, t)).init(),
                  e.onBeforeRender(D, e, t, n || F),
                  te.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse),
                  J.setFromMatrix(te),
                  (ee = this.localClippingEnabled),
                  ($ = K.init(this.clippingPlanes, ee, t)),
                  (h = T.get(e, t)).init(),
                  me(e, t, 0, D.sortObjects),
                  !0 === D.sortObjects && h.sort(),
                  $ && K.beginShadows();
                var i = d.state.shadowsArray;
                le.render(i, e, t),
                  d.setupLights(t),
                  $ && K.endShadows(),
                  this.info.autoReset && this.info.reset(),
                  void 0 !== n && this.setRenderTarget(n),
                  oe.enabled && se.isAvailable() && se.attachCamera(t),
                  S.render(h, e, t, r);
                var a = h.opaque,
                  o = h.transparent;
                if (e.overrideMaterial) {
                  var s = e.overrideMaterial;
                  a.length && ve(a, e, t, s), o.length && ve(o, e, t, s);
                } else a.length && ve(a, e, t), o.length && ve(o, e, t);
                e.onAfterRender(D, e, t),
                  null !== F &&
                    (b.updateRenderTargetMipmap(F),
                    b.updateMultisampleRenderTarget(F)),
                  v.buffers.depth.setTest(!0),
                  v.buffers.depth.setMask(!0),
                  v.buffers.color.setMask(!0),
                  v.setPolygonOffset(!1),
                  oe.enabled &&
                    (se.isAvailable() && se.detachCamera(t), oe.submitFrame()),
                  (h = null),
                  (d = null);
              }
            }),
            (this.setFramebuffer = function(e) {
              C !== e && null === F && p.bindFramebuffer(36160, e), (C = e);
            }),
            (this.getActiveCubeFace = function() {
              return L;
            }),
            (this.getActiveMipmapLevel = function() {
              return N;
            }),
            (this.getRenderTarget = function() {
              return F;
            }),
            (this.setRenderTarget = function(e, t, n) {
              (F = e),
                (L = t),
                (N = n),
                e &&
                  void 0 === y.get(e).__webglFramebuffer &&
                  b.setupRenderTarget(e);
              var r = C,
                i = !1;
              if (e) {
                var a = y.get(e).__webglFramebuffer;
                e.isWebGLRenderTargetCube
                  ? ((r = a[t || 0]), (i = !0))
                  : (r = e.isWebGLMultisampleRenderTarget
                      ? y.get(e).__webglMultisampledFramebuffer
                      : a),
                  V.copy(e.viewport),
                  G.copy(e.scissor),
                  (H = e.scissorTest);
              } else
                V.copy(q)
                  .multiplyScalar(Y)
                  .floor(),
                  G.copy(Q)
                    .multiplyScalar(Y)
                    .floor(),
                  (H = Z);
              if (
                (k !== r && (p.bindFramebuffer(36160, r), (k = r)),
                v.viewport(V),
                v.scissor(G),
                v.setScissorTest(H),
                i)
              ) {
                var o = y.get(e.texture);
                p.framebufferTexture2D(
                  36160,
                  36064,
                  34069 + (t || 0),
                  o.__webglTexture,
                  n || 0
                );
              }
            }),
            (this.readRenderTargetPixels = function(e, t, n, r, i, a, o) {
              if (e && e.isWebGLRenderTarget) {
                var s = y.get(e).__webglFramebuffer;
                if (
                  (e.isWebGLRenderTargetCube && void 0 !== o && (s = s[o]), s)
                ) {
                  var l = !1;
                  s !== k && (p.bindFramebuffer(36160, s), (l = !0));
                  try {
                    var c = e.texture,
                      u = c.format,
                      h = c.type;
                    if (u !== wr && I.convert(u) !== p.getParameter(35739))
                      return;
                    if (
                      !(
                        h === sr ||
                        I.convert(h) === p.getParameter(35738) ||
                        (h === pr &&
                          (m.isWebGL2 ||
                            f.get("OES_texture_float") ||
                            f.get("WEBGL_color_buffer_float"))) ||
                        (h === fr &&
                          (m.isWebGL2
                            ? f.get("EXT_color_buffer_float")
                            : f.get("EXT_color_buffer_half_float")))
                      )
                    )
                      return;
                    36053 === p.checkFramebufferStatus(36160) &&
                      t >= 0 &&
                      t <= e.width - r &&
                      n >= 0 &&
                      n <= e.height - i &&
                      p.readPixels(t, n, r, i, I.convert(u), I.convert(h), a);
                  } finally {
                    l && p.bindFramebuffer(36160, k);
                  }
                }
              }
            }),
            (this.copyFramebufferToTexture = function(e, t, n) {
              void 0 === n && (n = 0);
              var r = Math.pow(2, -n),
                i = Math.floor(t.image.width * r),
                a = Math.floor(t.image.height * r),
                o = I.convert(t.format);
              b.setTexture2D(t, 0),
                p.copyTexImage2D(3553, n, o, e.x, e.y, i, a, 0),
                v.unbindTexture();
            }),
            (this.copyTextureToTexture = function(e, t, n, r) {
              var i = t.image.width,
                a = t.image.height,
                o = I.convert(n.format),
                s = I.convert(n.type);
              b.setTexture2D(n, 0),
                t.isDataTexture
                  ? p.texSubImage2D(
                      3553,
                      r || 0,
                      e.x,
                      e.y,
                      i,
                      a,
                      o,
                      s,
                      t.image.data
                    )
                  : p.texSubImage2D(3553, r || 0, e.x, e.y, o, s, t.image),
                v.unbindTexture();
            }),
            (this.initTexture = function(e) {
              b.setTexture2D(e, 0), v.unbindTexture();
            }),
            "undefined" != typeof __THREE_DEVTOOLS__ &&
              __THREE_DEVTOOLS__.dispatchEvent(
                new CustomEvent("observe", { detail: this })
              );
        }
        function $c(e, t) {
          (this.name = ""),
            (this.color = new Eo(e)),
            (this.density = void 0 !== t ? t : 25e-5);
        }
        function eu(e, t, n) {
          (this.name = ""),
            (this.color = new Eo(e)),
            (this.near = void 0 !== t ? t : 1),
            (this.far = void 0 !== n ? n : 1e3);
        }
        function tu(e, t) {
          (this.array = e),
            (this.stride = t),
            (this.count = void 0 !== e ? e.length / t : 0),
            (this.usage = ki),
            (this.updateRange = { offset: 0, count: -1 }),
            (this.version = 0);
        }
        function nu(e, t, n, r) {
          (this.data = e),
            (this.itemSize = t),
            (this.offset = n),
            (this.normalized = !0 === r);
        }
        function ru(e) {
          Co.call(this),
            (this.type = "SpriteMaterial"),
            (this.color = new Eo(16777215)),
            (this.map = null),
            (this.alphaMap = null),
            (this.rotation = 0),
            (this.sizeAttenuation = !0),
            (this.transparent = !0),
            this.setValues(e);
        }
        Object.assign(Zc.prototype, Wi.prototype),
          Object.assign(Jc.prototype, Wi.prototype),
          Object.assign($c.prototype, {
            isFogExp2: !0,
            clone: function() {
              return new $c(this.color, this.density);
            },
            toJSON: function() {
              return {
                type: "FogExp2",
                color: this.color.getHex(),
                density: this.density
              };
            }
          }),
          Object.assign(eu.prototype, {
            isFog: !0,
            clone: function() {
              return new eu(this.color, this.near, this.far);
            },
            toJSON: function() {
              return {
                type: "Fog",
                color: this.color.getHex(),
                near: this.near,
                far: this.far
              };
            }
          }),
          Object.defineProperty(tu.prototype, "needsUpdate", {
            set: function(e) {
              !0 === e && this.version++;
            }
          }),
          Object.assign(tu.prototype, {
            isInterleavedBuffer: !0,
            onUploadCallback: function() {},
            setUsage: function(e) {
              return (this.usage = e), this;
            },
            copy: function(e) {
              return (
                (this.array = new e.array.constructor(e.array)),
                (this.count = e.count),
                (this.stride = e.stride),
                (this.usage = e.usage),
                this
              );
            },
            copyAt: function(e, t, n) {
              (e *= this.stride), (n *= t.stride);
              for (var r = 0, i = this.stride; r < i; r++)
                this.array[e + r] = t.array[n + r];
              return this;
            },
            set: function(e, t) {
              return void 0 === t && (t = 0), this.array.set(e, t), this;
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            onUpload: function(e) {
              return (this.onUploadCallback = e), this;
            }
          }),
          Object.defineProperties(nu.prototype, {
            count: {
              get: function() {
                return this.data.count;
              }
            },
            array: {
              get: function() {
                return this.data.array;
              }
            }
          }),
          Object.assign(nu.prototype, {
            isInterleavedBufferAttribute: !0,
            setX: function(e, t) {
              return (
                (this.data.array[e * this.data.stride + this.offset] = t), this
              );
            },
            setY: function(e, t) {
              return (
                (this.data.array[e * this.data.stride + this.offset + 1] = t),
                this
              );
            },
            setZ: function(e, t) {
              return (
                (this.data.array[e * this.data.stride + this.offset + 2] = t),
                this
              );
            },
            setW: function(e, t) {
              return (
                (this.data.array[e * this.data.stride + this.offset + 3] = t),
                this
              );
            },
            getX: function(e) {
              return this.data.array[e * this.data.stride + this.offset];
            },
            getY: function(e) {
              return this.data.array[e * this.data.stride + this.offset + 1];
            },
            getZ: function(e) {
              return this.data.array[e * this.data.stride + this.offset + 2];
            },
            getW: function(e) {
              return this.data.array[e * this.data.stride + this.offset + 3];
            },
            setXY: function(e, t, n) {
              return (
                (e = e * this.data.stride + this.offset),
                (this.data.array[e + 0] = t),
                (this.data.array[e + 1] = n),
                this
              );
            },
            setXYZ: function(e, t, n, r) {
              return (
                (e = e * this.data.stride + this.offset),
                (this.data.array[e + 0] = t),
                (this.data.array[e + 1] = n),
                (this.data.array[e + 2] = r),
                this
              );
            },
            setXYZW: function(e, t, n, r, i) {
              return (
                (e = e * this.data.stride + this.offset),
                (this.data.array[e + 0] = t),
                (this.data.array[e + 1] = n),
                (this.data.array[e + 2] = r),
                (this.data.array[e + 3] = i),
                this
              );
            }
          }),
          (ru.prototype = Object.create(Co.prototype)),
          (ru.prototype.constructor = ru),
          (ru.prototype.isSpriteMaterial = !0),
          (ru.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              (this.map = e.map),
              (this.alphaMap = e.alphaMap),
              (this.rotation = e.rotation),
              (this.sizeAttenuation = e.sizeAttenuation),
              this
            );
          });
        var iu = new ea(),
          au = new ea(),
          ou = new ea(),
          su = new Zi(),
          lu = new Zi(),
          cu = new ga(),
          uu = new ea(),
          hu = new ea(),
          du = new ea(),
          pu = new Zi(),
          fu = new Zi(),
          mu = new Zi();
        function vu(e) {
          if ((Na.call(this), (this.type = "Sprite"), void 0 === Wc)) {
            Wc = new es();
            var t = new tu(
              new Float32Array([
                -0.5,
                -0.5,
                0,
                0,
                0,
                0.5,
                -0.5,
                0,
                1,
                0,
                0.5,
                0.5,
                0,
                1,
                1,
                -0.5,
                0.5,
                0,
                0,
                1
              ]),
              5
            );
            Wc.setIndex([0, 1, 2, 0, 2, 3]),
              Wc.setAttribute("position", new nu(t, 3, 0, !1)),
              Wc.setAttribute("uv", new nu(t, 2, 3, !1));
          }
          (this.geometry = Wc),
            (this.material = void 0 !== e ? e : new ru()),
            (this.center = new Zi(0.5, 0.5));
        }
        function gu(e, t, n, r, i, a) {
          su
            .subVectors(e, n)
            .addScalar(0.5)
            .multiply(r),
            void 0 !== i
              ? ((lu.x = a * su.x - i * su.y), (lu.y = i * su.x + a * su.y))
              : lu.copy(su),
            e.copy(t),
            (e.x += lu.x),
            (e.y += lu.y),
            e.applyMatrix4(cu);
        }
        vu.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: vu,
          isSprite: !0,
          raycast: function(e, t) {
            e.camera,
              au.setFromMatrixScale(this.matrixWorld),
              cu.copy(e.camera.matrixWorld),
              this.modelViewMatrix.multiplyMatrices(
                e.camera.matrixWorldInverse,
                this.matrixWorld
              ),
              ou.setFromMatrixPosition(this.modelViewMatrix),
              e.camera.isPerspectiveCamera &&
                !1 === this.material.sizeAttenuation &&
                au.multiplyScalar(-ou.z);
            var n,
              r,
              i = this.material.rotation;
            0 !== i && ((r = Math.cos(i)), (n = Math.sin(i)));
            var a = this.center;
            gu(uu.set(-0.5, -0.5, 0), ou, a, au, n, r),
              gu(hu.set(0.5, -0.5, 0), ou, a, au, n, r),
              gu(du.set(0.5, 0.5, 0), ou, a, au, n, r),
              pu.set(0, 0),
              fu.set(1, 0),
              mu.set(1, 1);
            var o = e.ray.intersectTriangle(uu, hu, du, !1, iu);
            if (
              null !== o ||
              (gu(hu.set(-0.5, 0.5, 0), ou, a, au, n, r),
              fu.set(0, 1),
              null !== (o = e.ray.intersectTriangle(uu, du, hu, !1, iu)))
            ) {
              var s = e.ray.origin.distanceTo(iu);
              s < e.near ||
                s > e.far ||
                t.push({
                  distance: s,
                  point: iu.clone(),
                  uv: Mo.getUV(iu, uu, hu, du, pu, fu, mu, new Zi()),
                  face: null,
                  object: this
                });
            }
          },
          clone: function() {
            return new this.constructor(this.material).copy(this);
          },
          copy: function(e) {
            return (
              Na.prototype.copy.call(this, e),
              void 0 !== e.center && this.center.copy(e.center),
              this
            );
          }
        });
        var yu = new ea(),
          bu = new ea();
        function xu() {
          Na.call(this),
            (this.type = "LOD"),
            Object.defineProperties(this, {
              levels: { enumerable: !0, value: [] }
            }),
            (this.autoUpdate = !0);
        }
        function wu(e, t) {
          e && e.isGeometry,
            ys.call(this, e, t),
            (this.type = "SkinnedMesh"),
            (this.bindMode = "attached"),
            (this.bindMatrix = new ga()),
            (this.bindMatrixInverse = new ga());
        }
        (xu.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: xu,
          isLOD: !0,
          copy: function(e) {
            Na.prototype.copy.call(this, e, !1);
            for (var t = e.levels, n = 0, r = t.length; n < r; n++) {
              var i = t[n];
              this.addLevel(i.object.clone(), i.distance);
            }
            return (this.autoUpdate = e.autoUpdate), this;
          },
          addLevel: function(e, t) {
            void 0 === t && (t = 0), (t = Math.abs(t));
            for (
              var n = this.levels, r = 0;
              r < n.length && !(t < n[r].distance);
              r++
            );
            return (
              n.splice(r, 0, { distance: t, object: e }), this.add(e), this
            );
          },
          getObjectForDistance: function(e) {
            var t = this.levels;
            if (t.length > 0) {
              for (var n = 1, r = t.length; n < r && !(e < t[n].distance); n++);
              return t[n - 1].object;
            }
            return null;
          },
          raycast: function(e, t) {
            if (this.levels.length > 0) {
              yu.setFromMatrixPosition(this.matrixWorld);
              var n = e.ray.origin.distanceTo(yu);
              this.getObjectForDistance(n).raycast(e, t);
            }
          },
          update: function(e) {
            var t = this.levels;
            if (t.length > 1) {
              yu.setFromMatrixPosition(e.matrixWorld),
                bu.setFromMatrixPosition(this.matrixWorld);
              var n = yu.distanceTo(bu);
              t[0].object.visible = !0;
              for (var r = 1, i = t.length; r < i && n >= t[r].distance; r++)
                (t[r - 1].object.visible = !1), (t[r].object.visible = !0);
              for (; r < i; r++) t[r].object.visible = !1;
            }
          },
          toJSON: function(e) {
            var t = Na.prototype.toJSON.call(this, e);
            !1 === this.autoUpdate && (t.object.autoUpdate = !1),
              (t.object.levels = []);
            for (var n = this.levels, r = 0, i = n.length; r < i; r++) {
              var a = n[r];
              t.object.levels.push({
                object: a.object.uuid,
                distance: a.distance
              });
            }
            return t;
          }
        })),
          (wu.prototype = Object.assign(Object.create(ys.prototype), {
            constructor: wu,
            isSkinnedMesh: !0,
            bind: function(e, t) {
              (this.skeleton = e),
                void 0 === t &&
                  (this.updateMatrixWorld(!0),
                  this.skeleton.calculateInverses(),
                  (t = this.matrixWorld)),
                this.bindMatrix.copy(t),
                this.bindMatrixInverse.getInverse(t);
            },
            pose: function() {
              this.skeleton.pose();
            },
            normalizeSkinWeights: function() {
              for (
                var e = new sa(),
                  t = this.geometry.attributes.skinWeight,
                  n = 0,
                  r = t.count;
                n < r;
                n++
              ) {
                (e.x = t.getX(n)),
                  (e.y = t.getY(n)),
                  (e.z = t.getZ(n)),
                  (e.w = t.getW(n));
                var i = 1 / e.manhattanLength();
                i !== 1 / 0 ? e.multiplyScalar(i) : e.set(1, 0, 0, 0),
                  t.setXYZW(n, e.x, e.y, e.z, e.w);
              }
            },
            updateMatrixWorld: function(e) {
              ys.prototype.updateMatrixWorld.call(this, e),
                "attached" === this.bindMode
                  ? this.bindMatrixInverse.getInverse(this.matrixWorld)
                  : "detached" === this.bindMode &&
                    this.bindMatrixInverse.getInverse(this.bindMatrix);
            },
            clone: function() {
              return new this.constructor(this.geometry, this.material).copy(
                this
              );
            }
          }));
        var _u = new ga(),
          Mu = new ga();
        function Tu(e, t) {
          if (
            ((e = e || []),
            (this.bones = e.slice(0)),
            (this.boneMatrices = new Float32Array(16 * this.bones.length)),
            (this.frame = -1),
            void 0 === t)
          )
            this.calculateInverses();
          else if (this.bones.length === t.length)
            this.boneInverses = t.slice(0);
          else {
            this.boneInverses = [];
            for (var n = 0, r = this.bones.length; n < r; n++)
              this.boneInverses.push(new ga());
          }
        }
        function Au() {
          Na.call(this), (this.type = "Bone");
        }
        Object.assign(Tu.prototype, {
          calculateInverses: function() {
            this.boneInverses = [];
            for (var e = 0, t = this.bones.length; e < t; e++) {
              var n = new ga();
              this.bones[e] && n.getInverse(this.bones[e].matrixWorld),
                this.boneInverses.push(n);
            }
          },
          pose: function() {
            var e, t, n;
            for (t = 0, n = this.bones.length; t < n; t++)
              (e = this.bones[t]) &&
                e.matrixWorld.getInverse(this.boneInverses[t]);
            for (t = 0, n = this.bones.length; t < n; t++)
              (e = this.bones[t]) &&
                (e.parent && e.parent.isBone
                  ? (e.matrix.getInverse(e.parent.matrixWorld),
                    e.matrix.multiply(e.matrixWorld))
                  : e.matrix.copy(e.matrixWorld),
                e.matrix.decompose(e.position, e.quaternion, e.scale));
          },
          update: function() {
            for (
              var e = this.bones,
                t = this.boneInverses,
                n = this.boneMatrices,
                r = this.boneTexture,
                i = 0,
                a = e.length;
              i < a;
              i++
            ) {
              var o = e[i] ? e[i].matrixWorld : Mu;
              _u.multiplyMatrices(o, t[i]), _u.toArray(n, 16 * i);
            }
            void 0 !== r && (r.needsUpdate = !0);
          },
          clone: function() {
            return new Tu(this.bones, this.boneInverses);
          },
          getBoneByName: function(e) {
            for (var t = 0, n = this.bones.length; t < n; t++) {
              var r = this.bones[t];
              if (r.name === e) return r;
            }
          }
        }),
          (Au.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: Au,
            isBone: !0
          }));
        var Su = new ga(),
          Eu = new ga(),
          Ru = [],
          Pu = new ys();
        function Iu(e, t, n) {
          ys.call(this, e, t),
            (this.instanceMatrix = new No(new Float32Array(16 * n), 16)),
            (this.count = n);
        }
        function Du(e) {
          Co.call(this),
            (this.type = "LineBasicMaterial"),
            (this.color = new Eo(16777215)),
            (this.linewidth = 1),
            (this.linecap = "round"),
            (this.linejoin = "round"),
            this.setValues(e);
        }
        (Iu.prototype = Object.assign(Object.create(ys.prototype), {
          constructor: Iu,
          isInstancedMesh: !0,
          getMatrixAt: function(e, t) {
            t.fromArray(this.instanceMatrix.array, 16 * e);
          },
          raycast: function(e, t) {
            var n = this.matrixWorld,
              r = this.count;
            if (
              ((Pu.geometry = this.geometry),
              (Pu.material = this.material),
              void 0 !== Pu.material)
            )
              for (var i = 0; i < r; i++)
                this.getMatrixAt(i, Su),
                  Eu.multiplyMatrices(n, Su),
                  (Pu.matrixWorld = Eu),
                  Pu.raycast(e, Ru),
                  Ru.length > 0 &&
                    ((Ru[0].instanceId = i),
                    (Ru[0].object = this),
                    t.push(Ru[0]),
                    (Ru.length = 0));
          },
          setMatrixAt: function(e, t) {
            t.toArray(this.instanceMatrix.array, 16 * e);
          },
          updateMorphTargets: function() {}
        })),
          (Du.prototype = Object.create(Co.prototype)),
          (Du.prototype.constructor = Du),
          (Du.prototype.isLineBasicMaterial = !0),
          (Du.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              (this.linewidth = e.linewidth),
              (this.linecap = e.linecap),
              (this.linejoin = e.linejoin),
              this
            );
          });
        var Ou = new ea(),
          Cu = new ea(),
          Lu = new ga(),
          Nu = new so(),
          Fu = new $a();
        function ku(e, t, n) {
          Na.call(this),
            (this.type = "Line"),
            (this.geometry = void 0 !== e ? e : new es()),
            (this.material =
              void 0 !== t ? t : new Du({ color: 16777215 * Math.random() }));
        }
        ku.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: ku,
          isLine: !0,
          computeLineDistances: function() {
            var e = this.geometry;
            if (e.isBufferGeometry) {
              if (null === e.index) {
                for (
                  var t = e.attributes.position, n = [0], r = 1, i = t.count;
                  r < i;
                  r++
                )
                  Ou.fromBufferAttribute(t, r - 1),
                    Cu.fromBufferAttribute(t, r),
                    (n[r] = n[r - 1]),
                    (n[r] += Ou.distanceTo(Cu));
                e.setAttribute("lineDistance", new Go(n, 1));
              }
            } else if (e.isGeometry) {
              var a = e.vertices;
              for (
                (n = e.lineDistances)[0] = 0, r = 1, i = a.length;
                r < i;
                r++
              )
                (n[r] = n[r - 1]), (n[r] += a[r - 1].distanceTo(a[r]));
            }
            return this;
          },
          raycast: function(e, t) {
            var n = e.linePrecision,
              r = this.geometry,
              i = this.matrixWorld;
            if (
              (null === r.boundingSphere && r.computeBoundingSphere(),
              Fu.copy(r.boundingSphere),
              Fu.applyMatrix4(i),
              (Fu.radius += n),
              !1 !== e.ray.intersectsSphere(Fu))
            ) {
              Lu.getInverse(i), Nu.copy(e.ray).applyMatrix4(Lu);
              var a = n / ((this.scale.x + this.scale.y + this.scale.z) / 3),
                o = a * a,
                s = new ea(),
                l = new ea(),
                c = new ea(),
                u = new ea(),
                h = this && this.isLineSegments ? 2 : 1;
              if (r.isBufferGeometry) {
                var d = r.index,
                  p = r.attributes.position.array;
                if (null !== d)
                  for (
                    var f = d.array, m = 0, v = f.length - 1;
                    m < v;
                    m += h
                  ) {
                    var g = f[m],
                      y = f[m + 1];
                    s.fromArray(p, 3 * g),
                      l.fromArray(p, 3 * y),
                      Nu.distanceSqToSegment(s, l, u, c) > o ||
                        (u.applyMatrix4(this.matrixWorld),
                        (w = e.ray.origin.distanceTo(u)) < e.near ||
                          w > e.far ||
                          t.push({
                            distance: w,
                            point: c.clone().applyMatrix4(this.matrixWorld),
                            index: m,
                            face: null,
                            faceIndex: null,
                            object: this
                          }));
                  }
                else
                  for (m = 0, v = p.length / 3 - 1; m < v; m += h)
                    s.fromArray(p, 3 * m),
                      l.fromArray(p, 3 * m + 3),
                      Nu.distanceSqToSegment(s, l, u, c) > o ||
                        (u.applyMatrix4(this.matrixWorld),
                        (w = e.ray.origin.distanceTo(u)) < e.near ||
                          w > e.far ||
                          t.push({
                            distance: w,
                            point: c.clone().applyMatrix4(this.matrixWorld),
                            index: m,
                            face: null,
                            faceIndex: null,
                            object: this
                          }));
              } else if (r.isGeometry) {
                var b = r.vertices,
                  x = b.length;
                for (m = 0; m < x - 1; m += h) {
                  var w;
                  Nu.distanceSqToSegment(b[m], b[m + 1], u, c) > o ||
                    (u.applyMatrix4(this.matrixWorld),
                    (w = e.ray.origin.distanceTo(u)) < e.near ||
                      w > e.far ||
                      t.push({
                        distance: w,
                        point: c.clone().applyMatrix4(this.matrixWorld),
                        index: m,
                        face: null,
                        faceIndex: null,
                        object: this
                      }));
                }
              }
            }
          },
          clone: function() {
            return new this.constructor(this.geometry, this.material).copy(
              this
            );
          }
        });
        var Uu = new ea(),
          ju = new ea();
        function Bu(e, t) {
          ku.call(this, e, t), (this.type = "LineSegments");
        }
        function zu(e, t) {
          ku.call(this, e, t), (this.type = "LineLoop");
        }
        function Vu(e) {
          Co.call(this),
            (this.type = "PointsMaterial"),
            (this.color = new Eo(16777215)),
            (this.map = null),
            (this.alphaMap = null),
            (this.size = 1),
            (this.sizeAttenuation = !0),
            (this.morphTargets = !1),
            this.setValues(e);
        }
        (Bu.prototype = Object.assign(Object.create(ku.prototype), {
          constructor: Bu,
          isLineSegments: !0,
          computeLineDistances: function() {
            var e = this.geometry;
            if (e.isBufferGeometry) {
              if (null === e.index) {
                for (
                  var t = e.attributes.position, n = [], r = 0, i = t.count;
                  r < i;
                  r += 2
                )
                  Uu.fromBufferAttribute(t, r),
                    ju.fromBufferAttribute(t, r + 1),
                    (n[r] = 0 === r ? 0 : n[r - 1]),
                    (n[r + 1] = n[r] + Uu.distanceTo(ju));
                e.setAttribute("lineDistance", new Go(n, 1));
              }
            } else if (e.isGeometry) {
              var a = e.vertices;
              for (n = e.lineDistances, r = 0, i = a.length; r < i; r += 2)
                Uu.copy(a[r]),
                  ju.copy(a[r + 1]),
                  (n[r] = 0 === r ? 0 : n[r - 1]),
                  (n[r + 1] = n[r] + Uu.distanceTo(ju));
            }
            return this;
          }
        })),
          (zu.prototype = Object.assign(Object.create(ku.prototype), {
            constructor: zu,
            isLineLoop: !0
          })),
          (Vu.prototype = Object.create(Co.prototype)),
          (Vu.prototype.constructor = Vu),
          (Vu.prototype.isPointsMaterial = !0),
          (Vu.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              (this.map = e.map),
              (this.alphaMap = e.alphaMap),
              (this.size = e.size),
              (this.sizeAttenuation = e.sizeAttenuation),
              (this.morphTargets = e.morphTargets),
              this
            );
          });
        var Gu = new ga(),
          Hu = new so(),
          Xu = new $a(),
          Wu = new ea();
        function Yu(e, t) {
          Na.call(this),
            (this.type = "Points"),
            (this.geometry = void 0 !== e ? e : new es()),
            (this.material =
              void 0 !== t ? t : new Vu({ color: 16777215 * Math.random() })),
            this.updateMorphTargets();
        }
        function qu(e, t, n, r, i, a, o) {
          var s = Hu.distanceSqToPoint(e);
          if (s < n) {
            var l = new ea();
            Hu.closestPointToPoint(e, l), l.applyMatrix4(r);
            var c = i.ray.origin.distanceTo(l);
            if (c < i.near || c > i.far) return;
            a.push({
              distance: c,
              distanceToRay: Math.sqrt(s),
              point: l,
              index: t,
              face: null,
              object: o
            });
          }
        }
        function Qu(e, t, n, r, i, a, o, s, l) {
          oa.call(this, e, t, n, r, i, a, o, s, l),
            (this.format = void 0 !== o ? o : xr),
            (this.minFilter = void 0 !== a ? a : nr),
            (this.magFilter = void 0 !== i ? i : nr),
            (this.generateMipmaps = !1);
        }
        function Zu(e, t, n, r, i, a, o, s, l, c, u, h) {
          oa.call(this, null, a, o, s, l, c, r, i, u, h),
            (this.image = { width: t, height: n }),
            (this.mipmaps = e),
            (this.flipY = !1),
            (this.generateMipmaps = !1);
        }
        function Ju(e, t, n, r, i, a, o, s, l) {
          oa.call(this, e, t, n, r, i, a, o, s, l), (this.needsUpdate = !0);
        }
        function Ku(e, t, n, r, i, a, o, s, l, c) {
          if ((c = void 0 !== c ? c : Ar) !== Ar && c !== Sr)
            throw new Error(
              "DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat"
            );
          void 0 === n && c === Ar && (n = ur),
            void 0 === n && c === Sr && (n = yr),
            oa.call(this, null, r, i, a, o, s, c, n, l),
            (this.image = { width: e, height: t }),
            (this.magFilter = void 0 !== o ? o : Jn),
            (this.minFilter = void 0 !== s ? s : Jn),
            (this.flipY = !1),
            (this.generateMipmaps = !1);
        }
        function $u(e) {
          es.call(this), (this.type = "WireframeGeometry");
          var t,
            n,
            r,
            i,
            a,
            o,
            s,
            l,
            c,
            u,
            h = [],
            d = [0, 0],
            p = {},
            f = ["a", "b", "c"];
          if (e && e.isGeometry) {
            var m = e.faces;
            for (t = 0, r = m.length; t < r; t++) {
              var v = m[t];
              for (n = 0; n < 3; n++)
                (s = v[f[n]]),
                  (l = v[f[(n + 1) % 3]]),
                  (d[0] = Math.min(s, l)),
                  (d[1] = Math.max(s, l)),
                  void 0 === p[(c = d[0] + "," + d[1])] &&
                    (p[c] = { index1: d[0], index2: d[1] });
            }
            for (c in p)
              (o = p[c]),
                (u = e.vertices[o.index1]),
                h.push(u.x, u.y, u.z),
                (u = e.vertices[o.index2]),
                h.push(u.x, u.y, u.z);
          } else if (e && e.isBufferGeometry) {
            var g, y, b, x, w, _, M;
            if (((u = new ea()), null !== e.index)) {
              for (
                g = e.attributes.position,
                  y = e.index,
                  0 === (b = e.groups).length &&
                    (b = [{ start: 0, count: y.count, materialIndex: 0 }]),
                  i = 0,
                  a = b.length;
                i < a;
                ++i
              )
                for (t = w = (x = b[i]).start, r = w + x.count; t < r; t += 3)
                  for (n = 0; n < 3; n++)
                    (s = y.getX(t + n)),
                      (l = y.getX(t + ((n + 1) % 3))),
                      (d[0] = Math.min(s, l)),
                      (d[1] = Math.max(s, l)),
                      void 0 === p[(c = d[0] + "," + d[1])] &&
                        (p[c] = { index1: d[0], index2: d[1] });
              for (c in p)
                (o = p[c]),
                  u.fromBufferAttribute(g, o.index1),
                  h.push(u.x, u.y, u.z),
                  u.fromBufferAttribute(g, o.index2),
                  h.push(u.x, u.y, u.z);
            } else
              for (t = 0, r = (g = e.attributes.position).count / 3; t < r; t++)
                for (n = 0; n < 3; n++)
                  (_ = 3 * t + n),
                    u.fromBufferAttribute(g, _),
                    h.push(u.x, u.y, u.z),
                    (M = 3 * t + ((n + 1) % 3)),
                    u.fromBufferAttribute(g, M),
                    h.push(u.x, u.y, u.z);
          }
          this.setAttribute("position", new Go(h, 3));
        }
        function eh(e, t, n) {
          As.call(this),
            (this.type = "ParametricGeometry"),
            (this.parameters = { func: e, slices: t, stacks: n }),
            this.fromBufferGeometry(new th(e, t, n)),
            this.mergeVertices();
        }
        function th(e, t, n) {
          es.call(this),
            (this.type = "ParametricBufferGeometry"),
            (this.parameters = { func: e, slices: t, stacks: n });
          var r,
            i,
            a = [],
            o = [],
            s = [],
            l = [],
            c = new ea(),
            u = new ea(),
            h = new ea(),
            d = new ea(),
            p = new ea();
          e.length;
          var f = t + 1;
          for (r = 0; r <= n; r++) {
            var m = r / n;
            for (i = 0; i <= t; i++) {
              var v = i / t;
              e(v, m, u),
                o.push(u.x, u.y, u.z),
                v - 1e-5 >= 0
                  ? (e(v - 1e-5, m, h), d.subVectors(u, h))
                  : (e(v + 1e-5, m, h), d.subVectors(h, u)),
                m - 1e-5 >= 0
                  ? (e(v, m - 1e-5, h), p.subVectors(u, h))
                  : (e(v, m + 1e-5, h), p.subVectors(h, u)),
                c.crossVectors(d, p).normalize(),
                s.push(c.x, c.y, c.z),
                l.push(v, m);
            }
          }
          for (r = 0; r < n; r++)
            for (i = 0; i < t; i++) {
              var g = r * f + i,
                y = r * f + i + 1,
                b = (r + 1) * f + i + 1,
                x = (r + 1) * f + i;
              a.push(g, y, x), a.push(y, b, x);
            }
          this.setIndex(a),
            this.setAttribute("position", new Go(o, 3)),
            this.setAttribute("normal", new Go(s, 3)),
            this.setAttribute("uv", new Go(l, 2));
        }
        function nh(e, t, n, r) {
          As.call(this),
            (this.type = "PolyhedronGeometry"),
            (this.parameters = {
              vertices: e,
              indices: t,
              radius: n,
              detail: r
            }),
            this.fromBufferGeometry(new rh(e, t, n, r)),
            this.mergeVertices();
        }
        function rh(e, t, n, r) {
          es.call(this),
            (this.type = "PolyhedronBufferGeometry"),
            (this.parameters = {
              vertices: e,
              indices: t,
              radius: n,
              detail: r
            }),
            (n = n || 1);
          var i = [],
            a = [];
          function o(e, t, n, r) {
            var i,
              a,
              o = Math.pow(2, r),
              l = [];
            for (i = 0; i <= o; i++) {
              l[i] = [];
              var c = e.clone().lerp(n, i / o),
                u = t.clone().lerp(n, i / o),
                h = o - i;
              for (a = 0; a <= h; a++)
                l[i][a] = 0 === a && i === o ? c : c.clone().lerp(u, a / h);
            }
            for (i = 0; i < o; i++)
              for (a = 0; a < 2 * (o - i) - 1; a++) {
                var d = Math.floor(a / 2);
                a % 2 == 0
                  ? (s(l[i][d + 1]), s(l[i + 1][d]), s(l[i][d]))
                  : (s(l[i][d + 1]), s(l[i + 1][d + 1]), s(l[i + 1][d]));
              }
          }
          function s(e) {
            i.push(e.x, e.y, e.z);
          }
          function l(t, n) {
            var r = 3 * t;
            (n.x = e[r + 0]), (n.y = e[r + 1]), (n.z = e[r + 2]);
          }
          function c(e, t, n, r) {
            r < 0 && 1 === e.x && (a[t] = e.x - 1),
              0 === n.x && 0 === n.z && (a[t] = r / 2 / Math.PI + 0.5);
          }
          function u(e) {
            return Math.atan2(e.z, -e.x);
          }
          !(function(e) {
            for (
              var n = new ea(), r = new ea(), i = new ea(), a = 0;
              a < t.length;
              a += 3
            )
              l(t[a + 0], n), l(t[a + 1], r), l(t[a + 2], i), o(n, r, i, e);
          })((r = r || 0)),
            (function(e) {
              for (var t = new ea(), n = 0; n < i.length; n += 3)
                (t.x = i[n + 0]),
                  (t.y = i[n + 1]),
                  (t.z = i[n + 2]),
                  t.normalize().multiplyScalar(e),
                  (i[n + 0] = t.x),
                  (i[n + 1] = t.y),
                  (i[n + 2] = t.z);
            })(n),
            (function() {
              for (var e = new ea(), t = 0; t < i.length; t += 3) {
                (e.x = i[t + 0]), (e.y = i[t + 1]), (e.z = i[t + 2]);
                var n = u(e) / 2 / Math.PI + 0.5,
                  r =
                    ((o = e),
                    Math.atan2(-o.y, Math.sqrt(o.x * o.x + o.z * o.z)) /
                      Math.PI +
                      0.5);
                a.push(n, 1 - r);
              }
              var o;
              (function() {
                for (
                  var e = new ea(),
                    t = new ea(),
                    n = new ea(),
                    r = new ea(),
                    o = new Zi(),
                    s = new Zi(),
                    l = new Zi(),
                    h = 0,
                    d = 0;
                  h < i.length;
                  h += 9, d += 6
                ) {
                  e.set(i[h + 0], i[h + 1], i[h + 2]),
                    t.set(i[h + 3], i[h + 4], i[h + 5]),
                    n.set(i[h + 6], i[h + 7], i[h + 8]),
                    o.set(a[d + 0], a[d + 1]),
                    s.set(a[d + 2], a[d + 3]),
                    l.set(a[d + 4], a[d + 5]),
                    r
                      .copy(e)
                      .add(t)
                      .add(n)
                      .divideScalar(3);
                  var p = u(r);
                  c(o, d + 0, e, p), c(s, d + 2, t, p), c(l, d + 4, n, p);
                }
              })(),
                (function() {
                  for (var e = 0; e < a.length; e += 6) {
                    var t = a[e + 0],
                      n = a[e + 2],
                      r = a[e + 4],
                      i = Math.max(t, n, r),
                      o = Math.min(t, n, r);
                    i > 0.9 &&
                      o < 0.1 &&
                      (t < 0.2 && (a[e + 0] += 1),
                      n < 0.2 && (a[e + 2] += 1),
                      r < 0.2 && (a[e + 4] += 1));
                  }
                })();
            })(),
            this.setAttribute("position", new Go(i, 3)),
            this.setAttribute("normal", new Go(i.slice(), 3)),
            this.setAttribute("uv", new Go(a, 2)),
            0 === r ? this.computeVertexNormals() : this.normalizeNormals();
        }
        function ih(e, t) {
          As.call(this),
            (this.type = "TetrahedronGeometry"),
            (this.parameters = { radius: e, detail: t }),
            this.fromBufferGeometry(new ah(e, t)),
            this.mergeVertices();
        }
        function ah(e, t) {
          rh.call(
            this,
            [1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1],
            [2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1],
            e,
            t
          ),
            (this.type = "TetrahedronBufferGeometry"),
            (this.parameters = { radius: e, detail: t });
        }
        function oh(e, t) {
          As.call(this),
            (this.type = "OctahedronGeometry"),
            (this.parameters = { radius: e, detail: t }),
            this.fromBufferGeometry(new sh(e, t)),
            this.mergeVertices();
        }
        function sh(e, t) {
          rh.call(
            this,
            [1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1],
            [
              0,
              2,
              4,
              0,
              4,
              3,
              0,
              3,
              5,
              0,
              5,
              2,
              1,
              2,
              5,
              1,
              5,
              3,
              1,
              3,
              4,
              1,
              4,
              2
            ],
            e,
            t
          ),
            (this.type = "OctahedronBufferGeometry"),
            (this.parameters = { radius: e, detail: t });
        }
        function lh(e, t) {
          As.call(this),
            (this.type = "IcosahedronGeometry"),
            (this.parameters = { radius: e, detail: t }),
            this.fromBufferGeometry(new ch(e, t)),
            this.mergeVertices();
        }
        function ch(e, t) {
          var n = (1 + Math.sqrt(5)) / 2,
            r = [
              -1,
              n,
              0,
              1,
              n,
              0,
              -1,
              -n,
              0,
              1,
              -n,
              0,
              0,
              -1,
              n,
              0,
              1,
              n,
              0,
              -1,
              -n,
              0,
              1,
              -n,
              n,
              0,
              -1,
              n,
              0,
              1,
              -n,
              0,
              -1,
              -n,
              0,
              1
            ];
          rh.call(
            this,
            r,
            [
              0,
              11,
              5,
              0,
              5,
              1,
              0,
              1,
              7,
              0,
              7,
              10,
              0,
              10,
              11,
              1,
              5,
              9,
              5,
              11,
              4,
              11,
              10,
              2,
              10,
              7,
              6,
              7,
              1,
              8,
              3,
              9,
              4,
              3,
              4,
              2,
              3,
              2,
              6,
              3,
              6,
              8,
              3,
              8,
              9,
              4,
              9,
              5,
              2,
              4,
              11,
              6,
              2,
              10,
              8,
              6,
              7,
              9,
              8,
              1
            ],
            e,
            t
          ),
            (this.type = "IcosahedronBufferGeometry"),
            (this.parameters = { radius: e, detail: t });
        }
        function uh(e, t) {
          As.call(this),
            (this.type = "DodecahedronGeometry"),
            (this.parameters = { radius: e, detail: t }),
            this.fromBufferGeometry(new hh(e, t)),
            this.mergeVertices();
        }
        function hh(e, t) {
          var n = (1 + Math.sqrt(5)) / 2,
            r = 1 / n,
            i = [
              -1,
              -1,
              -1,
              -1,
              -1,
              1,
              -1,
              1,
              -1,
              -1,
              1,
              1,
              1,
              -1,
              -1,
              1,
              -1,
              1,
              1,
              1,
              -1,
              1,
              1,
              1,
              0,
              -r,
              -n,
              0,
              -r,
              n,
              0,
              r,
              -n,
              0,
              r,
              n,
              -r,
              -n,
              0,
              -r,
              n,
              0,
              r,
              -n,
              0,
              r,
              n,
              0,
              -n,
              0,
              -r,
              n,
              0,
              -r,
              -n,
              0,
              r,
              n,
              0,
              r
            ];
          rh.call(
            this,
            i,
            [
              3,
              11,
              7,
              3,
              7,
              15,
              3,
              15,
              13,
              7,
              19,
              17,
              7,
              17,
              6,
              7,
              6,
              15,
              17,
              4,
              8,
              17,
              8,
              10,
              17,
              10,
              6,
              8,
              0,
              16,
              8,
              16,
              2,
              8,
              2,
              10,
              0,
              12,
              1,
              0,
              1,
              18,
              0,
              18,
              16,
              6,
              10,
              2,
              6,
              2,
              13,
              6,
              13,
              15,
              2,
              16,
              18,
              2,
              18,
              3,
              2,
              3,
              13,
              18,
              1,
              9,
              18,
              9,
              11,
              18,
              11,
              3,
              4,
              14,
              12,
              4,
              12,
              0,
              4,
              0,
              8,
              11,
              9,
              5,
              11,
              5,
              19,
              11,
              19,
              7,
              19,
              5,
              14,
              19,
              14,
              4,
              19,
              4,
              17,
              1,
              12,
              14,
              1,
              14,
              5,
              1,
              5,
              9
            ],
            e,
            t
          ),
            (this.type = "DodecahedronBufferGeometry"),
            (this.parameters = { radius: e, detail: t });
        }
        function dh(e, t, n, r, i, a) {
          As.call(this),
            (this.type = "TubeGeometry"),
            (this.parameters = {
              path: e,
              tubularSegments: t,
              radius: n,
              radialSegments: r,
              closed: i
            });
          var o = new ph(e, t, n, r, i);
          (this.tangents = o.tangents),
            (this.normals = o.normals),
            (this.binormals = o.binormals),
            this.fromBufferGeometry(o),
            this.mergeVertices();
        }
        function ph(e, t, n, r, i) {
          es.call(this),
            (this.type = "TubeBufferGeometry"),
            (this.parameters = {
              path: e,
              tubularSegments: t,
              radius: n,
              radialSegments: r,
              closed: i
            }),
            (t = t || 64),
            (n = n || 1),
            (r = r || 8),
            (i = i || !1);
          var a = e.computeFrenetFrames(t, i);
          (this.tangents = a.tangents),
            (this.normals = a.normals),
            (this.binormals = a.binormals);
          var o,
            s,
            l = new ea(),
            c = new ea(),
            u = new Zi(),
            h = new ea(),
            d = [],
            p = [],
            f = [],
            m = [];
          function v(i) {
            h = e.getPointAt(i / t, h);
            var o = a.normals[i],
              u = a.binormals[i];
            for (s = 0; s <= r; s++) {
              var f = (s / r) * Math.PI * 2,
                m = Math.sin(f),
                v = -Math.cos(f);
              (c.x = v * o.x + m * u.x),
                (c.y = v * o.y + m * u.y),
                (c.z = v * o.z + m * u.z),
                c.normalize(),
                p.push(c.x, c.y, c.z),
                (l.x = h.x + n * c.x),
                (l.y = h.y + n * c.y),
                (l.z = h.z + n * c.z),
                d.push(l.x, l.y, l.z);
            }
          }
          !(function() {
            for (o = 0; o < t; o++) v(o);
            v(!1 === i ? t : 0),
              (function() {
                for (o = 0; o <= t; o++)
                  for (s = 0; s <= r; s++)
                    (u.x = o / t), (u.y = s / r), f.push(u.x, u.y);
              })(),
              (function() {
                for (s = 1; s <= t; s++)
                  for (o = 1; o <= r; o++) {
                    var e = (r + 1) * (s - 1) + (o - 1),
                      n = (r + 1) * s + (o - 1),
                      i = (r + 1) * s + o,
                      a = (r + 1) * (s - 1) + o;
                    m.push(e, n, a), m.push(n, i, a);
                  }
              })();
          })(),
            this.setIndex(m),
            this.setAttribute("position", new Go(d, 3)),
            this.setAttribute("normal", new Go(p, 3)),
            this.setAttribute("uv", new Go(f, 2));
        }
        function fh(e, t, n, r, i, a, o) {
          As.call(this),
            (this.type = "TorusKnotGeometry"),
            (this.parameters = {
              radius: e,
              tube: t,
              tubularSegments: n,
              radialSegments: r,
              p: i,
              q: a
            }),
            this.fromBufferGeometry(new mh(e, t, n, r, i, a)),
            this.mergeVertices();
        }
        function mh(e, t, n, r, i, a) {
          es.call(this),
            (this.type = "TorusKnotBufferGeometry"),
            (this.parameters = {
              radius: e,
              tube: t,
              tubularSegments: n,
              radialSegments: r,
              p: i,
              q: a
            }),
            (e = e || 1),
            (t = t || 0.4),
            (n = Math.floor(n) || 64),
            (r = Math.floor(r) || 8),
            (i = i || 2),
            (a = a || 3);
          var o,
            s,
            l = [],
            c = [],
            u = [],
            h = [],
            d = new ea(),
            p = new ea(),
            f = new ea(),
            m = new ea(),
            v = new ea(),
            g = new ea(),
            y = new ea();
          for (o = 0; o <= n; ++o) {
            var b = (o / n) * i * Math.PI * 2;
            for (
              E(b, i, a, e, f),
                E(b + 0.01, i, a, e, m),
                g.subVectors(m, f),
                y.addVectors(m, f),
                v.crossVectors(g, y),
                y.crossVectors(v, g),
                v.normalize(),
                y.normalize(),
                s = 0;
              s <= r;
              ++s
            ) {
              var x = (s / r) * Math.PI * 2,
                w = -t * Math.cos(x),
                _ = t * Math.sin(x);
              (d.x = f.x + (w * y.x + _ * v.x)),
                (d.y = f.y + (w * y.y + _ * v.y)),
                (d.z = f.z + (w * y.z + _ * v.z)),
                c.push(d.x, d.y, d.z),
                p.subVectors(d, f).normalize(),
                u.push(p.x, p.y, p.z),
                h.push(o / n),
                h.push(s / r);
            }
          }
          for (s = 1; s <= n; s++)
            for (o = 1; o <= r; o++) {
              var M = (r + 1) * (s - 1) + (o - 1),
                T = (r + 1) * s + (o - 1),
                A = (r + 1) * s + o,
                S = (r + 1) * (s - 1) + o;
              l.push(M, T, S), l.push(T, A, S);
            }
          function E(e, t, n, r, i) {
            var a = Math.cos(e),
              o = Math.sin(e),
              s = (n / t) * e,
              l = Math.cos(s);
            (i.x = r * (2 + l) * 0.5 * a),
              (i.y = r * (2 + l) * o * 0.5),
              (i.z = r * Math.sin(s) * 0.5);
          }
          this.setIndex(l),
            this.setAttribute("position", new Go(c, 3)),
            this.setAttribute("normal", new Go(u, 3)),
            this.setAttribute("uv", new Go(h, 2));
        }
        function vh(e, t, n, r, i) {
          As.call(this),
            (this.type = "TorusGeometry"),
            (this.parameters = {
              radius: e,
              tube: t,
              radialSegments: n,
              tubularSegments: r,
              arc: i
            }),
            this.fromBufferGeometry(new gh(e, t, n, r, i)),
            this.mergeVertices();
        }
        function gh(e, t, n, r, i) {
          es.call(this),
            (this.type = "TorusBufferGeometry"),
            (this.parameters = {
              radius: e,
              tube: t,
              radialSegments: n,
              tubularSegments: r,
              arc: i
            }),
            (e = e || 1),
            (t = t || 0.4),
            (n = Math.floor(n) || 8),
            (r = Math.floor(r) || 6),
            (i = i || 2 * Math.PI);
          var a,
            o,
            s = [],
            l = [],
            c = [],
            u = [],
            h = new ea(),
            d = new ea(),
            p = new ea();
          for (a = 0; a <= n; a++)
            for (o = 0; o <= r; o++) {
              var f = (o / r) * i,
                m = (a / n) * Math.PI * 2;
              (d.x = (e + t * Math.cos(m)) * Math.cos(f)),
                (d.y = (e + t * Math.cos(m)) * Math.sin(f)),
                (d.z = t * Math.sin(m)),
                l.push(d.x, d.y, d.z),
                (h.x = e * Math.cos(f)),
                (h.y = e * Math.sin(f)),
                p.subVectors(d, h).normalize(),
                c.push(p.x, p.y, p.z),
                u.push(o / r),
                u.push(a / n);
            }
          for (a = 1; a <= n; a++)
            for (o = 1; o <= r; o++) {
              var v = (r + 1) * a + o - 1,
                g = (r + 1) * (a - 1) + o - 1,
                y = (r + 1) * (a - 1) + o,
                b = (r + 1) * a + o;
              s.push(v, g, b), s.push(g, y, b);
            }
          this.setIndex(s),
            this.setAttribute("position", new Go(l, 3)),
            this.setAttribute("normal", new Go(c, 3)),
            this.setAttribute("uv", new Go(u, 2));
        }
        (Yu.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: Yu,
          isPoints: !0,
          raycast: function(e, t) {
            var n = this.geometry,
              r = this.matrixWorld,
              i = e.params.Points.threshold;
            if (
              (null === n.boundingSphere && n.computeBoundingSphere(),
              Xu.copy(n.boundingSphere),
              Xu.applyMatrix4(r),
              (Xu.radius += i),
              !1 !== e.ray.intersectsSphere(Xu))
            ) {
              Gu.getInverse(r), Hu.copy(e.ray).applyMatrix4(Gu);
              var a = i / ((this.scale.x + this.scale.y + this.scale.z) / 3),
                o = a * a;
              if (n.isBufferGeometry) {
                var s = n.index,
                  l = n.attributes.position.array;
                if (null !== s)
                  for (var c = s.array, u = 0, h = c.length; u < h; u++) {
                    var d = c[u];
                    Wu.fromArray(l, 3 * d), qu(Wu, d, o, r, e, t, this);
                  }
                else {
                  u = 0;
                  for (var p = l.length / 3; u < p; u++)
                    Wu.fromArray(l, 3 * u), qu(Wu, u, o, r, e, t, this);
                }
              } else {
                var f = n.vertices;
                for (u = 0, p = f.length; u < p; u++)
                  qu(f[u], u, o, r, e, t, this);
              }
            }
          },
          updateMorphTargets: function() {
            var e,
              t,
              n,
              r = this.geometry;
            if (r.isBufferGeometry) {
              var i = r.morphAttributes,
                a = Object.keys(i);
              if (a.length > 0) {
                var o = i[a[0]];
                if (void 0 !== o)
                  for (
                    this.morphTargetInfluences = [],
                      this.morphTargetDictionary = {},
                      e = 0,
                      t = o.length;
                    e < t;
                    e++
                  )
                    (n = o[e].name || String(e)),
                      this.morphTargetInfluences.push(0),
                      (this.morphTargetDictionary[n] = e);
              }
            } else {
              var s = r.morphTargets;
              void 0 !== s && s.length;
            }
          },
          clone: function() {
            return new this.constructor(this.geometry, this.material).copy(
              this
            );
          }
        })),
          (Qu.prototype = Object.assign(Object.create(oa.prototype), {
            constructor: Qu,
            isVideoTexture: !0,
            update: function() {
              var e = this.image;
              e.readyState >= e.HAVE_CURRENT_DATA && (this.needsUpdate = !0);
            }
          })),
          (Zu.prototype = Object.create(oa.prototype)),
          (Zu.prototype.constructor = Zu),
          (Zu.prototype.isCompressedTexture = !0),
          (Ju.prototype = Object.create(oa.prototype)),
          (Ju.prototype.constructor = Ju),
          (Ju.prototype.isCanvasTexture = !0),
          (Ku.prototype = Object.create(oa.prototype)),
          (Ku.prototype.constructor = Ku),
          (Ku.prototype.isDepthTexture = !0),
          ($u.prototype = Object.create(es.prototype)),
          ($u.prototype.constructor = $u),
          (eh.prototype = Object.create(As.prototype)),
          (eh.prototype.constructor = eh),
          (th.prototype = Object.create(es.prototype)),
          (th.prototype.constructor = th),
          (nh.prototype = Object.create(As.prototype)),
          (nh.prototype.constructor = nh),
          (rh.prototype = Object.create(es.prototype)),
          (rh.prototype.constructor = rh),
          (ih.prototype = Object.create(As.prototype)),
          (ih.prototype.constructor = ih),
          (ah.prototype = Object.create(rh.prototype)),
          (ah.prototype.constructor = ah),
          (oh.prototype = Object.create(As.prototype)),
          (oh.prototype.constructor = oh),
          (sh.prototype = Object.create(rh.prototype)),
          (sh.prototype.constructor = sh),
          (lh.prototype = Object.create(As.prototype)),
          (lh.prototype.constructor = lh),
          (ch.prototype = Object.create(rh.prototype)),
          (ch.prototype.constructor = ch),
          (uh.prototype = Object.create(As.prototype)),
          (uh.prototype.constructor = uh),
          (hh.prototype = Object.create(rh.prototype)),
          (hh.prototype.constructor = hh),
          (dh.prototype = Object.create(As.prototype)),
          (dh.prototype.constructor = dh),
          (ph.prototype = Object.create(es.prototype)),
          (ph.prototype.constructor = ph),
          (ph.prototype.toJSON = function() {
            var e = es.prototype.toJSON.call(this);
            return (e.path = this.parameters.path.toJSON()), e;
          }),
          (fh.prototype = Object.create(As.prototype)),
          (fh.prototype.constructor = fh),
          (mh.prototype = Object.create(es.prototype)),
          (mh.prototype.constructor = mh),
          (vh.prototype = Object.create(As.prototype)),
          (vh.prototype.constructor = vh),
          (gh.prototype = Object.create(es.prototype)),
          (gh.prototype.constructor = gh);
        var yh = function(e, t, n) {
          n = n || 2;
          var r,
            i,
            a,
            o,
            s,
            l,
            c,
            u = t && t.length,
            h = u ? t[0] * n : e.length,
            d = bh(e, 0, h, n, !0),
            p = [];
          if (!d || d.next === d.prev) return p;
          if (
            (u &&
              (d = (function(e, t, n, r) {
                var i,
                  a,
                  o,
                  s,
                  l,
                  c = [];
                for (i = 0, a = t.length; i < a; i++)
                  (o = t[i] * r),
                    (s = i < a - 1 ? t[i + 1] * r : e.length),
                    (l = bh(e, o, s, r, !1)) === l.next && (l.steiner = !0),
                    c.push(Ph(l));
                for (c.sort(Sh), i = 0; i < c.length; i++)
                  Eh(c[i], n), (n = xh(n, n.next));
                return n;
              })(e, t, d, n)),
            e.length > 80 * n)
          ) {
            (r = a = e[0]), (i = o = e[1]);
            for (var f = n; f < h; f += n)
              (s = e[f]) < r && (r = s),
                (l = e[f + 1]) < i && (i = l),
                s > a && (a = s),
                l > o && (o = l);
            c = 0 !== (c = Math.max(a - r, o - i)) ? 1 / c : 0;
          }
          return wh(d, p, n, r, i, c), p;
        };
        function bh(e, t, n, r, i) {
          var a, o;
          if (
            i ===
            (function(e, t, n, r) {
              for (var i = 0, a = t, o = n - r; a < n; a += r)
                (i += (e[o] - e[a]) * (e[a + 1] + e[o + 1])), (o = a);
              return i;
            })(e, t, n, r) >
              0
          )
            for (a = t; a < n; a += r) o = kh(a, e[a], e[a + 1], o);
          else for (a = n - r; a >= t; a -= r) o = kh(a, e[a], e[a + 1], o);
          return o && Ch(o, o.next) && (Uh(o), (o = o.next)), o;
        }
        function xh(e, t) {
          if (!e) return e;
          t || (t = e);
          var n,
            r = e;
          do {
            if (
              ((n = !1),
              r.steiner || (!Ch(r, r.next) && 0 !== Oh(r.prev, r, r.next)))
            )
              r = r.next;
            else {
              if ((Uh(r), (r = t = r.prev) === r.next)) break;
              n = !0;
            }
          } while (n || r !== t);
          return t;
        }
        function wh(e, t, n, r, i, a, o) {
          if (e) {
            !o &&
              a &&
              (function(e, t, n, r) {
                var i = e;
                do {
                  null === i.z && (i.z = Rh(i.x, i.y, t, n, r)),
                    (i.prevZ = i.prev),
                    (i.nextZ = i.next),
                    (i = i.next);
                } while (i !== e);
                (i.prevZ.nextZ = null),
                  (i.prevZ = null),
                  (function(e) {
                    var t,
                      n,
                      r,
                      i,
                      a,
                      o,
                      s,
                      l,
                      c = 1;
                    do {
                      for (n = e, e = null, a = null, o = 0; n; ) {
                        for (
                          o++, r = n, s = 0, t = 0;
                          t < c && (s++, (r = r.nextZ));
                          t++
                        );
                        for (l = c; s > 0 || (l > 0 && r); )
                          0 !== s && (0 === l || !r || n.z <= r.z)
                            ? ((i = n), (n = n.nextZ), s--)
                            : ((i = r), (r = r.nextZ), l--),
                            a ? (a.nextZ = i) : (e = i),
                            (i.prevZ = a),
                            (a = i);
                        n = r;
                      }
                      (a.nextZ = null), (c *= 2);
                    } while (o > 1);
                  })(i);
              })(e, r, i, a);
            for (var s, l, c = e; e.prev !== e.next; )
              if (((s = e.prev), (l = e.next), a ? Mh(e, r, i, a) : _h(e)))
                t.push(s.i / n),
                  t.push(e.i / n),
                  t.push(l.i / n),
                  Uh(e),
                  (e = l.next),
                  (c = l.next);
              else if ((e = l) === c) {
                o
                  ? 1 === o
                    ? wh((e = Th(e, t, n)), t, n, r, i, a, 2)
                    : 2 === o && Ah(e, t, n, r, i, a)
                  : wh(xh(e), t, n, r, i, a, 1);
                break;
              }
          }
        }
        function _h(e) {
          var t = e.prev,
            n = e,
            r = e.next;
          if (Oh(t, n, r) >= 0) return !1;
          for (var i = e.next.next; i !== e.prev; ) {
            if (
              Ih(t.x, t.y, n.x, n.y, r.x, r.y, i.x, i.y) &&
              Oh(i.prev, i, i.next) >= 0
            )
              return !1;
            i = i.next;
          }
          return !0;
        }
        function Mh(e, t, n, r) {
          var i = e.prev,
            a = e,
            o = e.next;
          if (Oh(i, a, o) >= 0) return !1;
          for (
            var s = i.x < a.x ? (i.x < o.x ? i.x : o.x) : a.x < o.x ? a.x : o.x,
              l = i.y < a.y ? (i.y < o.y ? i.y : o.y) : a.y < o.y ? a.y : o.y,
              c = i.x > a.x ? (i.x > o.x ? i.x : o.x) : a.x > o.x ? a.x : o.x,
              u = i.y > a.y ? (i.y > o.y ? i.y : o.y) : a.y > o.y ? a.y : o.y,
              h = Rh(s, l, t, n, r),
              d = Rh(c, u, t, n, r),
              p = e.prevZ,
              f = e.nextZ;
            p && p.z >= h && f && f.z <= d;

          ) {
            if (
              p !== e.prev &&
              p !== e.next &&
              Ih(i.x, i.y, a.x, a.y, o.x, o.y, p.x, p.y) &&
              Oh(p.prev, p, p.next) >= 0
            )
              return !1;
            if (
              ((p = p.prevZ),
              f !== e.prev &&
                f !== e.next &&
                Ih(i.x, i.y, a.x, a.y, o.x, o.y, f.x, f.y) &&
                Oh(f.prev, f, f.next) >= 0)
            )
              return !1;
            f = f.nextZ;
          }
          for (; p && p.z >= h; ) {
            if (
              p !== e.prev &&
              p !== e.next &&
              Ih(i.x, i.y, a.x, a.y, o.x, o.y, p.x, p.y) &&
              Oh(p.prev, p, p.next) >= 0
            )
              return !1;
            p = p.prevZ;
          }
          for (; f && f.z <= d; ) {
            if (
              f !== e.prev &&
              f !== e.next &&
              Ih(i.x, i.y, a.x, a.y, o.x, o.y, f.x, f.y) &&
              Oh(f.prev, f, f.next) >= 0
            )
              return !1;
            f = f.nextZ;
          }
          return !0;
        }
        function Th(e, t, n) {
          var r = e;
          do {
            var i = r.prev,
              a = r.next.next;
            !Ch(i, a) &&
              Lh(i, r, r.next, a) &&
              Nh(i, a) &&
              Nh(a, i) &&
              (t.push(i.i / n),
              t.push(r.i / n),
              t.push(a.i / n),
              Uh(r),
              Uh(r.next),
              (r = e = a)),
              (r = r.next);
          } while (r !== e);
          return r;
        }
        function Ah(e, t, n, r, i, a) {
          var o = e;
          do {
            for (var s = o.next.next; s !== o.prev; ) {
              if (o.i !== s.i && Dh(o, s)) {
                var l = Fh(o, s);
                return (
                  (o = xh(o, o.next)),
                  (l = xh(l, l.next)),
                  wh(o, t, n, r, i, a),
                  void wh(l, t, n, r, i, a)
                );
              }
              s = s.next;
            }
            o = o.next;
          } while (o !== e);
        }
        function Sh(e, t) {
          return e.x - t.x;
        }
        function Eh(e, t) {
          if (
            (t = (function(e, t) {
              var n,
                r = t,
                i = e.x,
                a = e.y,
                o = -1 / 0;
              do {
                if (a <= r.y && a >= r.next.y && r.next.y !== r.y) {
                  var s =
                    r.x + ((a - r.y) * (r.next.x - r.x)) / (r.next.y - r.y);
                  if (s <= i && s > o) {
                    if (((o = s), s === i)) {
                      if (a === r.y) return r;
                      if (a === r.next.y) return r.next;
                    }
                    n = r.x < r.next.x ? r : r.next;
                  }
                }
                r = r.next;
              } while (r !== t);
              if (!n) return null;
              if (i === o) return n.prev;
              var l,
                c = n,
                u = n.x,
                h = n.y,
                d = 1 / 0;
              for (r = n.next; r !== c; )
                i >= r.x &&
                  r.x >= u &&
                  i !== r.x &&
                  Ih(a < h ? i : o, a, u, h, a < h ? o : i, a, r.x, r.y) &&
                  ((l = Math.abs(a - r.y) / (i - r.x)) < d ||
                    (l === d && r.x > n.x)) &&
                  Nh(r, e) &&
                  ((n = r), (d = l)),
                  (r = r.next);
              return n;
            })(e, t))
          ) {
            var n = Fh(t, e);
            xh(n, n.next);
          }
        }
        function Rh(e, t, n, r, i) {
          return (
            (e =
              1431655765 &
              ((e =
                858993459 &
                ((e =
                  252645135 &
                  ((e = 16711935 & ((e = 32767 * (e - n) * i) | (e << 8))) |
                    (e << 4))) |
                  (e << 2))) |
                (e << 1))) |
            ((t =
              1431655765 &
              ((t =
                858993459 &
                ((t =
                  252645135 &
                  ((t = 16711935 & ((t = 32767 * (t - r) * i) | (t << 8))) |
                    (t << 4))) |
                  (t << 2))) |
                (t << 1))) <<
              1)
          );
        }
        function Ph(e) {
          var t = e,
            n = e;
          do {
            (t.x < n.x || (t.x === n.x && t.y < n.y)) && (n = t), (t = t.next);
          } while (t !== e);
          return n;
        }
        function Ih(e, t, n, r, i, a, o, s) {
          return (
            (i - o) * (t - s) - (e - o) * (a - s) >= 0 &&
            (e - o) * (r - s) - (n - o) * (t - s) >= 0 &&
            (n - o) * (a - s) - (i - o) * (r - s) >= 0
          );
        }
        function Dh(e, t) {
          return (
            e.next.i !== t.i &&
            e.prev.i !== t.i &&
            !(function(e, t) {
              var n = e;
              do {
                if (
                  n.i !== e.i &&
                  n.next.i !== e.i &&
                  n.i !== t.i &&
                  n.next.i !== t.i &&
                  Lh(n, n.next, e, t)
                )
                  return !0;
                n = n.next;
              } while (n !== e);
              return !1;
            })(e, t) &&
            Nh(e, t) &&
            Nh(t, e) &&
            (function(e, t) {
              var n = e,
                r = !1,
                i = (e.x + t.x) / 2,
                a = (e.y + t.y) / 2;
              do {
                n.y > a != n.next.y > a &&
                  n.next.y !== n.y &&
                  i < ((n.next.x - n.x) * (a - n.y)) / (n.next.y - n.y) + n.x &&
                  (r = !r),
                  (n = n.next);
              } while (n !== e);
              return r;
            })(e, t)
          );
        }
        function Oh(e, t, n) {
          return (t.y - e.y) * (n.x - t.x) - (t.x - e.x) * (n.y - t.y);
        }
        function Ch(e, t) {
          return e.x === t.x && e.y === t.y;
        }
        function Lh(e, t, n, r) {
          return (
            !!((Ch(e, n) && Ch(t, r)) || (Ch(e, r) && Ch(n, t))) ||
            (Oh(e, t, n) > 0 != Oh(e, t, r) > 0 &&
              Oh(n, r, e) > 0 != Oh(n, r, t) > 0)
          );
        }
        function Nh(e, t) {
          return Oh(e.prev, e, e.next) < 0
            ? Oh(e, t, e.next) >= 0 && Oh(e, e.prev, t) >= 0
            : Oh(e, t, e.prev) < 0 || Oh(e, e.next, t) < 0;
        }
        function Fh(e, t) {
          var n = new jh(e.i, e.x, e.y),
            r = new jh(t.i, t.x, t.y),
            i = e.next,
            a = t.prev;
          return (
            (e.next = t),
            (t.prev = e),
            (n.next = i),
            (i.prev = n),
            (r.next = n),
            (n.prev = r),
            (a.next = r),
            (r.prev = a),
            r
          );
        }
        function kh(e, t, n, r) {
          var i = new jh(e, t, n);
          return (
            r
              ? ((i.next = r.next),
                (i.prev = r),
                (r.next.prev = i),
                (r.next = i))
              : ((i.prev = i), (i.next = i)),
            i
          );
        }
        function Uh(e) {
          (e.next.prev = e.prev),
            (e.prev.next = e.next),
            e.prevZ && (e.prevZ.nextZ = e.nextZ),
            e.nextZ && (e.nextZ.prevZ = e.prevZ);
        }
        function jh(e, t, n) {
          (this.i = e),
            (this.x = t),
            (this.y = n),
            (this.prev = null),
            (this.next = null),
            (this.z = null),
            (this.prevZ = null),
            (this.nextZ = null),
            (this.steiner = !1);
        }
        var Bh = {
          area: function(e) {
            for (var t = e.length, n = 0, r = t - 1, i = 0; i < t; r = i++)
              n += e[r].x * e[i].y - e[i].x * e[r].y;
            return 0.5 * n;
          },
          isClockWise: function(e) {
            return Bh.area(e) < 0;
          },
          triangulateShape: function(e, t) {
            var n = [],
              r = [],
              i = [];
            zh(e), Vh(n, e);
            var a = e.length;
            t.forEach(zh);
            for (var o = 0; o < t.length; o++)
              r.push(a), (a += t[o].length), Vh(n, t[o]);
            var s = yh(n, r);
            for (o = 0; o < s.length; o += 3) i.push(s.slice(o, o + 3));
            return i;
          }
        };
        function zh(e) {
          var t = e.length;
          t > 2 && e[t - 1].equals(e[0]) && e.pop();
        }
        function Vh(e, t) {
          for (var n = 0; n < t.length; n++) e.push(t[n].x), e.push(t[n].y);
        }
        function Gh(e, t) {
          As.call(this),
            (this.type = "ExtrudeGeometry"),
            (this.parameters = { shapes: e, options: t }),
            this.fromBufferGeometry(new Hh(e, t)),
            this.mergeVertices();
        }
        function Hh(e, t) {
          es.call(this),
            (this.type = "ExtrudeBufferGeometry"),
            (this.parameters = { shapes: e, options: t }),
            (e = Array.isArray(e) ? e : [e]);
          for (var n = this, r = [], i = [], a = 0, o = e.length; a < o; a++)
            s(e[a]);
          function s(e) {
            var a = [],
              o = void 0 !== t.curveSegments ? t.curveSegments : 12,
              s = void 0 !== t.steps ? t.steps : 1,
              l = void 0 !== t.depth ? t.depth : 100,
              c = void 0 === t.bevelEnabled || t.bevelEnabled,
              u = void 0 !== t.bevelThickness ? t.bevelThickness : 6,
              h = void 0 !== t.bevelSize ? t.bevelSize : u - 2,
              d = void 0 !== t.bevelOffset ? t.bevelOffset : 0,
              p = void 0 !== t.bevelSegments ? t.bevelSegments : 3,
              f = t.extrudePath,
              m = void 0 !== t.UVGenerator ? t.UVGenerator : Xh;
            void 0 !== t.amount && (l = t.amount);
            var v,
              g,
              y,
              b,
              x,
              w,
              _,
              M,
              T = !1;
            f &&
              ((v = f.getSpacedPoints(s)),
              (T = !0),
              (c = !1),
              (g = f.computeFrenetFrames(s, !1)),
              (y = new ea()),
              (b = new ea()),
              (x = new ea())),
              c || ((p = 0), (u = 0), (h = 0), (d = 0));
            var A = e.extractPoints(o),
              S = A.shape,
              E = A.holes;
            if (!Bh.isClockWise(S))
              for (S = S.reverse(), _ = 0, M = E.length; _ < M; _++)
                (w = E[_]), Bh.isClockWise(w) && (E[_] = w.reverse());
            var R = Bh.triangulateShape(S, E),
              P = S;
            for (_ = 0, M = E.length; _ < M; _++) (w = E[_]), (S = S.concat(w));
            function I(e, t, n) {
              return t
                .clone()
                .multiplyScalar(n)
                .add(e);
            }
            var D,
              O,
              C,
              L,
              N,
              F,
              k = S.length,
              U = R.length;
            function j(e, t, n) {
              var r,
                i,
                a,
                o = e.x - t.x,
                s = e.y - t.y,
                l = n.x - e.x,
                c = n.y - e.y,
                u = o * o + s * s,
                h = o * c - s * l;
              if (Math.abs(h) > Number.EPSILON) {
                var d = Math.sqrt(u),
                  p = Math.sqrt(l * l + c * c),
                  f = t.x - s / d,
                  m = t.y + o / d,
                  v =
                    ((n.x - c / p - f) * c - (n.y + l / p - m) * l) /
                    (o * c - s * l),
                  g = (r = f + o * v - e.x) * r + (i = m + s * v - e.y) * i;
                if (g <= 2) return new Zi(r, i);
                a = Math.sqrt(g / 2);
              } else {
                var y = !1;
                o > Number.EPSILON
                  ? l > Number.EPSILON && (y = !0)
                  : o < -Number.EPSILON
                  ? l < -Number.EPSILON && (y = !0)
                  : Math.sign(s) === Math.sign(c) && (y = !0),
                  y
                    ? ((r = -s), (i = o), (a = Math.sqrt(u)))
                    : ((r = o), (i = s), (a = Math.sqrt(u / 2)));
              }
              return new Zi(r / a, i / a);
            }
            for (
              var B = [], z = 0, V = P.length, G = V - 1, H = z + 1;
              z < V;
              z++, G++, H++
            )
              G === V && (G = 0),
                H === V && (H = 0),
                (B[z] = j(P[z], P[G], P[H]));
            var X,
              W,
              Y = [],
              q = B.concat();
            for (_ = 0, M = E.length; _ < M; _++) {
              for (
                w = E[_], X = [], z = 0, G = (V = w.length) - 1, H = z + 1;
                z < V;
                z++, G++, H++
              )
                G === V && (G = 0),
                  H === V && (H = 0),
                  (X[z] = j(w[z], w[G], w[H]));
              Y.push(X), (q = q.concat(X));
            }
            for (D = 0; D < p; D++) {
              for (
                C = D / p,
                  L = u * Math.cos((C * Math.PI) / 2),
                  O = h * Math.sin((C * Math.PI) / 2) + d,
                  z = 0,
                  V = P.length;
                z < V;
                z++
              )
                Z((N = I(P[z], B[z], O)).x, N.y, -L);
              for (_ = 0, M = E.length; _ < M; _++)
                for (w = E[_], X = Y[_], z = 0, V = w.length; z < V; z++)
                  Z((N = I(w[z], X[z], O)).x, N.y, -L);
            }
            for (O = h + d, z = 0; z < k; z++)
              (N = c ? I(S[z], q[z], O) : S[z]),
                T
                  ? (b.copy(g.normals[0]).multiplyScalar(N.x),
                    y.copy(g.binormals[0]).multiplyScalar(N.y),
                    x
                      .copy(v[0])
                      .add(b)
                      .add(y),
                    Z(x.x, x.y, x.z))
                  : Z(N.x, N.y, 0);
            for (W = 1; W <= s; W++)
              for (z = 0; z < k; z++)
                (N = c ? I(S[z], q[z], O) : S[z]),
                  T
                    ? (b.copy(g.normals[W]).multiplyScalar(N.x),
                      y.copy(g.binormals[W]).multiplyScalar(N.y),
                      x
                        .copy(v[W])
                        .add(b)
                        .add(y),
                      Z(x.x, x.y, x.z))
                    : Z(N.x, N.y, (l / s) * W);
            for (D = p - 1; D >= 0; D--) {
              for (
                C = D / p,
                  L = u * Math.cos((C * Math.PI) / 2),
                  O = h * Math.sin((C * Math.PI) / 2) + d,
                  z = 0,
                  V = P.length;
                z < V;
                z++
              )
                Z((N = I(P[z], B[z], O)).x, N.y, l + L);
              for (_ = 0, M = E.length; _ < M; _++)
                for (w = E[_], X = Y[_], z = 0, V = w.length; z < V; z++)
                  (N = I(w[z], X[z], O)),
                    T
                      ? Z(N.x, N.y + v[s - 1].y, v[s - 1].x + L)
                      : Z(N.x, N.y, l + L);
            }
            function Q(e, t) {
              var n, r;
              for (z = e.length; --z >= 0; ) {
                (n = z), (r = z - 1) < 0 && (r = e.length - 1);
                var i = 0,
                  a = s + 2 * p;
                for (i = 0; i < a; i++) {
                  var o = k * i,
                    l = k * (i + 1);
                  K(t + n + o, t + r + o, t + r + l, t + n + l);
                }
              }
            }
            function Z(e, t, n) {
              a.push(e), a.push(t), a.push(n);
            }
            function J(e, t, i) {
              $(e), $(t), $(i);
              var a = r.length / 3,
                o = m.generateTopUV(n, r, a - 3, a - 2, a - 1);
              ee(o[0]), ee(o[1]), ee(o[2]);
            }
            function K(e, t, i, a) {
              $(e), $(t), $(a), $(t), $(i), $(a);
              var o = r.length / 3,
                s = m.generateSideWallUV(n, r, o - 6, o - 3, o - 2, o - 1);
              ee(s[0]), ee(s[1]), ee(s[3]), ee(s[1]), ee(s[2]), ee(s[3]);
            }
            function $(e) {
              r.push(a[3 * e + 0]), r.push(a[3 * e + 1]), r.push(a[3 * e + 2]);
            }
            function ee(e) {
              i.push(e.x), i.push(e.y);
            }
            !(function() {
              var e = r.length / 3;
              if (c) {
                var t = 0,
                  i = k * t;
                for (z = 0; z < U; z++)
                  J((F = R[z])[2] + i, F[1] + i, F[0] + i);
                for (i = k * (t = s + 2 * p), z = 0; z < U; z++)
                  J((F = R[z])[0] + i, F[1] + i, F[2] + i);
              } else {
                for (z = 0; z < U; z++) J((F = R[z])[2], F[1], F[0]);
                for (z = 0; z < U; z++)
                  J((F = R[z])[0] + k * s, F[1] + k * s, F[2] + k * s);
              }
              n.addGroup(e, r.length / 3 - e, 0);
            })(),
              (function() {
                var e = r.length / 3,
                  t = 0;
                for (Q(P, t), t += P.length, _ = 0, M = E.length; _ < M; _++)
                  Q((w = E[_]), t), (t += w.length);
                n.addGroup(e, r.length / 3 - e, 1);
              })();
          }
          this.setAttribute("position", new Go(r, 3)),
            this.setAttribute("uv", new Go(i, 2)),
            this.computeVertexNormals();
        }
        (Gh.prototype = Object.create(As.prototype)),
          (Gh.prototype.constructor = Gh),
          (Gh.prototype.toJSON = function() {
            var e = As.prototype.toJSON.call(this);
            return Wh(this.parameters.shapes, this.parameters.options, e);
          }),
          (Hh.prototype = Object.create(es.prototype)),
          (Hh.prototype.constructor = Hh),
          (Hh.prototype.toJSON = function() {
            var e = es.prototype.toJSON.call(this);
            return Wh(this.parameters.shapes, this.parameters.options, e);
          });
        var Xh = {
          generateTopUV: function(e, t, n, r, i) {
            var a = t[3 * n],
              o = t[3 * n + 1],
              s = t[3 * r],
              l = t[3 * r + 1],
              c = t[3 * i],
              u = t[3 * i + 1];
            return [new Zi(a, o), new Zi(s, l), new Zi(c, u)];
          },
          generateSideWallUV: function(e, t, n, r, i, a) {
            var o = t[3 * n],
              s = t[3 * n + 1],
              l = t[3 * n + 2],
              c = t[3 * r],
              u = t[3 * r + 1],
              h = t[3 * r + 2],
              d = t[3 * i],
              p = t[3 * i + 1],
              f = t[3 * i + 2],
              m = t[3 * a],
              v = t[3 * a + 1],
              g = t[3 * a + 2];
            return Math.abs(s - u) < 0.01
              ? [
                  new Zi(o, 1 - l),
                  new Zi(c, 1 - h),
                  new Zi(d, 1 - f),
                  new Zi(m, 1 - g)
                ]
              : [
                  new Zi(s, 1 - l),
                  new Zi(u, 1 - h),
                  new Zi(p, 1 - f),
                  new Zi(v, 1 - g)
                ];
          }
        };
        function Wh(e, t, n) {
          if (((n.shapes = []), Array.isArray(e)))
            for (var r = 0, i = e.length; r < i; r++) {
              var a = e[r];
              n.shapes.push(a.uuid);
            }
          else n.shapes.push(e.uuid);
          return (
            void 0 !== t.extrudePath &&
              (n.options.extrudePath = t.extrudePath.toJSON()),
            n
          );
        }
        function Yh(e, t) {
          As.call(this),
            (this.type = "TextGeometry"),
            (this.parameters = { text: e, parameters: t }),
            this.fromBufferGeometry(new qh(e, t)),
            this.mergeVertices();
        }
        function qh(e, t) {
          var n = (t = t || {}).font;
          if (!n || !n.isFont) return new As();
          var r = n.generateShapes(e, t.size);
          (t.depth = void 0 !== t.height ? t.height : 50),
            void 0 === t.bevelThickness && (t.bevelThickness = 10),
            void 0 === t.bevelSize && (t.bevelSize = 8),
            void 0 === t.bevelEnabled && (t.bevelEnabled = !1),
            Hh.call(this, r, t),
            (this.type = "TextBufferGeometry");
        }
        function Qh(e, t, n, r, i, a, o) {
          As.call(this),
            (this.type = "SphereGeometry"),
            (this.parameters = {
              radius: e,
              widthSegments: t,
              heightSegments: n,
              phiStart: r,
              phiLength: i,
              thetaStart: a,
              thetaLength: o
            }),
            this.fromBufferGeometry(new Zh(e, t, n, r, i, a, o)),
            this.mergeVertices();
        }
        function Zh(e, t, n, r, i, a, o) {
          es.call(this),
            (this.type = "SphereBufferGeometry"),
            (this.parameters = {
              radius: e,
              widthSegments: t,
              heightSegments: n,
              phiStart: r,
              phiLength: i,
              thetaStart: a,
              thetaLength: o
            }),
            (e = e || 1),
            (t = Math.max(3, Math.floor(t) || 8)),
            (n = Math.max(2, Math.floor(n) || 6)),
            (r = void 0 !== r ? r : 0),
            (i = void 0 !== i ? i : 2 * Math.PI),
            (a = void 0 !== a ? a : 0),
            (o = void 0 !== o ? o : Math.PI);
          var s,
            l,
            c = Math.min(a + o, Math.PI),
            u = 0,
            h = [],
            d = new ea(),
            p = new ea(),
            f = [],
            m = [],
            v = [],
            g = [];
          for (l = 0; l <= n; l++) {
            var y = [],
              b = l / n,
              x = 0;
            for (
              0 == l && 0 == a
                ? (x = 0.5 / t)
                : l == n && c == Math.PI && (x = -0.5 / t),
                s = 0;
              s <= t;
              s++
            ) {
              var w = s / t;
              (d.x = -e * Math.cos(r + w * i) * Math.sin(a + b * o)),
                (d.y = e * Math.cos(a + b * o)),
                (d.z = e * Math.sin(r + w * i) * Math.sin(a + b * o)),
                m.push(d.x, d.y, d.z),
                p.copy(d).normalize(),
                v.push(p.x, p.y, p.z),
                g.push(w + x, 1 - b),
                y.push(u++);
            }
            h.push(y);
          }
          for (l = 0; l < n; l++)
            for (s = 0; s < t; s++) {
              var _ = h[l][s + 1],
                M = h[l][s],
                T = h[l + 1][s],
                A = h[l + 1][s + 1];
              (0 !== l || a > 0) && f.push(_, M, A),
                (l !== n - 1 || c < Math.PI) && f.push(M, T, A);
            }
          this.setIndex(f),
            this.setAttribute("position", new Go(m, 3)),
            this.setAttribute("normal", new Go(v, 3)),
            this.setAttribute("uv", new Go(g, 2));
        }
        function Jh(e, t, n, r, i, a) {
          As.call(this),
            (this.type = "RingGeometry"),
            (this.parameters = {
              innerRadius: e,
              outerRadius: t,
              thetaSegments: n,
              phiSegments: r,
              thetaStart: i,
              thetaLength: a
            }),
            this.fromBufferGeometry(new Kh(e, t, n, r, i, a)),
            this.mergeVertices();
        }
        function Kh(e, t, n, r, i, a) {
          es.call(this),
            (this.type = "RingBufferGeometry"),
            (this.parameters = {
              innerRadius: e,
              outerRadius: t,
              thetaSegments: n,
              phiSegments: r,
              thetaStart: i,
              thetaLength: a
            }),
            (e = e || 0.5),
            (t = t || 1),
            (i = void 0 !== i ? i : 0),
            (a = void 0 !== a ? a : 2 * Math.PI),
            (n = void 0 !== n ? Math.max(3, n) : 8);
          var o,
            s,
            l,
            c = [],
            u = [],
            h = [],
            d = [],
            p = e,
            f = (t - e) / (r = void 0 !== r ? Math.max(1, r) : 1),
            m = new ea(),
            v = new Zi();
          for (s = 0; s <= r; s++) {
            for (l = 0; l <= n; l++)
              (o = i + (l / n) * a),
                (m.x = p * Math.cos(o)),
                (m.y = p * Math.sin(o)),
                u.push(m.x, m.y, m.z),
                h.push(0, 0, 1),
                (v.x = (m.x / t + 1) / 2),
                (v.y = (m.y / t + 1) / 2),
                d.push(v.x, v.y);
            p += f;
          }
          for (s = 0; s < r; s++) {
            var g = s * (n + 1);
            for (l = 0; l < n; l++) {
              var y = (o = l + g),
                b = o + n + 1,
                x = o + n + 2,
                w = o + 1;
              c.push(y, b, w), c.push(b, x, w);
            }
          }
          this.setIndex(c),
            this.setAttribute("position", new Go(u, 3)),
            this.setAttribute("normal", new Go(h, 3)),
            this.setAttribute("uv", new Go(d, 2));
        }
        function $h(e, t, n, r) {
          As.call(this),
            (this.type = "LatheGeometry"),
            (this.parameters = {
              points: e,
              segments: t,
              phiStart: n,
              phiLength: r
            }),
            this.fromBufferGeometry(new ed(e, t, n, r)),
            this.mergeVertices();
        }
        function ed(e, t, n, r) {
          es.call(this),
            (this.type = "LatheBufferGeometry"),
            (this.parameters = {
              points: e,
              segments: t,
              phiStart: n,
              phiLength: r
            }),
            (t = Math.floor(t) || 12),
            (n = n || 0),
            (r = r || 2 * Math.PI),
            (r = Qi.clamp(r, 0, 2 * Math.PI));
          var i,
            a,
            o,
            s = [],
            l = [],
            c = [],
            u = 1 / t,
            h = new ea(),
            d = new Zi();
          for (a = 0; a <= t; a++) {
            var p = n + a * u * r,
              f = Math.sin(p),
              m = Math.cos(p);
            for (o = 0; o <= e.length - 1; o++)
              (h.x = e[o].x * f),
                (h.y = e[o].y),
                (h.z = e[o].x * m),
                l.push(h.x, h.y, h.z),
                (d.x = a / t),
                (d.y = o / (e.length - 1)),
                c.push(d.x, d.y);
          }
          for (a = 0; a < t; a++)
            for (o = 0; o < e.length - 1; o++) {
              var v = (i = o + a * e.length),
                g = i + e.length,
                y = i + e.length + 1,
                b = i + 1;
              s.push(v, g, b), s.push(g, y, b);
            }
          if (
            (this.setIndex(s),
            this.setAttribute("position", new Go(l, 3)),
            this.setAttribute("uv", new Go(c, 2)),
            this.computeVertexNormals(),
            r === 2 * Math.PI)
          ) {
            var x = this.attributes.normal.array,
              w = new ea(),
              _ = new ea(),
              M = new ea();
            for (i = t * e.length * 3, a = 0, o = 0; a < e.length; a++, o += 3)
              (w.x = x[o + 0]),
                (w.y = x[o + 1]),
                (w.z = x[o + 2]),
                (_.x = x[i + o + 0]),
                (_.y = x[i + o + 1]),
                (_.z = x[i + o + 2]),
                M.addVectors(w, _).normalize(),
                (x[o + 0] = x[i + o + 0] = M.x),
                (x[o + 1] = x[i + o + 1] = M.y),
                (x[o + 2] = x[i + o + 2] = M.z);
          }
        }
        function td(e, t) {
          As.call(this),
            (this.type = "ShapeGeometry"),
            "object" == typeof t && (t = t.curveSegments),
            (this.parameters = { shapes: e, curveSegments: t }),
            this.fromBufferGeometry(new nd(e, t)),
            this.mergeVertices();
        }
        function nd(e, t) {
          es.call(this),
            (this.type = "ShapeBufferGeometry"),
            (this.parameters = { shapes: e, curveSegments: t }),
            (t = t || 12);
          var n = [],
            r = [],
            i = [],
            a = [],
            o = 0,
            s = 0;
          if (!1 === Array.isArray(e)) c(e);
          else
            for (var l = 0; l < e.length; l++)
              c(e[l]), this.addGroup(o, s, l), (o += s), (s = 0);
          function c(e) {
            var o,
              l,
              c,
              u = r.length / 3,
              h = e.extractPoints(t),
              d = h.shape,
              p = h.holes;
            for (
              !1 === Bh.isClockWise(d) && (d = d.reverse()),
                o = 0,
                l = p.length;
              o < l;
              o++
            )
              (c = p[o]), !0 === Bh.isClockWise(c) && (p[o] = c.reverse());
            var f = Bh.triangulateShape(d, p);
            for (o = 0, l = p.length; o < l; o++) (c = p[o]), (d = d.concat(c));
            for (o = 0, l = d.length; o < l; o++) {
              var m = d[o];
              r.push(m.x, m.y, 0), i.push(0, 0, 1), a.push(m.x, m.y);
            }
            for (o = 0, l = f.length; o < l; o++) {
              var v = f[o],
                g = v[0] + u,
                y = v[1] + u,
                b = v[2] + u;
              n.push(g, y, b), (s += 3);
            }
          }
          this.setIndex(n),
            this.setAttribute("position", new Go(r, 3)),
            this.setAttribute("normal", new Go(i, 3)),
            this.setAttribute("uv", new Go(a, 2));
        }
        function rd(e, t) {
          if (((t.shapes = []), Array.isArray(e)))
            for (var n = 0, r = e.length; n < r; n++) {
              var i = e[n];
              t.shapes.push(i.uuid);
            }
          else t.shapes.push(e.uuid);
          return t;
        }
        function id(e, t) {
          es.call(this),
            (this.type = "EdgesGeometry"),
            (this.parameters = { thresholdAngle: t }),
            (t = void 0 !== t ? t : 1);
          var n,
            r,
            i,
            a,
            o = [],
            s = Math.cos(Qi.DEG2RAD * t),
            l = [0, 0],
            c = {},
            u = ["a", "b", "c"];
          e.isBufferGeometry
            ? (a = new As()).fromBufferGeometry(e)
            : (a = e.clone()),
            a.mergeVertices(),
            a.computeFaceNormals();
          for (var h = a.vertices, d = a.faces, p = 0, f = d.length; p < f; p++)
            for (var m = d[p], v = 0; v < 3; v++)
              (n = m[u[v]]),
                (r = m[u[(v + 1) % 3]]),
                (l[0] = Math.min(n, r)),
                (l[1] = Math.max(n, r)),
                void 0 === c[(i = l[0] + "," + l[1])]
                  ? (c[i] = {
                      index1: l[0],
                      index2: l[1],
                      face1: p,
                      face2: void 0
                    })
                  : (c[i].face2 = p);
          for (i in c) {
            var g = c[i];
            if (
              void 0 === g.face2 ||
              d[g.face1].normal.dot(d[g.face2].normal) <= s
            ) {
              var y = h[g.index1];
              o.push(y.x, y.y, y.z), (y = h[g.index2]), o.push(y.x, y.y, y.z);
            }
          }
          this.setAttribute("position", new Go(o, 3));
        }
        function ad(e, t, n, r, i, a, o, s) {
          As.call(this),
            (this.type = "CylinderGeometry"),
            (this.parameters = {
              radiusTop: e,
              radiusBottom: t,
              height: n,
              radialSegments: r,
              heightSegments: i,
              openEnded: a,
              thetaStart: o,
              thetaLength: s
            }),
            this.fromBufferGeometry(new od(e, t, n, r, i, a, o, s)),
            this.mergeVertices();
        }
        function od(e, t, n, r, i, a, o, s) {
          es.call(this),
            (this.type = "CylinderBufferGeometry"),
            (this.parameters = {
              radiusTop: e,
              radiusBottom: t,
              height: n,
              radialSegments: r,
              heightSegments: i,
              openEnded: a,
              thetaStart: o,
              thetaLength: s
            });
          var l = this;
          (e = void 0 !== e ? e : 1),
            (t = void 0 !== t ? t : 1),
            (n = n || 1),
            (r = Math.floor(r) || 8),
            (i = Math.floor(i) || 1),
            (a = void 0 !== a && a),
            (o = void 0 !== o ? o : 0),
            (s = void 0 !== s ? s : 2 * Math.PI);
          var c = [],
            u = [],
            h = [],
            d = [],
            p = 0,
            f = [],
            m = n / 2,
            v = 0;
          function g(n) {
            var i,
              a,
              f,
              g = new Zi(),
              y = new ea(),
              b = 0,
              x = !0 === n ? e : t,
              w = !0 === n ? 1 : -1;
            for (a = p, i = 1; i <= r; i++)
              u.push(0, m * w, 0), h.push(0, w, 0), d.push(0.5, 0.5), p++;
            for (f = p, i = 0; i <= r; i++) {
              var _ = (i / r) * s + o,
                M = Math.cos(_),
                T = Math.sin(_);
              (y.x = x * T),
                (y.y = m * w),
                (y.z = x * M),
                u.push(y.x, y.y, y.z),
                h.push(0, w, 0),
                (g.x = 0.5 * M + 0.5),
                (g.y = 0.5 * T * w + 0.5),
                d.push(g.x, g.y),
                p++;
            }
            for (i = 0; i < r; i++) {
              var A = a + i,
                S = f + i;
              !0 === n ? c.push(S, S + 1, A) : c.push(S + 1, S, A), (b += 3);
            }
            l.addGroup(v, b, !0 === n ? 1 : 2), (v += b);
          }
          !(function() {
            var a,
              g,
              y = new ea(),
              b = new ea(),
              x = 0,
              w = (t - e) / n;
            for (g = 0; g <= i; g++) {
              var _ = [],
                M = g / i,
                T = M * (t - e) + e;
              for (a = 0; a <= r; a++) {
                var A = a / r,
                  S = A * s + o,
                  E = Math.sin(S),
                  R = Math.cos(S);
                (b.x = T * E),
                  (b.y = -M * n + m),
                  (b.z = T * R),
                  u.push(b.x, b.y, b.z),
                  y.set(E, w, R).normalize(),
                  h.push(y.x, y.y, y.z),
                  d.push(A, 1 - M),
                  _.push(p++);
              }
              f.push(_);
            }
            for (a = 0; a < r; a++)
              for (g = 0; g < i; g++) {
                var P = f[g][a],
                  I = f[g + 1][a],
                  D = f[g + 1][a + 1],
                  O = f[g][a + 1];
                c.push(P, I, O), c.push(I, D, O), (x += 6);
              }
            l.addGroup(v, x, 0), (v += x);
          })(),
            !1 === a && (e > 0 && g(!0), t > 0 && g(!1)),
            this.setIndex(c),
            this.setAttribute("position", new Go(u, 3)),
            this.setAttribute("normal", new Go(h, 3)),
            this.setAttribute("uv", new Go(d, 2));
        }
        function sd(e, t, n, r, i, a, o) {
          ad.call(this, 0, e, t, n, r, i, a, o),
            (this.type = "ConeGeometry"),
            (this.parameters = {
              radius: e,
              height: t,
              radialSegments: n,
              heightSegments: r,
              openEnded: i,
              thetaStart: a,
              thetaLength: o
            });
        }
        function ld(e, t, n, r, i, a, o) {
          od.call(this, 0, e, t, n, r, i, a, o),
            (this.type = "ConeBufferGeometry"),
            (this.parameters = {
              radius: e,
              height: t,
              radialSegments: n,
              heightSegments: r,
              openEnded: i,
              thetaStart: a,
              thetaLength: o
            });
        }
        function cd(e, t, n, r) {
          As.call(this),
            (this.type = "CircleGeometry"),
            (this.parameters = {
              radius: e,
              segments: t,
              thetaStart: n,
              thetaLength: r
            }),
            this.fromBufferGeometry(new ud(e, t, n, r)),
            this.mergeVertices();
        }
        function ud(e, t, n, r) {
          es.call(this),
            (this.type = "CircleBufferGeometry"),
            (this.parameters = {
              radius: e,
              segments: t,
              thetaStart: n,
              thetaLength: r
            }),
            (e = e || 1),
            (t = void 0 !== t ? Math.max(3, t) : 8),
            (n = void 0 !== n ? n : 0),
            (r = void 0 !== r ? r : 2 * Math.PI);
          var i,
            a,
            o = [],
            s = [],
            l = [],
            c = [],
            u = new ea(),
            h = new Zi();
          for (
            s.push(0, 0, 0), l.push(0, 0, 1), c.push(0.5, 0.5), a = 0, i = 3;
            a <= t;
            a++, i += 3
          ) {
            var d = n + (a / t) * r;
            (u.x = e * Math.cos(d)),
              (u.y = e * Math.sin(d)),
              s.push(u.x, u.y, u.z),
              l.push(0, 0, 1),
              (h.x = (s[i] / e + 1) / 2),
              (h.y = (s[i + 1] / e + 1) / 2),
              c.push(h.x, h.y);
          }
          for (i = 1; i <= t; i++) o.push(i, i + 1, 0);
          this.setIndex(o),
            this.setAttribute("position", new Go(s, 3)),
            this.setAttribute("normal", new Go(l, 3)),
            this.setAttribute("uv", new Go(c, 2));
        }
        (Yh.prototype = Object.create(As.prototype)),
          (Yh.prototype.constructor = Yh),
          (qh.prototype = Object.create(Hh.prototype)),
          (qh.prototype.constructor = qh),
          (Qh.prototype = Object.create(As.prototype)),
          (Qh.prototype.constructor = Qh),
          (Zh.prototype = Object.create(es.prototype)),
          (Zh.prototype.constructor = Zh),
          (Jh.prototype = Object.create(As.prototype)),
          (Jh.prototype.constructor = Jh),
          (Kh.prototype = Object.create(es.prototype)),
          (Kh.prototype.constructor = Kh),
          ($h.prototype = Object.create(As.prototype)),
          ($h.prototype.constructor = $h),
          (ed.prototype = Object.create(es.prototype)),
          (ed.prototype.constructor = ed),
          (td.prototype = Object.create(As.prototype)),
          (td.prototype.constructor = td),
          (td.prototype.toJSON = function() {
            var e = As.prototype.toJSON.call(this);
            return rd(this.parameters.shapes, e);
          }),
          (nd.prototype = Object.create(es.prototype)),
          (nd.prototype.constructor = nd),
          (nd.prototype.toJSON = function() {
            var e = es.prototype.toJSON.call(this);
            return rd(this.parameters.shapes, e);
          }),
          (id.prototype = Object.create(es.prototype)),
          (id.prototype.constructor = id),
          (ad.prototype = Object.create(As.prototype)),
          (ad.prototype.constructor = ad),
          (od.prototype = Object.create(es.prototype)),
          (od.prototype.constructor = od),
          (sd.prototype = Object.create(ad.prototype)),
          (sd.prototype.constructor = sd),
          (ld.prototype = Object.create(od.prototype)),
          (ld.prototype.constructor = ld),
          (cd.prototype = Object.create(As.prototype)),
          (cd.prototype.constructor = cd),
          (ud.prototype = Object.create(es.prototype)),
          (ud.prototype.constructor = ud);
        var hd = Object.freeze({
          __proto__: null,
          WireframeGeometry: $u,
          ParametricGeometry: eh,
          ParametricBufferGeometry: th,
          TetrahedronGeometry: ih,
          TetrahedronBufferGeometry: ah,
          OctahedronGeometry: oh,
          OctahedronBufferGeometry: sh,
          IcosahedronGeometry: lh,
          IcosahedronBufferGeometry: ch,
          DodecahedronGeometry: uh,
          DodecahedronBufferGeometry: hh,
          PolyhedronGeometry: nh,
          PolyhedronBufferGeometry: rh,
          TubeGeometry: dh,
          TubeBufferGeometry: ph,
          TorusKnotGeometry: fh,
          TorusKnotBufferGeometry: mh,
          TorusGeometry: vh,
          TorusBufferGeometry: gh,
          TextGeometry: Yh,
          TextBufferGeometry: qh,
          SphereGeometry: Qh,
          SphereBufferGeometry: Zh,
          RingGeometry: Jh,
          RingBufferGeometry: Kh,
          PlaneGeometry: Qs,
          PlaneBufferGeometry: Zs,
          LatheGeometry: $h,
          LatheBufferGeometry: ed,
          ShapeGeometry: td,
          ShapeBufferGeometry: nd,
          ExtrudeGeometry: Gh,
          ExtrudeBufferGeometry: Hh,
          EdgesGeometry: id,
          ConeGeometry: sd,
          ConeBufferGeometry: ld,
          CylinderGeometry: ad,
          CylinderBufferGeometry: od,
          CircleGeometry: cd,
          CircleBufferGeometry: ud,
          BoxGeometry: Ss,
          BoxBufferGeometry: Es
        });
        function dd(e) {
          Co.call(this),
            (this.type = "ShadowMaterial"),
            (this.color = new Eo(0)),
            (this.transparent = !0),
            this.setValues(e);
        }
        function pd(e) {
          Cs.call(this, e), (this.type = "RawShaderMaterial");
        }
        function fd(e) {
          Co.call(this),
            (this.defines = { STANDARD: "" }),
            (this.type = "MeshStandardMaterial"),
            (this.color = new Eo(16777215)),
            (this.roughness = 0.5),
            (this.metalness = 0.5),
            (this.map = null),
            (this.lightMap = null),
            (this.lightMapIntensity = 1),
            (this.aoMap = null),
            (this.aoMapIntensity = 1),
            (this.emissive = new Eo(0)),
            (this.emissiveIntensity = 1),
            (this.emissiveMap = null),
            (this.bumpMap = null),
            (this.bumpScale = 1),
            (this.normalMap = null),
            (this.normalMapType = bi),
            (this.normalScale = new Zi(1, 1)),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.roughnessMap = null),
            (this.metalnessMap = null),
            (this.alphaMap = null),
            (this.envMap = null),
            (this.envMapIntensity = 1),
            (this.refractionRatio = 0.98),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.wireframeLinecap = "round"),
            (this.wireframeLinejoin = "round"),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            this.setValues(e);
        }
        function md(e) {
          fd.call(this),
            (this.defines = { STANDARD: "", PHYSICAL: "" }),
            (this.type = "MeshPhysicalMaterial"),
            (this.reflectivity = 0.5),
            (this.clearcoat = 0),
            (this.clearcoatRoughness = 0),
            (this.sheen = null),
            (this.clearcoatNormalScale = new Zi(1, 1)),
            (this.clearcoatNormalMap = null),
            (this.transparency = 0),
            this.setValues(e);
        }
        function vd(e) {
          Co.call(this),
            (this.type = "MeshPhongMaterial"),
            (this.color = new Eo(16777215)),
            (this.specular = new Eo(1118481)),
            (this.shininess = 30),
            (this.map = null),
            (this.lightMap = null),
            (this.lightMapIntensity = 1),
            (this.aoMap = null),
            (this.aoMapIntensity = 1),
            (this.emissive = new Eo(0)),
            (this.emissiveIntensity = 1),
            (this.emissiveMap = null),
            (this.bumpMap = null),
            (this.bumpScale = 1),
            (this.normalMap = null),
            (this.normalMapType = bi),
            (this.normalScale = new Zi(1, 1)),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.specularMap = null),
            (this.alphaMap = null),
            (this.envMap = null),
            (this.combine = Dn),
            (this.reflectivity = 1),
            (this.refractionRatio = 0.98),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.wireframeLinecap = "round"),
            (this.wireframeLinejoin = "round"),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            this.setValues(e);
        }
        function gd(e) {
          vd.call(this),
            (this.defines = { TOON: "" }),
            (this.type = "MeshToonMaterial"),
            (this.gradientMap = null),
            this.setValues(e);
        }
        function yd(e) {
          Co.call(this),
            (this.type = "MeshNormalMaterial"),
            (this.bumpMap = null),
            (this.bumpScale = 1),
            (this.normalMap = null),
            (this.normalMapType = bi),
            (this.normalScale = new Zi(1, 1)),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.fog = !1),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            this.setValues(e);
        }
        function bd(e) {
          Co.call(this),
            (this.type = "MeshLambertMaterial"),
            (this.color = new Eo(16777215)),
            (this.map = null),
            (this.lightMap = null),
            (this.lightMapIntensity = 1),
            (this.aoMap = null),
            (this.aoMapIntensity = 1),
            (this.emissive = new Eo(0)),
            (this.emissiveIntensity = 1),
            (this.emissiveMap = null),
            (this.specularMap = null),
            (this.alphaMap = null),
            (this.envMap = null),
            (this.combine = Dn),
            (this.reflectivity = 1),
            (this.refractionRatio = 0.98),
            (this.wireframe = !1),
            (this.wireframeLinewidth = 1),
            (this.wireframeLinecap = "round"),
            (this.wireframeLinejoin = "round"),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            this.setValues(e);
        }
        function xd(e) {
          Co.call(this),
            (this.defines = { MATCAP: "" }),
            (this.type = "MeshMatcapMaterial"),
            (this.color = new Eo(16777215)),
            (this.matcap = null),
            (this.map = null),
            (this.bumpMap = null),
            (this.bumpScale = 1),
            (this.normalMap = null),
            (this.normalMapType = bi),
            (this.normalScale = new Zi(1, 1)),
            (this.displacementMap = null),
            (this.displacementScale = 1),
            (this.displacementBias = 0),
            (this.alphaMap = null),
            (this.skinning = !1),
            (this.morphTargets = !1),
            (this.morphNormals = !1),
            this.setValues(e);
        }
        function wd(e) {
          Du.call(this),
            (this.type = "LineDashedMaterial"),
            (this.scale = 1),
            (this.dashSize = 3),
            (this.gapSize = 1),
            this.setValues(e);
        }
        (dd.prototype = Object.create(Co.prototype)),
          (dd.prototype.constructor = dd),
          (dd.prototype.isShadowMaterial = !0),
          (dd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e), this.color.copy(e.color), this
            );
          }),
          (pd.prototype = Object.create(Cs.prototype)),
          (pd.prototype.constructor = pd),
          (pd.prototype.isRawShaderMaterial = !0),
          (fd.prototype = Object.create(Co.prototype)),
          (fd.prototype.constructor = fd),
          (fd.prototype.isMeshStandardMaterial = !0),
          (fd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              (this.defines = { STANDARD: "" }),
              this.color.copy(e.color),
              (this.roughness = e.roughness),
              (this.metalness = e.metalness),
              (this.map = e.map),
              (this.lightMap = e.lightMap),
              (this.lightMapIntensity = e.lightMapIntensity),
              (this.aoMap = e.aoMap),
              (this.aoMapIntensity = e.aoMapIntensity),
              this.emissive.copy(e.emissive),
              (this.emissiveMap = e.emissiveMap),
              (this.emissiveIntensity = e.emissiveIntensity),
              (this.bumpMap = e.bumpMap),
              (this.bumpScale = e.bumpScale),
              (this.normalMap = e.normalMap),
              (this.normalMapType = e.normalMapType),
              this.normalScale.copy(e.normalScale),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              (this.roughnessMap = e.roughnessMap),
              (this.metalnessMap = e.metalnessMap),
              (this.alphaMap = e.alphaMap),
              (this.envMap = e.envMap),
              (this.envMapIntensity = e.envMapIntensity),
              (this.refractionRatio = e.refractionRatio),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.wireframeLinecap = e.wireframeLinecap),
              (this.wireframeLinejoin = e.wireframeLinejoin),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              this
            );
          }),
          (md.prototype = Object.create(fd.prototype)),
          (md.prototype.constructor = md),
          (md.prototype.isMeshPhysicalMaterial = !0),
          (md.prototype.copy = function(e) {
            return (
              fd.prototype.copy.call(this, e),
              (this.defines = { STANDARD: "", PHYSICAL: "" }),
              (this.reflectivity = e.reflectivity),
              (this.clearcoat = e.clearcoat),
              (this.clearcoatRoughness = e.clearcoatRoughness),
              e.sheen
                ? (this.sheen = (this.sheen || new Eo()).copy(e.sheen))
                : (this.sheen = null),
              (this.clearcoatNormalMap = e.clearcoatNormalMap),
              this.clearcoatNormalScale.copy(e.clearcoatNormalScale),
              (this.transparency = e.transparency),
              this
            );
          }),
          (vd.prototype = Object.create(Co.prototype)),
          (vd.prototype.constructor = vd),
          (vd.prototype.isMeshPhongMaterial = !0),
          (vd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              this.specular.copy(e.specular),
              (this.shininess = e.shininess),
              (this.map = e.map),
              (this.lightMap = e.lightMap),
              (this.lightMapIntensity = e.lightMapIntensity),
              (this.aoMap = e.aoMap),
              (this.aoMapIntensity = e.aoMapIntensity),
              this.emissive.copy(e.emissive),
              (this.emissiveMap = e.emissiveMap),
              (this.emissiveIntensity = e.emissiveIntensity),
              (this.bumpMap = e.bumpMap),
              (this.bumpScale = e.bumpScale),
              (this.normalMap = e.normalMap),
              (this.normalMapType = e.normalMapType),
              this.normalScale.copy(e.normalScale),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              (this.specularMap = e.specularMap),
              (this.alphaMap = e.alphaMap),
              (this.envMap = e.envMap),
              (this.combine = e.combine),
              (this.reflectivity = e.reflectivity),
              (this.refractionRatio = e.refractionRatio),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.wireframeLinecap = e.wireframeLinecap),
              (this.wireframeLinejoin = e.wireframeLinejoin),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              this
            );
          }),
          (gd.prototype = Object.create(vd.prototype)),
          (gd.prototype.constructor = gd),
          (gd.prototype.isMeshToonMaterial = !0),
          (gd.prototype.copy = function(e) {
            return (
              vd.prototype.copy.call(this, e),
              (this.gradientMap = e.gradientMap),
              this
            );
          }),
          (yd.prototype = Object.create(Co.prototype)),
          (yd.prototype.constructor = yd),
          (yd.prototype.isMeshNormalMaterial = !0),
          (yd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              (this.bumpMap = e.bumpMap),
              (this.bumpScale = e.bumpScale),
              (this.normalMap = e.normalMap),
              (this.normalMapType = e.normalMapType),
              this.normalScale.copy(e.normalScale),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              this
            );
          }),
          (bd.prototype = Object.create(Co.prototype)),
          (bd.prototype.constructor = bd),
          (bd.prototype.isMeshLambertMaterial = !0),
          (bd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              this.color.copy(e.color),
              (this.map = e.map),
              (this.lightMap = e.lightMap),
              (this.lightMapIntensity = e.lightMapIntensity),
              (this.aoMap = e.aoMap),
              (this.aoMapIntensity = e.aoMapIntensity),
              this.emissive.copy(e.emissive),
              (this.emissiveMap = e.emissiveMap),
              (this.emissiveIntensity = e.emissiveIntensity),
              (this.specularMap = e.specularMap),
              (this.alphaMap = e.alphaMap),
              (this.envMap = e.envMap),
              (this.combine = e.combine),
              (this.reflectivity = e.reflectivity),
              (this.refractionRatio = e.refractionRatio),
              (this.wireframe = e.wireframe),
              (this.wireframeLinewidth = e.wireframeLinewidth),
              (this.wireframeLinecap = e.wireframeLinecap),
              (this.wireframeLinejoin = e.wireframeLinejoin),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              this
            );
          }),
          (xd.prototype = Object.create(Co.prototype)),
          (xd.prototype.constructor = xd),
          (xd.prototype.isMeshMatcapMaterial = !0),
          (xd.prototype.copy = function(e) {
            return (
              Co.prototype.copy.call(this, e),
              (this.defines = { MATCAP: "" }),
              this.color.copy(e.color),
              (this.matcap = e.matcap),
              (this.map = e.map),
              (this.bumpMap = e.bumpMap),
              (this.bumpScale = e.bumpScale),
              (this.normalMap = e.normalMap),
              (this.normalMapType = e.normalMapType),
              this.normalScale.copy(e.normalScale),
              (this.displacementMap = e.displacementMap),
              (this.displacementScale = e.displacementScale),
              (this.displacementBias = e.displacementBias),
              (this.alphaMap = e.alphaMap),
              (this.skinning = e.skinning),
              (this.morphTargets = e.morphTargets),
              (this.morphNormals = e.morphNormals),
              this
            );
          }),
          (wd.prototype = Object.create(Du.prototype)),
          (wd.prototype.constructor = wd),
          (wd.prototype.isLineDashedMaterial = !0),
          (wd.prototype.copy = function(e) {
            return (
              Du.prototype.copy.call(this, e),
              (this.scale = e.scale),
              (this.dashSize = e.dashSize),
              (this.gapSize = e.gapSize),
              this
            );
          });
        var _d = Object.freeze({
            __proto__: null,
            ShadowMaterial: dd,
            SpriteMaterial: ru,
            RawShaderMaterial: pd,
            ShaderMaterial: Cs,
            PointsMaterial: Vu,
            MeshPhysicalMaterial: md,
            MeshStandardMaterial: fd,
            MeshPhongMaterial: vd,
            MeshToonMaterial: gd,
            MeshNormalMaterial: yd,
            MeshLambertMaterial: bd,
            MeshDepthMaterial: Lc,
            MeshDistanceMaterial: Nc,
            MeshBasicMaterial: Lo,
            MeshMatcapMaterial: xd,
            LineDashedMaterial: wd,
            LineBasicMaterial: Du,
            Material: Co
          }),
          Md = {
            arraySlice: function(e, t, n) {
              return Md.isTypedArray(e)
                ? new e.constructor(e.subarray(t, void 0 !== n ? n : e.length))
                : e.slice(t, n);
            },
            convertArray: function(e, t, n) {
              return !e || (!n && e.constructor === t)
                ? e
                : "number" == typeof t.BYTES_PER_ELEMENT
                ? new t(e)
                : Array.prototype.slice.call(e);
            },
            isTypedArray: function(e) {
              return ArrayBuffer.isView(e) && !(e instanceof DataView);
            },
            getKeyframeOrder: function(e) {
              for (var t = e.length, n = new Array(t), r = 0; r !== t; ++r)
                n[r] = r;
              return (
                n.sort(function(t, n) {
                  return e[t] - e[n];
                }),
                n
              );
            },
            sortedArray: function(e, t, n) {
              for (
                var r = e.length, i = new e.constructor(r), a = 0, o = 0;
                o !== r;
                ++a
              )
                for (var s = n[a] * t, l = 0; l !== t; ++l) i[o++] = e[s + l];
              return i;
            },
            flattenJSON: function(e, t, n, r) {
              for (var i = 1, a = e[0]; void 0 !== a && void 0 === a[r]; )
                a = e[i++];
              if (void 0 !== a) {
                var o = a[r];
                if (void 0 !== o)
                  if (Array.isArray(o))
                    do {
                      void 0 !== (o = a[r]) &&
                        (t.push(a.time), n.push.apply(n, o)),
                        (a = e[i++]);
                    } while (void 0 !== a);
                  else if (void 0 !== o.toArray)
                    do {
                      void 0 !== (o = a[r]) &&
                        (t.push(a.time), o.toArray(n, n.length)),
                        (a = e[i++]);
                    } while (void 0 !== a);
                  else
                    do {
                      void 0 !== (o = a[r]) && (t.push(a.time), n.push(o)),
                        (a = e[i++]);
                    } while (void 0 !== a);
              }
            },
            subclip: function(e, t, n, r, i) {
              i = i || 30;
              var a = e.clone();
              a.name = t;
              for (var o = [], s = 0; s < a.tracks.length; ++s) {
                for (
                  var l = a.tracks[s],
                    c = l.getValueSize(),
                    u = [],
                    h = [],
                    d = 0;
                  d < l.times.length;
                  ++d
                ) {
                  var p = l.times[d] * i;
                  if (!(p < n || p >= r)) {
                    u.push(l.times[d]);
                    for (var f = 0; f < c; ++f) h.push(l.values[d * c + f]);
                  }
                }
                0 !== u.length &&
                  ((l.times = Md.convertArray(u, l.times.constructor)),
                  (l.values = Md.convertArray(h, l.values.constructor)),
                  o.push(l));
              }
              a.tracks = o;
              var m = 1 / 0;
              for (s = 0; s < a.tracks.length; ++s)
                m > a.tracks[s].times[0] && (m = a.tracks[s].times[0]);
              for (s = 0; s < a.tracks.length; ++s) a.tracks[s].shift(-1 * m);
              return a.resetDuration(), a;
            }
          };
        function Td(e, t, n, r) {
          (this.parameterPositions = e),
            (this._cachedIndex = 0),
            (this.resultBuffer = void 0 !== r ? r : new t.constructor(n)),
            (this.sampleValues = t),
            (this.valueSize = n);
        }
        function Ad(e, t, n, r) {
          Td.call(this, e, t, n, r),
            (this._weightPrev = -0),
            (this._offsetPrev = -0),
            (this._weightNext = -0),
            (this._offsetNext = -0);
        }
        function Sd(e, t, n, r) {
          Td.call(this, e, t, n, r);
        }
        function Ed(e, t, n, r) {
          Td.call(this, e, t, n, r);
        }
        function Rd(e, t, n, r) {
          if (void 0 === e)
            throw new Error("THREE.KeyframeTrack: track name is undefined");
          if (void 0 === t || 0 === t.length)
            throw new Error(
              "THREE.KeyframeTrack: no keyframes in track named " + e
            );
          (this.name = e),
            (this.times = Md.convertArray(t, this.TimeBufferType)),
            (this.values = Md.convertArray(n, this.ValueBufferType)),
            this.setInterpolation(r || this.DefaultInterpolation);
        }
        function Pd(e, t, n) {
          Rd.call(this, e, t, n);
        }
        function Id(e, t, n, r) {
          Rd.call(this, e, t, n, r);
        }
        function Dd(e, t, n, r) {
          Rd.call(this, e, t, n, r);
        }
        function Od(e, t, n, r) {
          Td.call(this, e, t, n, r);
        }
        function Cd(e, t, n, r) {
          Rd.call(this, e, t, n, r);
        }
        function Ld(e, t, n, r) {
          Rd.call(this, e, t, n, r);
        }
        function Nd(e, t, n, r) {
          Rd.call(this, e, t, n, r);
        }
        function Fd(e, t, n) {
          (this.name = e),
            (this.tracks = n),
            (this.duration = void 0 !== t ? t : -1),
            (this.uuid = Qi.generateUUID()),
            this.duration < 0 && this.resetDuration();
        }
        function kd(e) {
          if (void 0 === e.type)
            throw new Error(
              "THREE.KeyframeTrack: track type undefined, can not parse"
            );
          var t = (function(e) {
            switch (e.toLowerCase()) {
              case "scalar":
              case "double":
              case "float":
              case "number":
              case "integer":
                return Dd;
              case "vector":
              case "vector2":
              case "vector3":
              case "vector4":
                return Nd;
              case "color":
                return Id;
              case "quaternion":
                return Cd;
              case "bool":
              case "boolean":
                return Pd;
              case "string":
                return Ld;
            }
            throw new Error("THREE.KeyframeTrack: Unsupported typeName: " + e);
          })(e.type);
          if (void 0 === e.times) {
            var n = [],
              r = [];
            Md.flattenJSON(e.keys, n, r, "value"),
              (e.times = n),
              (e.values = r);
          }
          return void 0 !== t.parse
            ? t.parse(e)
            : new t(e.name, e.times, e.values, e.interpolation);
        }
        Object.assign(Td.prototype, {
          evaluate: function(e) {
            var t = this.parameterPositions,
              n = this._cachedIndex,
              r = t[n],
              i = t[n - 1];
            e: {
              t: {
                var a;
                n: {
                  r: if (!(e < r)) {
                    for (var o = n + 2; ; ) {
                      if (void 0 === r) {
                        if (e < i) break r;
                        return (
                          (n = t.length),
                          (this._cachedIndex = n),
                          this.afterEnd_(n - 1, e, i)
                        );
                      }
                      if (n === o) break;
                      if (((i = r), e < (r = t[++n]))) break t;
                    }
                    a = t.length;
                    break n;
                  }
                  if (e >= i) break e;
                  var s = t[1];
                  for (e < s && ((n = 2), (i = s)), o = n - 2; ; ) {
                    if (void 0 === i)
                      return (
                        (this._cachedIndex = 0), this.beforeStart_(0, e, r)
                      );
                    if (n === o) break;
                    if (((r = i), e >= (i = t[--n - 1]))) break t;
                  }
                  (a = n), (n = 0);
                }
                for (; n < a; ) {
                  var l = (n + a) >>> 1;
                  e < t[l] ? (a = l) : (n = l + 1);
                }
                if (((r = t[n]), void 0 === (i = t[n - 1])))
                  return (this._cachedIndex = 0), this.beforeStart_(0, e, r);
                if (void 0 === r)
                  return (
                    (n = t.length),
                    (this._cachedIndex = n),
                    this.afterEnd_(n - 1, i, e)
                  );
              }
              (this._cachedIndex = n), this.intervalChanged_(n, i, r);
            }
            return this.interpolate_(n, i, e, r);
          },
          settings: null,
          DefaultSettings_: {},
          getSettings_: function() {
            return this.settings || this.DefaultSettings_;
          },
          copySampleValue_: function(e) {
            for (
              var t = this.resultBuffer,
                n = this.sampleValues,
                r = this.valueSize,
                i = e * r,
                a = 0;
              a !== r;
              ++a
            )
              t[a] = n[i + a];
            return t;
          },
          interpolate_: function() {
            throw new Error("call to abstract method");
          },
          intervalChanged_: function() {}
        }),
          Object.assign(Td.prototype, {
            beforeStart_: Td.prototype.copySampleValue_,
            afterEnd_: Td.prototype.copySampleValue_
          }),
          (Ad.prototype = Object.assign(Object.create(Td.prototype), {
            constructor: Ad,
            DefaultSettings_: { endingStart: ri, endingEnd: ri },
            intervalChanged_: function(e, t, n) {
              var r = this.parameterPositions,
                i = e - 2,
                a = e + 1,
                o = r[i],
                s = r[a];
              if (void 0 === o)
                switch (this.getSettings_().endingStart) {
                  case ii:
                    (i = e), (o = 2 * t - n);
                    break;
                  case ai:
                    o = t + r[(i = r.length - 2)] - r[i + 1];
                    break;
                  default:
                    (i = e), (o = n);
                }
              if (void 0 === s)
                switch (this.getSettings_().endingEnd) {
                  case ii:
                    (a = e), (s = 2 * n - t);
                    break;
                  case ai:
                    (a = 1), (s = n + r[1] - r[0]);
                    break;
                  default:
                    (a = e - 1), (s = t);
                }
              var l = 0.5 * (n - t),
                c = this.valueSize;
              (this._weightPrev = l / (t - o)),
                (this._weightNext = l / (s - n)),
                (this._offsetPrev = i * c),
                (this._offsetNext = a * c);
            },
            interpolate_: function(e, t, n, r) {
              for (
                var i = this.resultBuffer,
                  a = this.sampleValues,
                  o = this.valueSize,
                  s = e * o,
                  l = s - o,
                  c = this._offsetPrev,
                  u = this._offsetNext,
                  h = this._weightPrev,
                  d = this._weightNext,
                  p = (n - t) / (r - t),
                  f = p * p,
                  m = f * p,
                  v = -h * m + 2 * h * f - h * p,
                  g = (1 + h) * m + (-1.5 - 2 * h) * f + (-0.5 + h) * p + 1,
                  y = (-1 - d) * m + (1.5 + d) * f + 0.5 * p,
                  b = d * m - d * f,
                  x = 0;
                x !== o;
                ++x
              )
                i[x] =
                  v * a[c + x] + g * a[l + x] + y * a[s + x] + b * a[u + x];
              return i;
            }
          })),
          (Sd.prototype = Object.assign(Object.create(Td.prototype), {
            constructor: Sd,
            interpolate_: function(e, t, n, r) {
              for (
                var i = this.resultBuffer,
                  a = this.sampleValues,
                  o = this.valueSize,
                  s = e * o,
                  l = s - o,
                  c = (n - t) / (r - t),
                  u = 1 - c,
                  h = 0;
                h !== o;
                ++h
              )
                i[h] = a[l + h] * u + a[s + h] * c;
              return i;
            }
          })),
          (Ed.prototype = Object.assign(Object.create(Td.prototype), {
            constructor: Ed,
            interpolate_: function(e) {
              return this.copySampleValue_(e - 1);
            }
          })),
          Object.assign(Rd, {
            toJSON: function(e) {
              var t,
                n = e.constructor;
              if (void 0 !== n.toJSON) t = n.toJSON(e);
              else {
                t = {
                  name: e.name,
                  times: Md.convertArray(e.times, Array),
                  values: Md.convertArray(e.values, Array)
                };
                var r = e.getInterpolation();
                r !== e.DefaultInterpolation && (t.interpolation = r);
              }
              return (t.type = e.ValueTypeName), t;
            }
          }),
          Object.assign(Rd.prototype, {
            constructor: Rd,
            TimeBufferType: Float32Array,
            ValueBufferType: Float32Array,
            DefaultInterpolation: ti,
            InterpolantFactoryMethodDiscrete: function(e) {
              return new Ed(this.times, this.values, this.getValueSize(), e);
            },
            InterpolantFactoryMethodLinear: function(e) {
              return new Sd(this.times, this.values, this.getValueSize(), e);
            },
            InterpolantFactoryMethodSmooth: function(e) {
              return new Ad(this.times, this.values, this.getValueSize(), e);
            },
            setInterpolation: function(e) {
              var t;
              switch (e) {
                case ei:
                  t = this.InterpolantFactoryMethodDiscrete;
                  break;
                case ti:
                  t = this.InterpolantFactoryMethodLinear;
                  break;
                case ni:
                  t = this.InterpolantFactoryMethodSmooth;
              }
              if (void 0 === t) {
                var n =
                  "unsupported interpolation for " +
                  this.ValueTypeName +
                  " keyframe track named " +
                  this.name;
                if (void 0 === this.createInterpolant) {
                  if (e === this.DefaultInterpolation) throw new Error(n);
                  this.setInterpolation(this.DefaultInterpolation);
                }
                return this;
              }
              return (this.createInterpolant = t), this;
            },
            getInterpolation: function() {
              switch (this.createInterpolant) {
                case this.InterpolantFactoryMethodDiscrete:
                  return ei;
                case this.InterpolantFactoryMethodLinear:
                  return ti;
                case this.InterpolantFactoryMethodSmooth:
                  return ni;
              }
            },
            getValueSize: function() {
              return this.values.length / this.times.length;
            },
            shift: function(e) {
              if (0 !== e)
                for (var t = this.times, n = 0, r = t.length; n !== r; ++n)
                  t[n] += e;
              return this;
            },
            scale: function(e) {
              if (1 !== e)
                for (var t = this.times, n = 0, r = t.length; n !== r; ++n)
                  t[n] *= e;
              return this;
            },
            trim: function(e, t) {
              for (
                var n = this.times, r = n.length, i = 0, a = r - 1;
                i !== r && n[i] < e;

              )
                ++i;
              for (; -1 !== a && n[a] > t; ) --a;
              if ((++a, 0 !== i || a !== r)) {
                i >= a && (i = (a = Math.max(a, 1)) - 1);
                var o = this.getValueSize();
                (this.times = Md.arraySlice(n, i, a)),
                  (this.values = Md.arraySlice(this.values, i * o, a * o));
              }
              return this;
            },
            validate: function() {
              var e = !0,
                t = this.getValueSize();
              t - Math.floor(t) != 0 && (e = !1);
              var n = this.times,
                r = this.values,
                i = n.length;
              0 === i && (e = !1);
              for (var a = null, o = 0; o !== i; o++) {
                var s = n[o];
                if ("number" == typeof s && isNaN(s)) {
                  e = !1;
                  break;
                }
                if (null !== a && a > s) {
                  e = !1;
                  break;
                }
                a = s;
              }
              if (void 0 !== r && Md.isTypedArray(r)) {
                o = 0;
                for (var l = r.length; o !== l; ++o) {
                  var c = r[o];
                  if (isNaN(c)) {
                    e = !1;
                    break;
                  }
                }
              }
              return e;
            },
            optimize: function() {
              for (
                var e = this.times,
                  t = this.values,
                  n = this.getValueSize(),
                  r = this.getInterpolation() === ni,
                  i = 1,
                  a = e.length - 1,
                  o = 1;
                o < a;
                ++o
              ) {
                var s = !1,
                  l = e[o];
                if (l !== e[o + 1] && (1 !== o || l !== l[0]))
                  if (r) s = !0;
                  else
                    for (
                      var c = o * n, u = c - n, h = c + n, d = 0;
                      d !== n;
                      ++d
                    ) {
                      var p = t[c + d];
                      if (p !== t[u + d] || p !== t[h + d]) {
                        s = !0;
                        break;
                      }
                    }
                if (s) {
                  if (o !== i) {
                    e[i] = e[o];
                    var f = o * n,
                      m = i * n;
                    for (d = 0; d !== n; ++d) t[m + d] = t[f + d];
                  }
                  ++i;
                }
              }
              if (a > 0) {
                for (e[i] = e[a], f = a * n, m = i * n, d = 0; d !== n; ++d)
                  t[m + d] = t[f + d];
                ++i;
              }
              return (
                i !== e.length &&
                  ((this.times = Md.arraySlice(e, 0, i)),
                  (this.values = Md.arraySlice(t, 0, i * n))),
                this
              );
            },
            clone: function() {
              var e = Md.arraySlice(this.times, 0),
                t = Md.arraySlice(this.values, 0),
                n = new (0, this.constructor)(this.name, e, t);
              return (n.createInterpolant = this.createInterpolant), n;
            }
          }),
          (Pd.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Pd,
            ValueTypeName: "bool",
            ValueBufferType: Array,
            DefaultInterpolation: ei,
            InterpolantFactoryMethodLinear: void 0,
            InterpolantFactoryMethodSmooth: void 0
          })),
          (Id.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Id,
            ValueTypeName: "color"
          })),
          (Dd.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Dd,
            ValueTypeName: "number"
          })),
          (Od.prototype = Object.assign(Object.create(Td.prototype), {
            constructor: Od,
            interpolate_: function(e, t, n, r) {
              for (
                var i = this.resultBuffer,
                  a = this.sampleValues,
                  o = this.valueSize,
                  s = e * o,
                  l = (n - t) / (r - t),
                  c = s + o;
                s !== c;
                s += 4
              )
                Ji.slerpFlat(i, 0, a, s - o, a, s, l);
              return i;
            }
          })),
          (Cd.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Cd,
            ValueTypeName: "quaternion",
            DefaultInterpolation: ti,
            InterpolantFactoryMethodLinear: function(e) {
              return new Od(this.times, this.values, this.getValueSize(), e);
            },
            InterpolantFactoryMethodSmooth: void 0
          })),
          (Ld.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Ld,
            ValueTypeName: "string",
            ValueBufferType: Array,
            DefaultInterpolation: ei,
            InterpolantFactoryMethodLinear: void 0,
            InterpolantFactoryMethodSmooth: void 0
          })),
          (Nd.prototype = Object.assign(Object.create(Rd.prototype), {
            constructor: Nd,
            ValueTypeName: "vector"
          })),
          Object.assign(Fd, {
            parse: function(e) {
              for (
                var t = [],
                  n = e.tracks,
                  r = 1 / (e.fps || 1),
                  i = 0,
                  a = n.length;
                i !== a;
                ++i
              )
                t.push(kd(n[i]).scale(r));
              return new Fd(e.name, e.duration, t);
            },
            toJSON: function(e) {
              for (
                var t = [],
                  n = e.tracks,
                  r = {
                    name: e.name,
                    duration: e.duration,
                    tracks: t,
                    uuid: e.uuid
                  },
                  i = 0,
                  a = n.length;
                i !== a;
                ++i
              )
                t.push(Rd.toJSON(n[i]));
              return r;
            },
            CreateFromMorphTargetSequence: function(e, t, n, r) {
              for (var i = t.length, a = [], o = 0; o < i; o++) {
                var s = [],
                  l = [];
                s.push((o + i - 1) % i, o, (o + 1) % i), l.push(0, 1, 0);
                var c = Md.getKeyframeOrder(s);
                (s = Md.sortedArray(s, 1, c)),
                  (l = Md.sortedArray(l, 1, c)),
                  r || 0 !== s[0] || (s.push(i), l.push(l[0])),
                  a.push(
                    new Dd(
                      ".morphTargetInfluences[" + t[o].name + "]",
                      s,
                      l
                    ).scale(1 / n)
                  );
              }
              return new Fd(e, -1, a);
            },
            findByName: function(e, t) {
              var n = e;
              if (!Array.isArray(e)) {
                var r = e;
                n = (r.geometry && r.geometry.animations) || r.animations;
              }
              for (var i = 0; i < n.length; i++)
                if (n[i].name === t) return n[i];
              return null;
            },
            CreateClipsFromMorphTargetSequences: function(e, t, n) {
              for (
                var r = {}, i = /^([\w-]*?)([\d]+)$/, a = 0, o = e.length;
                a < o;
                a++
              ) {
                var s = e[a],
                  l = s.name.match(i);
                if (l && l.length > 1) {
                  var c = r[(h = l[1])];
                  c || (r[h] = c = []), c.push(s);
                }
              }
              var u = [];
              for (var h in r)
                u.push(Fd.CreateFromMorphTargetSequence(h, r[h], t, n));
              return u;
            },
            parseAnimation: function(e, t) {
              if (!e) return null;
              for (
                var n = function(e, t, n, r, i) {
                    if (0 !== n.length) {
                      var a = [],
                        o = [];
                      Md.flattenJSON(n, a, o, r),
                        0 !== a.length && i.push(new e(t, a, o));
                    }
                  },
                  r = [],
                  i = e.name || "default",
                  a = e.length || -1,
                  o = e.fps || 30,
                  s = e.hierarchy || [],
                  l = 0;
                l < s.length;
                l++
              ) {
                var c = s[l].keys;
                if (c && 0 !== c.length)
                  if (c[0].morphTargets) {
                    for (var u = {}, h = 0; h < c.length; h++)
                      if (c[h].morphTargets)
                        for (var d = 0; d < c[h].morphTargets.length; d++)
                          u[c[h].morphTargets[d]] = -1;
                    for (var p in u) {
                      var f = [],
                        m = [];
                      for (d = 0; d !== c[h].morphTargets.length; ++d) {
                        var v = c[h];
                        f.push(v.time), m.push(v.morphTarget === p ? 1 : 0);
                      }
                      r.push(new Dd(".morphTargetInfluence[" + p + "]", f, m));
                    }
                    a = u.length * (o || 1);
                  } else {
                    var g = ".bones[" + t[l].name + "]";
                    n(Nd, g + ".position", c, "pos", r),
                      n(Cd, g + ".quaternion", c, "rot", r),
                      n(Nd, g + ".scale", c, "scl", r);
                  }
              }
              return 0 === r.length ? null : new Fd(i, a, r);
            }
          }),
          Object.assign(Fd.prototype, {
            resetDuration: function() {
              for (var e = 0, t = 0, n = this.tracks.length; t !== n; ++t) {
                var r = this.tracks[t];
                e = Math.max(e, r.times[r.times.length - 1]);
              }
              return (this.duration = e), this;
            },
            trim: function() {
              for (var e = 0; e < this.tracks.length; e++)
                this.tracks[e].trim(0, this.duration);
              return this;
            },
            validate: function() {
              for (var e = !0, t = 0; t < this.tracks.length; t++)
                e = e && this.tracks[t].validate();
              return e;
            },
            optimize: function() {
              for (var e = 0; e < this.tracks.length; e++)
                this.tracks[e].optimize();
              return this;
            },
            clone: function() {
              for (var e = [], t = 0; t < this.tracks.length; t++)
                e.push(this.tracks[t].clone());
              return new Fd(this.name, this.duration, e);
            }
          });
        var Ud = {
          enabled: !1,
          files: {},
          add: function(e, t) {
            !1 !== this.enabled && (this.files[e] = t);
          },
          get: function(e) {
            if (!1 !== this.enabled) return this.files[e];
          },
          remove: function(e) {
            delete this.files[e];
          },
          clear: function() {
            this.files = {};
          }
        };
        function jd(e, t, n) {
          var r = this,
            i = !1,
            a = 0,
            o = 0,
            s = void 0,
            l = [];
          (this.onStart = void 0),
            (this.onLoad = e),
            (this.onProgress = t),
            (this.onError = n),
            (this.itemStart = function(e) {
              o++,
                !1 === i && void 0 !== r.onStart && r.onStart(e, a, o),
                (i = !0);
            }),
            (this.itemEnd = function(e) {
              a++,
                void 0 !== r.onProgress && r.onProgress(e, a, o),
                a === o && ((i = !1), void 0 !== r.onLoad && r.onLoad());
            }),
            (this.itemError = function(e) {
              void 0 !== r.onError && r.onError(e);
            }),
            (this.resolveURL = function(e) {
              return s ? s(e) : e;
            }),
            (this.setURLModifier = function(e) {
              return (s = e), this;
            }),
            (this.addHandler = function(e, t) {
              return l.push(e, t), this;
            }),
            (this.removeHandler = function(e) {
              var t = l.indexOf(e);
              return -1 !== t && l.splice(t, 2), this;
            }),
            (this.getHandler = function(e) {
              for (var t = 0, n = l.length; t < n; t += 2) {
                var r = l[t],
                  i = l[t + 1];
                if ((r.global && (r.lastIndex = 0), r.test(e))) return i;
              }
              return null;
            });
        }
        var Bd = new jd();
        function zd(e) {
          (this.manager = void 0 !== e ? e : Bd),
            (this.crossOrigin = "anonymous"),
            (this.path = ""),
            (this.resourcePath = "");
        }
        Object.assign(zd.prototype, {
          load: function() {},
          parse: function() {},
          setCrossOrigin: function(e) {
            return (this.crossOrigin = e), this;
          },
          setPath: function(e) {
            return (this.path = e), this;
          },
          setResourcePath: function(e) {
            return (this.resourcePath = e), this;
          }
        });
        var Vd = {};
        function Gd(e) {
          zd.call(this, e);
        }
        function Hd(e) {
          zd.call(this, e);
        }
        function Xd(e) {
          zd.call(this, e);
        }
        function Wd(e) {
          zd.call(this, e);
        }
        function Yd(e) {
          zd.call(this, e);
        }
        function qd(e) {
          zd.call(this, e);
        }
        function Qd(e) {
          zd.call(this, e);
        }
        function Zd() {
          (this.type = "Curve"), (this.arcLengthDivisions = 200);
        }
        function Jd(e, t, n, r, i, a, o, s) {
          Zd.call(this),
            (this.type = "EllipseCurve"),
            (this.aX = e || 0),
            (this.aY = t || 0),
            (this.xRadius = n || 1),
            (this.yRadius = r || 1),
            (this.aStartAngle = i || 0),
            (this.aEndAngle = a || 2 * Math.PI),
            (this.aClockwise = o || !1),
            (this.aRotation = s || 0);
        }
        function Kd(e, t, n, r, i, a) {
          Jd.call(this, e, t, n, n, r, i, a), (this.type = "ArcCurve");
        }
        function $d() {
          var e = 0,
            t = 0,
            n = 0,
            r = 0;
          function i(i, a, o, s) {
            (e = i),
              (t = o),
              (n = -3 * i + 3 * a - 2 * o - s),
              (r = 2 * i - 2 * a + o + s);
          }
          return {
            initCatmullRom: function(e, t, n, r, a) {
              i(t, n, a * (n - e), a * (r - t));
            },
            initNonuniformCatmullRom: function(e, t, n, r, a, o, s) {
              var l = (t - e) / a - (n - e) / (a + o) + (n - t) / o,
                c = (n - t) / o - (r - t) / (o + s) + (r - n) / s;
              i(t, n, (l *= o), (c *= o));
            },
            calc: function(i) {
              var a = i * i;
              return e + t * i + n * a + r * (a * i);
            }
          };
        }
        (Gd.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: Gd,
          load: function(e, t, n, r) {
            void 0 === e && (e = ""),
              void 0 !== this.path && (e = this.path + e),
              (e = this.manager.resolveURL(e));
            var i = this,
              a = Ud.get(e);
            if (void 0 !== a)
              return (
                i.manager.itemStart(e),
                setTimeout(function() {
                  t && t(a), i.manager.itemEnd(e);
                }, 0),
                a
              );
            if (void 0 === Vd[e]) {
              var o = e.match(/^data:(.*?)(;base64)?,(.*)$/);
              if (o) {
                var s = o[1],
                  l = !!o[2],
                  c = o[3];
                (c = decodeURIComponent(c)), l && (c = atob(c));
                try {
                  var u,
                    h = (this.responseType || "").toLowerCase();
                  switch (h) {
                    case "arraybuffer":
                    case "blob":
                      for (
                        var d = new Uint8Array(c.length), p = 0;
                        p < c.length;
                        p++
                      )
                        d[p] = c.charCodeAt(p);
                      u =
                        "blob" === h
                          ? new Blob([d.buffer], { type: s })
                          : d.buffer;
                      break;
                    case "document":
                      var f = new DOMParser();
                      u = f.parseFromString(c, s);
                      break;
                    case "json":
                      u = JSON.parse(c);
                      break;
                    default:
                      u = c;
                  }
                  setTimeout(function() {
                    t && t(u), i.manager.itemEnd(e);
                  }, 0);
                } catch (t) {
                  setTimeout(function() {
                    r && r(t), i.manager.itemError(e), i.manager.itemEnd(e);
                  }, 0);
                }
              } else {
                (Vd[e] = []),
                  Vd[e].push({ onLoad: t, onProgress: n, onError: r });
                var m = new XMLHttpRequest();
                for (var v in (m.open("GET", e, !0),
                m.addEventListener(
                  "load",
                  function(t) {
                    var n = this.response,
                      r = Vd[e];
                    if (
                      (delete Vd[e], 200 === this.status || 0 === this.status)
                    ) {
                      this.status, Ud.add(e, n);
                      for (var a = 0, o = r.length; a < o; a++)
                        (s = r[a]).onLoad && s.onLoad(n);
                      i.manager.itemEnd(e);
                    } else {
                      for (a = 0, o = r.length; a < o; a++) {
                        var s;
                        (s = r[a]).onError && s.onError(t);
                      }
                      i.manager.itemError(e), i.manager.itemEnd(e);
                    }
                  },
                  !1
                ),
                m.addEventListener(
                  "progress",
                  function(t) {
                    for (var n = Vd[e], r = 0, i = n.length; r < i; r++) {
                      var a = n[r];
                      a.onProgress && a.onProgress(t);
                    }
                  },
                  !1
                ),
                m.addEventListener(
                  "error",
                  function(t) {
                    var n = Vd[e];
                    delete Vd[e];
                    for (var r = 0, a = n.length; r < a; r++) {
                      var o = n[r];
                      o.onError && o.onError(t);
                    }
                    i.manager.itemError(e), i.manager.itemEnd(e);
                  },
                  !1
                ),
                m.addEventListener(
                  "abort",
                  function(t) {
                    var n = Vd[e];
                    delete Vd[e];
                    for (var r = 0, a = n.length; r < a; r++) {
                      var o = n[r];
                      o.onError && o.onError(t);
                    }
                    i.manager.itemError(e), i.manager.itemEnd(e);
                  },
                  !1
                ),
                void 0 !== this.responseType &&
                  (m.responseType = this.responseType),
                void 0 !== this.withCredentials &&
                  (m.withCredentials = this.withCredentials),
                m.overrideMimeType &&
                  m.overrideMimeType(
                    void 0 !== this.mimeType ? this.mimeType : "text/plain"
                  ),
                this.requestHeader))
                  m.setRequestHeader(v, this.requestHeader[v]);
                m.send(null);
              }
              return i.manager.itemStart(e), m;
            }
            Vd[e].push({ onLoad: t, onProgress: n, onError: r });
          },
          setResponseType: function(e) {
            return (this.responseType = e), this;
          },
          setWithCredentials: function(e) {
            return (this.withCredentials = e), this;
          },
          setMimeType: function(e) {
            return (this.mimeType = e), this;
          },
          setRequestHeader: function(e) {
            return (this.requestHeader = e), this;
          }
        })),
          (Hd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Hd,
            load: function(e, t, n, r) {
              var i = this,
                a = new Gd(i.manager);
              a.setPath(i.path),
                a.load(
                  e,
                  function(e) {
                    t(i.parse(JSON.parse(e)));
                  },
                  n,
                  r
                );
            },
            parse: function(e) {
              for (var t = [], n = 0; n < e.length; n++) {
                var r = Fd.parse(e[n]);
                t.push(r);
              }
              return t;
            }
          })),
          (Xd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Xd,
            load: function(e, t, n, r) {
              var i = this,
                a = [],
                o = new Zu();
              o.image = a;
              var s = new Gd(this.manager);
              function l(l) {
                s.load(
                  e[l],
                  function(e) {
                    var n = i.parse(e, !0);
                    (a[l] = {
                      width: n.width,
                      height: n.height,
                      format: n.format,
                      mipmaps: n.mipmaps
                    }),
                      6 === (c += 1) &&
                        (1 === n.mipmapCount && (o.minFilter = nr),
                        (o.format = n.format),
                        (o.needsUpdate = !0),
                        t && t(o));
                  },
                  n,
                  r
                );
              }
              if (
                (s.setPath(this.path),
                s.setResponseType("arraybuffer"),
                Array.isArray(e))
              )
                for (var c = 0, u = 0, h = e.length; u < h; ++u) l(u);
              else
                s.load(
                  e,
                  function(e) {
                    var n = i.parse(e, !0);
                    if (n.isCubemap)
                      for (
                        var r = n.mipmaps.length / n.mipmapCount, s = 0;
                        s < r;
                        s++
                      ) {
                        a[s] = { mipmaps: [] };
                        for (var l = 0; l < n.mipmapCount; l++)
                          a[s].mipmaps.push(n.mipmaps[s * n.mipmapCount + l]),
                            (a[s].format = n.format),
                            (a[s].width = n.width),
                            (a[s].height = n.height);
                      }
                    else
                      (o.image.width = n.width),
                        (o.image.height = n.height),
                        (o.mipmaps = n.mipmaps);
                    1 === n.mipmapCount && (o.minFilter = nr),
                      (o.format = n.format),
                      (o.needsUpdate = !0),
                      t && t(o);
                  },
                  n,
                  r
                );
              return o;
            }
          })),
          (Wd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Wd,
            load: function(e, t, n, r) {
              var i = this,
                a = new Bs(),
                o = new Gd(this.manager);
              return (
                o.setResponseType("arraybuffer"),
                o.setPath(this.path),
                o.load(
                  e,
                  function(e) {
                    var n = i.parse(e);
                    n &&
                      (void 0 !== n.image
                        ? (a.image = n.image)
                        : void 0 !== n.data &&
                          ((a.image.width = n.width),
                          (a.image.height = n.height),
                          (a.image.data = n.data)),
                      (a.wrapS = void 0 !== n.wrapS ? n.wrapS : Qn),
                      (a.wrapT = void 0 !== n.wrapT ? n.wrapT : Qn),
                      (a.magFilter = void 0 !== n.magFilter ? n.magFilter : nr),
                      (a.minFilter = void 0 !== n.minFilter ? n.minFilter : nr),
                      (a.anisotropy =
                        void 0 !== n.anisotropy ? n.anisotropy : 1),
                      void 0 !== n.format && (a.format = n.format),
                      void 0 !== n.type && (a.type = n.type),
                      void 0 !== n.mipmaps &&
                        ((a.mipmaps = n.mipmaps), (a.minFilter = ar)),
                      1 === n.mipmapCount && (a.minFilter = nr),
                      (a.needsUpdate = !0),
                      t && t(a, n));
                  },
                  n,
                  r
                ),
                a
              );
            }
          })),
          (Yd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Yd,
            load: function(e, t, n, r) {
              void 0 !== this.path && (e = this.path + e),
                (e = this.manager.resolveURL(e));
              var i = this,
                a = Ud.get(e);
              if (void 0 !== a)
                return (
                  i.manager.itemStart(e),
                  setTimeout(function() {
                    t && t(a), i.manager.itemEnd(e);
                  }, 0),
                  a
                );
              var o = document.createElementNS(
                "http://www.w3.org/1999/xhtml",
                "img"
              );
              function s() {
                o.removeEventListener("load", s, !1),
                  o.removeEventListener("error", l, !1),
                  Ud.add(e, this),
                  t && t(this),
                  i.manager.itemEnd(e);
              }
              function l(t) {
                o.removeEventListener("load", s, !1),
                  o.removeEventListener("error", l, !1),
                  r && r(t),
                  i.manager.itemError(e),
                  i.manager.itemEnd(e);
              }
              return (
                o.addEventListener("load", s, !1),
                o.addEventListener("error", l, !1),
                "data:" !== e.substr(0, 5) &&
                  void 0 !== this.crossOrigin &&
                  (o.crossOrigin = this.crossOrigin),
                i.manager.itemStart(e),
                (o.src = e),
                o
              );
            }
          })),
          (qd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: qd,
            load: function(e, t, n, r) {
              var i = new ll(),
                a = new Yd(this.manager);
              a.setCrossOrigin(this.crossOrigin), a.setPath(this.path);
              var o = 0;
              function s(n) {
                a.load(
                  e[n],
                  function(e) {
                    (i.images[n] = e),
                      6 == ++o && ((i.needsUpdate = !0), t && t(i));
                  },
                  void 0,
                  r
                );
              }
              for (var l = 0; l < e.length; ++l) s(l);
              return i;
            }
          })),
          (Qd.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Qd,
            load: function(e, t, n, r) {
              var i = new oa(),
                a = new Yd(this.manager);
              return (
                a.setCrossOrigin(this.crossOrigin),
                a.setPath(this.path),
                a.load(
                  e,
                  function(n) {
                    i.image = n;
                    var r =
                      e.search(/\.jpe?g($|\?)/i) > 0 ||
                      0 === e.search(/^data\:image\/jpeg/);
                    (i.format = r ? xr : wr),
                      (i.needsUpdate = !0),
                      void 0 !== t && t(i);
                  },
                  n,
                  r
                ),
                i
              );
            }
          })),
          Object.assign(Zd.prototype, {
            getPoint: function() {
              return null;
            },
            getPointAt: function(e, t) {
              var n = this.getUtoTmapping(e);
              return this.getPoint(n, t);
            },
            getPoints: function(e) {
              void 0 === e && (e = 5);
              for (var t = [], n = 0; n <= e; n++) t.push(this.getPoint(n / e));
              return t;
            },
            getSpacedPoints: function(e) {
              void 0 === e && (e = 5);
              for (var t = [], n = 0; n <= e; n++)
                t.push(this.getPointAt(n / e));
              return t;
            },
            getLength: function() {
              var e = this.getLengths();
              return e[e.length - 1];
            },
            getLengths: function(e) {
              if (
                (void 0 === e && (e = this.arcLengthDivisions),
                this.cacheArcLengths &&
                  this.cacheArcLengths.length === e + 1 &&
                  !this.needsUpdate)
              )
                return this.cacheArcLengths;
              this.needsUpdate = !1;
              var t,
                n,
                r = [],
                i = this.getPoint(0),
                a = 0;
              for (r.push(0), n = 1; n <= e; n++)
                (a += (t = this.getPoint(n / e)).distanceTo(i)),
                  r.push(a),
                  (i = t);
              return (this.cacheArcLengths = r), r;
            },
            updateArcLengths: function() {
              (this.needsUpdate = !0), this.getLengths();
            },
            getUtoTmapping: function(e, t) {
              var n,
                r = this.getLengths(),
                i = 0,
                a = r.length;
              n = t || e * r[a - 1];
              for (var o, s = 0, l = a - 1; s <= l; )
                if ((o = r[(i = Math.floor(s + (l - s) / 2))] - n) < 0)
                  s = i + 1;
                else {
                  if (!(o > 0)) {
                    l = i;
                    break;
                  }
                  l = i - 1;
                }
              if (r[(i = l)] === n) return i / (a - 1);
              var c = r[i];
              return (i + (n - c) / (r[i + 1] - c)) / (a - 1);
            },
            getTangent: function(e) {
              var t = e - 1e-4,
                n = e + 1e-4;
              t < 0 && (t = 0), n > 1 && (n = 1);
              var r = this.getPoint(t);
              return this.getPoint(n)
                .clone()
                .sub(r)
                .normalize();
            },
            getTangentAt: function(e) {
              var t = this.getUtoTmapping(e);
              return this.getTangent(t);
            },
            computeFrenetFrames: function(e, t) {
              var n,
                r,
                i,
                a = new ea(),
                o = [],
                s = [],
                l = [],
                c = new ea(),
                u = new ga();
              for (n = 0; n <= e; n++)
                (r = n / e), (o[n] = this.getTangentAt(r)), o[n].normalize();
              (s[0] = new ea()), (l[0] = new ea());
              var h = Number.MAX_VALUE,
                d = Math.abs(o[0].x),
                p = Math.abs(o[0].y),
                f = Math.abs(o[0].z);
              for (
                d <= h && ((h = d), a.set(1, 0, 0)),
                  p <= h && ((h = p), a.set(0, 1, 0)),
                  f <= h && a.set(0, 0, 1),
                  c.crossVectors(o[0], a).normalize(),
                  s[0].crossVectors(o[0], c),
                  l[0].crossVectors(o[0], s[0]),
                  n = 1;
                n <= e;
                n++
              )
                (s[n] = s[n - 1].clone()),
                  (l[n] = l[n - 1].clone()),
                  c.crossVectors(o[n - 1], o[n]),
                  c.length() > Number.EPSILON &&
                    (c.normalize(),
                    (i = Math.acos(Qi.clamp(o[n - 1].dot(o[n]), -1, 1))),
                    s[n].applyMatrix4(u.makeRotationAxis(c, i))),
                  l[n].crossVectors(o[n], s[n]);
              if (!0 === t)
                for (
                  i = Math.acos(Qi.clamp(s[0].dot(s[e]), -1, 1)),
                    i /= e,
                    o[0].dot(c.crossVectors(s[0], s[e])) > 0 && (i = -i),
                    n = 1;
                  n <= e;
                  n++
                )
                  s[n].applyMatrix4(u.makeRotationAxis(o[n], i * n)),
                    l[n].crossVectors(o[n], s[n]);
              return { tangents: o, normals: s, binormals: l };
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return (this.arcLengthDivisions = e.arcLengthDivisions), this;
            },
            toJSON: function() {
              var e = {
                metadata: {
                  version: 4.5,
                  type: "Curve",
                  generator: "Curve.toJSON"
                }
              };
              return (
                (e.arcLengthDivisions = this.arcLengthDivisions),
                (e.type = this.type),
                e
              );
            },
            fromJSON: function(e) {
              return (this.arcLengthDivisions = e.arcLengthDivisions), this;
            }
          }),
          (Jd.prototype = Object.create(Zd.prototype)),
          (Jd.prototype.constructor = Jd),
          (Jd.prototype.isEllipseCurve = !0),
          (Jd.prototype.getPoint = function(e, t) {
            for (
              var n = t || new Zi(),
                r = 2 * Math.PI,
                i = this.aEndAngle - this.aStartAngle,
                a = Math.abs(i) < Number.EPSILON;
              i < 0;

            )
              i += r;
            for (; i > r; ) i -= r;
            i < Number.EPSILON && (i = a ? 0 : r),
              !0 !== this.aClockwise || a || (i === r ? (i = -r) : (i -= r));
            var o = this.aStartAngle + e * i,
              s = this.aX + this.xRadius * Math.cos(o),
              l = this.aY + this.yRadius * Math.sin(o);
            if (0 !== this.aRotation) {
              var c = Math.cos(this.aRotation),
                u = Math.sin(this.aRotation),
                h = s - this.aX,
                d = l - this.aY;
              (s = h * c - d * u + this.aX), (l = h * u + d * c + this.aY);
            }
            return n.set(s, l);
          }),
          (Jd.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              (this.aX = e.aX),
              (this.aY = e.aY),
              (this.xRadius = e.xRadius),
              (this.yRadius = e.yRadius),
              (this.aStartAngle = e.aStartAngle),
              (this.aEndAngle = e.aEndAngle),
              (this.aClockwise = e.aClockwise),
              (this.aRotation = e.aRotation),
              this
            );
          }),
          (Jd.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (
              (e.aX = this.aX),
              (e.aY = this.aY),
              (e.xRadius = this.xRadius),
              (e.yRadius = this.yRadius),
              (e.aStartAngle = this.aStartAngle),
              (e.aEndAngle = this.aEndAngle),
              (e.aClockwise = this.aClockwise),
              (e.aRotation = this.aRotation),
              e
            );
          }),
          (Jd.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              (this.aX = e.aX),
              (this.aY = e.aY),
              (this.xRadius = e.xRadius),
              (this.yRadius = e.yRadius),
              (this.aStartAngle = e.aStartAngle),
              (this.aEndAngle = e.aEndAngle),
              (this.aClockwise = e.aClockwise),
              (this.aRotation = e.aRotation),
              this
            );
          }),
          (Kd.prototype = Object.create(Jd.prototype)),
          (Kd.prototype.constructor = Kd),
          (Kd.prototype.isArcCurve = !0);
        var ep = new ea(),
          tp = new $d(),
          np = new $d(),
          rp = new $d();
        function ip(e, t, n, r) {
          Zd.call(this),
            (this.type = "CatmullRomCurve3"),
            (this.points = e || []),
            (this.closed = t || !1),
            (this.curveType = n || "centripetal"),
            (this.tension = r || 0.5);
        }
        function ap(e, t, n, r, i) {
          var a = 0.5 * (r - t),
            o = 0.5 * (i - n),
            s = e * e;
          return (
            (2 * n - 2 * r + a + o) * (e * s) +
            (-3 * n + 3 * r - 2 * a - o) * s +
            a * e +
            n
          );
        }
        function op(e, t, n, r) {
          return (
            (function(e, t) {
              var n = 1 - e;
              return n * n * t;
            })(e, t) +
            (function(e, t) {
              return 2 * (1 - e) * e * t;
            })(e, n) +
            (function(e, t) {
              return e * e * t;
            })(e, r)
          );
        }
        function sp(e, t, n, r, i) {
          return (
            (function(e, t) {
              var n = 1 - e;
              return n * n * n * t;
            })(e, t) +
            (function(e, t) {
              var n = 1 - e;
              return 3 * n * n * e * t;
            })(e, n) +
            (function(e, t) {
              return 3 * (1 - e) * e * e * t;
            })(e, r) +
            (function(e, t) {
              return e * e * e * t;
            })(e, i)
          );
        }
        function lp(e, t, n, r) {
          Zd.call(this),
            (this.type = "CubicBezierCurve"),
            (this.v0 = e || new Zi()),
            (this.v1 = t || new Zi()),
            (this.v2 = n || new Zi()),
            (this.v3 = r || new Zi());
        }
        function cp(e, t, n, r) {
          Zd.call(this),
            (this.type = "CubicBezierCurve3"),
            (this.v0 = e || new ea()),
            (this.v1 = t || new ea()),
            (this.v2 = n || new ea()),
            (this.v3 = r || new ea());
        }
        function up(e, t) {
          Zd.call(this),
            (this.type = "LineCurve"),
            (this.v1 = e || new Zi()),
            (this.v2 = t || new Zi());
        }
        function hp(e, t) {
          Zd.call(this),
            (this.type = "LineCurve3"),
            (this.v1 = e || new ea()),
            (this.v2 = t || new ea());
        }
        function dp(e, t, n) {
          Zd.call(this),
            (this.type = "QuadraticBezierCurve"),
            (this.v0 = e || new Zi()),
            (this.v1 = t || new Zi()),
            (this.v2 = n || new Zi());
        }
        function pp(e, t, n) {
          Zd.call(this),
            (this.type = "QuadraticBezierCurve3"),
            (this.v0 = e || new ea()),
            (this.v1 = t || new ea()),
            (this.v2 = n || new ea());
        }
        function fp(e) {
          Zd.call(this), (this.type = "SplineCurve"), (this.points = e || []);
        }
        (ip.prototype = Object.create(Zd.prototype)),
          (ip.prototype.constructor = ip),
          (ip.prototype.isCatmullRomCurve3 = !0),
          (ip.prototype.getPoint = function(e, t) {
            var n,
              r,
              i,
              a,
              o = t || new ea(),
              s = this.points,
              l = s.length,
              c = (l - (this.closed ? 0 : 1)) * e,
              u = Math.floor(c),
              h = c - u;
            if (
              (this.closed
                ? (u += u > 0 ? 0 : (Math.floor(Math.abs(u) / l) + 1) * l)
                : 0 === h && u === l - 1 && ((u = l - 2), (h = 1)),
              this.closed || u > 0
                ? (n = s[(u - 1) % l])
                : (ep.subVectors(s[0], s[1]).add(s[0]), (n = ep)),
              (r = s[u % l]),
              (i = s[(u + 1) % l]),
              this.closed || u + 2 < l
                ? (a = s[(u + 2) % l])
                : (ep.subVectors(s[l - 1], s[l - 2]).add(s[l - 1]), (a = ep)),
              "centripetal" === this.curveType || "chordal" === this.curveType)
            ) {
              var d = "chordal" === this.curveType ? 0.5 : 0.25,
                p = Math.pow(n.distanceToSquared(r), d),
                f = Math.pow(r.distanceToSquared(i), d),
                m = Math.pow(i.distanceToSquared(a), d);
              f < 1e-4 && (f = 1),
                p < 1e-4 && (p = f),
                m < 1e-4 && (m = f),
                tp.initNonuniformCatmullRom(n.x, r.x, i.x, a.x, p, f, m),
                np.initNonuniformCatmullRom(n.y, r.y, i.y, a.y, p, f, m),
                rp.initNonuniformCatmullRom(n.z, r.z, i.z, a.z, p, f, m);
            } else
              "catmullrom" === this.curveType &&
                (tp.initCatmullRom(n.x, r.x, i.x, a.x, this.tension),
                np.initCatmullRom(n.y, r.y, i.y, a.y, this.tension),
                rp.initCatmullRom(n.z, r.z, i.z, a.z, this.tension));
            return o.set(tp.calc(h), np.calc(h), rp.calc(h)), o;
          }),
          (ip.prototype.copy = function(e) {
            Zd.prototype.copy.call(this, e), (this.points = []);
            for (var t = 0, n = e.points.length; t < n; t++) {
              var r = e.points[t];
              this.points.push(r.clone());
            }
            return (
              (this.closed = e.closed),
              (this.curveType = e.curveType),
              (this.tension = e.tension),
              this
            );
          }),
          (ip.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            e.points = [];
            for (var t = 0, n = this.points.length; t < n; t++) {
              var r = this.points[t];
              e.points.push(r.toArray());
            }
            return (
              (e.closed = this.closed),
              (e.curveType = this.curveType),
              (e.tension = this.tension),
              e
            );
          }),
          (ip.prototype.fromJSON = function(e) {
            Zd.prototype.fromJSON.call(this, e), (this.points = []);
            for (var t = 0, n = e.points.length; t < n; t++) {
              var r = e.points[t];
              this.points.push(new ea().fromArray(r));
            }
            return (
              (this.closed = e.closed),
              (this.curveType = e.curveType),
              (this.tension = e.tension),
              this
            );
          }),
          (lp.prototype = Object.create(Zd.prototype)),
          (lp.prototype.constructor = lp),
          (lp.prototype.isCubicBezierCurve = !0),
          (lp.prototype.getPoint = function(e, t) {
            var n = t || new Zi(),
              r = this.v0,
              i = this.v1,
              a = this.v2,
              o = this.v3;
            return (
              n.set(sp(e, r.x, i.x, a.x, o.x), sp(e, r.y, i.y, a.y, o.y)), n
            );
          }),
          (lp.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v0.copy(e.v0),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this.v3.copy(e.v3),
              this
            );
          }),
          (lp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (
              (e.v0 = this.v0.toArray()),
              (e.v1 = this.v1.toArray()),
              (e.v2 = this.v2.toArray()),
              (e.v3 = this.v3.toArray()),
              e
            );
          }),
          (lp.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v0.fromArray(e.v0),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this.v3.fromArray(e.v3),
              this
            );
          }),
          (cp.prototype = Object.create(Zd.prototype)),
          (cp.prototype.constructor = cp),
          (cp.prototype.isCubicBezierCurve3 = !0),
          (cp.prototype.getPoint = function(e, t) {
            var n = t || new ea(),
              r = this.v0,
              i = this.v1,
              a = this.v2,
              o = this.v3;
            return (
              n.set(
                sp(e, r.x, i.x, a.x, o.x),
                sp(e, r.y, i.y, a.y, o.y),
                sp(e, r.z, i.z, a.z, o.z)
              ),
              n
            );
          }),
          (cp.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v0.copy(e.v0),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this.v3.copy(e.v3),
              this
            );
          }),
          (cp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (
              (e.v0 = this.v0.toArray()),
              (e.v1 = this.v1.toArray()),
              (e.v2 = this.v2.toArray()),
              (e.v3 = this.v3.toArray()),
              e
            );
          }),
          (cp.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v0.fromArray(e.v0),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this.v3.fromArray(e.v3),
              this
            );
          }),
          (up.prototype = Object.create(Zd.prototype)),
          (up.prototype.constructor = up),
          (up.prototype.isLineCurve = !0),
          (up.prototype.getPoint = function(e, t) {
            var n = t || new Zi();
            return (
              1 === e
                ? n.copy(this.v2)
                : (n.copy(this.v2).sub(this.v1),
                  n.multiplyScalar(e).add(this.v1)),
              n
            );
          }),
          (up.prototype.getPointAt = function(e, t) {
            return this.getPoint(e, t);
          }),
          (up.prototype.getTangent = function() {
            return this.v2
              .clone()
              .sub(this.v1)
              .normalize();
          }),
          (up.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this
            );
          }),
          (up.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (e.v1 = this.v1.toArray()), (e.v2 = this.v2.toArray()), e;
          }),
          (up.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this
            );
          }),
          (hp.prototype = Object.create(Zd.prototype)),
          (hp.prototype.constructor = hp),
          (hp.prototype.isLineCurve3 = !0),
          (hp.prototype.getPoint = function(e, t) {
            var n = t || new ea();
            return (
              1 === e
                ? n.copy(this.v2)
                : (n.copy(this.v2).sub(this.v1),
                  n.multiplyScalar(e).add(this.v1)),
              n
            );
          }),
          (hp.prototype.getPointAt = function(e, t) {
            return this.getPoint(e, t);
          }),
          (hp.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this
            );
          }),
          (hp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (e.v1 = this.v1.toArray()), (e.v2 = this.v2.toArray()), e;
          }),
          (hp.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this
            );
          }),
          (dp.prototype = Object.create(Zd.prototype)),
          (dp.prototype.constructor = dp),
          (dp.prototype.isQuadraticBezierCurve = !0),
          (dp.prototype.getPoint = function(e, t) {
            var n = t || new Zi(),
              r = this.v0,
              i = this.v1,
              a = this.v2;
            return n.set(op(e, r.x, i.x, a.x), op(e, r.y, i.y, a.y)), n;
          }),
          (dp.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v0.copy(e.v0),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this
            );
          }),
          (dp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (
              (e.v0 = this.v0.toArray()),
              (e.v1 = this.v1.toArray()),
              (e.v2 = this.v2.toArray()),
              e
            );
          }),
          (dp.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v0.fromArray(e.v0),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this
            );
          }),
          (pp.prototype = Object.create(Zd.prototype)),
          (pp.prototype.constructor = pp),
          (pp.prototype.isQuadraticBezierCurve3 = !0),
          (pp.prototype.getPoint = function(e, t) {
            var n = t || new ea(),
              r = this.v0,
              i = this.v1,
              a = this.v2;
            return (
              n.set(
                op(e, r.x, i.x, a.x),
                op(e, r.y, i.y, a.y),
                op(e, r.z, i.z, a.z)
              ),
              n
            );
          }),
          (pp.prototype.copy = function(e) {
            return (
              Zd.prototype.copy.call(this, e),
              this.v0.copy(e.v0),
              this.v1.copy(e.v1),
              this.v2.copy(e.v2),
              this
            );
          }),
          (pp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            return (
              (e.v0 = this.v0.toArray()),
              (e.v1 = this.v1.toArray()),
              (e.v2 = this.v2.toArray()),
              e
            );
          }),
          (pp.prototype.fromJSON = function(e) {
            return (
              Zd.prototype.fromJSON.call(this, e),
              this.v0.fromArray(e.v0),
              this.v1.fromArray(e.v1),
              this.v2.fromArray(e.v2),
              this
            );
          }),
          (fp.prototype = Object.create(Zd.prototype)),
          (fp.prototype.constructor = fp),
          (fp.prototype.isSplineCurve = !0),
          (fp.prototype.getPoint = function(e, t) {
            var n = t || new Zi(),
              r = this.points,
              i = (r.length - 1) * e,
              a = Math.floor(i),
              o = i - a,
              s = r[0 === a ? a : a - 1],
              l = r[a],
              c = r[a > r.length - 2 ? r.length - 1 : a + 1],
              u = r[a > r.length - 3 ? r.length - 1 : a + 2];
            return (
              n.set(ap(o, s.x, l.x, c.x, u.x), ap(o, s.y, l.y, c.y, u.y)), n
            );
          }),
          (fp.prototype.copy = function(e) {
            Zd.prototype.copy.call(this, e), (this.points = []);
            for (var t = 0, n = e.points.length; t < n; t++) {
              var r = e.points[t];
              this.points.push(r.clone());
            }
            return this;
          }),
          (fp.prototype.toJSON = function() {
            var e = Zd.prototype.toJSON.call(this);
            e.points = [];
            for (var t = 0, n = this.points.length; t < n; t++) {
              var r = this.points[t];
              e.points.push(r.toArray());
            }
            return e;
          }),
          (fp.prototype.fromJSON = function(e) {
            Zd.prototype.fromJSON.call(this, e), (this.points = []);
            for (var t = 0, n = e.points.length; t < n; t++) {
              var r = e.points[t];
              this.points.push(new Zi().fromArray(r));
            }
            return this;
          });
        var mp = Object.freeze({
          __proto__: null,
          ArcCurve: Kd,
          CatmullRomCurve3: ip,
          CubicBezierCurve: lp,
          CubicBezierCurve3: cp,
          EllipseCurve: Jd,
          LineCurve: up,
          LineCurve3: hp,
          QuadraticBezierCurve: dp,
          QuadraticBezierCurve3: pp,
          SplineCurve: fp
        });
        function vp() {
          Zd.call(this),
            (this.type = "CurvePath"),
            (this.curves = []),
            (this.autoClose = !1);
        }
        function gp(e) {
          vp.call(this),
            (this.type = "Path"),
            (this.currentPoint = new Zi()),
            e && this.setFromPoints(e);
        }
        function yp(e) {
          gp.call(this, e),
            (this.uuid = Qi.generateUUID()),
            (this.type = "Shape"),
            (this.holes = []);
        }
        function bp(e, t) {
          Na.call(this),
            (this.type = "Light"),
            (this.color = new Eo(e)),
            (this.intensity = void 0 !== t ? t : 1),
            (this.receiveShadow = void 0);
        }
        function xp(e, t, n) {
          bp.call(this, e, n),
            (this.type = "HemisphereLight"),
            (this.castShadow = void 0),
            this.position.copy(Na.DefaultUp),
            this.updateMatrix(),
            (this.groundColor = new Eo(t));
        }
        function wp(e) {
          (this.camera = e),
            (this.bias = 0),
            (this.radius = 1),
            (this.mapSize = new Zi(512, 512)),
            (this.map = null),
            (this.mapPass = null),
            (this.matrix = new ga()),
            (this._frustum = new Gs()),
            (this._frameExtents = new Zi(1, 1)),
            (this._viewportCount = 1),
            (this._viewports = [new sa(0, 0, 1, 1)]);
        }
        function _p() {
          wp.call(this, new Ns(50, 1, 0.5, 500));
        }
        function Mp(e, t, n, r, i, a) {
          bp.call(this, e, t),
            (this.type = "SpotLight"),
            this.position.copy(Na.DefaultUp),
            this.updateMatrix(),
            (this.target = new Na()),
            Object.defineProperty(this, "power", {
              get: function() {
                return this.intensity * Math.PI;
              },
              set: function(e) {
                this.intensity = e / Math.PI;
              }
            }),
            (this.distance = void 0 !== n ? n : 0),
            (this.angle = void 0 !== r ? r : Math.PI / 3),
            (this.penumbra = void 0 !== i ? i : 0),
            (this.decay = void 0 !== a ? a : 1),
            (this.shadow = new _p());
        }
        function Tp() {
          wp.call(this, new Ns(90, 1, 0.5, 500)),
            (this._frameExtents = new Zi(4, 2)),
            (this._viewportCount = 6),
            (this._viewports = [
              new sa(2, 1, 1, 1),
              new sa(0, 1, 1, 1),
              new sa(3, 1, 1, 1),
              new sa(1, 1, 1, 1),
              new sa(3, 0, 1, 1),
              new sa(1, 0, 1, 1)
            ]),
            (this._cubeDirections = [
              new ea(1, 0, 0),
              new ea(-1, 0, 0),
              new ea(0, 0, 1),
              new ea(0, 0, -1),
              new ea(0, 1, 0),
              new ea(0, -1, 0)
            ]),
            (this._cubeUps = [
              new ea(0, 1, 0),
              new ea(0, 1, 0),
              new ea(0, 1, 0),
              new ea(0, 1, 0),
              new ea(0, 0, 1),
              new ea(0, 0, -1)
            ]);
        }
        function Ap(e, t, n, r) {
          bp.call(this, e, t),
            (this.type = "PointLight"),
            Object.defineProperty(this, "power", {
              get: function() {
                return 4 * this.intensity * Math.PI;
              },
              set: function(e) {
                this.intensity = e / (4 * Math.PI);
              }
            }),
            (this.distance = void 0 !== n ? n : 0),
            (this.decay = void 0 !== r ? r : 1),
            (this.shadow = new Tp());
        }
        function Sp(e, t, n, r, i, a) {
          Ls.call(this),
            (this.type = "OrthographicCamera"),
            (this.zoom = 1),
            (this.view = null),
            (this.left = void 0 !== e ? e : -1),
            (this.right = void 0 !== t ? t : 1),
            (this.top = void 0 !== n ? n : 1),
            (this.bottom = void 0 !== r ? r : -1),
            (this.near = void 0 !== i ? i : 0.1),
            (this.far = void 0 !== a ? a : 2e3),
            this.updateProjectionMatrix();
        }
        function Ep() {
          wp.call(this, new Sp(-5, 5, 5, -5, 0.5, 500));
        }
        function Rp(e, t) {
          bp.call(this, e, t),
            (this.type = "DirectionalLight"),
            this.position.copy(Na.DefaultUp),
            this.updateMatrix(),
            (this.target = new Na()),
            (this.shadow = new Ep());
        }
        function Pp(e, t) {
          bp.call(this, e, t),
            (this.type = "AmbientLight"),
            (this.castShadow = void 0);
        }
        function Ip(e, t, n, r) {
          bp.call(this, e, t),
            (this.type = "RectAreaLight"),
            (this.width = void 0 !== n ? n : 10),
            (this.height = void 0 !== r ? r : 10);
        }
        function Dp(e) {
          zd.call(this, e), (this.textures = {});
        }
        (vp.prototype = Object.assign(Object.create(Zd.prototype), {
          constructor: vp,
          add: function(e) {
            this.curves.push(e);
          },
          closePath: function() {
            var e = this.curves[0].getPoint(0),
              t = this.curves[this.curves.length - 1].getPoint(1);
            e.equals(t) || this.curves.push(new up(t, e));
          },
          getPoint: function(e) {
            for (
              var t = e * this.getLength(), n = this.getCurveLengths(), r = 0;
              r < n.length;

            ) {
              if (n[r] >= t) {
                var i = n[r] - t,
                  a = this.curves[r],
                  o = a.getLength(),
                  s = 0 === o ? 0 : 1 - i / o;
                return a.getPointAt(s);
              }
              r++;
            }
            return null;
          },
          getLength: function() {
            var e = this.getCurveLengths();
            return e[e.length - 1];
          },
          updateArcLengths: function() {
            (this.needsUpdate = !0),
              (this.cacheLengths = null),
              this.getCurveLengths();
          },
          getCurveLengths: function() {
            if (
              this.cacheLengths &&
              this.cacheLengths.length === this.curves.length
            )
              return this.cacheLengths;
            for (var e = [], t = 0, n = 0, r = this.curves.length; n < r; n++)
              (t += this.curves[n].getLength()), e.push(t);
            return (this.cacheLengths = e), e;
          },
          getSpacedPoints: function(e) {
            void 0 === e && (e = 40);
            for (var t = [], n = 0; n <= e; n++) t.push(this.getPoint(n / e));
            return this.autoClose && t.push(t[0]), t;
          },
          getPoints: function(e) {
            e = e || 12;
            for (var t, n = [], r = 0, i = this.curves; r < i.length; r++)
              for (
                var a = i[r],
                  o =
                    a && a.isEllipseCurve
                      ? 2 * e
                      : a && (a.isLineCurve || a.isLineCurve3)
                      ? 1
                      : a && a.isSplineCurve
                      ? e * a.points.length
                      : e,
                  s = a.getPoints(o),
                  l = 0;
                l < s.length;
                l++
              ) {
                var c = s[l];
                (t && t.equals(c)) || (n.push(c), (t = c));
              }
            return (
              this.autoClose &&
                n.length > 1 &&
                !n[n.length - 1].equals(n[0]) &&
                n.push(n[0]),
              n
            );
          },
          copy: function(e) {
            Zd.prototype.copy.call(this, e), (this.curves = []);
            for (var t = 0, n = e.curves.length; t < n; t++) {
              var r = e.curves[t];
              this.curves.push(r.clone());
            }
            return (this.autoClose = e.autoClose), this;
          },
          toJSON: function() {
            var e = Zd.prototype.toJSON.call(this);
            (e.autoClose = this.autoClose), (e.curves = []);
            for (var t = 0, n = this.curves.length; t < n; t++) {
              var r = this.curves[t];
              e.curves.push(r.toJSON());
            }
            return e;
          },
          fromJSON: function(e) {
            Zd.prototype.fromJSON.call(this, e),
              (this.autoClose = e.autoClose),
              (this.curves = []);
            for (var t = 0, n = e.curves.length; t < n; t++) {
              var r = e.curves[t];
              this.curves.push(new mp[r.type]().fromJSON(r));
            }
            return this;
          }
        })),
          (gp.prototype = Object.assign(Object.create(vp.prototype), {
            constructor: gp,
            setFromPoints: function(e) {
              this.moveTo(e[0].x, e[0].y);
              for (var t = 1, n = e.length; t < n; t++)
                this.lineTo(e[t].x, e[t].y);
              return this;
            },
            moveTo: function(e, t) {
              return this.currentPoint.set(e, t), this;
            },
            lineTo: function(e, t) {
              var n = new up(this.currentPoint.clone(), new Zi(e, t));
              return this.curves.push(n), this.currentPoint.set(e, t), this;
            },
            quadraticCurveTo: function(e, t, n, r) {
              var i = new dp(
                this.currentPoint.clone(),
                new Zi(e, t),
                new Zi(n, r)
              );
              return this.curves.push(i), this.currentPoint.set(n, r), this;
            },
            bezierCurveTo: function(e, t, n, r, i, a) {
              var o = new lp(
                this.currentPoint.clone(),
                new Zi(e, t),
                new Zi(n, r),
                new Zi(i, a)
              );
              return this.curves.push(o), this.currentPoint.set(i, a), this;
            },
            splineThru: function(e) {
              var t = new fp([this.currentPoint.clone()].concat(e));
              return (
                this.curves.push(t),
                this.currentPoint.copy(e[e.length - 1]),
                this
              );
            },
            arc: function(e, t, n, r, i, a) {
              var o = this.currentPoint.x,
                s = this.currentPoint.y;
              return this.absarc(e + o, t + s, n, r, i, a), this;
            },
            absarc: function(e, t, n, r, i, a) {
              return this.absellipse(e, t, n, n, r, i, a), this;
            },
            ellipse: function(e, t, n, r, i, a, o, s) {
              var l = this.currentPoint.x,
                c = this.currentPoint.y;
              return this.absellipse(e + l, t + c, n, r, i, a, o, s), this;
            },
            absellipse: function(e, t, n, r, i, a, o, s) {
              var l = new Jd(e, t, n, r, i, a, o, s);
              if (this.curves.length > 0) {
                var c = l.getPoint(0);
                c.equals(this.currentPoint) || this.lineTo(c.x, c.y);
              }
              this.curves.push(l);
              var u = l.getPoint(1);
              return this.currentPoint.copy(u), this;
            },
            copy: function(e) {
              return (
                vp.prototype.copy.call(this, e),
                this.currentPoint.copy(e.currentPoint),
                this
              );
            },
            toJSON: function() {
              var e = vp.prototype.toJSON.call(this);
              return (e.currentPoint = this.currentPoint.toArray()), e;
            },
            fromJSON: function(e) {
              return (
                vp.prototype.fromJSON.call(this, e),
                this.currentPoint.fromArray(e.currentPoint),
                this
              );
            }
          })),
          (yp.prototype = Object.assign(Object.create(gp.prototype), {
            constructor: yp,
            getPointsHoles: function(e) {
              for (var t = [], n = 0, r = this.holes.length; n < r; n++)
                t[n] = this.holes[n].getPoints(e);
              return t;
            },
            extractPoints: function(e) {
              return {
                shape: this.getPoints(e),
                holes: this.getPointsHoles(e)
              };
            },
            copy: function(e) {
              gp.prototype.copy.call(this, e), (this.holes = []);
              for (var t = 0, n = e.holes.length; t < n; t++) {
                var r = e.holes[t];
                this.holes.push(r.clone());
              }
              return this;
            },
            toJSON: function() {
              var e = gp.prototype.toJSON.call(this);
              (e.uuid = this.uuid), (e.holes = []);
              for (var t = 0, n = this.holes.length; t < n; t++) {
                var r = this.holes[t];
                e.holes.push(r.toJSON());
              }
              return e;
            },
            fromJSON: function(e) {
              gp.prototype.fromJSON.call(this, e),
                (this.uuid = e.uuid),
                (this.holes = []);
              for (var t = 0, n = e.holes.length; t < n; t++) {
                var r = e.holes[t];
                this.holes.push(new gp().fromJSON(r));
              }
              return this;
            }
          })),
          (bp.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: bp,
            isLight: !0,
            copy: function(e) {
              return (
                Na.prototype.copy.call(this, e),
                this.color.copy(e.color),
                (this.intensity = e.intensity),
                this
              );
            },
            toJSON: function(e) {
              var t = Na.prototype.toJSON.call(this, e);
              return (
                (t.object.color = this.color.getHex()),
                (t.object.intensity = this.intensity),
                void 0 !== this.groundColor &&
                  (t.object.groundColor = this.groundColor.getHex()),
                void 0 !== this.distance && (t.object.distance = this.distance),
                void 0 !== this.angle && (t.object.angle = this.angle),
                void 0 !== this.decay && (t.object.decay = this.decay),
                void 0 !== this.penumbra && (t.object.penumbra = this.penumbra),
                void 0 !== this.shadow &&
                  (t.object.shadow = this.shadow.toJSON()),
                t
              );
            }
          })),
          (xp.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: xp,
            isHemisphereLight: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                this.groundColor.copy(e.groundColor),
                this
              );
            }
          })),
          Object.assign(wp.prototype, {
            _projScreenMatrix: new ga(),
            _lightPositionWorld: new ea(),
            _lookTarget: new ea(),
            getViewportCount: function() {
              return this._viewportCount;
            },
            getFrustum: function() {
              return this._frustum;
            },
            updateMatrices: function(e) {
              var t = this.camera,
                n = this.matrix,
                r = this._projScreenMatrix,
                i = this._lookTarget,
                a = this._lightPositionWorld;
              a.setFromMatrixPosition(e.matrixWorld),
                t.position.copy(a),
                i.setFromMatrixPosition(e.target.matrixWorld),
                t.lookAt(i),
                t.updateMatrixWorld(),
                r.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse),
                this._frustum.setFromMatrix(r),
                n.set(
                  0.5,
                  0,
                  0,
                  0.5,
                  0,
                  0.5,
                  0,
                  0.5,
                  0,
                  0,
                  0.5,
                  0.5,
                  0,
                  0,
                  0,
                  1
                ),
                n.multiply(t.projectionMatrix),
                n.multiply(t.matrixWorldInverse);
            },
            getViewport: function(e) {
              return this._viewports[e];
            },
            getFrameExtents: function() {
              return this._frameExtents;
            },
            copy: function(e) {
              return (
                (this.camera = e.camera.clone()),
                (this.bias = e.bias),
                (this.radius = e.radius),
                this.mapSize.copy(e.mapSize),
                this
              );
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            toJSON: function() {
              var e = {};
              return (
                0 !== this.bias && (e.bias = this.bias),
                1 !== this.radius && (e.radius = this.radius),
                (512 === this.mapSize.x && 512 === this.mapSize.y) ||
                  (e.mapSize = this.mapSize.toArray()),
                (e.camera = this.camera.toJSON(!1).object),
                delete e.camera.matrix,
                e
              );
            }
          }),
          (_p.prototype = Object.assign(Object.create(wp.prototype), {
            constructor: _p,
            isSpotLightShadow: !0,
            updateMatrices: function(e) {
              var t = this.camera,
                n = 2 * Qi.RAD2DEG * e.angle,
                r = this.mapSize.width / this.mapSize.height,
                i = e.distance || t.far;
              (n === t.fov && r === t.aspect && i === t.far) ||
                ((t.fov = n),
                (t.aspect = r),
                (t.far = i),
                t.updateProjectionMatrix()),
                wp.prototype.updateMatrices.call(this, e);
            }
          })),
          (Mp.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Mp,
            isSpotLight: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                (this.distance = e.distance),
                (this.angle = e.angle),
                (this.penumbra = e.penumbra),
                (this.decay = e.decay),
                (this.target = e.target.clone()),
                (this.shadow = e.shadow.clone()),
                this
              );
            }
          })),
          (Tp.prototype = Object.assign(Object.create(wp.prototype), {
            constructor: Tp,
            isPointLightShadow: !0,
            updateMatrices: function(e, t) {
              void 0 === t && (t = 0);
              var n = this.camera,
                r = this.matrix,
                i = this._lightPositionWorld,
                a = this._lookTarget,
                o = this._projScreenMatrix;
              i.setFromMatrixPosition(e.matrixWorld),
                n.position.copy(i),
                a.copy(n.position),
                a.add(this._cubeDirections[t]),
                n.up.copy(this._cubeUps[t]),
                n.lookAt(a),
                n.updateMatrixWorld(),
                r.makeTranslation(-i.x, -i.y, -i.z),
                o.multiplyMatrices(n.projectionMatrix, n.matrixWorldInverse),
                this._frustum.setFromMatrix(o);
            }
          })),
          (Ap.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Ap,
            isPointLight: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                (this.distance = e.distance),
                (this.decay = e.decay),
                (this.shadow = e.shadow.clone()),
                this
              );
            }
          })),
          (Sp.prototype = Object.assign(Object.create(Ls.prototype), {
            constructor: Sp,
            isOrthographicCamera: !0,
            copy: function(e, t) {
              return (
                Ls.prototype.copy.call(this, e, t),
                (this.left = e.left),
                (this.right = e.right),
                (this.top = e.top),
                (this.bottom = e.bottom),
                (this.near = e.near),
                (this.far = e.far),
                (this.zoom = e.zoom),
                (this.view =
                  null === e.view ? null : Object.assign({}, e.view)),
                this
              );
            },
            setViewOffset: function(e, t, n, r, i, a) {
              null === this.view &&
                (this.view = {
                  enabled: !0,
                  fullWidth: 1,
                  fullHeight: 1,
                  offsetX: 0,
                  offsetY: 0,
                  width: 1,
                  height: 1
                }),
                (this.view.enabled = !0),
                (this.view.fullWidth = e),
                (this.view.fullHeight = t),
                (this.view.offsetX = n),
                (this.view.offsetY = r),
                (this.view.width = i),
                (this.view.height = a),
                this.updateProjectionMatrix();
            },
            clearViewOffset: function() {
              null !== this.view && (this.view.enabled = !1),
                this.updateProjectionMatrix();
            },
            updateProjectionMatrix: function() {
              var e = (this.right - this.left) / (2 * this.zoom),
                t = (this.top - this.bottom) / (2 * this.zoom),
                n = (this.right + this.left) / 2,
                r = (this.top + this.bottom) / 2,
                i = n - e,
                a = n + e,
                o = r + t,
                s = r - t;
              if (null !== this.view && this.view.enabled) {
                var l = this.zoom / (this.view.width / this.view.fullWidth),
                  c = this.zoom / (this.view.height / this.view.fullHeight),
                  u = (this.right - this.left) / this.view.width,
                  h = (this.top - this.bottom) / this.view.height;
                (a =
                  (i += u * (this.view.offsetX / l)) +
                  u * (this.view.width / l)),
                  (s =
                    (o -= h * (this.view.offsetY / c)) -
                    h * (this.view.height / c));
              }
              this.projectionMatrix.makeOrthographic(
                i,
                a,
                o,
                s,
                this.near,
                this.far
              ),
                this.projectionMatrixInverse.getInverse(this.projectionMatrix);
            },
            toJSON: function(e) {
              var t = Na.prototype.toJSON.call(this, e);
              return (
                (t.object.zoom = this.zoom),
                (t.object.left = this.left),
                (t.object.right = this.right),
                (t.object.top = this.top),
                (t.object.bottom = this.bottom),
                (t.object.near = this.near),
                (t.object.far = this.far),
                null !== this.view &&
                  (t.object.view = Object.assign({}, this.view)),
                t
              );
            }
          })),
          (Ep.prototype = Object.assign(Object.create(wp.prototype), {
            constructor: Ep,
            isDirectionalLightShadow: !0,
            updateMatrices: function(e) {
              wp.prototype.updateMatrices.call(this, e);
            }
          })),
          (Rp.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Rp,
            isDirectionalLight: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                (this.target = e.target.clone()),
                (this.shadow = e.shadow.clone()),
                this
              );
            }
          })),
          (Pp.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Pp,
            isAmbientLight: !0
          })),
          (Ip.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Ip,
            isRectAreaLight: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                (this.width = e.width),
                (this.height = e.height),
                this
              );
            },
            toJSON: function(e) {
              var t = bp.prototype.toJSON.call(this, e);
              return (
                (t.object.width = this.width),
                (t.object.height = this.height),
                t
              );
            }
          })),
          (Dp.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Dp,
            load: function(e, t, n, r) {
              var i = this,
                a = new Gd(i.manager);
              a.setPath(i.path),
                a.load(
                  e,
                  function(e) {
                    t(i.parse(JSON.parse(e)));
                  },
                  n,
                  r
                );
            },
            parse: function(e) {
              var t = this.textures;
              function n(e) {
                return t[e], t[e];
              }
              var r = new _d[e.type]();
              if (
                (void 0 !== e.uuid && (r.uuid = e.uuid),
                void 0 !== e.name && (r.name = e.name),
                void 0 !== e.color && r.color.setHex(e.color),
                void 0 !== e.roughness && (r.roughness = e.roughness),
                void 0 !== e.metalness && (r.metalness = e.metalness),
                void 0 !== e.sheen && (r.sheen = new Eo().setHex(e.sheen)),
                void 0 !== e.emissive && r.emissive.setHex(e.emissive),
                void 0 !== e.specular && r.specular.setHex(e.specular),
                void 0 !== e.shininess && (r.shininess = e.shininess),
                void 0 !== e.clearcoat && (r.clearcoat = e.clearcoat),
                void 0 !== e.clearcoatRoughness &&
                  (r.clearcoatRoughness = e.clearcoatRoughness),
                void 0 !== e.vertexColors && (r.vertexColors = e.vertexColors),
                void 0 !== e.fog && (r.fog = e.fog),
                void 0 !== e.flatShading && (r.flatShading = e.flatShading),
                void 0 !== e.blending && (r.blending = e.blending),
                void 0 !== e.combine && (r.combine = e.combine),
                void 0 !== e.side && (r.side = e.side),
                void 0 !== e.opacity && (r.opacity = e.opacity),
                void 0 !== e.transparent && (r.transparent = e.transparent),
                void 0 !== e.alphaTest && (r.alphaTest = e.alphaTest),
                void 0 !== e.depthTest && (r.depthTest = e.depthTest),
                void 0 !== e.depthWrite && (r.depthWrite = e.depthWrite),
                void 0 !== e.colorWrite && (r.colorWrite = e.colorWrite),
                void 0 !== e.stencilWrite && (r.stencilWrite = e.stencilWrite),
                void 0 !== e.stencilWriteMask &&
                  (r.stencilWriteMask = e.stencilWriteMask),
                void 0 !== e.stencilFunc && (r.stencilFunc = e.stencilFunc),
                void 0 !== e.stencilRef && (r.stencilRef = e.stencilRef),
                void 0 !== e.stencilFuncMask &&
                  (r.stencilFuncMask = e.stencilFuncMask),
                void 0 !== e.stencilFail && (r.stencilFail = e.stencilFail),
                void 0 !== e.stencilZFail && (r.stencilZFail = e.stencilZFail),
                void 0 !== e.stencilZPass && (r.stencilZPass = e.stencilZPass),
                void 0 !== e.wireframe && (r.wireframe = e.wireframe),
                void 0 !== e.wireframeLinewidth &&
                  (r.wireframeLinewidth = e.wireframeLinewidth),
                void 0 !== e.wireframeLinecap &&
                  (r.wireframeLinecap = e.wireframeLinecap),
                void 0 !== e.wireframeLinejoin &&
                  (r.wireframeLinejoin = e.wireframeLinejoin),
                void 0 !== e.rotation && (r.rotation = e.rotation),
                1 !== e.linewidth && (r.linewidth = e.linewidth),
                void 0 !== e.dashSize && (r.dashSize = e.dashSize),
                void 0 !== e.gapSize && (r.gapSize = e.gapSize),
                void 0 !== e.scale && (r.scale = e.scale),
                void 0 !== e.polygonOffset &&
                  (r.polygonOffset = e.polygonOffset),
                void 0 !== e.polygonOffsetFactor &&
                  (r.polygonOffsetFactor = e.polygonOffsetFactor),
                void 0 !== e.polygonOffsetUnits &&
                  (r.polygonOffsetUnits = e.polygonOffsetUnits),
                void 0 !== e.skinning && (r.skinning = e.skinning),
                void 0 !== e.morphTargets && (r.morphTargets = e.morphTargets),
                void 0 !== e.morphNormals && (r.morphNormals = e.morphNormals),
                void 0 !== e.dithering && (r.dithering = e.dithering),
                void 0 !== e.visible && (r.visible = e.visible),
                void 0 !== e.toneMapped && (r.toneMapped = e.toneMapped),
                void 0 !== e.userData && (r.userData = e.userData),
                void 0 !== e.uniforms)
              )
                for (var i in e.uniforms) {
                  var a = e.uniforms[i];
                  switch (((r.uniforms[i] = {}), a.type)) {
                    case "t":
                      r.uniforms[i].value = n(a.value);
                      break;
                    case "c":
                      r.uniforms[i].value = new Eo().setHex(a.value);
                      break;
                    case "v2":
                      r.uniforms[i].value = new Zi().fromArray(a.value);
                      break;
                    case "v3":
                      r.uniforms[i].value = new ea().fromArray(a.value);
                      break;
                    case "v4":
                      r.uniforms[i].value = new sa().fromArray(a.value);
                      break;
                    case "m3":
                      r.uniforms[i].value = new ra().fromArray(a.value);
                    case "m4":
                      r.uniforms[i].value = new ga().fromArray(a.value);
                      break;
                    default:
                      r.uniforms[i].value = a.value;
                  }
                }
              if (
                (void 0 !== e.defines && (r.defines = e.defines),
                void 0 !== e.vertexShader && (r.vertexShader = e.vertexShader),
                void 0 !== e.fragmentShader &&
                  (r.fragmentShader = e.fragmentShader),
                void 0 !== e.extensions)
              )
                for (var o in e.extensions) r.extensions[o] = e.extensions[o];
              if (
                (void 0 !== e.shading && (r.flatShading = 1 === e.shading),
                void 0 !== e.size && (r.size = e.size),
                void 0 !== e.sizeAttenuation &&
                  (r.sizeAttenuation = e.sizeAttenuation),
                void 0 !== e.map && (r.map = n(e.map)),
                void 0 !== e.matcap && (r.matcap = n(e.matcap)),
                void 0 !== e.alphaMap &&
                  ((r.alphaMap = n(e.alphaMap)), (r.transparent = !0)),
                void 0 !== e.bumpMap && (r.bumpMap = n(e.bumpMap)),
                void 0 !== e.bumpScale && (r.bumpScale = e.bumpScale),
                void 0 !== e.normalMap && (r.normalMap = n(e.normalMap)),
                void 0 !== e.normalMapType &&
                  (r.normalMapType = e.normalMapType),
                void 0 !== e.normalScale)
              ) {
                var s = e.normalScale;
                !1 === Array.isArray(s) && (s = [s, s]),
                  (r.normalScale = new Zi().fromArray(s));
              }
              return (
                void 0 !== e.displacementMap &&
                  (r.displacementMap = n(e.displacementMap)),
                void 0 !== e.displacementScale &&
                  (r.displacementScale = e.displacementScale),
                void 0 !== e.displacementBias &&
                  (r.displacementBias = e.displacementBias),
                void 0 !== e.roughnessMap &&
                  (r.roughnessMap = n(e.roughnessMap)),
                void 0 !== e.metalnessMap &&
                  (r.metalnessMap = n(e.metalnessMap)),
                void 0 !== e.emissiveMap && (r.emissiveMap = n(e.emissiveMap)),
                void 0 !== e.emissiveIntensity &&
                  (r.emissiveIntensity = e.emissiveIntensity),
                void 0 !== e.specularMap && (r.specularMap = n(e.specularMap)),
                void 0 !== e.envMap && (r.envMap = n(e.envMap)),
                void 0 !== e.envMapIntensity &&
                  (r.envMapIntensity = e.envMapIntensity),
                void 0 !== e.reflectivity && (r.reflectivity = e.reflectivity),
                void 0 !== e.refractionRatio &&
                  (r.refractionRatio = e.refractionRatio),
                void 0 !== e.lightMap && (r.lightMap = n(e.lightMap)),
                void 0 !== e.lightMapIntensity &&
                  (r.lightMapIntensity = e.lightMapIntensity),
                void 0 !== e.aoMap && (r.aoMap = n(e.aoMap)),
                void 0 !== e.aoMapIntensity &&
                  (r.aoMapIntensity = e.aoMapIntensity),
                void 0 !== e.gradientMap && (r.gradientMap = n(e.gradientMap)),
                void 0 !== e.clearcoatNormalMap &&
                  (r.clearcoatNormalMap = n(e.clearcoatNormalMap)),
                void 0 !== e.clearcoatNormalScale &&
                  (r.clearcoatNormalScale = new Zi().fromArray(
                    e.clearcoatNormalScale
                  )),
                r
              );
            },
            setTextures: function(e) {
              return (this.textures = e), this;
            }
          }));
        var Op = {
          decodeText: function(e) {
            if ("undefined" != typeof TextDecoder)
              return new TextDecoder().decode(e);
            for (var t = "", n = 0, r = e.length; n < r; n++)
              t += String.fromCharCode(e[n]);
            try {
              return decodeURIComponent(escape(t));
            } catch (e) {
              return t;
            }
          },
          extractUrlBase: function(e) {
            var t = e.lastIndexOf("/");
            return -1 === t ? "./" : e.substr(0, t + 1);
          }
        };
        function Cp() {
          es.call(this),
            (this.type = "InstancedBufferGeometry"),
            (this.maxInstancedCount = void 0);
        }
        function Lp(e, t, n, r) {
          "number" == typeof n && ((r = n), (n = !1)),
            No.call(this, e, t, n),
            (this.meshPerAttribute = r || 1);
        }
        function Np(e) {
          zd.call(this, e);
        }
        (Cp.prototype = Object.assign(Object.create(es.prototype), {
          constructor: Cp,
          isInstancedBufferGeometry: !0,
          copy: function(e) {
            return (
              es.prototype.copy.call(this, e),
              (this.maxInstancedCount = e.maxInstancedCount),
              this
            );
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          toJSON: function() {
            var e = es.prototype.toJSON.call(this);
            return (
              (e.maxInstancedCount = this.maxInstancedCount),
              (e.isInstancedBufferGeometry = !0),
              e
            );
          }
        })),
          (Lp.prototype = Object.assign(Object.create(No.prototype), {
            constructor: Lp,
            isInstancedBufferAttribute: !0,
            copy: function(e) {
              return (
                No.prototype.copy.call(this, e),
                (this.meshPerAttribute = e.meshPerAttribute),
                this
              );
            },
            toJSON: function() {
              var e = No.prototype.toJSON.call(this);
              return (
                (e.meshPerAttribute = this.meshPerAttribute),
                (e.isInstancedBufferAttribute = !0),
                e
              );
            }
          })),
          (Np.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Np,
            load: function(e, t, n, r) {
              var i = this,
                a = new Gd(i.manager);
              a.setPath(i.path),
                a.load(
                  e,
                  function(e) {
                    t(i.parse(JSON.parse(e)));
                  },
                  n,
                  r
                );
            },
            parse: function(e) {
              var t = e.isInstancedBufferGeometry ? new Cp() : new es(),
                n = e.data.index;
              if (void 0 !== n) {
                var r = new Fp[n.type](n.array);
                t.setIndex(new No(r, 1));
              }
              var i = e.data.attributes;
              for (var a in i) {
                var o = i[a],
                  s =
                    ((r = new Fp[o.type](o.array)),
                    new (o.isInstancedBufferAttribute ? Lp : No)(
                      r,
                      o.itemSize,
                      o.normalized
                    ));
                void 0 !== o.name && (s.name = o.name), t.setAttribute(a, s);
              }
              var l = e.data.morphAttributes;
              if (l)
                for (var a in l) {
                  for (var c = l[a], u = [], h = 0, d = c.length; h < d; h++)
                    (o = c[h]),
                      (s = new No(
                        (r = new Fp[o.type](o.array)),
                        o.itemSize,
                        o.normalized
                      )),
                      void 0 !== o.name && (s.name = o.name),
                      u.push(s);
                  t.morphAttributes[a] = u;
                }
              e.data.morphTargetsRelative && (t.morphTargetsRelative = !0);
              var p = e.data.groups || e.data.drawcalls || e.data.offsets;
              if (void 0 !== p) {
                h = 0;
                for (var f = p.length; h !== f; ++h) {
                  var m = p[h];
                  t.addGroup(m.start, m.count, m.materialIndex);
                }
              }
              var v = e.data.boundingSphere;
              if (void 0 !== v) {
                var g = new ea();
                void 0 !== v.center && g.fromArray(v.center),
                  (t.boundingSphere = new $a(g, v.radius));
              }
              return (
                e.name && (t.name = e.name),
                e.userData && (t.userData = e.userData),
                t
              );
            }
          }));
        var Fp = {
          Int8Array: Int8Array,
          Uint8Array: Uint8Array,
          Uint8ClampedArray:
            "undefined" != typeof Uint8ClampedArray
              ? Uint8ClampedArray
              : Uint8Array,
          Int16Array: Int16Array,
          Uint16Array: Uint16Array,
          Int32Array: Int32Array,
          Uint32Array: Uint32Array,
          Float32Array: Float32Array,
          Float64Array: Float64Array
        };
        function kp(e) {
          zd.call(this, e);
        }
        kp.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: kp,
          load: function(e, t, n, r) {
            var i = this,
              a = "" === this.path ? Op.extractUrlBase(e) : this.path;
            this.resourcePath = this.resourcePath || a;
            var o = new Gd(i.manager);
            o.setPath(this.path),
              o.load(
                e,
                function(e) {
                  var n = null;
                  try {
                    n = JSON.parse(e);
                  } catch (e) {
                    return void (void 0 !== r && r(e));
                  }
                  var a = n.metadata;
                  void 0 !== a &&
                    void 0 !== a.type &&
                    "geometry" !== a.type.toLowerCase() &&
                    i.parse(n, t);
                },
                n,
                r
              );
          },
          parse: function(e, t) {
            var n = this.parseShape(e.shapes),
              r = this.parseGeometries(e.geometries, n),
              i = this.parseImages(e.images, function() {
                void 0 !== t && t(s);
              }),
              a = this.parseTextures(e.textures, i),
              o = this.parseMaterials(e.materials, a),
              s = this.parseObject(e.object, r, o);
            return (
              e.animations &&
                (s.animations = this.parseAnimations(e.animations)),
              (void 0 !== e.images && 0 !== e.images.length) ||
                (void 0 !== t && t(s)),
              s
            );
          },
          parseShape: function(e) {
            var t = {};
            if (void 0 !== e)
              for (var n = 0, r = e.length; n < r; n++) {
                var i = new yp().fromJSON(e[n]);
                t[i.uuid] = i;
              }
            return t;
          },
          parseGeometries: function(e, t) {
            var n = {};
            if (void 0 !== e)
              for (var r = new Np(), i = 0, a = e.length; i < a; i++) {
                var o,
                  s = e[i];
                switch (s.type) {
                  case "PlaneGeometry":
                  case "PlaneBufferGeometry":
                    o = new hd[s.type](
                      s.width,
                      s.height,
                      s.widthSegments,
                      s.heightSegments
                    );
                    break;
                  case "BoxGeometry":
                  case "BoxBufferGeometry":
                  case "CubeGeometry":
                    o = new hd[s.type](
                      s.width,
                      s.height,
                      s.depth,
                      s.widthSegments,
                      s.heightSegments,
                      s.depthSegments
                    );
                    break;
                  case "CircleGeometry":
                  case "CircleBufferGeometry":
                    o = new hd[s.type](
                      s.radius,
                      s.segments,
                      s.thetaStart,
                      s.thetaLength
                    );
                    break;
                  case "CylinderGeometry":
                  case "CylinderBufferGeometry":
                    o = new hd[s.type](
                      s.radiusTop,
                      s.radiusBottom,
                      s.height,
                      s.radialSegments,
                      s.heightSegments,
                      s.openEnded,
                      s.thetaStart,
                      s.thetaLength
                    );
                    break;
                  case "ConeGeometry":
                  case "ConeBufferGeometry":
                    o = new hd[s.type](
                      s.radius,
                      s.height,
                      s.radialSegments,
                      s.heightSegments,
                      s.openEnded,
                      s.thetaStart,
                      s.thetaLength
                    );
                    break;
                  case "SphereGeometry":
                  case "SphereBufferGeometry":
                    o = new hd[s.type](
                      s.radius,
                      s.widthSegments,
                      s.heightSegments,
                      s.phiStart,
                      s.phiLength,
                      s.thetaStart,
                      s.thetaLength
                    );
                    break;
                  case "DodecahedronGeometry":
                  case "DodecahedronBufferGeometry":
                  case "IcosahedronGeometry":
                  case "IcosahedronBufferGeometry":
                  case "OctahedronGeometry":
                  case "OctahedronBufferGeometry":
                  case "TetrahedronGeometry":
                  case "TetrahedronBufferGeometry":
                    o = new hd[s.type](s.radius, s.detail);
                    break;
                  case "RingGeometry":
                  case "RingBufferGeometry":
                    o = new hd[s.type](
                      s.innerRadius,
                      s.outerRadius,
                      s.thetaSegments,
                      s.phiSegments,
                      s.thetaStart,
                      s.thetaLength
                    );
                    break;
                  case "TorusGeometry":
                  case "TorusBufferGeometry":
                    o = new hd[s.type](
                      s.radius,
                      s.tube,
                      s.radialSegments,
                      s.tubularSegments,
                      s.arc
                    );
                    break;
                  case "TorusKnotGeometry":
                  case "TorusKnotBufferGeometry":
                    o = new hd[s.type](
                      s.radius,
                      s.tube,
                      s.tubularSegments,
                      s.radialSegments,
                      s.p,
                      s.q
                    );
                    break;
                  case "TubeGeometry":
                  case "TubeBufferGeometry":
                    o = new hd[s.type](
                      new mp[s.path.type]().fromJSON(s.path),
                      s.tubularSegments,
                      s.radius,
                      s.radialSegments,
                      s.closed
                    );
                    break;
                  case "LatheGeometry":
                  case "LatheBufferGeometry":
                    o = new hd[s.type](
                      s.points,
                      s.segments,
                      s.phiStart,
                      s.phiLength
                    );
                    break;
                  case "PolyhedronGeometry":
                  case "PolyhedronBufferGeometry":
                    o = new hd[s.type](
                      s.vertices,
                      s.indices,
                      s.radius,
                      s.details
                    );
                    break;
                  case "ShapeGeometry":
                  case "ShapeBufferGeometry":
                    for (var l = [], c = 0, u = s.shapes.length; c < u; c++) {
                      var h = t[s.shapes[c]];
                      l.push(h);
                    }
                    o = new hd[s.type](l, s.curveSegments);
                    break;
                  case "ExtrudeGeometry":
                  case "ExtrudeBufferGeometry":
                    for (l = [], c = 0, u = s.shapes.length; c < u; c++)
                      (h = t[s.shapes[c]]), l.push(h);
                    var d = s.options.extrudePath;
                    void 0 !== d &&
                      (s.options.extrudePath = new mp[d.type]().fromJSON(d)),
                      (o = new hd[s.type](l, s.options));
                    break;
                  case "BufferGeometry":
                  case "InstancedBufferGeometry":
                    o = r.parse(s);
                    break;
                  case "Geometry":
                    "THREE" in window &&
                      "LegacyJSONLoader" in THREE &&
                      (o = new THREE.LegacyJSONLoader().parse(
                        s,
                        this.resourcePath
                      ).geometry);
                    break;
                  default:
                    continue;
                }
                (o.uuid = s.uuid),
                  void 0 !== s.name && (o.name = s.name),
                  !0 === o.isBufferGeometry &&
                    void 0 !== s.userData &&
                    (o.userData = s.userData),
                  (n[s.uuid] = o);
              }
            return n;
          },
          parseMaterials: function(e, t) {
            var n = {},
              r = {};
            if (void 0 !== e) {
              var i = new Dp();
              i.setTextures(t);
              for (var a = 0, o = e.length; a < o; a++) {
                var s = e[a];
                if ("MultiMaterial" === s.type) {
                  for (var l = [], c = 0; c < s.materials.length; c++) {
                    var u = s.materials[c];
                    void 0 === n[u.uuid] && (n[u.uuid] = i.parse(u)),
                      l.push(n[u.uuid]);
                  }
                  r[s.uuid] = l;
                } else
                  void 0 === n[s.uuid] && (n[s.uuid] = i.parse(s)),
                    (r[s.uuid] = n[s.uuid]);
              }
            }
            return r;
          },
          parseAnimations: function(e) {
            for (var t = [], n = 0; n < e.length; n++) {
              var r = e[n],
                i = Fd.parse(r);
              void 0 !== r.uuid && (i.uuid = r.uuid), t.push(i);
            }
            return t;
          },
          parseImages: function(e, t) {
            var n = this,
              r = {};
            function i(e) {
              return (
                n.manager.itemStart(e),
                a.load(
                  e,
                  function() {
                    n.manager.itemEnd(e);
                  },
                  void 0,
                  function() {
                    n.manager.itemError(e), n.manager.itemEnd(e);
                  }
                )
              );
            }
            if (void 0 !== e && e.length > 0) {
              var a = new Yd(new jd(t));
              a.setCrossOrigin(this.crossOrigin);
              for (var o = 0, s = e.length; o < s; o++) {
                var l = e[o],
                  c = l.url;
                if (Array.isArray(c)) {
                  r[l.uuid] = [];
                  for (var u = 0, h = c.length; u < h; u++) {
                    var d = c[u],
                      p = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)
                        ? d
                        : n.resourcePath + d;
                    r[l.uuid].push(i(p));
                  }
                } else
                  (p = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)
                    ? l.url
                    : n.resourcePath + l.url),
                    (r[l.uuid] = i(p));
              }
            }
            return r;
          },
          parseTextures: function(e, t) {
            function n(e, t) {
              return "number" == typeof e ? e : t[e];
            }
            var r = {};
            if (void 0 !== e)
              for (var i = 0, a = e.length; i < a; i++) {
                var o,
                  s = e[i];
                s.image,
                  t[s.image],
                  ((o = Array.isArray(t[s.image])
                    ? new ll(t[s.image])
                    : new oa(t[s.image])).needsUpdate = !0),
                  (o.uuid = s.uuid),
                  void 0 !== s.name && (o.name = s.name),
                  void 0 !== s.mapping && (o.mapping = n(s.mapping, jp)),
                  void 0 !== s.offset && o.offset.fromArray(s.offset),
                  void 0 !== s.repeat && o.repeat.fromArray(s.repeat),
                  void 0 !== s.center && o.center.fromArray(s.center),
                  void 0 !== s.rotation && (o.rotation = s.rotation),
                  void 0 !== s.wrap &&
                    ((o.wrapS = n(s.wrap[0], Bp)),
                    (o.wrapT = n(s.wrap[1], Bp))),
                  void 0 !== s.format && (o.format = s.format),
                  void 0 !== s.type && (o.type = s.type),
                  void 0 !== s.encoding && (o.encoding = s.encoding),
                  void 0 !== s.minFilter && (o.minFilter = n(s.minFilter, zp)),
                  void 0 !== s.magFilter && (o.magFilter = n(s.magFilter, zp)),
                  void 0 !== s.anisotropy && (o.anisotropy = s.anisotropy),
                  void 0 !== s.flipY && (o.flipY = s.flipY),
                  void 0 !== s.premultiplyAlpha &&
                    (o.premultiplyAlpha = s.premultiplyAlpha),
                  void 0 !== s.unpackAlignment &&
                    (o.unpackAlignment = s.unpackAlignment),
                  (r[s.uuid] = o);
              }
            return r;
          },
          parseObject: function(e, t, n) {
            var r;
            function i(e) {
              return t[e], t[e];
            }
            function a(e) {
              if (void 0 !== e) {
                if (Array.isArray(e)) {
                  for (var t = [], r = 0, i = e.length; r < i; r++) {
                    var a = e[r];
                    n[a], t.push(n[a]);
                  }
                  return t;
                }
                return n[e], n[e];
              }
            }
            switch (e.type) {
              case "Scene":
                (r = new Fa()),
                  void 0 !== e.background &&
                    Number.isInteger(e.background) &&
                    (r.background = new Eo(e.background)),
                  void 0 !== e.fog &&
                    ("Fog" === e.fog.type
                      ? (r.fog = new eu(e.fog.color, e.fog.near, e.fog.far))
                      : "FogExp2" === e.fog.type &&
                        (r.fog = new $c(e.fog.color, e.fog.density)));
                break;
              case "PerspectiveCamera":
                (r = new Ns(e.fov, e.aspect, e.near, e.far)),
                  void 0 !== e.focus && (r.focus = e.focus),
                  void 0 !== e.zoom && (r.zoom = e.zoom),
                  void 0 !== e.filmGauge && (r.filmGauge = e.filmGauge),
                  void 0 !== e.filmOffset && (r.filmOffset = e.filmOffset),
                  void 0 !== e.view && (r.view = Object.assign({}, e.view));
                break;
              case "OrthographicCamera":
                (r = new Sp(e.left, e.right, e.top, e.bottom, e.near, e.far)),
                  void 0 !== e.zoom && (r.zoom = e.zoom),
                  void 0 !== e.view && (r.view = Object.assign({}, e.view));
                break;
              case "AmbientLight":
                r = new Pp(e.color, e.intensity);
                break;
              case "DirectionalLight":
                r = new Rp(e.color, e.intensity);
                break;
              case "PointLight":
                r = new Ap(e.color, e.intensity, e.distance, e.decay);
                break;
              case "RectAreaLight":
                r = new Ip(e.color, e.intensity, e.width, e.height);
                break;
              case "SpotLight":
                r = new Mp(
                  e.color,
                  e.intensity,
                  e.distance,
                  e.angle,
                  e.penumbra,
                  e.decay
                );
                break;
              case "HemisphereLight":
                r = new xp(e.color, e.groundColor, e.intensity);
                break;
              case "SkinnedMesh":
              case "Mesh":
                var o = i(e.geometry),
                  s = a(e.material);
                r = o.bones && o.bones.length > 0 ? new wu(o, s) : new ys(o, s);
                break;
              case "InstancedMesh":
                (o = i(e.geometry)), (s = a(e.material));
                var l = e.count,
                  c = e.instanceMatrix;
                (r = new Iu(o, s, l)).instanceMatrix = new No(
                  new Float32Array(c.array),
                  16
                );
                break;
              case "LOD":
                r = new xu();
                break;
              case "Line":
                r = new ku(i(e.geometry), a(e.material), e.mode);
                break;
              case "LineLoop":
                r = new zu(i(e.geometry), a(e.material));
                break;
              case "LineSegments":
                r = new Bu(i(e.geometry), a(e.material));
                break;
              case "PointCloud":
              case "Points":
                r = new Yu(i(e.geometry), a(e.material));
                break;
              case "Sprite":
                r = new vu(a(e.material));
                break;
              case "Group":
                r = new Hc();
                break;
              default:
                r = new Na();
            }
            if (
              ((r.uuid = e.uuid),
              void 0 !== e.name && (r.name = e.name),
              void 0 !== e.matrix
                ? (r.matrix.fromArray(e.matrix),
                  void 0 !== e.matrixAutoUpdate &&
                    (r.matrixAutoUpdate = e.matrixAutoUpdate),
                  r.matrixAutoUpdate &&
                    r.matrix.decompose(r.position, r.quaternion, r.scale))
                : (void 0 !== e.position && r.position.fromArray(e.position),
                  void 0 !== e.rotation && r.rotation.fromArray(e.rotation),
                  void 0 !== e.quaternion &&
                    r.quaternion.fromArray(e.quaternion),
                  void 0 !== e.scale && r.scale.fromArray(e.scale)),
              void 0 !== e.castShadow && (r.castShadow = e.castShadow),
              void 0 !== e.receiveShadow && (r.receiveShadow = e.receiveShadow),
              e.shadow &&
                (void 0 !== e.shadow.bias && (r.shadow.bias = e.shadow.bias),
                void 0 !== e.shadow.radius &&
                  (r.shadow.radius = e.shadow.radius),
                void 0 !== e.shadow.mapSize &&
                  r.shadow.mapSize.fromArray(e.shadow.mapSize),
                void 0 !== e.shadow.camera &&
                  (r.shadow.camera = this.parseObject(e.shadow.camera))),
              void 0 !== e.visible && (r.visible = e.visible),
              void 0 !== e.frustumCulled && (r.frustumCulled = e.frustumCulled),
              void 0 !== e.renderOrder && (r.renderOrder = e.renderOrder),
              void 0 !== e.userData && (r.userData = e.userData),
              void 0 !== e.layers && (r.layers.mask = e.layers),
              void 0 !== e.drawMode && r.setDrawMode(e.drawMode),
              void 0 !== e.children)
            )
              for (var u = e.children, h = 0; h < u.length; h++)
                r.add(this.parseObject(u[h], t, n));
            if ("LOD" === e.type) {
              void 0 !== e.autoUpdate && (r.autoUpdate = e.autoUpdate);
              for (var d = e.levels, p = 0; p < d.length; p++) {
                var f = d[p],
                  m = r.getObjectByProperty("uuid", f.object);
                void 0 !== m && r.addLevel(m, f.distance);
              }
            }
            return r;
          }
        });
        var Up,
          jp = {
            UVMapping: Bn,
            CubeReflectionMapping: zn,
            CubeRefractionMapping: Vn,
            EquirectangularReflectionMapping: Gn,
            EquirectangularRefractionMapping: Hn,
            SphericalReflectionMapping: Xn,
            CubeUVReflectionMapping: Wn,
            CubeUVRefractionMapping: Yn
          },
          Bp = {
            RepeatWrapping: qn,
            ClampToEdgeWrapping: Qn,
            MirroredRepeatWrapping: Zn
          },
          zp = {
            NearestFilter: Jn,
            NearestMipmapNearestFilter: Kn,
            NearestMipmapLinearFilter: er,
            LinearFilter: nr,
            LinearMipmapNearestFilter: rr,
            LinearMipmapLinearFilter: ar
          };
        function Vp(e) {
          zd.call(this, e), (this.options = void 0);
        }
        function Gp() {
          (this.type = "ShapePath"),
            (this.color = new Eo()),
            (this.subPaths = []),
            (this.currentPath = null);
        }
        function Hp(e) {
          (this.type = "Font"), (this.data = e);
        }
        function Xp(e, t, n, r, i) {
          var a = i.glyphs[e] || i.glyphs["?"];
          if (a) {
            var o,
              s,
              l,
              c,
              u,
              h,
              d,
              p,
              f = new Gp();
            if (a.o)
              for (
                var m = a._cachedOutline || (a._cachedOutline = a.o.split(" ")),
                  v = 0,
                  g = m.length;
                v < g;

              )
                switch (m[v++]) {
                  case "m":
                    (o = m[v++] * t + n), (s = m[v++] * t + r), f.moveTo(o, s);
                    break;
                  case "l":
                    (o = m[v++] * t + n), (s = m[v++] * t + r), f.lineTo(o, s);
                    break;
                  case "q":
                    (l = m[v++] * t + n),
                      (c = m[v++] * t + r),
                      (u = m[v++] * t + n),
                      (h = m[v++] * t + r),
                      f.quadraticCurveTo(u, h, l, c);
                    break;
                  case "b":
                    (l = m[v++] * t + n),
                      (c = m[v++] * t + r),
                      (u = m[v++] * t + n),
                      (h = m[v++] * t + r),
                      (d = m[v++] * t + n),
                      (p = m[v++] * t + r),
                      f.bezierCurveTo(u, h, d, p, l, c);
                }
            return { offsetX: a.ha * t, path: f };
          }
        }
        function Wp(e) {
          zd.call(this, e);
        }
        (Vp.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: Vp,
          setOptions: function(e) {
            return (this.options = e), this;
          },
          load: function(e, t, n, r) {
            void 0 === e && (e = ""),
              void 0 !== this.path && (e = this.path + e),
              (e = this.manager.resolveURL(e));
            var i = this,
              a = Ud.get(e);
            if (void 0 !== a)
              return (
                i.manager.itemStart(e),
                setTimeout(function() {
                  t && t(a), i.manager.itemEnd(e);
                }, 0),
                a
              );
            fetch(e)
              .then(function(e) {
                return e.blob();
              })
              .then(function(e) {
                return void 0 === i.options
                  ? createImageBitmap(e)
                  : createImageBitmap(e, i.options);
              })
              .then(function(n) {
                Ud.add(e, n), t && t(n), i.manager.itemEnd(e);
              })
              .catch(function(t) {
                r && r(t), i.manager.itemError(e), i.manager.itemEnd(e);
              }),
              i.manager.itemStart(e);
          }
        })),
          Object.assign(Gp.prototype, {
            moveTo: function(e, t) {
              return (
                (this.currentPath = new gp()),
                this.subPaths.push(this.currentPath),
                this.currentPath.moveTo(e, t),
                this
              );
            },
            lineTo: function(e, t) {
              return this.currentPath.lineTo(e, t), this;
            },
            quadraticCurveTo: function(e, t, n, r) {
              return this.currentPath.quadraticCurveTo(e, t, n, r), this;
            },
            bezierCurveTo: function(e, t, n, r, i, a) {
              return this.currentPath.bezierCurveTo(e, t, n, r, i, a), this;
            },
            splineThru: function(e) {
              return this.currentPath.splineThru(e), this;
            },
            toShapes: function(e, t) {
              function n(e) {
                for (var t = [], n = 0, r = e.length; n < r; n++) {
                  var i = e[n],
                    a = new yp();
                  (a.curves = i.curves), t.push(a);
                }
                return t;
              }
              function r(e, t) {
                for (
                  var n = t.length, r = !1, i = n - 1, a = 0;
                  a < n;
                  i = a++
                ) {
                  var o = t[i],
                    s = t[a],
                    l = s.x - o.x,
                    c = s.y - o.y;
                  if (Math.abs(c) > Number.EPSILON) {
                    if (
                      (c < 0 && ((o = t[a]), (l = -l), (s = t[i]), (c = -c)),
                      e.y < o.y || e.y > s.y)
                    )
                      continue;
                    if (e.y === o.y) {
                      if (e.x === o.x) return !0;
                    } else {
                      var u = c * (e.x - o.x) - l * (e.y - o.y);
                      if (0 === u) return !0;
                      if (u < 0) continue;
                      r = !r;
                    }
                  } else {
                    if (e.y !== o.y) continue;
                    if (
                      (s.x <= e.x && e.x <= o.x) ||
                      (o.x <= e.x && e.x <= s.x)
                    )
                      return !0;
                  }
                }
                return r;
              }
              var i = Bh.isClockWise,
                a = this.subPaths;
              if (0 === a.length) return [];
              if (!0 === t) return n(a);
              var o,
                s,
                l,
                c = [];
              if (1 === a.length)
                return (
                  (s = a[0]), ((l = new yp()).curves = s.curves), c.push(l), c
                );
              var u = !i(a[0].getPoints());
              u = e ? !u : u;
              var h,
                d,
                p = [],
                f = [],
                m = [],
                v = 0;
              (f[v] = void 0), (m[v] = []);
              for (var g = 0, y = a.length; g < y; g++)
                (o = i((h = (s = a[g]).getPoints()))),
                  (o = e ? !o : o)
                    ? (!u && f[v] && v++,
                      (f[v] = { s: new yp(), p: h }),
                      (f[v].s.curves = s.curves),
                      u && v++,
                      (m[v] = []))
                    : m[v].push({ h: s, p: h[0] });
              if (!f[0]) return n(a);
              if (f.length > 1) {
                for (var b = !1, x = [], w = 0, _ = f.length; w < _; w++)
                  p[w] = [];
                for (w = 0, _ = f.length; w < _; w++)
                  for (var M = m[w], T = 0; T < M.length; T++) {
                    for (var A = M[T], S = !0, E = 0; E < f.length; E++)
                      r(A.p, f[E].p) &&
                        (w !== E && x.push({ froms: w, tos: E, hole: T }),
                        S ? ((S = !1), p[E].push(A)) : (b = !0));
                    S && p[w].push(A);
                  }
                x.length > 0 && (b || (m = p));
              }
              g = 0;
              for (var R = f.length; g < R; g++) {
                (l = f[g].s), c.push(l);
                for (var P = 0, I = (d = m[g]).length; P < I; P++)
                  l.holes.push(d[P].h);
              }
              return c;
            }
          }),
          Object.assign(Hp.prototype, {
            isFont: !0,
            generateShapes: function(e, t) {
              void 0 === t && (t = 100);
              for (
                var n = [],
                  r = (function(e, t, n) {
                    for (
                      var r = Array.from ? Array.from(e) : String(e).split(""),
                        i = t / n.resolution,
                        a =
                          (n.boundingBox.yMax -
                            n.boundingBox.yMin +
                            n.underlineThickness) *
                          i,
                        o = [],
                        s = 0,
                        l = 0,
                        c = 0;
                      c < r.length;
                      c++
                    ) {
                      var u = r[c];
                      if ("\n" === u) (s = 0), (l -= a);
                      else {
                        var h = Xp(u, i, s, l, n);
                        (s += h.offsetX), o.push(h.path);
                      }
                    }
                    return o;
                  })(e, t, this.data),
                  i = 0,
                  a = r.length;
                i < a;
                i++
              )
                Array.prototype.push.apply(n, r[i].toShapes());
              return n;
            }
          }),
          (Wp.prototype = Object.assign(Object.create(zd.prototype), {
            constructor: Wp,
            load: function(e, t, n, r) {
              var i = this,
                a = new Gd(this.manager);
              a.setPath(this.path),
                a.load(
                  e,
                  function(e) {
                    var n;
                    try {
                      n = JSON.parse(e);
                    } catch (t) {
                      n = JSON.parse(e.substring(65, e.length - 2));
                    }
                    var r = i.parse(n);
                    t && t(r);
                  },
                  n,
                  r
                );
            },
            parse: function(e) {
              return new Hp(e);
            }
          }));
        var Yp = {
          getContext: function() {
            return (
              void 0 === Up &&
                (Up = new (window.AudioContext || window.webkitAudioContext)()),
              Up
            );
          },
          setContext: function(e) {
            Up = e;
          }
        };
        function qp(e) {
          zd.call(this, e);
        }
        function Qp() {
          this.coefficients = [];
          for (var e = 0; e < 9; e++) this.coefficients.push(new ea());
        }
        function Zp(e, t) {
          bp.call(this, void 0, t), (this.sh = void 0 !== e ? e : new Qp());
        }
        function Jp(e, t, n) {
          Zp.call(this, void 0, n);
          var r = new Eo().set(e),
            i = new Eo().set(t),
            a = new ea(r.r, r.g, r.b),
            o = new ea(i.r, i.g, i.b),
            s = Math.sqrt(Math.PI),
            l = s * Math.sqrt(0.75);
          this.sh.coefficients[0]
            .copy(a)
            .add(o)
            .multiplyScalar(s),
            this.sh.coefficients[1]
              .copy(a)
              .sub(o)
              .multiplyScalar(l);
        }
        function Kp(e, t) {
          Zp.call(this, void 0, t);
          var n = new Eo().set(e);
          this.sh.coefficients[0]
            .set(n.r, n.g, n.b)
            .multiplyScalar(2 * Math.sqrt(Math.PI));
        }
        (qp.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: qp,
          load: function(e, t, n, r) {
            var i = new Gd(this.manager);
            i.setResponseType("arraybuffer"),
              i.setPath(this.path),
              i.load(
                e,
                function(e) {
                  var n = e.slice(0);
                  Yp.getContext().decodeAudioData(n, function(e) {
                    t(e);
                  });
                },
                n,
                r
              );
          }
        })),
          Object.assign(Qp.prototype, {
            isSphericalHarmonics3: !0,
            set: function(e) {
              for (var t = 0; t < 9; t++) this.coefficients[t].copy(e[t]);
              return this;
            },
            zero: function() {
              for (var e = 0; e < 9; e++) this.coefficients[e].set(0, 0, 0);
              return this;
            },
            getAt: function(e, t) {
              var n = e.x,
                r = e.y,
                i = e.z,
                a = this.coefficients;
              return (
                t.copy(a[0]).multiplyScalar(0.282095),
                t.addScale(a[1], 0.488603 * r),
                t.addScale(a[2], 0.488603 * i),
                t.addScale(a[3], 0.488603 * n),
                t.addScale(a[4], n * r * 1.092548),
                t.addScale(a[5], r * i * 1.092548),
                t.addScale(a[6], 0.315392 * (3 * i * i - 1)),
                t.addScale(a[7], n * i * 1.092548),
                t.addScale(a[8], 0.546274 * (n * n - r * r)),
                t
              );
            },
            getIrradianceAt: function(e, t) {
              var n = e.x,
                r = e.y,
                i = e.z,
                a = this.coefficients;
              return (
                t.copy(a[0]).multiplyScalar(0.886227),
                t.addScale(a[1], 1.023328 * r),
                t.addScale(a[2], 1.023328 * i),
                t.addScale(a[3], 1.023328 * n),
                t.addScale(a[4], 0.858086 * n * r),
                t.addScale(a[5], 0.858086 * r * i),
                t.addScale(a[6], 0.743125 * i * i - 0.247708),
                t.addScale(a[7], 0.858086 * n * i),
                t.addScale(a[8], 0.429043 * (n * n - r * r)),
                t
              );
            },
            add: function(e) {
              for (var t = 0; t < 9; t++)
                this.coefficients[t].add(e.coefficients[t]);
              return this;
            },
            scale: function(e) {
              for (var t = 0; t < 9; t++)
                this.coefficients[t].multiplyScalar(e);
              return this;
            },
            lerp: function(e, t) {
              for (var n = 0; n < 9; n++)
                this.coefficients[n].lerp(e.coefficients[n], t);
              return this;
            },
            equals: function(e) {
              for (var t = 0; t < 9; t++)
                if (!this.coefficients[t].equals(e.coefficients[t])) return !1;
              return !0;
            },
            copy: function(e) {
              return this.set(e.coefficients);
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            fromArray: function(e, t) {
              void 0 === t && (t = 0);
              for (var n = this.coefficients, r = 0; r < 9; r++)
                n[r].fromArray(e, t + 3 * r);
              return this;
            },
            toArray: function(e, t) {
              void 0 === e && (e = []), void 0 === t && (t = 0);
              for (var n = this.coefficients, r = 0; r < 9; r++)
                n[r].toArray(e, t + 3 * r);
              return e;
            }
          }),
          Object.assign(Qp, {
            getBasisAt: function(e, t) {
              var n = e.x,
                r = e.y,
                i = e.z;
              (t[0] = 0.282095),
                (t[1] = 0.488603 * r),
                (t[2] = 0.488603 * i),
                (t[3] = 0.488603 * n),
                (t[4] = 1.092548 * n * r),
                (t[5] = 1.092548 * r * i),
                (t[6] = 0.315392 * (3 * i * i - 1)),
                (t[7] = 1.092548 * n * i),
                (t[8] = 0.546274 * (n * n - r * r));
            }
          }),
          (Zp.prototype = Object.assign(Object.create(bp.prototype), {
            constructor: Zp,
            isLightProbe: !0,
            copy: function(e) {
              return (
                bp.prototype.copy.call(this, e),
                this.sh.copy(e.sh),
                (this.intensity = e.intensity),
                this
              );
            },
            toJSON: function(e) {
              return bp.prototype.toJSON.call(this, e);
            }
          })),
          (Jp.prototype = Object.assign(Object.create(Zp.prototype), {
            constructor: Jp,
            isHemisphereLightProbe: !0,
            copy: function(e) {
              return Zp.prototype.copy.call(this, e), this;
            },
            toJSON: function(e) {
              return Zp.prototype.toJSON.call(this, e);
            }
          })),
          (Kp.prototype = Object.assign(Object.create(Zp.prototype), {
            constructor: Kp,
            isAmbientLightProbe: !0,
            copy: function(e) {
              return Zp.prototype.copy.call(this, e), this;
            },
            toJSON: function(e) {
              return Zp.prototype.toJSON.call(this, e);
            }
          }));
        var $p = new ga(),
          ef = new ga();
        function tf() {
          (this.type = "StereoCamera"),
            (this.aspect = 1),
            (this.eyeSep = 0.064),
            (this.cameraL = new Ns()),
            this.cameraL.layers.enable(1),
            (this.cameraL.matrixAutoUpdate = !1),
            (this.cameraR = new Ns()),
            this.cameraR.layers.enable(2),
            (this.cameraR.matrixAutoUpdate = !1),
            (this._cache = {
              focus: null,
              fov: null,
              aspect: null,
              near: null,
              far: null,
              zoom: null,
              eyeSep: null
            });
        }
        function nf(e) {
          (this.autoStart = void 0 === e || e),
            (this.startTime = 0),
            (this.oldTime = 0),
            (this.elapsedTime = 0),
            (this.running = !1);
        }
        Object.assign(tf.prototype, {
          update: function(e) {
            var t = this._cache;
            if (
              t.focus !== e.focus ||
              t.fov !== e.fov ||
              t.aspect !== e.aspect * this.aspect ||
              t.near !== e.near ||
              t.far !== e.far ||
              t.zoom !== e.zoom ||
              t.eyeSep !== this.eyeSep
            ) {
              (t.focus = e.focus),
                (t.fov = e.fov),
                (t.aspect = e.aspect * this.aspect),
                (t.near = e.near),
                (t.far = e.far),
                (t.zoom = e.zoom),
                (t.eyeSep = this.eyeSep);
              var n,
                r,
                i = e.projectionMatrix.clone(),
                a = t.eyeSep / 2,
                o = (a * t.near) / t.focus,
                s = (t.near * Math.tan(Qi.DEG2RAD * t.fov * 0.5)) / t.zoom;
              (ef.elements[12] = -a),
                ($p.elements[12] = a),
                (n = -s * t.aspect + o),
                (r = s * t.aspect + o),
                (i.elements[0] = (2 * t.near) / (r - n)),
                (i.elements[8] = (r + n) / (r - n)),
                this.cameraL.projectionMatrix.copy(i),
                (n = -s * t.aspect - o),
                (r = s * t.aspect - o),
                (i.elements[0] = (2 * t.near) / (r - n)),
                (i.elements[8] = (r + n) / (r - n)),
                this.cameraR.projectionMatrix.copy(i);
            }
            this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(ef),
              this.cameraR.matrixWorld.copy(e.matrixWorld).multiply($p);
          }
        }),
          Object.assign(nf.prototype, {
            start: function() {
              (this.startTime = ("undefined" == typeof performance
                ? Date
                : performance
              ).now()),
                (this.oldTime = this.startTime),
                (this.elapsedTime = 0),
                (this.running = !0);
            },
            stop: function() {
              this.getElapsedTime(), (this.running = !1), (this.autoStart = !1);
            },
            getElapsedTime: function() {
              return this.getDelta(), this.elapsedTime;
            },
            getDelta: function() {
              var e = 0;
              if (this.autoStart && !this.running) return this.start(), 0;
              if (this.running) {
                var t = ("undefined" == typeof performance
                  ? Date
                  : performance
                ).now();
                (e = (t - this.oldTime) / 1e3),
                  (this.oldTime = t),
                  (this.elapsedTime += e);
              }
              return e;
            }
          });
        var rf = new ea(),
          af = new Ji(),
          of = new ea(),
          sf = new ea();
        function lf() {
          Na.call(this),
            (this.type = "AudioListener"),
            (this.context = Yp.getContext()),
            (this.gain = this.context.createGain()),
            this.gain.connect(this.context.destination),
            (this.filter = null),
            (this.timeDelta = 0),
            (this._clock = new nf());
        }
        function cf(e) {
          Na.call(this),
            (this.type = "Audio"),
            (this.listener = e),
            (this.context = e.context),
            (this.gain = this.context.createGain()),
            this.gain.connect(e.getInput()),
            (this.autoplay = !1),
            (this.buffer = null),
            (this.detune = 0),
            (this.loop = !1),
            (this.loopStart = 0),
            (this.loopEnd = 0),
            (this.offset = 0),
            (this.duration = void 0),
            (this.playbackRate = 1),
            (this.isPlaying = !1),
            (this.hasPlaybackControl = !0),
            (this.sourceType = "empty"),
            (this._startedAt = 0),
            (this._pausedAt = 0),
            (this.filters = []);
        }
        (lf.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: lf,
          getInput: function() {
            return this.gain;
          },
          removeFilter: function() {
            return (
              null !== this.filter &&
                (this.gain.disconnect(this.filter),
                this.filter.disconnect(this.context.destination),
                this.gain.connect(this.context.destination),
                (this.filter = null)),
              this
            );
          },
          getFilter: function() {
            return this.filter;
          },
          setFilter: function(e) {
            return (
              null !== this.filter
                ? (this.gain.disconnect(this.filter),
                  this.filter.disconnect(this.context.destination))
                : this.gain.disconnect(this.context.destination),
              (this.filter = e),
              this.gain.connect(this.filter),
              this.filter.connect(this.context.destination),
              this
            );
          },
          getMasterVolume: function() {
            return this.gain.gain.value;
          },
          setMasterVolume: function(e) {
            return (
              this.gain.gain.setTargetAtTime(e, this.context.currentTime, 0.01),
              this
            );
          },
          updateMatrixWorld: function(e) {
            Na.prototype.updateMatrixWorld.call(this, e);
            var t = this.context.listener,
              n = this.up;
            if (
              ((this.timeDelta = this._clock.getDelta()),
              this.matrixWorld.decompose(rf, af, of),
              sf.set(0, 0, -1).applyQuaternion(af),
              t.positionX)
            ) {
              var r = this.context.currentTime + this.timeDelta;
              t.positionX.linearRampToValueAtTime(rf.x, r),
                t.positionY.linearRampToValueAtTime(rf.y, r),
                t.positionZ.linearRampToValueAtTime(rf.z, r),
                t.forwardX.linearRampToValueAtTime(sf.x, r),
                t.forwardY.linearRampToValueAtTime(sf.y, r),
                t.forwardZ.linearRampToValueAtTime(sf.z, r),
                t.upX.linearRampToValueAtTime(n.x, r),
                t.upY.linearRampToValueAtTime(n.y, r),
                t.upZ.linearRampToValueAtTime(n.z, r);
            } else
              t.setPosition(rf.x, rf.y, rf.z),
                t.setOrientation(sf.x, sf.y, sf.z, n.x, n.y, n.z);
          }
        })),
          (cf.prototype = Object.assign(Object.create(Na.prototype), {
            constructor: cf,
            getOutput: function() {
              return this.gain;
            },
            setNodeSource: function(e) {
              return (
                (this.hasPlaybackControl = !1),
                (this.sourceType = "audioNode"),
                (this.source = e),
                this.connect(),
                this
              );
            },
            setMediaElementSource: function(e) {
              return (
                (this.hasPlaybackControl = !1),
                (this.sourceType = "mediaNode"),
                (this.source = this.context.createMediaElementSource(e)),
                this.connect(),
                this
              );
            },
            setMediaStreamSource: function(e) {
              return (
                (this.hasPlaybackControl = !1),
                (this.sourceType = "mediaStreamNode"),
                (this.source = this.context.createMediaStreamSource(e)),
                this.connect(),
                this
              );
            },
            setBuffer: function(e) {
              return (
                (this.buffer = e),
                (this.sourceType = "buffer"),
                this.autoplay && this.play(),
                this
              );
            },
            play: function(e) {
              if (
                (void 0 === e && (e = 0),
                !0 !== this.isPlaying && !1 !== this.hasPlaybackControl)
              ) {
                this._startedAt = this.context.currentTime + e;
                var t = this.context.createBufferSource();
                return (
                  (t.buffer = this.buffer),
                  (t.loop = this.loop),
                  (t.loopStart = this.loopStart),
                  (t.loopEnd = this.loopEnd),
                  (t.onended = this.onEnded.bind(this)),
                  t.start(
                    this._startedAt,
                    this._pausedAt + this.offset,
                    this.duration
                  ),
                  (this.isPlaying = !0),
                  (this.source = t),
                  this.setDetune(this.detune),
                  this.setPlaybackRate(this.playbackRate),
                  this.connect()
                );
              }
            },
            pause: function() {
              if (!1 !== this.hasPlaybackControl)
                return (
                  !0 === this.isPlaying &&
                    ((this._pausedAt =
                      (this.context.currentTime - this._startedAt) *
                      this.playbackRate),
                    this.source.stop(),
                    (this.source.onended = null),
                    (this.isPlaying = !1)),
                  this
                );
            },
            stop: function() {
              if (!1 !== this.hasPlaybackControl)
                return (
                  (this._pausedAt = 0),
                  this.source.stop(),
                  (this.source.onended = null),
                  (this.isPlaying = !1),
                  this
                );
            },
            connect: function() {
              if (this.filters.length > 0) {
                this.source.connect(this.filters[0]);
                for (var e = 1, t = this.filters.length; e < t; e++)
                  this.filters[e - 1].connect(this.filters[e]);
                this.filters[this.filters.length - 1].connect(this.getOutput());
              } else this.source.connect(this.getOutput());
              return this;
            },
            disconnect: function() {
              if (this.filters.length > 0) {
                this.source.disconnect(this.filters[0]);
                for (var e = 1, t = this.filters.length; e < t; e++)
                  this.filters[e - 1].disconnect(this.filters[e]);
                this.filters[this.filters.length - 1].disconnect(
                  this.getOutput()
                );
              } else this.source.disconnect(this.getOutput());
              return this;
            },
            getFilters: function() {
              return this.filters;
            },
            setFilters: function(e) {
              return (
                e || (e = []),
                !0 === this.isPlaying
                  ? (this.disconnect(), (this.filters = e), this.connect())
                  : (this.filters = e),
                this
              );
            },
            setDetune: function(e) {
              if (((this.detune = e), void 0 !== this.source.detune))
                return (
                  !0 === this.isPlaying &&
                    this.source.detune.setTargetAtTime(
                      this.detune,
                      this.context.currentTime,
                      0.01
                    ),
                  this
                );
            },
            getDetune: function() {
              return this.detune;
            },
            getFilter: function() {
              return this.getFilters()[0];
            },
            setFilter: function(e) {
              return this.setFilters(e ? [e] : []);
            },
            setPlaybackRate: function(e) {
              if (!1 !== this.hasPlaybackControl)
                return (
                  (this.playbackRate = e),
                  !0 === this.isPlaying &&
                    this.source.playbackRate.setTargetAtTime(
                      this.playbackRate,
                      this.context.currentTime,
                      0.01
                    ),
                  this
                );
            },
            getPlaybackRate: function() {
              return this.playbackRate;
            },
            onEnded: function() {
              this.isPlaying = !1;
            },
            getLoop: function() {
              return !1 !== this.hasPlaybackControl && this.loop;
            },
            setLoop: function(e) {
              if (!1 !== this.hasPlaybackControl)
                return (
                  (this.loop = e),
                  !0 === this.isPlaying && (this.source.loop = this.loop),
                  this
                );
            },
            setLoopStart: function(e) {
              return (this.loopStart = e), this;
            },
            setLoopEnd: function(e) {
              return (this.loopEnd = e), this;
            },
            getVolume: function() {
              return this.gain.gain.value;
            },
            setVolume: function(e) {
              return (
                this.gain.gain.setTargetAtTime(
                  e,
                  this.context.currentTime,
                  0.01
                ),
                this
              );
            }
          }));
        var uf = new ea(),
          hf = new Ji(),
          df = new ea(),
          pf = new ea();
        function ff(e) {
          cf.call(this, e),
            (this.panner = this.context.createPanner()),
            (this.panner.panningModel = "HRTF"),
            this.panner.connect(this.gain);
        }
        function mf(e, t) {
          (this.analyser = e.context.createAnalyser()),
            (this.analyser.fftSize = void 0 !== t ? t : 2048),
            (this.data = new Uint8Array(this.analyser.frequencyBinCount)),
            e.getOutput().connect(this.analyser);
        }
        function vf(e, t, n) {
          (this.binding = e), (this.valueSize = n);
          var r,
            i = Float64Array;
          switch (t) {
            case "quaternion":
              r = this._slerp;
              break;
            case "string":
            case "bool":
              (i = Array), (r = this._select);
              break;
            default:
              r = this._lerp;
          }
          (this.buffer = new i(4 * n)),
            (this._mixBufferRegion = r),
            (this.cumulativeWeight = 0),
            (this.useCount = 0),
            (this.referenceCount = 0);
        }
        (ff.prototype = Object.assign(Object.create(cf.prototype), {
          constructor: ff,
          getOutput: function() {
            return this.panner;
          },
          getRefDistance: function() {
            return this.panner.refDistance;
          },
          setRefDistance: function(e) {
            return (this.panner.refDistance = e), this;
          },
          getRolloffFactor: function() {
            return this.panner.rolloffFactor;
          },
          setRolloffFactor: function(e) {
            return (this.panner.rolloffFactor = e), this;
          },
          getDistanceModel: function() {
            return this.panner.distanceModel;
          },
          setDistanceModel: function(e) {
            return (this.panner.distanceModel = e), this;
          },
          getMaxDistance: function() {
            return this.panner.maxDistance;
          },
          setMaxDistance: function(e) {
            return (this.panner.maxDistance = e), this;
          },
          setDirectionalCone: function(e, t, n) {
            return (
              (this.panner.coneInnerAngle = e),
              (this.panner.coneOuterAngle = t),
              (this.panner.coneOuterGain = n),
              this
            );
          },
          updateMatrixWorld: function(e) {
            if (
              (Na.prototype.updateMatrixWorld.call(this, e),
              !0 !== this.hasPlaybackControl || !1 !== this.isPlaying)
            ) {
              this.matrixWorld.decompose(uf, hf, df),
                pf.set(0, 0, 1).applyQuaternion(hf);
              var t = this.panner;
              if (t.positionX) {
                var n = this.context.currentTime + this.listener.timeDelta;
                t.positionX.linearRampToValueAtTime(uf.x, n),
                  t.positionY.linearRampToValueAtTime(uf.y, n),
                  t.positionZ.linearRampToValueAtTime(uf.z, n),
                  t.orientationX.linearRampToValueAtTime(pf.x, n),
                  t.orientationY.linearRampToValueAtTime(pf.y, n),
                  t.orientationZ.linearRampToValueAtTime(pf.z, n);
              } else
                t.setPosition(uf.x, uf.y, uf.z),
                  t.setOrientation(pf.x, pf.y, pf.z);
            }
          }
        })),
          Object.assign(mf.prototype, {
            getFrequencyData: function() {
              return this.analyser.getByteFrequencyData(this.data), this.data;
            },
            getAverageFrequency: function() {
              for (
                var e = 0, t = this.getFrequencyData(), n = 0;
                n < t.length;
                n++
              )
                e += t[n];
              return e / t.length;
            }
          }),
          Object.assign(vf.prototype, {
            accumulate: function(e, t) {
              var n = this.buffer,
                r = this.valueSize,
                i = e * r + r,
                a = this.cumulativeWeight;
              if (0 === a) {
                for (var o = 0; o !== r; ++o) n[i + o] = n[o];
                a = t;
              } else {
                var s = t / (a += t);
                this._mixBufferRegion(n, i, 0, s, r);
              }
              this.cumulativeWeight = a;
            },
            apply: function(e) {
              var t = this.valueSize,
                n = this.buffer,
                r = e * t + t,
                i = this.cumulativeWeight,
                a = this.binding;
              if (((this.cumulativeWeight = 0), i < 1)) {
                var o = 3 * t;
                this._mixBufferRegion(n, r, o, 1 - i, t);
              }
              for (var s = t, l = t + t; s !== l; ++s)
                if (n[s] !== n[s + t]) {
                  a.setValue(n, r);
                  break;
                }
            },
            saveOriginalState: function() {
              var e = this.binding,
                t = this.buffer,
                n = this.valueSize,
                r = 3 * n;
              e.getValue(t, r);
              for (var i = n, a = r; i !== a; ++i) t[i] = t[r + (i % n)];
              this.cumulativeWeight = 0;
            },
            restoreOriginalState: function() {
              var e = 3 * this.valueSize;
              this.binding.setValue(this.buffer, e);
            },
            _select: function(e, t, n, r, i) {
              if (r >= 0.5) for (var a = 0; a !== i; ++a) e[t + a] = e[n + a];
            },
            _slerp: function(e, t, n, r) {
              Ji.slerpFlat(e, t, e, t, e, n, r);
            },
            _lerp: function(e, t, n, r, i) {
              for (var a = 1 - r, o = 0; o !== i; ++o) {
                var s = t + o;
                e[s] = e[s] * a + e[n + o] * r;
              }
            }
          });
        var gf = new RegExp("[\\[\\]\\.:\\/]", "g"),
          yf = "[^" + "\\[\\]\\.:\\/".replace("\\.", "") + "]",
          bf = /((?:WC+[\/:])*)/.source.replace("WC", "[^\\[\\]\\.:\\/]"),
          xf = /(WCOD+)?/.source.replace("WCOD", yf),
          wf = /(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace(
            "WC",
            "[^\\[\\]\\.:\\/]"
          ),
          _f = /\.(WC+)(?:\[(.+)\])?/.source.replace("WC", "[^\\[\\]\\.:\\/]"),
          Mf = new RegExp("^" + bf + xf + wf + _f + "$"),
          Tf = ["material", "materials", "bones"];
        function Af(e, t, n) {
          var r = n || Sf.parseTrackName(t);
          (this._targetGroup = e), (this._bindings = e.subscribe_(t, r));
        }
        function Sf(e, t, n) {
          (this.path = t),
            (this.parsedPath = n || Sf.parseTrackName(t)),
            (this.node = Sf.findNode(e, this.parsedPath.nodeName) || e),
            (this.rootNode = e);
        }
        function Ef() {
          (this.uuid = Qi.generateUUID()),
            (this._objects = Array.prototype.slice.call(arguments)),
            (this.nCachedObjects_ = 0);
          var e = {};
          this._indicesByUUID = e;
          for (var t = 0, n = arguments.length; t !== n; ++t)
            e[arguments[t].uuid] = t;
          (this._paths = []),
            (this._parsedPaths = []),
            (this._bindings = []),
            (this._bindingsIndicesByPath = {});
          var r = this;
          this.stats = {
            objects: {
              get total() {
                return r._objects.length;
              },
              get inUse() {
                return this.total - r.nCachedObjects_;
              }
            },
            get bindingsPerObject() {
              return r._bindings.length;
            }
          };
        }
        function Rf(e, t, n) {
          (this._mixer = e), (this._clip = t), (this._localRoot = n || null);
          for (
            var r = t.tracks,
              i = r.length,
              a = new Array(i),
              o = { endingStart: ri, endingEnd: ri },
              s = 0;
            s !== i;
            ++s
          ) {
            var l = r[s].createInterpolant(null);
            (a[s] = l), (l.settings = o);
          }
          (this._interpolantSettings = o),
            (this._interpolants = a),
            (this._propertyBindings = new Array(i)),
            (this._cacheIndex = null),
            (this._byClipCacheIndex = null),
            (this._timeScaleInterpolant = null),
            (this._weightInterpolant = null),
            (this.loop = Kr),
            (this._loopCount = -1),
            (this._startTime = null),
            (this.time = 0),
            (this.timeScale = 1),
            (this._effectiveTimeScale = 1),
            (this.weight = 1),
            (this._effectiveWeight = 1),
            (this.repetitions = 1 / 0),
            (this.paused = !1),
            (this.enabled = !0),
            (this.clampWhenFinished = !1),
            (this.zeroSlopeAtStart = !0),
            (this.zeroSlopeAtEnd = !0);
        }
        function Pf(e) {
          (this._root = e),
            this._initMemoryManager(),
            (this._accuIndex = 0),
            (this.time = 0),
            (this.timeScale = 1);
        }
        function If(e) {
          "string" == typeof e && (e = arguments[1]), (this.value = e);
        }
        function Df(e, t, n) {
          tu.call(this, e, t), (this.meshPerAttribute = n || 1);
        }
        function Of(e, t, n, r) {
          (this.ray = new so(e, t)),
            (this.near = n || 0),
            (this.far = r || 1 / 0),
            (this.camera = null),
            (this.params = {
              Mesh: {},
              Line: {},
              LOD: {},
              Points: { threshold: 1 },
              Sprite: {}
            }),
            Object.defineProperties(this.params, {
              PointCloud: {
                get: function() {
                  return this.Points;
                }
              }
            });
        }
        function Cf(e, t) {
          return e.distance - t.distance;
        }
        function Lf(e, t, n, r) {
          if (!1 !== e.visible && (e.raycast(t, n), !0 === r))
            for (var i = e.children, a = 0, o = i.length; a < o; a++)
              Lf(i[a], t, n, !0);
        }
        function Nf(e, t, n) {
          return (
            (this.radius = void 0 !== e ? e : 1),
            (this.phi = void 0 !== t ? t : 0),
            (this.theta = void 0 !== n ? n : 0),
            this
          );
        }
        function Ff(e, t, n) {
          return (
            (this.radius = void 0 !== e ? e : 1),
            (this.theta = void 0 !== t ? t : 0),
            (this.y = void 0 !== n ? n : 0),
            this
          );
        }
        Object.assign(Af.prototype, {
          getValue: function(e, t) {
            this.bind();
            var n = this._targetGroup.nCachedObjects_,
              r = this._bindings[n];
            void 0 !== r && r.getValue(e, t);
          },
          setValue: function(e, t) {
            for (
              var n = this._bindings,
                r = this._targetGroup.nCachedObjects_,
                i = n.length;
              r !== i;
              ++r
            )
              n[r].setValue(e, t);
          },
          bind: function() {
            for (
              var e = this._bindings,
                t = this._targetGroup.nCachedObjects_,
                n = e.length;
              t !== n;
              ++t
            )
              e[t].bind();
          },
          unbind: function() {
            for (
              var e = this._bindings,
                t = this._targetGroup.nCachedObjects_,
                n = e.length;
              t !== n;
              ++t
            )
              e[t].unbind();
          }
        }),
          Object.assign(Sf, {
            Composite: Af,
            create: function(e, t, n) {
              return e && e.isAnimationObjectGroup
                ? new Sf.Composite(e, t, n)
                : new Sf(e, t, n);
            },
            sanitizeNodeName: function(e) {
              return e.replace(/\s/g, "_").replace(gf, "");
            },
            parseTrackName: function(e) {
              var t = Mf.exec(e);
              if (!t)
                throw new Error(
                  "PropertyBinding: Cannot parse trackName: " + e
                );
              var n = {
                  nodeName: t[2],
                  objectName: t[3],
                  objectIndex: t[4],
                  propertyName: t[5],
                  propertyIndex: t[6]
                },
                r = n.nodeName && n.nodeName.lastIndexOf(".");
              if (void 0 !== r && -1 !== r) {
                var i = n.nodeName.substring(r + 1);
                -1 !== Tf.indexOf(i) &&
                  ((n.nodeName = n.nodeName.substring(0, r)),
                  (n.objectName = i));
              }
              if (null === n.propertyName || 0 === n.propertyName.length)
                throw new Error(
                  "PropertyBinding: can not parse propertyName from trackName: " +
                    e
                );
              return n;
            },
            findNode: function(e, t) {
              if (
                !t ||
                "" === t ||
                "root" === t ||
                "." === t ||
                -1 === t ||
                t === e.name ||
                t === e.uuid
              )
                return e;
              if (e.skeleton) {
                var n = e.skeleton.getBoneByName(t);
                if (void 0 !== n) return n;
              }
              if (e.children) {
                var r = function(e) {
                    for (var n = 0; n < e.length; n++) {
                      var i = e[n];
                      if (i.name === t || i.uuid === t) return i;
                      var a = r(i.children);
                      if (a) return a;
                    }
                    return null;
                  },
                  i = r(e.children);
                if (i) return i;
              }
              return null;
            }
          }),
          Object.assign(Sf.prototype, {
            _getValue_unavailable: function() {},
            _setValue_unavailable: function() {},
            BindingType: {
              Direct: 0,
              EntireArray: 1,
              ArrayElement: 2,
              HasFromToArray: 3
            },
            Versioning: { None: 0, NeedsUpdate: 1, MatrixWorldNeedsUpdate: 2 },
            GetterByBindingType: [
              function(e, t) {
                e[t] = this.node[this.propertyName];
              },
              function(e, t) {
                for (
                  var n = this.resolvedProperty, r = 0, i = n.length;
                  r !== i;
                  ++r
                )
                  e[t++] = n[r];
              },
              function(e, t) {
                e[t] = this.resolvedProperty[this.propertyIndex];
              },
              function(e, t) {
                this.resolvedProperty.toArray(e, t);
              }
            ],
            SetterByBindingTypeAndVersioning: [
              [
                function(e, t) {
                  this.targetObject[this.propertyName] = e[t];
                },
                function(e, t) {
                  (this.targetObject[this.propertyName] = e[t]),
                    (this.targetObject.needsUpdate = !0);
                },
                function(e, t) {
                  (this.targetObject[this.propertyName] = e[t]),
                    (this.targetObject.matrixWorldNeedsUpdate = !0);
                }
              ],
              [
                function(e, t) {
                  for (
                    var n = this.resolvedProperty, r = 0, i = n.length;
                    r !== i;
                    ++r
                  )
                    n[r] = e[t++];
                },
                function(e, t) {
                  for (
                    var n = this.resolvedProperty, r = 0, i = n.length;
                    r !== i;
                    ++r
                  )
                    n[r] = e[t++];
                  this.targetObject.needsUpdate = !0;
                },
                function(e, t) {
                  for (
                    var n = this.resolvedProperty, r = 0, i = n.length;
                    r !== i;
                    ++r
                  )
                    n[r] = e[t++];
                  this.targetObject.matrixWorldNeedsUpdate = !0;
                }
              ],
              [
                function(e, t) {
                  this.resolvedProperty[this.propertyIndex] = e[t];
                },
                function(e, t) {
                  (this.resolvedProperty[this.propertyIndex] = e[t]),
                    (this.targetObject.needsUpdate = !0);
                },
                function(e, t) {
                  (this.resolvedProperty[this.propertyIndex] = e[t]),
                    (this.targetObject.matrixWorldNeedsUpdate = !0);
                }
              ],
              [
                function(e, t) {
                  this.resolvedProperty.fromArray(e, t);
                },
                function(e, t) {
                  this.resolvedProperty.fromArray(e, t),
                    (this.targetObject.needsUpdate = !0);
                },
                function(e, t) {
                  this.resolvedProperty.fromArray(e, t),
                    (this.targetObject.matrixWorldNeedsUpdate = !0);
                }
              ]
            ],
            getValue: function(e, t) {
              this.bind(), this.getValue(e, t);
            },
            setValue: function(e, t) {
              this.bind(), this.setValue(e, t);
            },
            bind: function() {
              var e = this.node,
                t = this.parsedPath,
                n = t.objectName,
                r = t.propertyName,
                i = t.propertyIndex;
              if (
                (e ||
                  ((e =
                    Sf.findNode(this.rootNode, t.nodeName) || this.rootNode),
                  (this.node = e)),
                (this.getValue = this._getValue_unavailable),
                (this.setValue = this._setValue_unavailable),
                e)
              ) {
                if (n) {
                  var a = t.objectIndex;
                  switch (n) {
                    case "materials":
                      if (!e.material) return;
                      if (!e.material.materials) return;
                      e = e.material.materials;
                      break;
                    case "bones":
                      if (!e.skeleton) return;
                      e = e.skeleton.bones;
                      for (var o = 0; o < e.length; o++)
                        if (e[o].name === a) {
                          a = o;
                          break;
                        }
                      break;
                    default:
                      if (void 0 === e[n]) return;
                      e = e[n];
                  }
                  if (void 0 !== a) {
                    if (void 0 === e[a]) return;
                    e = e[a];
                  }
                }
                var s = e[r];
                if (void 0 !== s) {
                  var l = this.Versioning.None;
                  (this.targetObject = e),
                    void 0 !== e.needsUpdate
                      ? (l = this.Versioning.NeedsUpdate)
                      : void 0 !== e.matrixWorldNeedsUpdate &&
                        (l = this.Versioning.MatrixWorldNeedsUpdate);
                  var c = this.BindingType.Direct;
                  if (void 0 !== i) {
                    if ("morphTargetInfluences" === r) {
                      if (!e.geometry) return;
                      if (e.geometry.isBufferGeometry) {
                        if (!e.geometry.morphAttributes) return;
                        for (
                          o = 0;
                          o <
                          this.node.geometry.morphAttributes.position.length;
                          o++
                        )
                          if (
                            e.geometry.morphAttributes.position[o].name === i
                          ) {
                            i = o;
                            break;
                          }
                      } else {
                        if (!e.geometry.morphTargets) return;
                        for (
                          o = 0;
                          o < this.node.geometry.morphTargets.length;
                          o++
                        )
                          if (e.geometry.morphTargets[o].name === i) {
                            i = o;
                            break;
                          }
                      }
                    }
                    (c = this.BindingType.ArrayElement),
                      (this.resolvedProperty = s),
                      (this.propertyIndex = i);
                  } else
                    void 0 !== s.fromArray && void 0 !== s.toArray
                      ? ((c = this.BindingType.HasFromToArray),
                        (this.resolvedProperty = s))
                      : Array.isArray(s)
                      ? ((c = this.BindingType.EntireArray),
                        (this.resolvedProperty = s))
                      : (this.propertyName = r);
                  (this.getValue = this.GetterByBindingType[c]),
                    (this.setValue = this.SetterByBindingTypeAndVersioning[c][
                      l
                    ]);
                } else t.nodeName;
              }
            },
            unbind: function() {
              (this.node = null),
                (this.getValue = this._getValue_unbound),
                (this.setValue = this._setValue_unbound);
            }
          }),
          Object.assign(Sf.prototype, {
            _getValue_unbound: Sf.prototype.getValue,
            _setValue_unbound: Sf.prototype.setValue
          }),
          Object.assign(Ef.prototype, {
            isAnimationObjectGroup: !0,
            add: function() {
              for (
                var e = this._objects,
                  t = e.length,
                  n = this.nCachedObjects_,
                  r = this._indicesByUUID,
                  i = this._paths,
                  a = this._parsedPaths,
                  o = this._bindings,
                  s = o.length,
                  l = 0,
                  c = arguments.length;
                l !== c;
                ++l
              ) {
                var u = arguments[l],
                  h = u.uuid,
                  d = r[h];
                if (void 0 === d) {
                  (d = t++), (r[h] = d), e.push(u);
                  for (var p = 0, f = s; p !== f; ++p)
                    o[p].push(new Sf(u, i[p], a[p]));
                } else if (d < n) {
                  e[d];
                  var m = --n,
                    v = e[m];
                  for (
                    r[v.uuid] = d, e[d] = v, r[h] = m, e[m] = u, p = 0, f = s;
                    p !== f;
                    ++p
                  ) {
                    var g = o[p],
                      y = g[m],
                      b = g[d];
                    (g[d] = y),
                      void 0 === b && (b = new Sf(u, i[p], a[p])),
                      (g[m] = b);
                  }
                } else e[d];
              }
              this.nCachedObjects_ = n;
            },
            remove: function() {
              for (
                var e = this._objects,
                  t = this.nCachedObjects_,
                  n = this._indicesByUUID,
                  r = this._bindings,
                  i = r.length,
                  a = 0,
                  o = arguments.length;
                a !== o;
                ++a
              ) {
                var s = arguments[a],
                  l = s.uuid,
                  c = n[l];
                if (void 0 !== c && c >= t) {
                  var u = t++,
                    h = e[u];
                  (n[h.uuid] = c), (e[c] = h), (n[l] = u), (e[u] = s);
                  for (var d = 0, p = i; d !== p; ++d) {
                    var f = r[d],
                      m = f[u],
                      v = f[c];
                    (f[c] = m), (f[u] = v);
                  }
                }
              }
              this.nCachedObjects_ = t;
            },
            uncache: function() {
              for (
                var e = this._objects,
                  t = e.length,
                  n = this.nCachedObjects_,
                  r = this._indicesByUUID,
                  i = this._bindings,
                  a = i.length,
                  o = 0,
                  s = arguments.length;
                o !== s;
                ++o
              ) {
                var l = arguments[o],
                  c = l.uuid,
                  u = r[c];
                if (void 0 !== u)
                  if ((delete r[c], u < n)) {
                    var h = --n,
                      d = e[h],
                      p = e[(y = --t)];
                    (r[d.uuid] = u),
                      (e[u] = d),
                      (r[p.uuid] = h),
                      (e[h] = p),
                      e.pop();
                    for (var f = 0, m = a; f !== m; ++f) {
                      var v = (b = i[f])[h],
                        g = b[y];
                      (b[u] = v), (b[h] = g), b.pop();
                    }
                  } else {
                    var y;
                    for (
                      r[(p = e[(y = --t)]).uuid] = u,
                        e[u] = p,
                        e.pop(),
                        f = 0,
                        m = a;
                      f !== m;
                      ++f
                    ) {
                      var b;
                      ((b = i[f])[u] = b[y]), b.pop();
                    }
                  }
              }
              this.nCachedObjects_ = n;
            },
            subscribe_: function(e, t) {
              var n = this._bindingsIndicesByPath,
                r = n[e],
                i = this._bindings;
              if (void 0 !== r) return i[r];
              var a = this._paths,
                o = this._parsedPaths,
                s = this._objects,
                l = s.length,
                c = this.nCachedObjects_,
                u = new Array(l);
              (r = i.length), (n[e] = r), a.push(e), o.push(t), i.push(u);
              for (var h = c, d = s.length; h !== d; ++h) {
                var p = s[h];
                u[h] = new Sf(p, e, t);
              }
              return u;
            },
            unsubscribe_: function(e) {
              var t = this._bindingsIndicesByPath,
                n = t[e];
              if (void 0 !== n) {
                var r = this._paths,
                  i = this._parsedPaths,
                  a = this._bindings,
                  o = a.length - 1,
                  s = a[o];
                (t[e[o]] = n),
                  (a[n] = s),
                  a.pop(),
                  (i[n] = i[o]),
                  i.pop(),
                  (r[n] = r[o]),
                  r.pop();
              }
            }
          }),
          Object.assign(Rf.prototype, {
            play: function() {
              return this._mixer._activateAction(this), this;
            },
            stop: function() {
              return this._mixer._deactivateAction(this), this.reset();
            },
            reset: function() {
              return (
                (this.paused = !1),
                (this.enabled = !0),
                (this.time = 0),
                (this._loopCount = -1),
                (this._startTime = null),
                this.stopFading().stopWarping()
              );
            },
            isRunning: function() {
              return (
                this.enabled &&
                !this.paused &&
                0 !== this.timeScale &&
                null === this._startTime &&
                this._mixer._isActiveAction(this)
              );
            },
            isScheduled: function() {
              return this._mixer._isActiveAction(this);
            },
            startAt: function(e) {
              return (this._startTime = e), this;
            },
            setLoop: function(e, t) {
              return (this.loop = e), (this.repetitions = t), this;
            },
            setEffectiveWeight: function(e) {
              return (
                (this.weight = e),
                (this._effectiveWeight = this.enabled ? e : 0),
                this.stopFading()
              );
            },
            getEffectiveWeight: function() {
              return this._effectiveWeight;
            },
            fadeIn: function(e) {
              return this._scheduleFading(e, 0, 1);
            },
            fadeOut: function(e) {
              return this._scheduleFading(e, 1, 0);
            },
            crossFadeFrom: function(e, t, n) {
              if ((e.fadeOut(t), this.fadeIn(t), n)) {
                var r = this._clip.duration,
                  i = e._clip.duration,
                  a = i / r,
                  o = r / i;
                e.warp(1, a, t), this.warp(o, 1, t);
              }
              return this;
            },
            crossFadeTo: function(e, t, n) {
              return e.crossFadeFrom(this, t, n);
            },
            stopFading: function() {
              var e = this._weightInterpolant;
              return (
                null !== e &&
                  ((this._weightInterpolant = null),
                  this._mixer._takeBackControlInterpolant(e)),
                this
              );
            },
            setEffectiveTimeScale: function(e) {
              return (
                (this.timeScale = e),
                (this._effectiveTimeScale = this.paused ? 0 : e),
                this.stopWarping()
              );
            },
            getEffectiveTimeScale: function() {
              return this._effectiveTimeScale;
            },
            setDuration: function(e) {
              return (
                (this.timeScale = this._clip.duration / e), this.stopWarping()
              );
            },
            syncWith: function(e) {
              return (
                (this.time = e.time),
                (this.timeScale = e.timeScale),
                this.stopWarping()
              );
            },
            halt: function(e) {
              return this.warp(this._effectiveTimeScale, 0, e);
            },
            warp: function(e, t, n) {
              var r = this._mixer,
                i = r.time,
                a = this._timeScaleInterpolant,
                o = this.timeScale;
              null === a &&
                ((a = r._lendControlInterpolant()),
                (this._timeScaleInterpolant = a));
              var s = a.parameterPositions,
                l = a.sampleValues;
              return (
                (s[0] = i), (s[1] = i + n), (l[0] = e / o), (l[1] = t / o), this
              );
            },
            stopWarping: function() {
              var e = this._timeScaleInterpolant;
              return (
                null !== e &&
                  ((this._timeScaleInterpolant = null),
                  this._mixer._takeBackControlInterpolant(e)),
                this
              );
            },
            getMixer: function() {
              return this._mixer;
            },
            getClip: function() {
              return this._clip;
            },
            getRoot: function() {
              return this._localRoot || this._mixer._root;
            },
            _update: function(e, t, n, r) {
              if (this.enabled) {
                var i = this._startTime;
                if (null !== i) {
                  var a = (e - i) * n;
                  if (a < 0 || 0 === n) return;
                  (this._startTime = null), (t = n * a);
                }
                t *= this._updateTimeScale(e);
                var o = this._updateTime(t),
                  s = this._updateWeight(e);
                if (s > 0)
                  for (
                    var l = this._interpolants,
                      c = this._propertyBindings,
                      u = 0,
                      h = l.length;
                    u !== h;
                    ++u
                  )
                    l[u].evaluate(o), c[u].accumulate(r, s);
              } else this._updateWeight(e);
            },
            _updateWeight: function(e) {
              var t = 0;
              if (this.enabled) {
                t = this.weight;
                var n = this._weightInterpolant;
                if (null !== n) {
                  var r = n.evaluate(e)[0];
                  (t *= r),
                    e > n.parameterPositions[1] &&
                      (this.stopFading(), 0 === r && (this.enabled = !1));
                }
              }
              return (this._effectiveWeight = t), t;
            },
            _updateTimeScale: function(e) {
              var t = 0;
              if (!this.paused) {
                t = this.timeScale;
                var n = this._timeScaleInterpolant;
                null !== n &&
                  ((t *= n.evaluate(e)[0]),
                  e > n.parameterPositions[1] &&
                    (this.stopWarping(),
                    0 === t ? (this.paused = !0) : (this.timeScale = t)));
              }
              return (this._effectiveTimeScale = t), t;
            },
            _updateTime: function(e) {
              var t = this.time + e,
                n = this._clip.duration,
                r = this.loop,
                i = this._loopCount,
                a = r === $r;
              if (0 === e) return -1 === i ? t : a && 1 == (1 & i) ? n - t : t;
              if (r === Jr) {
                -1 === i &&
                  ((this._loopCount = 0), this._setEndings(!0, !0, !1));
                e: {
                  if (t >= n) t = n;
                  else {
                    if (!(t < 0)) {
                      this.time = t;
                      break e;
                    }
                    t = 0;
                  }
                  this.clampWhenFinished
                    ? (this.paused = !0)
                    : (this.enabled = !1),
                    (this.time = t),
                    this._mixer.dispatchEvent({
                      type: "finished",
                      action: this,
                      direction: e < 0 ? -1 : 1
                    });
                }
              } else {
                if (
                  (-1 === i &&
                    (e >= 0
                      ? ((i = 0),
                        this._setEndings(!0, 0 === this.repetitions, a))
                      : this._setEndings(0 === this.repetitions, !0, a)),
                  t >= n || t < 0)
                ) {
                  var o = Math.floor(t / n);
                  (t -= n * o), (i += Math.abs(o));
                  var s = this.repetitions - i;
                  if (s <= 0)
                    this.clampWhenFinished
                      ? (this.paused = !0)
                      : (this.enabled = !1),
                      (t = e > 0 ? n : 0),
                      (this.time = t),
                      this._mixer.dispatchEvent({
                        type: "finished",
                        action: this,
                        direction: e > 0 ? 1 : -1
                      });
                  else {
                    if (1 === s) {
                      var l = e < 0;
                      this._setEndings(l, !l, a);
                    } else this._setEndings(!1, !1, a);
                    (this._loopCount = i),
                      (this.time = t),
                      this._mixer.dispatchEvent({
                        type: "loop",
                        action: this,
                        loopDelta: o
                      });
                  }
                } else this.time = t;
                if (a && 1 == (1 & i)) return n - t;
              }
              return t;
            },
            _setEndings: function(e, t, n) {
              var r = this._interpolantSettings;
              n
                ? ((r.endingStart = ii), (r.endingEnd = ii))
                : ((r.endingStart = e ? (this.zeroSlopeAtStart ? ii : ri) : ai),
                  (r.endingEnd = t ? (this.zeroSlopeAtEnd ? ii : ri) : ai));
            },
            _scheduleFading: function(e, t, n) {
              var r = this._mixer,
                i = r.time,
                a = this._weightInterpolant;
              null === a &&
                ((a = r._lendControlInterpolant()),
                (this._weightInterpolant = a));
              var o = a.parameterPositions,
                s = a.sampleValues;
              return (o[0] = i), (s[0] = t), (o[1] = i + e), (s[1] = n), this;
            }
          }),
          (Pf.prototype = Object.assign(Object.create(Wi.prototype), {
            constructor: Pf,
            _bindAction: function(e, t) {
              var n = e._localRoot || this._root,
                r = e._clip.tracks,
                i = r.length,
                a = e._propertyBindings,
                o = e._interpolants,
                s = n.uuid,
                l = this._bindingsByRootAndName,
                c = l[s];
              void 0 === c && ((c = {}), (l[s] = c));
              for (var u = 0; u !== i; ++u) {
                var h = r[u],
                  d = h.name,
                  p = c[d];
                if (void 0 !== p) a[u] = p;
                else {
                  if (void 0 !== (p = a[u])) {
                    null === p._cacheIndex &&
                      (++p.referenceCount, this._addInactiveBinding(p, s, d));
                    continue;
                  }
                  var f = t && t._propertyBindings[u].binding.parsedPath;
                  ++(p = new vf(
                    Sf.create(n, d, f),
                    h.ValueTypeName,
                    h.getValueSize()
                  )).referenceCount,
                    this._addInactiveBinding(p, s, d),
                    (a[u] = p);
                }
                o[u].resultBuffer = p.buffer;
              }
            },
            _activateAction: function(e) {
              if (!this._isActiveAction(e)) {
                if (null === e._cacheIndex) {
                  var t = (e._localRoot || this._root).uuid,
                    n = e._clip.uuid,
                    r = this._actionsByClip[n];
                  this._bindAction(e, r && r.knownActions[0]),
                    this._addInactiveAction(e, n, t);
                }
                for (
                  var i = e._propertyBindings, a = 0, o = i.length;
                  a !== o;
                  ++a
                ) {
                  var s = i[a];
                  0 == s.useCount++ &&
                    (this._lendBinding(s), s.saveOriginalState());
                }
                this._lendAction(e);
              }
            },
            _deactivateAction: function(e) {
              if (this._isActiveAction(e)) {
                for (
                  var t = e._propertyBindings, n = 0, r = t.length;
                  n !== r;
                  ++n
                ) {
                  var i = t[n];
                  0 == --i.useCount &&
                    (i.restoreOriginalState(), this._takeBackBinding(i));
                }
                this._takeBackAction(e);
              }
            },
            _initMemoryManager: function() {
              (this._actions = []),
                (this._nActiveActions = 0),
                (this._actionsByClip = {}),
                (this._bindings = []),
                (this._nActiveBindings = 0),
                (this._bindingsByRootAndName = {}),
                (this._controlInterpolants = []),
                (this._nActiveControlInterpolants = 0);
              var e = this;
              this.stats = {
                actions: {
                  get total() {
                    return e._actions.length;
                  },
                  get inUse() {
                    return e._nActiveActions;
                  }
                },
                bindings: {
                  get total() {
                    return e._bindings.length;
                  },
                  get inUse() {
                    return e._nActiveBindings;
                  }
                },
                controlInterpolants: {
                  get total() {
                    return e._controlInterpolants.length;
                  },
                  get inUse() {
                    return e._nActiveControlInterpolants;
                  }
                }
              };
            },
            _isActiveAction: function(e) {
              var t = e._cacheIndex;
              return null !== t && t < this._nActiveActions;
            },
            _addInactiveAction: function(e, t, n) {
              var r = this._actions,
                i = this._actionsByClip,
                a = i[t];
              if (void 0 === a)
                (a = { knownActions: [e], actionByRoot: {} }),
                  (e._byClipCacheIndex = 0),
                  (i[t] = a);
              else {
                var o = a.knownActions;
                (e._byClipCacheIndex = o.length), o.push(e);
              }
              (e._cacheIndex = r.length), r.push(e), (a.actionByRoot[n] = e);
            },
            _removeInactiveAction: function(e) {
              var t = this._actions,
                n = t[t.length - 1],
                r = e._cacheIndex;
              (n._cacheIndex = r), (t[r] = n), t.pop(), (e._cacheIndex = null);
              var i = e._clip.uuid,
                a = this._actionsByClip,
                o = a[i],
                s = o.knownActions,
                l = s[s.length - 1],
                c = e._byClipCacheIndex;
              (l._byClipCacheIndex = c),
                (s[c] = l),
                s.pop(),
                (e._byClipCacheIndex = null),
                delete o.actionByRoot[(e._localRoot || this._root).uuid],
                0 === s.length && delete a[i],
                this._removeInactiveBindingsForAction(e);
            },
            _removeInactiveBindingsForAction: function(e) {
              for (
                var t = e._propertyBindings, n = 0, r = t.length;
                n !== r;
                ++n
              ) {
                var i = t[n];
                0 == --i.referenceCount && this._removeInactiveBinding(i);
              }
            },
            _lendAction: function(e) {
              var t = this._actions,
                n = e._cacheIndex,
                r = this._nActiveActions++,
                i = t[r];
              (e._cacheIndex = r), (t[r] = e), (i._cacheIndex = n), (t[n] = i);
            },
            _takeBackAction: function(e) {
              var t = this._actions,
                n = e._cacheIndex,
                r = --this._nActiveActions,
                i = t[r];
              (e._cacheIndex = r), (t[r] = e), (i._cacheIndex = n), (t[n] = i);
            },
            _addInactiveBinding: function(e, t, n) {
              var r = this._bindingsByRootAndName,
                i = r[t],
                a = this._bindings;
              void 0 === i && ((i = {}), (r[t] = i)),
                (i[n] = e),
                (e._cacheIndex = a.length),
                a.push(e);
            },
            _removeInactiveBinding: function(e) {
              var t = this._bindings,
                n = e.binding,
                r = n.rootNode.uuid,
                i = n.path,
                a = this._bindingsByRootAndName,
                o = a[r],
                s = t[t.length - 1],
                l = e._cacheIndex;
              (s._cacheIndex = l),
                (t[l] = s),
                t.pop(),
                delete o[i],
                0 === Object.keys(o).length && delete a[r];
            },
            _lendBinding: function(e) {
              var t = this._bindings,
                n = e._cacheIndex,
                r = this._nActiveBindings++,
                i = t[r];
              (e._cacheIndex = r), (t[r] = e), (i._cacheIndex = n), (t[n] = i);
            },
            _takeBackBinding: function(e) {
              var t = this._bindings,
                n = e._cacheIndex,
                r = --this._nActiveBindings,
                i = t[r];
              (e._cacheIndex = r), (t[r] = e), (i._cacheIndex = n), (t[n] = i);
            },
            _lendControlInterpolant: function() {
              var e = this._controlInterpolants,
                t = this._nActiveControlInterpolants++,
                n = e[t];
              return (
                void 0 === n &&
                  (((n = new Sd(
                    new Float32Array(2),
                    new Float32Array(2),
                    1,
                    this._controlInterpolantsResultBuffer
                  )).__cacheIndex = t),
                  (e[t] = n)),
                n
              );
            },
            _takeBackControlInterpolant: function(e) {
              var t = this._controlInterpolants,
                n = e.__cacheIndex,
                r = --this._nActiveControlInterpolants,
                i = t[r];
              (e.__cacheIndex = r),
                (t[r] = e),
                (i.__cacheIndex = n),
                (t[n] = i);
            },
            _controlInterpolantsResultBuffer: new Float32Array(1),
            clipAction: function(e, t) {
              var n = t || this._root,
                r = n.uuid,
                i = "string" == typeof e ? Fd.findByName(n, e) : e,
                a = null !== i ? i.uuid : e,
                o = this._actionsByClip[a],
                s = null;
              if (void 0 !== o) {
                var l = o.actionByRoot[r];
                if (void 0 !== l) return l;
                (s = o.knownActions[0]), null === i && (i = s._clip);
              }
              if (null === i) return null;
              var c = new Rf(this, i, t);
              return (
                this._bindAction(c, s), this._addInactiveAction(c, a, r), c
              );
            },
            existingAction: function(e, t) {
              var n = t || this._root,
                r = n.uuid,
                i = "string" == typeof e ? Fd.findByName(n, e) : e,
                a = i ? i.uuid : e,
                o = this._actionsByClip[a];
              return (void 0 !== o && o.actionByRoot[r]) || null;
            },
            stopAllAction: function() {
              var e = this._actions,
                t = this._nActiveActions,
                n = this._bindings,
                r = this._nActiveBindings;
              (this._nActiveActions = 0), (this._nActiveBindings = 0);
              for (var i = 0; i !== t; ++i) e[i].reset();
              for (i = 0; i !== r; ++i) n[i].useCount = 0;
              return this;
            },
            update: function(e) {
              e *= this.timeScale;
              for (
                var t = this._actions,
                  n = this._nActiveActions,
                  r = (this.time += e),
                  i = Math.sign(e),
                  a = (this._accuIndex ^= 1),
                  o = 0;
                o !== n;
                ++o
              )
                t[o]._update(r, e, i, a);
              var s = this._bindings,
                l = this._nActiveBindings;
              for (o = 0; o !== l; ++o) s[o].apply(a);
              return this;
            },
            setTime: function(e) {
              this.time = 0;
              for (var t = 0; t < this._actions.length; t++)
                this._actions[t].time = 0;
              return this.update(e);
            },
            getRoot: function() {
              return this._root;
            },
            uncacheClip: function(e) {
              var t = this._actions,
                n = e.uuid,
                r = this._actionsByClip,
                i = r[n];
              if (void 0 !== i) {
                for (
                  var a = i.knownActions, o = 0, s = a.length;
                  o !== s;
                  ++o
                ) {
                  var l = a[o];
                  this._deactivateAction(l);
                  var c = l._cacheIndex,
                    u = t[t.length - 1];
                  (l._cacheIndex = null),
                    (l._byClipCacheIndex = null),
                    (u._cacheIndex = c),
                    (t[c] = u),
                    t.pop(),
                    this._removeInactiveBindingsForAction(l);
                }
                delete r[n];
              }
            },
            uncacheRoot: function(e) {
              var t = e.uuid,
                n = this._actionsByClip;
              for (var r in n) {
                var i = n[r].actionByRoot[t];
                void 0 !== i &&
                  (this._deactivateAction(i), this._removeInactiveAction(i));
              }
              var a = this._bindingsByRootAndName[t];
              if (void 0 !== a)
                for (var o in a) {
                  var s = a[o];
                  s.restoreOriginalState(), this._removeInactiveBinding(s);
                }
            },
            uncacheAction: function(e, t) {
              var n = this.existingAction(e, t);
              null !== n &&
                (this._deactivateAction(n), this._removeInactiveAction(n));
            }
          })),
          (If.prototype.clone = function() {
            return new If(
              void 0 === this.value.clone ? this.value : this.value.clone()
            );
          }),
          (Df.prototype = Object.assign(Object.create(tu.prototype), {
            constructor: Df,
            isInstancedInterleavedBuffer: !0,
            copy: function(e) {
              return (
                tu.prototype.copy.call(this, e),
                (this.meshPerAttribute = e.meshPerAttribute),
                this
              );
            }
          })),
          Object.assign(Of.prototype, {
            linePrecision: 1,
            set: function(e, t) {
              this.ray.set(e, t);
            },
            setFromCamera: function(e, t) {
              t && t.isPerspectiveCamera
                ? (this.ray.origin.setFromMatrixPosition(t.matrixWorld),
                  this.ray.direction
                    .set(e.x, e.y, 0.5)
                    .unproject(t)
                    .sub(this.ray.origin)
                    .normalize(),
                  (this.camera = t))
                : t &&
                  t.isOrthographicCamera &&
                  (this.ray.origin
                    .set(e.x, e.y, (t.near + t.far) / (t.near - t.far))
                    .unproject(t),
                  this.ray.direction
                    .set(0, 0, -1)
                    .transformDirection(t.matrixWorld),
                  (this.camera = t));
            },
            intersectObject: function(e, t, n) {
              var r = n || [];
              return Lf(e, this, r, t), r.sort(Cf), r;
            },
            intersectObjects: function(e, t, n) {
              var r = n || [];
              if (!1 === Array.isArray(e)) return r;
              for (var i = 0, a = e.length; i < a; i++) Lf(e[i], this, r, t);
              return r.sort(Cf), r;
            }
          }),
          Object.assign(Nf.prototype, {
            set: function(e, t, n) {
              return (this.radius = e), (this.phi = t), (this.theta = n), this;
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return (
                (this.radius = e.radius),
                (this.phi = e.phi),
                (this.theta = e.theta),
                this
              );
            },
            makeSafe: function() {
              return (
                (this.phi = Math.max(1e-6, Math.min(Math.PI - 1e-6, this.phi))),
                this
              );
            },
            setFromVector3: function(e) {
              return this.setFromCartesianCoords(e.x, e.y, e.z);
            },
            setFromCartesianCoords: function(e, t, n) {
              return (
                (this.radius = Math.sqrt(e * e + t * t + n * n)),
                0 === this.radius
                  ? ((this.theta = 0), (this.phi = 0))
                  : ((this.theta = Math.atan2(e, n)),
                    (this.phi = Math.acos(Qi.clamp(t / this.radius, -1, 1)))),
                this
              );
            }
          }),
          Object.assign(Ff.prototype, {
            set: function(e, t, n) {
              return (this.radius = e), (this.theta = t), (this.y = n), this;
            },
            clone: function() {
              return new this.constructor().copy(this);
            },
            copy: function(e) {
              return (
                (this.radius = e.radius),
                (this.theta = e.theta),
                (this.y = e.y),
                this
              );
            },
            setFromVector3: function(e) {
              return this.setFromCartesianCoords(e.x, e.y, e.z);
            },
            setFromCartesianCoords: function(e, t, n) {
              return (
                (this.radius = Math.sqrt(e * e + n * n)),
                (this.theta = Math.atan2(e, n)),
                (this.y = t),
                this
              );
            }
          });
        var kf = new Zi();
        function Uf(e, t) {
          (this.min = void 0 !== e ? e : new Zi(1 / 0, 1 / 0)),
            (this.max = void 0 !== t ? t : new Zi(-1 / 0, -1 / 0));
        }
        Object.assign(Uf.prototype, {
          set: function(e, t) {
            return this.min.copy(e), this.max.copy(t), this;
          },
          setFromPoints: function(e) {
            this.makeEmpty();
            for (var t = 0, n = e.length; t < n; t++) this.expandByPoint(e[t]);
            return this;
          },
          setFromCenterAndSize: function(e, t) {
            var n = kf.copy(t).multiplyScalar(0.5);
            return this.min.copy(e).sub(n), this.max.copy(e).add(n), this;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return this.min.copy(e.min), this.max.copy(e.max), this;
          },
          makeEmpty: function() {
            return (
              (this.min.x = this.min.y = 1 / 0),
              (this.max.x = this.max.y = -1 / 0),
              this
            );
          },
          isEmpty: function() {
            return this.max.x < this.min.x || this.max.y < this.min.y;
          },
          getCenter: function(e) {
            return (
              void 0 === e && (e = new Zi()),
              this.isEmpty()
                ? e.set(0, 0)
                : e.addVectors(this.min, this.max).multiplyScalar(0.5)
            );
          },
          getSize: function(e) {
            return (
              void 0 === e && (e = new Zi()),
              this.isEmpty() ? e.set(0, 0) : e.subVectors(this.max, this.min)
            );
          },
          expandByPoint: function(e) {
            return this.min.min(e), this.max.max(e), this;
          },
          expandByVector: function(e) {
            return this.min.sub(e), this.max.add(e), this;
          },
          expandByScalar: function(e) {
            return this.min.addScalar(-e), this.max.addScalar(e), this;
          },
          containsPoint: function(e) {
            return !(
              e.x < this.min.x ||
              e.x > this.max.x ||
              e.y < this.min.y ||
              e.y > this.max.y
            );
          },
          containsBox: function(e) {
            return (
              this.min.x <= e.min.x &&
              e.max.x <= this.max.x &&
              this.min.y <= e.min.y &&
              e.max.y <= this.max.y
            );
          },
          getParameter: function(e, t) {
            return (
              void 0 === t && (t = new Zi()),
              t.set(
                (e.x - this.min.x) / (this.max.x - this.min.x),
                (e.y - this.min.y) / (this.max.y - this.min.y)
              )
            );
          },
          intersectsBox: function(e) {
            return !(
              e.max.x < this.min.x ||
              e.min.x > this.max.x ||
              e.max.y < this.min.y ||
              e.min.y > this.max.y
            );
          },
          clampPoint: function(e, t) {
            return (
              void 0 === t && (t = new Zi()),
              t.copy(e).clamp(this.min, this.max)
            );
          },
          distanceToPoint: function(e) {
            return kf
              .copy(e)
              .clamp(this.min, this.max)
              .sub(e)
              .length();
          },
          intersect: function(e) {
            return this.min.max(e.min), this.max.min(e.max), this;
          },
          union: function(e) {
            return this.min.min(e.min), this.max.max(e.max), this;
          },
          translate: function(e) {
            return this.min.add(e), this.max.add(e), this;
          },
          equals: function(e) {
            return e.min.equals(this.min) && e.max.equals(this.max);
          }
        });
        var jf = new ea(),
          Bf = new ea();
        function zf(e, t) {
          (this.start = void 0 !== e ? e : new ea()),
            (this.end = void 0 !== t ? t : new ea());
        }
        function Vf(e) {
          Na.call(this), (this.material = e), (this.render = function() {});
        }
        Object.assign(zf.prototype, {
          set: function(e, t) {
            return this.start.copy(e), this.end.copy(t), this;
          },
          clone: function() {
            return new this.constructor().copy(this);
          },
          copy: function(e) {
            return this.start.copy(e.start), this.end.copy(e.end), this;
          },
          getCenter: function(e) {
            return (
              void 0 === e && (e = new ea()),
              e.addVectors(this.start, this.end).multiplyScalar(0.5)
            );
          },
          delta: function(e) {
            return (
              void 0 === e && (e = new ea()), e.subVectors(this.end, this.start)
            );
          },
          distanceSq: function() {
            return this.start.distanceToSquared(this.end);
          },
          distance: function() {
            return this.start.distanceTo(this.end);
          },
          at: function(e, t) {
            return (
              void 0 === t && (t = new ea()),
              this.delta(t)
                .multiplyScalar(e)
                .add(this.start)
            );
          },
          closestPointToPointParameter: function(e, t) {
            jf.subVectors(e, this.start), Bf.subVectors(this.end, this.start);
            var n = Bf.dot(Bf),
              r = Bf.dot(jf) / n;
            return t && (r = Qi.clamp(r, 0, 1)), r;
          },
          closestPointToPoint: function(e, t, n) {
            var r = this.closestPointToPointParameter(e, t);
            return (
              void 0 === n && (n = new ea()),
              this.delta(n)
                .multiplyScalar(r)
                .add(this.start)
            );
          },
          applyMatrix4: function(e) {
            return this.start.applyMatrix4(e), this.end.applyMatrix4(e), this;
          },
          equals: function(e) {
            return e.start.equals(this.start) && e.end.equals(this.end);
          }
        }),
          (Vf.prototype = Object.create(Na.prototype)),
          (Vf.prototype.constructor = Vf),
          (Vf.prototype.isImmediateRenderObject = !0);
        var Gf = new ea(),
          Hf = new ea(),
          Xf = new ra(),
          Wf = ["a", "b", "c"];
        function Yf(e, t, n, r) {
          (this.object = e), (this.size = void 0 !== t ? t : 1);
          var i = void 0 !== n ? n : 16711680,
            a = void 0 !== r ? r : 1,
            o = 0,
            s = this.object.geometry;
          s && s.isGeometry
            ? (o = 3 * s.faces.length)
            : s && s.isBufferGeometry && (o = s.attributes.normal.count);
          var l = new es(),
            c = new Go(2 * o * 3, 3);
          l.setAttribute("position", c),
            Bu.call(this, l, new Du({ color: i, linewidth: a })),
            (this.matrixAutoUpdate = !1),
            this.update();
        }
        (Yf.prototype = Object.create(Bu.prototype)),
          (Yf.prototype.constructor = Yf),
          (Yf.prototype.update = function() {
            this.object.updateMatrixWorld(!0),
              Xf.getNormalMatrix(this.object.matrixWorld);
            var e = this.object.matrixWorld,
              t = this.geometry.attributes.position,
              n = this.object.geometry;
            if (n && n.isGeometry)
              for (
                var r = n.vertices, i = n.faces, a = 0, o = 0, s = i.length;
                o < s;
                o++
              )
                for (
                  var l = i[o], c = 0, u = l.vertexNormals.length;
                  c < u;
                  c++
                ) {
                  var h = r[l[Wf[c]]],
                    d = l.vertexNormals[c];
                  Gf.copy(h).applyMatrix4(e),
                    Hf.copy(d)
                      .applyMatrix3(Xf)
                      .normalize()
                      .multiplyScalar(this.size)
                      .add(Gf),
                    t.setXYZ(a, Gf.x, Gf.y, Gf.z),
                    (a += 1),
                    t.setXYZ(a, Hf.x, Hf.y, Hf.z),
                    (a += 1);
                }
            else if (n && n.isBufferGeometry) {
              var p = n.attributes.position,
                f = n.attributes.normal;
              for (a = 0, c = 0, u = p.count; c < u; c++)
                Gf.set(p.getX(c), p.getY(c), p.getZ(c)).applyMatrix4(e),
                  Hf.set(f.getX(c), f.getY(c), f.getZ(c)),
                  Hf.applyMatrix3(Xf)
                    .normalize()
                    .multiplyScalar(this.size)
                    .add(Gf),
                  t.setXYZ(a, Gf.x, Gf.y, Gf.z),
                  (a += 1),
                  t.setXYZ(a, Hf.x, Hf.y, Hf.z),
                  (a += 1);
            }
            t.needsUpdate = !0;
          });
        var qf = new ea();
        function Qf(e, t) {
          Na.call(this),
            (this.light = e),
            this.light.updateMatrixWorld(),
            (this.matrix = e.matrixWorld),
            (this.matrixAutoUpdate = !1),
            (this.color = t);
          for (
            var n = new es(),
              r = [
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0,
                0,
                -1,
                0,
                1,
                0,
                0,
                0,
                0,
                1,
                1,
                0,
                0,
                0,
                0,
                -1,
                1
              ],
              i = 0,
              a = 1;
            i < 32;
            i++, a++
          ) {
            var o = (i / 32) * Math.PI * 2,
              s = (a / 32) * Math.PI * 2;
            r.push(Math.cos(o), Math.sin(o), 1, Math.cos(s), Math.sin(s), 1);
          }
          n.setAttribute("position", new Go(r, 3));
          var l = new Du({ fog: !1 });
          (this.cone = new Bu(n, l)), this.add(this.cone), this.update();
        }
        (Qf.prototype = Object.create(Na.prototype)),
          (Qf.prototype.constructor = Qf),
          (Qf.prototype.dispose = function() {
            this.cone.geometry.dispose(), this.cone.material.dispose();
          }),
          (Qf.prototype.update = function() {
            this.light.updateMatrixWorld();
            var e = this.light.distance ? this.light.distance : 1e3,
              t = e * Math.tan(this.light.angle);
            this.cone.scale.set(t, t, e),
              qf.setFromMatrixPosition(this.light.target.matrixWorld),
              this.cone.lookAt(qf),
              void 0 !== this.color
                ? this.cone.material.color.set(this.color)
                : this.cone.material.color.copy(this.light.color);
          });
        var Zf = new ea(),
          Jf = new ga(),
          Kf = new ga();
        function $f(e) {
          for (
            var t = (function e(t) {
                var n = [];
                t && t.isBone && n.push(t);
                for (var r = 0; r < t.children.length; r++)
                  n.push.apply(n, e(t.children[r]));
                return n;
              })(e),
              n = new es(),
              r = [],
              i = [],
              a = new Eo(0, 0, 1),
              o = new Eo(0, 1, 0),
              s = 0;
            s < t.length;
            s++
          ) {
            var l = t[s];
            l.parent &&
              l.parent.isBone &&
              (r.push(0, 0, 0),
              r.push(0, 0, 0),
              i.push(a.r, a.g, a.b),
              i.push(o.r, o.g, o.b));
          }
          n.setAttribute("position", new Go(r, 3)),
            n.setAttribute("color", new Go(i, 3));
          var c = new Du({
            vertexColors: $t,
            depthTest: !1,
            depthWrite: !1,
            transparent: !0
          });
          Bu.call(this, n, c),
            (this.root = e),
            (this.bones = t),
            (this.matrix = e.matrixWorld),
            (this.matrixAutoUpdate = !1);
        }
        function em(e, t, n) {
          (this.light = e), this.light.updateMatrixWorld(), (this.color = n);
          var r = new Zh(t, 4, 2),
            i = new Lo({ wireframe: !0, fog: !1 });
          ys.call(this, r, i),
            (this.matrix = this.light.matrixWorld),
            (this.matrixAutoUpdate = !1),
            this.update();
        }
        function tm(e, t) {
          (this.type = "RectAreaLightHelper"),
            (this.light = e),
            (this.color = t);
          var n = new es();
          n.setAttribute(
            "position",
            new Go([1, 1, 0, -1, 1, 0, -1, -1, 0, 1, -1, 0, 1, 1, 0], 3)
          ),
            n.computeBoundingSphere();
          var r = new Du({ fog: !1 });
          ku.call(this, n, r);
          var i = new es();
          i.setAttribute(
            "position",
            new Go(
              [1, 1, 0, -1, 1, 0, -1, -1, 0, 1, 1, 0, -1, -1, 0, 1, -1, 0],
              3
            )
          ),
            i.computeBoundingSphere(),
            this.add(new ys(i, new Lo({ side: Yt, fog: !1 }))),
            this.update();
        }
        ($f.prototype = Object.create(Bu.prototype)),
          ($f.prototype.constructor = $f),
          ($f.prototype.updateMatrixWorld = function(e) {
            var t = this.bones,
              n = this.geometry,
              r = n.getAttribute("position");
            Kf.getInverse(this.root.matrixWorld);
            for (var i = 0, a = 0; i < t.length; i++) {
              var o = t[i];
              o.parent &&
                o.parent.isBone &&
                (Jf.multiplyMatrices(Kf, o.matrixWorld),
                Zf.setFromMatrixPosition(Jf),
                r.setXYZ(a, Zf.x, Zf.y, Zf.z),
                Jf.multiplyMatrices(Kf, o.parent.matrixWorld),
                Zf.setFromMatrixPosition(Jf),
                r.setXYZ(a + 1, Zf.x, Zf.y, Zf.z),
                (a += 2));
            }
            (n.getAttribute("position").needsUpdate = !0),
              Na.prototype.updateMatrixWorld.call(this, e);
          }),
          (em.prototype = Object.create(ys.prototype)),
          (em.prototype.constructor = em),
          (em.prototype.dispose = function() {
            this.geometry.dispose(), this.material.dispose();
          }),
          (em.prototype.update = function() {
            void 0 !== this.color
              ? this.material.color.set(this.color)
              : this.material.color.copy(this.light.color);
          }),
          (tm.prototype = Object.create(ku.prototype)),
          (tm.prototype.constructor = tm),
          (tm.prototype.update = function() {
            if (
              (this.scale.set(
                0.5 * this.light.width,
                0.5 * this.light.height,
                1
              ),
              void 0 !== this.color)
            )
              this.material.color.set(this.color),
                this.children[0].material.color.set(this.color);
            else {
              this.material.color
                .copy(this.light.color)
                .multiplyScalar(this.light.intensity);
              var e = this.material.color,
                t = Math.max(e.r, e.g, e.b);
              t > 1 && e.multiplyScalar(1 / t),
                this.children[0].material.color.copy(this.material.color);
            }
          }),
          (tm.prototype.dispose = function() {
            this.geometry.dispose(),
              this.material.dispose(),
              this.children[0].geometry.dispose(),
              this.children[0].material.dispose();
          });
        var nm = new ea(),
          rm = new Eo(),
          im = new Eo();
        function am(e, t, n) {
          Na.call(this),
            (this.light = e),
            this.light.updateMatrixWorld(),
            (this.matrix = e.matrixWorld),
            (this.matrixAutoUpdate = !1),
            (this.color = n);
          var r = new sh(t);
          r.rotateY(0.5 * Math.PI),
            (this.material = new Lo({ wireframe: !0, fog: !1 })),
            void 0 === this.color && (this.material.vertexColors = $t);
          var i = r.getAttribute("position"),
            a = new Float32Array(3 * i.count);
          r.setAttribute("color", new No(a, 3)),
            this.add(new ys(r, this.material)),
            this.update();
        }
        function om(e, t) {
          (this.lightProbe = e), (this.size = t);
          var n = { GAMMA_OUTPUT: "" },
            r = new Cs({
              defines: n,
              uniforms: {
                sh: { value: this.lightProbe.sh.coefficients },
                intensity: { value: this.lightProbe.intensity }
              },
              vertexShader: [
                "varying vec3 vNormal;",
                "void main() {",
                "\tvNormal = normalize( normalMatrix * normal );",
                "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
                "}"
              ].join("\n"),
              fragmentShader: [
                "#define RECIPROCAL_PI 0.318309886",
                "vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {",
                "\t// matrix is assumed to be orthogonal",
                "\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );",
                "}",
                "vec3 linearToOutput( in vec3 a ) {",
                "\t#ifdef GAMMA_OUTPUT",
                "\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );",
                "\t#else",
                "\t\treturn a;",
                "\t#endif",
                "}",
                "// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf",
                "vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {",
                "\t// normal is assumed to have unit length",
                "\tfloat x = normal.x, y = normal.y, z = normal.z;",
                "\t// band 0",
                "\tvec3 result = shCoefficients[ 0 ] * 0.886227;",
                "\t// band 1",
                "\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;",
                "\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;",
                "\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;",
                "\t// band 2",
                "\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;",
                "\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;",
                "\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );",
                "\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;",
                "\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );",
                "\treturn result;",
                "}",
                "uniform vec3 sh[ 9 ]; // sh coefficients",
                "uniform float intensity; // light probe intensity",
                "varying vec3 vNormal;",
                "void main() {",
                "\tvec3 normal = normalize( vNormal );",
                "\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );",
                "\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );",
                "\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;",
                "\toutgoingLight = linearToOutput( outgoingLight );",
                "\tgl_FragColor = vec4( outgoingLight, 1.0 );",
                "}"
              ].join("\n")
            }),
            i = new Zh(1, 32, 16);
          ys.call(this, i, r), this.onBeforeRender();
        }
        function sm(e, t, n, r) {
          (e = e || 10),
            (t = t || 10),
            (n = new Eo(void 0 !== n ? n : 4473924)),
            (r = new Eo(void 0 !== r ? r : 8947848));
          for (
            var i = t / 2,
              a = e / t,
              o = e / 2,
              s = [],
              l = [],
              c = 0,
              u = 0,
              h = -o;
            c <= t;
            c++, h += a
          ) {
            s.push(-o, 0, h, o, 0, h), s.push(h, 0, -o, h, 0, o);
            var d = c === i ? n : r;
            d.toArray(l, u),
              (u += 3),
              d.toArray(l, u),
              (u += 3),
              d.toArray(l, u),
              (u += 3),
              d.toArray(l, u),
              (u += 3);
          }
          var p = new es();
          p.setAttribute("position", new Go(s, 3)),
            p.setAttribute("color", new Go(l, 3));
          var f = new Du({ vertexColors: $t });
          Bu.call(this, p, f);
        }
        function lm(e, t, n, r, i, a) {
          (e = e || 10),
            (t = t || 16),
            (n = n || 8),
            (r = r || 64),
            (i = new Eo(void 0 !== i ? i : 4473924)),
            (a = new Eo(void 0 !== a ? a : 8947848));
          var o,
            s,
            l,
            c,
            u,
            h,
            d,
            p = [],
            f = [];
          for (c = 0; c <= t; c++)
            (l = (c / t) * (2 * Math.PI)),
              (o = Math.sin(l) * e),
              (s = Math.cos(l) * e),
              p.push(0, 0, 0),
              p.push(o, 0, s),
              (d = 1 & c ? i : a),
              f.push(d.r, d.g, d.b),
              f.push(d.r, d.g, d.b);
          for (c = 0; c <= n; c++)
            for (d = 1 & c ? i : a, h = e - (e / n) * c, u = 0; u < r; u++)
              (l = (u / r) * (2 * Math.PI)),
                (o = Math.sin(l) * h),
                (s = Math.cos(l) * h),
                p.push(o, 0, s),
                f.push(d.r, d.g, d.b),
                (l = ((u + 1) / r) * (2 * Math.PI)),
                (o = Math.sin(l) * h),
                (s = Math.cos(l) * h),
                p.push(o, 0, s),
                f.push(d.r, d.g, d.b);
          var m = new es();
          m.setAttribute("position", new Go(p, 3)),
            m.setAttribute("color", new Go(f, 3));
          var v = new Du({ vertexColors: $t });
          Bu.call(this, m, v);
        }
        function cm(e, t, n, r) {
          (this.audio = e),
            (this.range = t || 1),
            (this.divisionsInnerAngle = n || 16),
            (this.divisionsOuterAngle = r || 2);
          var i = new es(),
            a = this.divisionsInnerAngle + 2 * this.divisionsOuterAngle,
            o = new Float32Array(3 * (3 * a + 3));
          i.setAttribute("position", new No(o, 3));
          var s = new Du({ color: 65280 }),
            l = new Du({ color: 16776960 });
          ku.call(this, i, [l, s]), this.update();
        }
        (am.prototype = Object.create(Na.prototype)),
          (am.prototype.constructor = am),
          (am.prototype.dispose = function() {
            this.children[0].geometry.dispose(),
              this.children[0].material.dispose();
          }),
          (am.prototype.update = function() {
            var e = this.children[0];
            if (void 0 !== this.color) this.material.color.set(this.color);
            else {
              var t = e.geometry.getAttribute("color");
              rm.copy(this.light.color), im.copy(this.light.groundColor);
              for (var n = 0, r = t.count; n < r; n++) {
                var i = n < r / 2 ? rm : im;
                t.setXYZ(n, i.r, i.g, i.b);
              }
              t.needsUpdate = !0;
            }
            e.lookAt(nm.setFromMatrixPosition(this.light.matrixWorld).negate());
          }),
          (om.prototype = Object.create(ys.prototype)),
          (om.prototype.constructor = om),
          (om.prototype.dispose = function() {
            this.geometry.dispose(), this.material.dispose();
          }),
          (om.prototype.onBeforeRender = function() {
            this.position.copy(this.lightProbe.position),
              this.scale.set(1, 1, 1).multiplyScalar(this.size),
              (this.material.uniforms.intensity.value = this.lightProbe.intensity);
          }),
          (sm.prototype = Object.assign(Object.create(Bu.prototype), {
            constructor: sm,
            copy: function(e) {
              return (
                Bu.prototype.copy.call(this, e),
                this.geometry.copy(e.geometry),
                this.material.copy(e.material),
                this
              );
            },
            clone: function() {
              return new this.constructor().copy(this);
            }
          })),
          (lm.prototype = Object.create(Bu.prototype)),
          (lm.prototype.constructor = lm),
          (cm.prototype = Object.create(ku.prototype)),
          (cm.prototype.constructor = cm),
          (cm.prototype.update = function() {
            var e,
              t,
              n = this.audio,
              r = this.range,
              i = this.divisionsInnerAngle,
              a = this.divisionsOuterAngle,
              o = Qi.degToRad(n.panner.coneInnerAngle),
              s = Qi.degToRad(n.panner.coneOuterAngle),
              l = o / 2,
              c = s / 2,
              u = 0,
              h = 0,
              d = this.geometry,
              p = d.attributes.position;
            function f(n, i, a, o) {
              var s = (i - n) / a;
              for (p.setXYZ(u, 0, 0, 0), h++, e = n; e < i; e += s)
                (t = u + h),
                  p.setXYZ(t, Math.sin(e) * r, 0, Math.cos(e) * r),
                  p.setXYZ(
                    t + 1,
                    Math.sin(Math.min(e + s, i)) * r,
                    0,
                    Math.cos(Math.min(e + s, i)) * r
                  ),
                  p.setXYZ(t + 2, 0, 0, 0),
                  (h += 3);
              d.addGroup(u, h, o), (u += h), (h = 0);
            }
            d.clearGroups(),
              f(-c, -l, a, 0),
              f(-l, l, i, 1),
              f(l, c, a, 0),
              (p.needsUpdate = !0),
              o === s && (this.material[0].visible = !1);
          }),
          (cm.prototype.dispose = function() {
            this.geometry.dispose(),
              this.material[0].dispose(),
              this.material[1].dispose();
          });
        var um = new ea(),
          hm = new ea(),
          dm = new ra();
        function pm(e, t, n, r) {
          (this.object = e), (this.size = void 0 !== t ? t : 1);
          var i = void 0 !== n ? n : 16776960,
            a = void 0 !== r ? r : 1,
            o = 0,
            s = this.object.geometry;
          s && s.isGeometry && (o = s.faces.length);
          var l = new es(),
            c = new Go(2 * o * 3, 3);
          l.setAttribute("position", c),
            Bu.call(this, l, new Du({ color: i, linewidth: a })),
            (this.matrixAutoUpdate = !1),
            this.update();
        }
        (pm.prototype = Object.create(Bu.prototype)),
          (pm.prototype.constructor = pm),
          (pm.prototype.update = function() {
            this.object.updateMatrixWorld(!0),
              dm.getNormalMatrix(this.object.matrixWorld);
            for (
              var e = this.object.matrixWorld,
                t = this.geometry.attributes.position,
                n = this.object.geometry,
                r = n.vertices,
                i = n.faces,
                a = 0,
                o = 0,
                s = i.length;
              o < s;
              o++
            ) {
              var l = i[o],
                c = l.normal;
              um
                .copy(r[l.a])
                .add(r[l.b])
                .add(r[l.c])
                .divideScalar(3)
                .applyMatrix4(e),
                hm
                  .copy(c)
                  .applyMatrix3(dm)
                  .normalize()
                  .multiplyScalar(this.size)
                  .add(um),
                t.setXYZ(a, um.x, um.y, um.z),
                (a += 1),
                t.setXYZ(a, hm.x, hm.y, hm.z),
                (a += 1);
            }
            t.needsUpdate = !0;
          });
        var fm = new ea(),
          mm = new ea(),
          vm = new ea();
        function gm(e, t, n) {
          Na.call(this),
            (this.light = e),
            this.light.updateMatrixWorld(),
            (this.matrix = e.matrixWorld),
            (this.matrixAutoUpdate = !1),
            (this.color = n),
            void 0 === t && (t = 1);
          var r = new es();
          r.setAttribute(
            "position",
            new Go([-t, t, 0, t, t, 0, t, -t, 0, -t, -t, 0, -t, t, 0], 3)
          );
          var i = new Du({ fog: !1 });
          (this.lightPlane = new ku(r, i)),
            this.add(this.lightPlane),
            (r = new es()).setAttribute(
              "position",
              new Go([0, 0, 0, 0, 0, 1], 3)
            ),
            (this.targetLine = new ku(r, i)),
            this.add(this.targetLine),
            this.update();
        }
        (gm.prototype = Object.create(Na.prototype)),
          (gm.prototype.constructor = gm),
          (gm.prototype.dispose = function() {
            this.lightPlane.geometry.dispose(),
              this.lightPlane.material.dispose(),
              this.targetLine.geometry.dispose(),
              this.targetLine.material.dispose();
          }),
          (gm.prototype.update = function() {
            fm.setFromMatrixPosition(this.light.matrixWorld),
              mm.setFromMatrixPosition(this.light.target.matrixWorld),
              vm.subVectors(mm, fm),
              this.lightPlane.lookAt(mm),
              void 0 !== this.color
                ? (this.lightPlane.material.color.set(this.color),
                  this.targetLine.material.color.set(this.color))
                : (this.lightPlane.material.color.copy(this.light.color),
                  this.targetLine.material.color.copy(this.light.color)),
              this.targetLine.lookAt(mm),
              (this.targetLine.scale.z = vm.length());
          });
        var ym = new ea(),
          bm = new Ls();
        function xm(e) {
          var t = new es(),
            n = new Du({ color: 16777215, vertexColors: Kt }),
            r = [],
            i = [],
            a = {},
            o = new Eo(16755200),
            s = new Eo(16711680),
            l = new Eo(43775),
            c = new Eo(16777215),
            u = new Eo(3355443);
          function h(e, t, n) {
            d(e, n), d(t, n);
          }
          function d(e, t) {
            r.push(0, 0, 0),
              i.push(t.r, t.g, t.b),
              void 0 === a[e] && (a[e] = []),
              a[e].push(r.length / 3 - 1);
          }
          h("n1", "n2", o),
            h("n2", "n4", o),
            h("n4", "n3", o),
            h("n3", "n1", o),
            h("f1", "f2", o),
            h("f2", "f4", o),
            h("f4", "f3", o),
            h("f3", "f1", o),
            h("n1", "f1", o),
            h("n2", "f2", o),
            h("n3", "f3", o),
            h("n4", "f4", o),
            h("p", "n1", s),
            h("p", "n2", s),
            h("p", "n3", s),
            h("p", "n4", s),
            h("u1", "u2", l),
            h("u2", "u3", l),
            h("u3", "u1", l),
            h("c", "t", c),
            h("p", "c", u),
            h("cn1", "cn2", u),
            h("cn3", "cn4", u),
            h("cf1", "cf2", u),
            h("cf3", "cf4", u),
            t.setAttribute("position", new Go(r, 3)),
            t.setAttribute("color", new Go(i, 3)),
            Bu.call(this, t, n),
            (this.camera = e),
            this.camera.updateProjectionMatrix &&
              this.camera.updateProjectionMatrix(),
            (this.matrix = e.matrixWorld),
            (this.matrixAutoUpdate = !1),
            (this.pointMap = a),
            this.update();
        }
        function wm(e, t, n, r, i, a, o) {
          ym.set(i, a, o).unproject(r);
          var s = t[e];
          if (void 0 !== s)
            for (
              var l = n.getAttribute("position"), c = 0, u = s.length;
              c < u;
              c++
            )
              l.setXYZ(s[c], ym.x, ym.y, ym.z);
        }
        (xm.prototype = Object.create(Bu.prototype)),
          (xm.prototype.constructor = xm),
          (xm.prototype.update = function() {
            var e = this.geometry,
              t = this.pointMap;
            bm.projectionMatrixInverse.copy(
              this.camera.projectionMatrixInverse
            ),
              wm("c", t, e, bm, 0, 0, -1),
              wm("t", t, e, bm, 0, 0, 1),
              wm("n1", t, e, bm, -1, -1, -1),
              wm("n2", t, e, bm, 1, -1, -1),
              wm("n3", t, e, bm, -1, 1, -1),
              wm("n4", t, e, bm, 1, 1, -1),
              wm("f1", t, e, bm, -1, -1, 1),
              wm("f2", t, e, bm, 1, -1, 1),
              wm("f3", t, e, bm, -1, 1, 1),
              wm("f4", t, e, bm, 1, 1, 1),
              wm("u1", t, e, bm, 0.7, 1.1, -1),
              wm("u2", t, e, bm, -0.7, 1.1, -1),
              wm("u3", t, e, bm, 0, 2, -1),
              wm("cf1", t, e, bm, -1, 0, 1),
              wm("cf2", t, e, bm, 1, 0, 1),
              wm("cf3", t, e, bm, 0, -1, 1),
              wm("cf4", t, e, bm, 0, 1, 1),
              wm("cn1", t, e, bm, -1, 0, -1),
              wm("cn2", t, e, bm, 1, 0, -1),
              wm("cn3", t, e, bm, 0, -1, -1),
              wm("cn4", t, e, bm, 0, 1, -1),
              (e.getAttribute("position").needsUpdate = !0);
          });
        var _m = new Za();
        function Mm(e, t) {
          (this.object = e), void 0 === t && (t = 16776960);
          var n = new Uint16Array([
              0,
              1,
              1,
              2,
              2,
              3,
              3,
              0,
              4,
              5,
              5,
              6,
              6,
              7,
              7,
              4,
              0,
              4,
              1,
              5,
              2,
              6,
              3,
              7
            ]),
            r = new Float32Array(24),
            i = new es();
          i.setIndex(new No(n, 1)),
            i.setAttribute("position", new No(r, 3)),
            Bu.call(this, i, new Du({ color: t })),
            (this.matrixAutoUpdate = !1),
            this.update();
        }
        function Tm(e, t) {
          (this.type = "Box3Helper"), (this.box = e), (t = t || 16776960);
          var n = new Uint16Array([
              0,
              1,
              1,
              2,
              2,
              3,
              3,
              0,
              4,
              5,
              5,
              6,
              6,
              7,
              7,
              4,
              0,
              4,
              1,
              5,
              2,
              6,
              3,
              7
            ]),
            r = new es();
          r.setIndex(new No(n, 1)),
            r.setAttribute(
              "position",
              new Go(
                [
                  1,
                  1,
                  1,
                  -1,
                  1,
                  1,
                  -1,
                  -1,
                  1,
                  1,
                  -1,
                  1,
                  1,
                  1,
                  -1,
                  -1,
                  1,
                  -1,
                  -1,
                  -1,
                  -1,
                  1,
                  -1,
                  -1
                ],
                3
              )
            ),
            Bu.call(this, r, new Du({ color: t })),
            this.geometry.computeBoundingSphere();
        }
        function Am(e, t, n) {
          (this.type = "PlaneHelper"),
            (this.plane = e),
            (this.size = void 0 === t ? 1 : t);
          var r = void 0 !== n ? n : 16776960,
            i = new es();
          i.setAttribute(
            "position",
            new Go(
              [
                1,
                -1,
                1,
                -1,
                1,
                1,
                -1,
                -1,
                1,
                1,
                1,
                1,
                -1,
                1,
                1,
                -1,
                -1,
                1,
                1,
                -1,
                1,
                1,
                1,
                1,
                0,
                0,
                1,
                0,
                0,
                0
              ],
              3
            )
          ),
            i.computeBoundingSphere(),
            ku.call(this, i, new Du({ color: r }));
          var a = new es();
          a.setAttribute(
            "position",
            new Go(
              [1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1],
              3
            )
          ),
            a.computeBoundingSphere(),
            this.add(
              new ys(
                a,
                new Lo({
                  color: r,
                  opacity: 0.2,
                  transparent: !0,
                  depthWrite: !1
                })
              )
            );
        }
        (Mm.prototype = Object.create(Bu.prototype)),
          (Mm.prototype.constructor = Mm),
          (Mm.prototype.update = function(e) {
            if (
              (void 0 !== this.object && _m.setFromObject(this.object),
              !_m.isEmpty())
            ) {
              var t = _m.min,
                n = _m.max,
                r = this.geometry.attributes.position,
                i = r.array;
              (i[0] = n.x),
                (i[1] = n.y),
                (i[2] = n.z),
                (i[3] = t.x),
                (i[4] = n.y),
                (i[5] = n.z),
                (i[6] = t.x),
                (i[7] = t.y),
                (i[8] = n.z),
                (i[9] = n.x),
                (i[10] = t.y),
                (i[11] = n.z),
                (i[12] = n.x),
                (i[13] = n.y),
                (i[14] = t.z),
                (i[15] = t.x),
                (i[16] = n.y),
                (i[17] = t.z),
                (i[18] = t.x),
                (i[19] = t.y),
                (i[20] = t.z),
                (i[21] = n.x),
                (i[22] = t.y),
                (i[23] = t.z),
                (r.needsUpdate = !0),
                this.geometry.computeBoundingSphere();
            }
          }),
          (Mm.prototype.setFromObject = function(e) {
            return (this.object = e), this.update(), this;
          }),
          (Mm.prototype.copy = function(e) {
            return (
              Bu.prototype.copy.call(this, e), (this.object = e.object), this
            );
          }),
          (Mm.prototype.clone = function() {
            return new this.constructor().copy(this);
          }),
          (Tm.prototype = Object.create(Bu.prototype)),
          (Tm.prototype.constructor = Tm),
          (Tm.prototype.updateMatrixWorld = function(e) {
            var t = this.box;
            t.isEmpty() ||
              (t.getCenter(this.position),
              t.getSize(this.scale),
              this.scale.multiplyScalar(0.5),
              Na.prototype.updateMatrixWorld.call(this, e));
          }),
          (Am.prototype = Object.create(ku.prototype)),
          (Am.prototype.constructor = Am),
          (Am.prototype.updateMatrixWorld = function(e) {
            var t = -this.plane.constant;
            Math.abs(t) < 1e-8 && (t = 1e-8),
              this.scale.set(0.5 * this.size, 0.5 * this.size, t),
              (this.children[0].material.side = t < 0 ? Yt : Wt),
              this.lookAt(this.plane.normal),
              Na.prototype.updateMatrixWorld.call(this, e);
          });
        var Sm,
          Em,
          Rm = new ea();
        function Pm(e, t, n, r, i, a) {
          Na.call(this),
            void 0 === e && (e = new ea(0, 0, 1)),
            void 0 === t && (t = new ea(0, 0, 0)),
            void 0 === n && (n = 1),
            void 0 === r && (r = 16776960),
            void 0 === i && (i = 0.2 * n),
            void 0 === a && (a = 0.2 * i),
            void 0 === Sm &&
              ((Sm = new es()).setAttribute(
                "position",
                new Go([0, 0, 0, 0, 1, 0], 3)
              ),
              (Em = new od(0, 0.5, 1, 5, 1)).translate(0, -0.5, 0)),
            this.position.copy(t),
            (this.line = new ku(Sm, new Du({ color: r }))),
            (this.line.matrixAutoUpdate = !1),
            this.add(this.line),
            (this.cone = new ys(Em, new Lo({ color: r }))),
            (this.cone.matrixAutoUpdate = !1),
            this.add(this.cone),
            this.setDirection(e),
            this.setLength(n, i, a);
        }
        function Im(e) {
          var t = [
              0,
              0,
              0,
              (e = e || 1),
              0,
              0,
              0,
              0,
              0,
              0,
              e,
              0,
              0,
              0,
              0,
              0,
              0,
              e
            ],
            n = new es();
          n.setAttribute("position", new Go(t, 3)),
            n.setAttribute(
              "color",
              new Go(
                [1, 0, 0, 1, 0.6, 0, 0, 1, 0, 0.6, 1, 0, 0, 0, 1, 0, 0.6, 1],
                3
              )
            );
          var r = new Du({ vertexColors: $t });
          Bu.call(this, n, r);
        }
        function Dm(e, t, n, r, i, a, o) {
          return new Do(e, t, n, i, a, o);
        }
        (Pm.prototype = Object.create(Na.prototype)),
          (Pm.prototype.constructor = Pm),
          (Pm.prototype.setDirection = function(e) {
            if (e.y > 0.99999) this.quaternion.set(0, 0, 0, 1);
            else if (e.y < -0.99999) this.quaternion.set(1, 0, 0, 0);
            else {
              Rm.set(e.z, 0, -e.x).normalize();
              var t = Math.acos(e.y);
              this.quaternion.setFromAxisAngle(Rm, t);
            }
          }),
          (Pm.prototype.setLength = function(e, t, n) {
            void 0 === t && (t = 0.2 * e),
              void 0 === n && (n = 0.2 * t),
              this.line.scale.set(1, Math.max(1e-4, e - t), 1),
              this.line.updateMatrix(),
              this.cone.scale.set(n, t, n),
              (this.cone.position.y = e),
              this.cone.updateMatrix();
          }),
          (Pm.prototype.setColor = function(e) {
            this.line.material.color.set(e), this.cone.material.color.set(e);
          }),
          (Pm.prototype.copy = function(e) {
            return (
              Na.prototype.copy.call(this, e, !1),
              this.line.copy(e.line),
              this.cone.copy(e.cone),
              this
            );
          }),
          (Pm.prototype.clone = function() {
            return new this.constructor().copy(this);
          }),
          (Im.prototype = Object.create(Bu.prototype)),
          (Im.prototype.constructor = Im);
        var Om = 0,
          Cm = 1;
        function Lm(e) {
          return e;
        }
        function Nm(e) {
          return (
            void 0 === e && (e = []),
            (e.isMultiMaterial = !0),
            (e.materials = e),
            (e.clone = function() {
              return e.slice();
            }),
            e
          );
        }
        function Fm(e, t) {
          return new Yu(e, t);
        }
        function km(e) {
          return new vu(e);
        }
        function Um(e, t) {
          return new Yu(e, t);
        }
        function jm(e) {
          return new Vu(e);
        }
        function Bm(e) {
          return new Vu(e);
        }
        function zm(e) {
          return new Vu(e);
        }
        function Vm(e, t, n) {
          return new ea(e, t, n);
        }
        function Gm(e, t) {
          return new No(e, t).setDynamic(!0);
        }
        function Hm(e, t) {
          return new Fo(e, t);
        }
        function Xm(e, t) {
          return new ko(e, t);
        }
        function Wm(e, t) {
          return new Uo(e, t);
        }
        function Ym(e, t) {
          return new jo(e, t);
        }
        function qm(e, t) {
          return new Bo(e, t);
        }
        function Qm(e, t) {
          return new zo(e, t);
        }
        function Zm(e, t) {
          return new Vo(e, t);
        }
        function Jm(e, t) {
          return new Go(e, t);
        }
        function Km(e, t) {
          return new Ho(e, t);
        }
        function $m(e) {
          ip.call(this, e), (this.type = "catmullrom"), (this.closed = !0);
        }
        function ev(e) {
          ip.call(this, e), (this.type = "catmullrom");
        }
        function tv(e) {
          ip.call(this, e), (this.type = "catmullrom");
        }
        function nv(e) {
          return new Im(e);
        }
        function rv(e, t) {
          return new Mm(e, t);
        }
        function iv(e, t) {
          return new Bu(
            new id(e.geometry),
            new Du({ color: void 0 !== t ? t : 16777215 })
          );
        }
        function av(e, t) {
          return new Bu(
            new $u(e.geometry),
            new Du({ color: void 0 !== t ? t : 16777215 })
          );
        }
        function ov(e) {
          return new Gd(e);
        }
        function sv(e) {
          return new Wd(e);
        }
        (Zd.create = function(e, t) {
          return (
            (e.prototype = Object.create(Zd.prototype)),
            (e.prototype.constructor = e),
            (e.prototype.getPoint = t),
            e
          );
        }),
          Object.assign(vp.prototype, {
            createPointsGeometry: function(e) {
              var t = this.getPoints(e);
              return this.createGeometry(t);
            },
            createSpacedPointsGeometry: function(e) {
              var t = this.getSpacedPoints(e);
              return this.createGeometry(t);
            },
            createGeometry: function(e) {
              for (var t = new As(), n = 0, r = e.length; n < r; n++) {
                var i = e[n];
                t.vertices.push(new ea(i.x, i.y, i.z || 0));
              }
              return t;
            }
          }),
          Object.assign(gp.prototype, {
            fromPoints: function(e) {
              return this.setFromPoints(e);
            }
          }),
          ($m.prototype = Object.create(ip.prototype)),
          (ev.prototype = Object.create(ip.prototype)),
          (tv.prototype = Object.create(ip.prototype)),
          Object.assign(tv.prototype, {
            initFromArray: function() {},
            getControlPointsArray: function() {},
            reparametrizeByArcLength: function() {}
          }),
          (sm.prototype.setColors = function() {}),
          ($f.prototype.update = function() {}),
          Object.assign(zd.prototype, {
            extractUrlBase: function(e) {
              return Op.extractUrlBase(e);
            }
          }),
          (zd.Handlers = { add: function() {}, get: function() {} }),
          Object.assign(kp.prototype, {
            setTexturePath: function(e) {
              return this.setResourcePath(e);
            }
          }),
          Object.assign(Uf.prototype, {
            center: function(e) {
              return this.getCenter(e);
            },
            empty: function() {
              return this.isEmpty();
            },
            isIntersectionBox: function(e) {
              return this.intersectsBox(e);
            },
            size: function(e) {
              return this.getSize(e);
            }
          }),
          Object.assign(Za.prototype, {
            center: function(e) {
              return this.getCenter(e);
            },
            empty: function() {
              return this.isEmpty();
            },
            isIntersectionBox: function(e) {
              return this.intersectsBox(e);
            },
            isIntersectionSphere: function(e) {
              return this.intersectsSphere(e);
            },
            size: function(e) {
              return this.getSize(e);
            }
          }),
          (zf.prototype.center = function(e) {
            return this.getCenter(e);
          }),
          Object.assign(Qi, {
            random16: function() {
              return Math.random();
            },
            nearestPowerOfTwo: function(e) {
              return Qi.floorPowerOfTwo(e);
            },
            nextPowerOfTwo: function(e) {
              return Qi.ceilPowerOfTwo(e);
            }
          }),
          Object.assign(ra.prototype, {
            flattenToArrayOffset: function(e, t) {
              return this.toArray(e, t);
            },
            multiplyVector3: function(e) {
              return e.applyMatrix3(this);
            },
            multiplyVector3Array: function() {},
            applyToBuffer: function(e) {
              return this.applyToBufferAttribute(e);
            },
            applyToVector3Array: function() {}
          }),
          Object.assign(ga.prototype, {
            extractPosition: function(e) {
              return this.copyPosition(e);
            },
            flattenToArrayOffset: function(e, t) {
              return this.toArray(e, t);
            },
            getPosition: function() {
              return new ea().setFromMatrixColumn(this, 3);
            },
            setRotationFromQuaternion: function(e) {
              return this.makeRotationFromQuaternion(e);
            },
            multiplyToArray: function() {},
            multiplyVector3: function(e) {
              return e.applyMatrix4(this);
            },
            multiplyVector4: function(e) {
              return e.applyMatrix4(this);
            },
            multiplyVector3Array: function() {},
            rotateAxis: function(e) {
              e.transformDirection(this);
            },
            crossVector: function(e) {
              return e.applyMatrix4(this);
            },
            translate: function() {},
            rotateX: function() {},
            rotateY: function() {},
            rotateZ: function() {},
            rotateByAxis: function() {},
            applyToBuffer: function(e) {
              return this.applyToBufferAttribute(e);
            },
            applyToVector3Array: function() {},
            makeFrustum: function(e, t, n, r, i, a) {
              return this.makePerspective(e, t, r, n, i, a);
            }
          }),
          (ho.prototype.isIntersectionLine = function(e) {
            return this.intersectsLine(e);
          }),
          (Ji.prototype.multiplyVector3 = function(e) {
            return e.applyQuaternion(this);
          }),
          Object.assign(so.prototype, {
            isIntersectionBox: function(e) {
              return this.intersectsBox(e);
            },
            isIntersectionPlane: function(e) {
              return this.intersectsPlane(e);
            },
            isIntersectionSphere: function(e) {
              return this.intersectsSphere(e);
            }
          }),
          Object.assign(Mo.prototype, {
            area: function() {
              return this.getArea();
            },
            barycoordFromPoint: function(e, t) {
              return this.getBarycoord(e, t);
            },
            midpoint: function(e) {
              return this.getMidpoint(e);
            },
            normal: function(e) {
              return this.getNormal(e);
            },
            plane: function(e) {
              return this.getPlane(e);
            }
          }),
          Object.assign(Mo, {
            barycoordFromPoint: function(e, t, n, r, i) {
              return Mo.getBarycoord(e, t, n, r, i);
            },
            normal: function(e, t, n, r) {
              return Mo.getNormal(e, t, n, r);
            }
          }),
          Object.assign(yp.prototype, {
            extractAllPoints: function(e) {
              return this.extractPoints(e);
            },
            extrude: function(e) {
              return new Gh(this, e);
            },
            makeGeometry: function(e) {
              return new td(this, e);
            }
          }),
          Object.assign(Zi.prototype, {
            fromAttribute: function(e, t, n) {
              return this.fromBufferAttribute(e, t, n);
            },
            distanceToManhattan: function(e) {
              return this.manhattanDistanceTo(e);
            },
            lengthManhattan: function() {
              return this.manhattanLength();
            }
          }),
          Object.assign(ea.prototype, {
            setEulerFromRotationMatrix: function() {},
            setEulerFromQuaternion: function() {},
            getPositionFromMatrix: function(e) {
              return this.setFromMatrixPosition(e);
            },
            getScaleFromMatrix: function(e) {
              return this.setFromMatrixScale(e);
            },
            getColumnFromMatrix: function(e, t) {
              return this.setFromMatrixColumn(t, e);
            },
            applyProjection: function(e) {
              return this.applyMatrix4(e);
            },
            fromAttribute: function(e, t, n) {
              return this.fromBufferAttribute(e, t, n);
            },
            distanceToManhattan: function(e) {
              return this.manhattanDistanceTo(e);
            },
            lengthManhattan: function() {
              return this.manhattanLength();
            }
          }),
          Object.assign(sa.prototype, {
            fromAttribute: function(e, t, n) {
              return this.fromBufferAttribute(e, t, n);
            },
            lengthManhattan: function() {
              return this.manhattanLength();
            }
          }),
          Object.assign(As.prototype, {
            computeTangents: function() {},
            computeLineDistances: function() {}
          }),
          Object.assign(Na.prototype, {
            getChildByName: function(e) {
              return this.getObjectByName(e);
            },
            renderDepth: function() {},
            translate: function(e, t) {
              return this.translateOnAxis(t, e);
            },
            getWorldRotation: function() {}
          }),
          Object.defineProperties(Na.prototype, {
            eulerOrder: {
              get: function() {
                return this.rotation.order;
              },
              set: function(e) {
                this.rotation.order = e;
              }
            },
            useQuaternion: { get: function() {}, set: function() {} }
          }),
          Object.defineProperties(xu.prototype, {
            objects: {
              get: function() {
                return this.levels;
              }
            }
          }),
          Object.defineProperty(Tu.prototype, "useVertexTexture", {
            get: function() {},
            set: function() {}
          }),
          (wu.prototype.initBones = function() {}),
          Object.defineProperty(Zd.prototype, "__arcLengthDivisions", {
            get: function() {
              return this.arcLengthDivisions;
            },
            set: function(e) {
              this.arcLengthDivisions = e;
            }
          }),
          (Ns.prototype.setLens = function(e, t) {
            void 0 !== t && (this.filmGauge = t), this.setFocalLength(e);
          }),
          Object.defineProperties(bp.prototype, {
            onlyShadow: { set: function() {} },
            shadowCameraFov: {
              set: function(e) {
                this.shadow.camera.fov = e;
              }
            },
            shadowCameraLeft: {
              set: function(e) {
                this.shadow.camera.left = e;
              }
            },
            shadowCameraRight: {
              set: function(e) {
                this.shadow.camera.right = e;
              }
            },
            shadowCameraTop: {
              set: function(e) {
                this.shadow.camera.top = e;
              }
            },
            shadowCameraBottom: {
              set: function(e) {
                this.shadow.camera.bottom = e;
              }
            },
            shadowCameraNear: {
              set: function(e) {
                this.shadow.camera.near = e;
              }
            },
            shadowCameraFar: {
              set: function(e) {
                this.shadow.camera.far = e;
              }
            },
            shadowCameraVisible: { set: function() {} },
            shadowBias: {
              set: function(e) {
                this.shadow.bias = e;
              }
            },
            shadowDarkness: { set: function() {} },
            shadowMapWidth: {
              set: function(e) {
                this.shadow.mapSize.width = e;
              }
            },
            shadowMapHeight: {
              set: function(e) {
                this.shadow.mapSize.height = e;
              }
            }
          }),
          Object.defineProperties(No.prototype, {
            length: {
              get: function() {
                return this.array.length;
              }
            },
            dynamic: {
              get: function() {
                return this.usage === Ui;
              },
              set: function() {
                this.setUsage(Ui);
              }
            }
          }),
          Object.assign(No.prototype, {
            setDynamic: function(e) {
              return this.setUsage(!0 === e ? Ui : ki), this;
            },
            copyIndicesArray: function() {},
            setArray: function() {}
          }),
          Object.assign(es.prototype, {
            addIndex: function(e) {
              this.setIndex(e);
            },
            addAttribute: function(e, t) {
              return (t && t.isBufferAttribute) ||
                (t && t.isInterleavedBufferAttribute)
                ? "index" === e
                  ? (this.setIndex(t), this)
                  : this.setAttribute(e, t)
                : this.setAttribute(e, new No(arguments[1], arguments[2]));
            },
            addDrawCall: function(e, t, n) {
              this.addGroup(e, t);
            },
            clearDrawCalls: function() {
              this.clearGroups();
            },
            computeTangents: function() {},
            computeOffsets: function() {},
            removeAttribute: function(e) {
              return this.deleteAttribute(e);
            }
          }),
          Object.defineProperties(es.prototype, {
            drawcalls: {
              get: function() {
                return this.groups;
              }
            },
            offsets: {
              get: function() {
                return this.groups;
              }
            }
          }),
          Object.defineProperties(tu.prototype, {
            dynamic: {
              get: function() {
                return this.usage === Ui;
              },
              set: function(e) {
                this.setUsage(e);
              }
            }
          }),
          Object.assign(tu.prototype, {
            setDynamic: function(e) {
              return this.setUsage(!0 === e ? Ui : ki), this;
            },
            setArray: function() {}
          }),
          Object.assign(Hh.prototype, {
            getArrays: function() {},
            addShapeList: function() {},
            addShape: function() {}
          }),
          Object.defineProperties(If.prototype, {
            dynamic: { set: function() {} },
            onUpdate: {
              value: function() {
                return this;
              }
            }
          }),
          Object.defineProperties(Co.prototype, {
            wrapAround: { get: function() {}, set: function() {} },
            overdraw: { get: function() {}, set: function() {} },
            wrapRGB: {
              get: function() {
                return new Eo();
              }
            },
            shading: {
              get: function() {},
              set: function(e) {
                this.flatShading = e === Qt;
              }
            },
            stencilMask: {
              get: function() {
                return this.stencilFuncMask;
              },
              set: function(e) {
                this.stencilFuncMask = e;
              }
            }
          }),
          Object.defineProperties(vd.prototype, {
            metal: {
              get: function() {
                return !1;
              },
              set: function() {}
            }
          }),
          Object.defineProperties(Cs.prototype, {
            derivatives: {
              get: function() {
                return this.extensions.derivatives;
              },
              set: function(e) {
                this.extensions.derivatives = e;
              }
            }
          }),
          Object.assign(Kc.prototype, {
            clearTarget: function(e, t, n, r) {
              this.setRenderTarget(e), this.clear(t, n, r);
            },
            animate: function(e) {
              this.setAnimationLoop(e);
            },
            getCurrentRenderTarget: function() {
              return this.getRenderTarget();
            },
            getMaxAnisotropy: function() {
              return this.capabilities.getMaxAnisotropy();
            },
            getPrecision: function() {
              return this.capabilities.precision;
            },
            resetGLState: function() {
              return this.state.reset();
            },
            supportsFloatTextures: function() {
              return this.extensions.get("OES_texture_float");
            },
            supportsHalfFloatTextures: function() {
              return this.extensions.get("OES_texture_half_float");
            },
            supportsStandardDerivatives: function() {
              return this.extensions.get("OES_standard_derivatives");
            },
            supportsCompressedTextureS3TC: function() {
              return this.extensions.get("WEBGL_compressed_texture_s3tc");
            },
            supportsCompressedTexturePVRTC: function() {
              return this.extensions.get("WEBGL_compressed_texture_pvrtc");
            },
            supportsBlendMinMax: function() {
              return this.extensions.get("EXT_blend_minmax");
            },
            supportsVertexTextures: function() {
              return this.capabilities.vertexTextures;
            },
            supportsInstancedArrays: function() {
              return this.extensions.get("ANGLE_instanced_arrays");
            },
            enableScissorTest: function(e) {
              this.setScissorTest(e);
            },
            initMaterial: function() {},
            addPrePlugin: function() {},
            addPostPlugin: function() {},
            updateShadowMap: function() {},
            setFaceCulling: function() {},
            allocTextureUnit: function() {},
            setTexture: function() {},
            setTexture2D: function() {},
            setTextureCube: function() {},
            getActiveMipMapLevel: function() {
              return this.getActiveMipmapLevel();
            }
          }),
          Object.defineProperties(Kc.prototype, {
            shadowMapEnabled: {
              get: function() {
                return this.shadowMap.enabled;
              },
              set: function(e) {
                this.shadowMap.enabled = e;
              }
            },
            shadowMapType: {
              get: function() {
                return this.shadowMap.type;
              },
              set: function(e) {
                this.shadowMap.type = e;
              }
            },
            shadowMapCullFace: { get: function() {}, set: function() {} },
            context: {
              get: function() {
                return this.getContext();
              }
            }
          }),
          Object.defineProperties(Uc.prototype, {
            cullFace: { get: function() {}, set: function() {} },
            renderReverseSided: { get: function() {}, set: function() {} },
            renderSingleSided: { get: function() {}, set: function() {} }
          }),
          Object.defineProperties(js.prototype, {
            activeCubeFace: { set: function() {} },
            activeMipMapLevel: { set: function() {} }
          }),
          Object.defineProperties(la.prototype, {
            wrapS: {
              get: function() {
                return this.texture.wrapS;
              },
              set: function(e) {
                this.texture.wrapS = e;
              }
            },
            wrapT: {
              get: function() {
                return this.texture.wrapT;
              },
              set: function(e) {
                this.texture.wrapT = e;
              }
            },
            magFilter: {
              get: function() {
                return this.texture.magFilter;
              },
              set: function(e) {
                this.texture.magFilter = e;
              }
            },
            minFilter: {
              get: function() {
                return this.texture.minFilter;
              },
              set: function(e) {
                this.texture.minFilter = e;
              }
            },
            anisotropy: {
              get: function() {
                return this.texture.anisotropy;
              },
              set: function(e) {
                this.texture.anisotropy = e;
              }
            },
            offset: {
              get: function() {
                return this.texture.offset;
              },
              set: function(e) {
                this.texture.offset = e;
              }
            },
            repeat: {
              get: function() {
                return this.texture.repeat;
              },
              set: function(e) {
                this.texture.repeat = e;
              }
            },
            format: {
              get: function() {
                return this.texture.format;
              },
              set: function(e) {
                this.texture.format = e;
              }
            },
            type: {
              get: function() {
                return this.texture.type;
              },
              set: function(e) {
                this.texture.type = e;
              }
            },
            generateMipmaps: {
              get: function() {
                return this.texture.generateMipmaps;
              },
              set: function(e) {
                this.texture.generateMipmaps = e;
              }
            }
          }),
          Object.defineProperties(Zc.prototype, {
            standing: { set: function() {} },
            userHeight: { set: function() {} }
          }),
          Object.defineProperties(cf.prototype, {
            load: {
              value: function(e) {
                var t = this;
                return (
                  new qp().load(e, function(e) {
                    t.setBuffer(e);
                  }),
                  this
                );
              }
            },
            startTime: { set: function() {} }
          }),
          (mf.prototype.getData = function() {
            return this.getFrequencyData();
          }),
          (Us.prototype.updateCubeMap = function(e, t) {
            return this.update(e, t);
          });
        var lv = {
          merge: function(e, t, n) {
            var r;
            t.isMesh &&
              (t.matrixAutoUpdate && t.updateMatrix(),
              (r = t.matrix),
              (t = t.geometry)),
              e.merge(t, r, n);
          },
          center: function(e) {
            return e.center();
          }
        };
        function cv() {}
        function uv() {}
        (ia.crossOrigin = void 0),
          (ia.loadTexture = function(e, t, n, r) {
            var i = new Qd();
            i.setCrossOrigin(this.crossOrigin);
            var a = i.load(e, n, void 0, r);
            return t && (a.mapping = t), a;
          }),
          (ia.loadTextureCube = function(e, t, n, r) {
            var i = new qd();
            i.setCrossOrigin(this.crossOrigin);
            var a = i.load(e, n, void 0, r);
            return t && (a.mapping = t), a;
          }),
          (ia.loadCompressedTexture = function() {}),
          (ia.loadCompressedTextureCube = function() {});
        var hv = {
          createMultiMaterialObject: function() {},
          detach: function() {},
          attach: function() {}
        };
        function dv() {}
        "undefined" != typeof __THREE_DEVTOOLS__ &&
          __THREE_DEVTOOLS__.dispatchEvent(
            new CustomEvent("register", { detail: { revision: Ct } })
          );
        var pv = n(1),
          fv = n.n(pv);
        function mv(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function vv(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function gv(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function yv(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var bv = (function() {
          function e(t) {
            var n = t.controller,
              r = t.name,
              i = t.type,
              a = void 0 === i ? "Element" : i,
              o = t.addable,
              s = void 0 !== o && o,
              l = t.updatable,
              c = void 0 !== l && l,
              u = t.disposable,
              h = void 0 === u || u;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.controller = n),
              (this.name = r),
              (this.uuid = null),
              (this.type = a),
              (this.addable = s),
              (this.updatable = c),
              (this.disposable = h),
              (this.refs = { obj: null, helpers: { boundaryBox: null } });
          }
          var t, n, i;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function() {
                  return (
                    arguments.length > 0 &&
                      void 0 !== arguments[0] &&
                      arguments[0],
                    Promise.resolve(!0)
                  );
                }
              },
              {
                key: "getObject",
                value: function() {
                  return (
                    arguments.length > 0 &&
                      void 0 !== arguments[0] &&
                      arguments[0],
                    this.refs.obj
                  );
                }
              },
              {
                key: "getRefs",
                value: function() {
                  return this.refs;
                }
              },
              {
                key: "getInfo",
                value: function() {
                  return {
                    type: this.type,
                    userData:
                      this.refs.obj && this.refs.obj.userData
                        ? this.refs.obj.userData
                        : {}
                  };
                }
              },
              {
                key: "isActive",
                value: function() {
                  return this.refs.obj && this.refs.obj.visible;
                }
              },
              {
                key: "setActive",
                value: function(e) {
                  this.refs.obj && (this.refs.obj.visible = e);
                }
              },
              {
                key: "setMaterial",
                value: function() {
                  throw new Error(
                    "Setting material for type ".concat(
                      this.type,
                      " is not supported"
                    )
                  );
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var t,
                    n = e.key,
                    i = e.value,
                    a = e.valueType,
                    o = e.notify,
                    s = void 0 === o || o,
                    l = e.ignore;
                  if (void 0 === l || !l) {
                    var c = this.refs.obj;
                    try {
                      switch (a) {
                        case "enum":
                          c[n] = null !== i ? r[i] : null;
                          break;
                        case "coordinate2":
                        case "coordinate3":
                        case "coordinate4":
                          (t = c[n]).set.apply(t, gv(i));
                          break;
                        case "color":
                          c[n].set(i),
                            this.controller.viewer.useColorConversion &&
                              c[n].convertSRGBToLinear();
                          break;
                        case "range":
                        case "boolean":
                        case "integer":
                        case "float":
                          c[n] = i;
                      }
                    } catch (e) {
                      throw new Error(
                        "Invalid setting of property "
                          .concat(n, " to ")
                          .concat(i, " of type ")
                          .concat(a)
                      );
                    }
                  }
                  return this.controller.notify({
                    notifyType: "propertyUpdated",
                    elementID: this.uuid,
                    properties: [{ key: n, value: i }],
                    emit: s
                  });
                }
              },
              {
                key: "setProperties",
                value: function(e) {
                  var t = this,
                    n = e.properties,
                    r = e.notify,
                    i = void 0 === r || r,
                    a = [];
                  return (
                    n.forEach(function(e) {
                      var n = t.setProperty(
                        (function(e) {
                          for (var t = 1; t < arguments.length; t++) {
                            var n = null != arguments[t] ? arguments[t] : {};
                            t % 2
                              ? mv(Object(n), !0).forEach(function(t) {
                                  vv(e, t, n[t]);
                                })
                              : Object.getOwnPropertyDescriptors
                              ? Object.defineProperties(
                                  e,
                                  Object.getOwnPropertyDescriptors(n)
                                )
                              : mv(Object(n)).forEach(function(t) {
                                  Object.defineProperty(
                                    e,
                                    t,
                                    Object.getOwnPropertyDescriptor(n, t)
                                  );
                                });
                          }
                          return e;
                        })({}, e, { notify: i })
                      );
                      a = [].concat(gv(a), gv(n));
                    }),
                    a
                  );
                }
              },
              {
                key: "getProperty",
                value: function(e) {
                  var t = e.key,
                    n = e.valueType,
                    r = this.refs.obj;
                  switch (n) {
                    case "enum":
                      throw new Error("Enum get is not yet implemented!");
                    case "coordinate2":
                      var i = r[t];
                      return [i.x, i.y];
                    case "coordinate3":
                      var a = r[t];
                      return [a.x, a.y, a.z];
                    case "coordinate4":
                      var o = r[t];
                      return [o.x, o.y, o.z, o.w];
                    case "color":
                      var s = r[t].clone();
                      return s.convertLinearToSRGB(), [s.r, s.g, s.b];
                    case "range":
                    case "boolean":
                    case "integer":
                    case "float":
                      return r[t];
                    default:
                      throw new Error("Unknown property type!");
                  }
                }
              },
              {
                key: "getProperties",
                value: function(e) {
                  var t = this,
                    n = e.map(function(e) {
                      return {
                        key: e.key,
                        value: t.getProperty({
                          key: e.key,
                          valueType: e.valueType
                        })
                      };
                    });
                  return { elementID: this.uuid, properties: n };
                }
              }
            ]) && yv(t.prototype, n),
            i && yv(t, i),
            e
          );
        })();
        function xv(e) {
          return (xv =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function wv(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function _v(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Mv(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? _v(Object(n), !0).forEach(function(t) {
                  Tv(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : _v(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function Tv(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Av(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Sv(e, t) {
          return !t || ("object" !== xv(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Ev(e, t, n) {
          return (Ev =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Rv(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Rv(e) {
          return (Rv = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Pv(e, t) {
          return (Pv =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Iv = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "Node" : i,
              o = e.name,
              s = e.addable,
              l = void 0 === s || s,
              c = e.updatable,
              u = void 0 !== c && c,
              h = e.disposable,
              d = void 0 === h || h;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = Sv(
                this,
                Rv(t).call(this, {
                  controller: r,
                  name: o,
                  type: a,
                  addable: l,
                  updatable: u,
                  disposable: d
                })
              )).added = !1),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Pv(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return Ev(Rv(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (
                        n.obj &&
                          ((e.refs.obj = n.obj),
                          (e.materialID = null),
                          (e.refs.obj.userData = Mv({}, n.userData))),
                        (e.uuid = e.refs.obj ? e.refs.obj.uuid : null),
                        !0
                      );
                    });
                }
              },
              {
                key: "add",
                value: function(e) {
                  var t = e.parent;
                  this.addable &&
                    (t.getObject().add(this.refs.obj),
                    (this.added = !0),
                    document.dispatchEvent(new Event("pulseUpdate")));
                }
              },
              {
                key: "remove",
                value: function() {
                  this.addable &&
                    this.added &&
                    (this.getParent()
                      .getObject()
                      .remove(this.refs.obj),
                    (this.added = !1),
                    document.dispatchEvent(new Event("pulseUpdate")));
                }
              },
              {
                key: "getParent",
                value: function() {
                  return this.refs.obj.parent
                    ? this.controller.getElement(this.refs.obj.parent.uuid)
                    : null;
                }
              },
              {
                key: "setMaterial",
                value: function() {
                  var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : null;
                  if (!this.refs.obj.material)
                    throw new Error(
                      "Material can't be set on node ".concat(this.uuid)
                    );
                  if (!e || e.uuid !== this.materialID) {
                    var t = this.controller.getElement(this.materialID);
                    if (
                      (t &&
                        t.notify({ elementID: this.uuid, action: "remove" }),
                      e)
                    )
                      (this.refs.obj.material = e.getObject()),
                        "CompoundMaterial" === e.materialType
                          ? this._updateGeometryForMaterial()
                          : (this.refs.obj.material.needsUpdate = !0),
                        e.notify({ elementID: this.uuid, action: "add" });
                    else {
                      var n = this.controller.getElementByName(
                        "DefaultMaterial"
                      );
                      n &&
                        ((this.refs.obj.material = n.getObject()),
                        (this.refs.obj.material.needsUpdate = !0));
                    }
                    (this.materialID = e ? e.uuid : null),
                      document.dispatchEvent(new Event("pulseUpdate"));
                  }
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.refs.obj.material && this.setMaterial(null),
                    (this.refs.obj = null);
                }
              },
              {
                key: "update",
                value: function() {
                  var e = this.controller.getElement(this.materialID);
                  e &&
                    ("CompoundMaterial" === e.materialType &&
                      this._updateGeometryForMaterial(),
                    (this.refs.obj.material = e.getObject()));
                }
              },
              {
                key: "_updateGeometryForMaterial",
                value: function() {
                  var e = this,
                    t = this.refs.obj.geometry;
                  t.clearGroups(),
                    this.refs.obj.material.forEach(function(n, r) {
                      if (!t.index)
                        throw new Error(
                          "Element's ".concat(
                            e.uuid,
                            " geometry doesn't have index property!"
                          )
                        );
                      t.addGroup(0, t.index.count, r), (n.needsUpdate = !0);
                    });
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n,
                    r = e.key,
                    i = e.value,
                    a = e.valueType,
                    o = e.notify,
                    s = void 0 === o || o,
                    l = e.ignore,
                    c = void 0 !== l && l,
                    u = this.refs.obj,
                    h = c;
                  return (
                    "rotation" === r &&
                      ((n = u.quaternion).set.apply(n, wv(i)), (h = !0)),
                    Ev(Rv(t.prototype), "setProperty", this).call(this, {
                      key: r,
                      value: i,
                      valueType: a,
                      notify: s,
                      ignore: h
                    })
                  );
                }
              }
            ]) && Av(n.prototype, r),
            i && Av(n, i),
            t
          );
        })(bv);
        function Dv(e) {
          return (Dv =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Ov(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Cv(e, t) {
          return !t || ("object" !== Dv(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Lv(e, t, n) {
          return (Lv =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Nv(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Nv(e) {
          return (Nv = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Fv(e, t) {
          return (Fv =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var kv,
          Uv,
          jv = (function(e) {
            function t(e) {
              var n = e.controller,
                r = e.type,
                i = void 0 === r ? "Grid" : r,
                a = e.name;
              return (
                (function(e, t) {
                  if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function");
                })(this, t),
                Cv(this, Nv(t).call(this, { controller: n, name: a, type: i }))
              );
            }
            var n, r, i;
            return (
              (function(e, t) {
                if ("function" != typeof t && null !== t)
                  throw new TypeError(
                    "Super expression must either be null or a function"
                  );
                (e.prototype = Object.create(t && t.prototype, {
                  constructor: { value: e, writable: !0, configurable: !0 }
                })),
                  t && Fv(e, t);
              })(t, e),
              (n = t),
              (r = [
                {
                  key: "init",
                  value: function(e) {
                    var n = this;
                    return Lv(Nv(t.prototype), "init", this)
                      .call(this, e)
                      .then(function() {
                        return (n.uuid = n._createGrid(e)), !0;
                      });
                  }
                },
                {
                  key: "_createGrid",
                  value: function(e) {
                    var t = e.visible,
                      n = void 0 !== t && t,
                      r = e.size,
                      i = void 0 === r ? 30 : r,
                      a = e.divisions,
                      o = void 0 === a ? 30 : a,
                      s = e.colorCenterLine,
                      l = void 0 === s ? 4473924 : s,
                      c = e.color,
                      u = new Eo(void 0 === c ? 8947848 : c);
                    this.controller.viewer.useColorConversion &&
                      u.convertSRGBToLinear();
                    var h = new sm(i, o, l, u);
                    return (
                      (this.refs.obj = h),
                      (h.uuid = E()()),
                      (h.visible = n),
                      h.uuid
                    );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    this.refs.obj.geometry.dispose(), (this.refs.obj = null);
                  }
                }
              ]) && Ov(n.prototype, r),
              i && Ov(n, i),
              t
            );
          })(Iv),
          Bv = function() {
            Cp.call(this),
              (this.type = "LineSegmentsGeometry"),
              this.setIndex([
                0,
                2,
                1,
                2,
                3,
                1,
                2,
                4,
                3,
                4,
                5,
                3,
                4,
                6,
                5,
                6,
                7,
                5
              ]),
              this.setAttribute(
                "position",
                new Go(
                  [
                    -1,
                    2,
                    0,
                    1,
                    2,
                    0,
                    -1,
                    1,
                    0,
                    1,
                    1,
                    0,
                    -1,
                    0,
                    0,
                    1,
                    0,
                    0,
                    -1,
                    -1,
                    0,
                    1,
                    -1,
                    0
                  ],
                  3
                )
              ),
              this.setAttribute(
                "uv",
                new Go(
                  [-1, 2, 1, 2, -1, 1, 1, 1, -1, -1, 1, -1, -1, -2, 1, -2],
                  2
                )
              );
          };
        (Bv.prototype = Object.assign(Object.create(Cp.prototype), {
          constructor: Bv,
          isLineSegmentsGeometry: !0,
          applyMatrix: function(e) {
            var t = this.attributes.instanceStart,
              n = this.attributes.instanceEnd;
            return (
              void 0 !== t &&
                (e.applyToBufferAttribute(t),
                e.applyToBufferAttribute(n),
                (t.data.needsUpdate = !0)),
              null !== this.boundingBox && this.computeBoundingBox(),
              null !== this.boundingSphere && this.computeBoundingSphere(),
              this
            );
          },
          setPositions: function(e) {
            var t;
            e instanceof Float32Array
              ? (t = e)
              : Array.isArray(e) && (t = new Float32Array(e));
            var n = new Df(t, 6, 1);
            return (
              this.setAttribute("instanceStart", new nu(n, 3, 0)),
              this.setAttribute("instanceEnd", new nu(n, 3, 3)),
              this.computeBoundingBox(),
              this.computeBoundingSphere(),
              this
            );
          },
          setColors: function(e) {
            var t;
            e instanceof Float32Array
              ? (t = e)
              : Array.isArray(e) && (t = new Float32Array(e));
            var n = new Df(t, 6, 1);
            return (
              this.setAttribute("instanceColorStart", new nu(n, 3, 0)),
              this.setAttribute("instanceColorEnd", new nu(n, 3, 3)),
              this
            );
          },
          fromWireframeGeometry: function(e) {
            return this.setPositions(e.attributes.position.array), this;
          },
          fromEdgesGeometry: function(e) {
            return this.setPositions(e.attributes.position.array), this;
          },
          fromMesh: function(e) {
            return this.fromWireframeGeometry(new $u(e.geometry)), this;
          },
          fromLineSegements: function(e) {
            var t = e.geometry;
            return (
              t.isGeometry
                ? this.setPositions(t.vertices)
                : t.isBufferGeometry && this.setPositions(t.position.array),
              this
            );
          },
          computeBoundingBox:
            ((Uv = new Za()),
            function() {
              null === this.boundingBox && (this.boundingBox = new Za());
              var e = this.attributes.instanceStart,
                t = this.attributes.instanceEnd;
              void 0 !== e &&
                void 0 !== t &&
                (this.boundingBox.setFromBufferAttribute(e),
                Uv.setFromBufferAttribute(t),
                this.boundingBox.union(Uv));
            }),
          computeBoundingSphere:
            ((kv = new ea()),
            function() {
              null === this.boundingSphere && (this.boundingSphere = new $a()),
                null === this.boundingBox && this.computeBoundingBox();
              var e = this.attributes.instanceStart,
                t = this.attributes.instanceEnd;
              if (void 0 !== e && void 0 !== t) {
                var n = this.boundingSphere.center;
                this.boundingBox.getCenter(n);
                for (var r = 0, i = 0, a = e.count; i < a; i++)
                  kv.fromBufferAttribute(e, i),
                    (r = Math.max(r, n.distanceToSquared(kv))),
                    kv.fromBufferAttribute(t, i),
                    (r = Math.max(r, n.distanceToSquared(kv)));
                (this.boundingSphere.radius = Math.sqrt(r)),
                  isNaN(this.boundingSphere.radius);
              }
            }),
          toJSON: function() {}
        })),
          (Xs.line = {
            linewidth: { value: 1 },
            resolution: { value: new Zi(1, 1) },
            dashScale: { value: 1 },
            dashSize: { value: 1 },
            gapSize: { value: 1 }
          }),
          (Ws.line = {
            uniforms: Is.merge([Xs.common, Xs.fog, Xs.line]),
            vertexShader:
              "\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",
            fragmentShader:
              "\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"
          });
        var zv = function(e) {
          Cs.call(this, {
            type: "LineMaterial",
            uniforms: Is.clone(Ws.line.uniforms),
            vertexShader: Ws.line.vertexShader,
            fragmentShader: Ws.line.fragmentShader,
            clipping: !0
          }),
            (this.dashed = !1),
            Object.defineProperties(this, {
              color: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.diffuse.value;
                },
                set: function(e) {
                  this.uniforms.diffuse.value = e;
                }
              },
              linewidth: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.linewidth.value;
                },
                set: function(e) {
                  this.uniforms.linewidth.value = e;
                }
              },
              dashScale: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.dashScale.value;
                },
                set: function(e) {
                  this.uniforms.dashScale.value = e;
                }
              },
              dashSize: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.dashSize.value;
                },
                set: function(e) {
                  this.uniforms.dashSize.value = e;
                }
              },
              gapSize: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.gapSize.value;
                },
                set: function(e) {
                  this.uniforms.gapSize.value = e;
                }
              },
              resolution: {
                enumerable: !0,
                get: function() {
                  return this.uniforms.resolution.value;
                },
                set: function(e) {
                  this.uniforms.resolution.value.copy(e);
                }
              }
            }),
            this.setValues(e);
        };
        ((zv.prototype = Object.create(Cs.prototype)).constructor = zv),
          (zv.prototype.isLineMaterial = !0);
        var Vv,
          Gv,
          Hv = function(e, t) {
            ys.call(this),
              (this.type = "LineSegments2"),
              (this.geometry = void 0 !== e ? e : new Bv()),
              (this.material =
                void 0 !== t ? t : new zv({ color: 16777215 * Math.random() }));
          };
        Hv.prototype = Object.assign(Object.create(ys.prototype), {
          constructor: Hv,
          isLineSegments2: !0,
          computeLineDistances:
            ((Vv = new ea()),
            (Gv = new ea()),
            function() {
              for (
                var e = this.geometry,
                  t = e.attributes.instanceStart,
                  n = e.attributes.instanceEnd,
                  r = new Float32Array(2 * t.data.count),
                  i = 0,
                  a = 0,
                  o = t.data.count;
                i < o;
                i++, a += 2
              )
                Vv.fromBufferAttribute(t, i),
                  Gv.fromBufferAttribute(n, i),
                  (r[a] = 0 === a ? 0 : r[a - 1]),
                  (r[a + 1] = r[a] + Vv.distanceTo(Gv));
              var s = new Df(r, 2, 1);
              return (
                e.setAttribute("instanceDistanceStart", new nu(s, 1, 0)),
                e.setAttribute("instanceDistanceEnd", new nu(s, 1, 1)),
                this
              );
            })
        });
        var Xv = function() {
          Bv.call(this), (this.type = "LineGeometry");
        };
        Xv.prototype = Object.assign(Object.create(Bv.prototype), {
          constructor: Xv,
          isLineGeometry: !0,
          setPositions: function(e) {
            for (
              var t = e.length - 3, n = new Float32Array(2 * t), r = 0;
              r < t;
              r += 3
            )
              (n[2 * r] = e[r]),
                (n[2 * r + 1] = e[r + 1]),
                (n[2 * r + 2] = e[r + 2]),
                (n[2 * r + 3] = e[r + 3]),
                (n[2 * r + 4] = e[r + 4]),
                (n[2 * r + 5] = e[r + 5]);
            return Bv.prototype.setPositions.call(this, n), this;
          },
          setColors: function(e) {
            for (
              var t = e.length - 3, n = new Float32Array(2 * t), r = 0;
              r < t;
              r += 3
            )
              (n[2 * r] = e[r]),
                (n[2 * r + 1] = e[r + 1]),
                (n[2 * r + 2] = e[r + 2]),
                (n[2 * r + 3] = e[r + 3]),
                (n[2 * r + 4] = e[r + 4]),
                (n[2 * r + 5] = e[r + 5]);
            return Bv.prototype.setColors.call(this, n), this;
          },
          fromLine: function(e) {
            var t = e.geometry;
            return (
              t.isGeometry
                ? this.setPositions(t.vertices)
                : t.isBufferGeometry && this.setPositions(t.position.array),
              this
            );
          },
          copy: function() {
            return this;
          }
        });
        var Wv = function(e, t) {
          Hv.call(this),
            (this.type = "Line2"),
            (this.geometry = void 0 !== e ? e : new Xv()),
            (this.material =
              void 0 !== t ? t : new zv({ color: 16777215 * Math.random() }));
        };
        function Yv(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        Wv.prototype = Object.assign(Object.create(Hv.prototype), {
          constructor: Wv,
          isLine2: !0
        });
        var qv = (function() {
          function e() {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e);
          }
          var t, n, r;
          return (
            (t = e),
            (r = [
              {
                key: "equalArrays",
                value: function(e, t) {
                  if (!e || !t) return !1;
                  if (e.length !== t.length) return !1;
                  for (var n = 0; n < e.length; n += 1)
                    if (e[n] instanceof Array && t[n] instanceof Array) {
                      if (!e[n].compare(t[n])) return !1;
                    } else if (e[n] !== t[n]) return !1;
                  return !0;
                }
              },
              {
                key: "throttled",
                value: function(e, t) {
                  var n = 0;
                  return function() {
                    var r = new Date().getTime();
                    if (!(r - n < e))
                      return (n = r), t.apply(void 0, arguments);
                  };
                }
              },
              {
                key: "debounced",
                value: function(e, t) {
                  var n;
                  return function() {
                    for (
                      var r = arguments.length, i = new Array(r), a = 0;
                      a < r;
                      a++
                    )
                      i[a] = arguments[a];
                    n && clearTimeout(n),
                      (n = setTimeout(function() {
                        t.apply(void 0, i), (n = null);
                      }, e));
                  };
                }
              },
              {
                key: "disposeNode",
                value: function(e) {
                  var t =
                    !(arguments.length > 1 && void 0 !== arguments[1]) ||
                    arguments[1];
                  e.traverse(function(e) {
                    if (e instanceof ys) {
                      e.geometry && e.geometry.dispose();
                      var n = function(e) {
                        e &&
                          ([
                            "alphaMap",
                            "aoMap",
                            "bumpMap",
                            "displacementMap",
                            "emissiveMap",
                            "envMap",
                            "lightMap",
                            "map",
                            "metalnessMap",
                            "normalMap",
                            "roughnessMap",
                            "specularMap",
                            "gradientMap",
                            "clearcoatNormalMap"
                          ].forEach(function(t) {
                            e[t] && e[t].dispose();
                          }),
                          e.dispose());
                      };
                      t &&
                        e.material &&
                        (Array.isArray(e.material)
                          ? e.material.forEach(function(e) {
                              return n(e);
                            })
                          : n(e.material));
                    }
                  });
                }
              },
              {
                key: "powerOfTwo",
                value: function(e) {
                  return Math.log2(e) % 1 == 0;
                }
              }
            ]),
            (n = null) && Yv(t.prototype, n),
            r && Yv(t, r),
            e
          );
        })();
        function Qv(e) {
          return (Qv =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Zv(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Jv(e, t) {
          return !t || ("object" !== Qv(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Kv(e, t, n) {
          return (Kv =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = $v(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function $v(e) {
          return ($v = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function eg(e, t) {
          return (eg =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var tg = (function(e) {
          function t(e) {
            var n = e.controller,
              r = e.type,
              i = void 0 === r ? "Axes" : r,
              a = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              Jv(this, $v(t).call(this, { controller: n, name: a, type: i }))
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && eg(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return Kv($v(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (e.uuid = e._createAxes(n)), !0;
                    });
                }
              },
              {
                key: "_createAxes",
                value: function(e) {
                  for (
                    var t = e.visible,
                      n = void 0 !== t && t,
                      r = e.size,
                      i = void 0 === r ? 10 : r,
                      a = e.width,
                      o = void 0 === a ? 5 : a,
                      s = [
                        0,
                        0,
                        0,
                        i,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        i,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        i
                      ],
                      l = [
                        1,
                        0,
                        0,
                        1,
                        0.6,
                        0,
                        0,
                        1,
                        0,
                        0.6,
                        1,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0.6,
                        1
                      ],
                      c = new Na(),
                      u = 0;
                    u < 3;
                    u += 1
                  ) {
                    var h = new Xv();
                    h.setPositions(s.slice(6 * u, 6 * u + 6)),
                      h.setColors(l.slice(6 * u, 6 * u + 6));
                    var d = new zv({
                        color: 16777215,
                        linewidth: 0.001 * o,
                        vertexColors: $t,
                        dashed: !1
                      }),
                      p = new Wv(h, d);
                    p.computeLineDistances(), c.add(p);
                  }
                  return (
                    (this.refs.obj = c),
                    (c.uuid = E()()),
                    (c.visible = n),
                    c.uuid
                  );
                }
              },
              {
                key: "dispose",
                value: function() {
                  qv.disposeNode(this.refs.obj, !0), (this.refs.obj = null);
                }
              }
            ]) && Zv(n.prototype, r),
            i && Zv(n, i),
            t
          );
        })(Iv);
        function ng(e) {
          return (ng =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function rg(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function ig(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function ag(e, t) {
          return !t || ("object" !== ng(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function og(e, t, n) {
          return (og =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = sg(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function sg(e) {
          return (sg = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function lg(e, t) {
          return (lg =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var cg = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "Model" : i,
              o = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = ag(
                this,
                sg(t).call(this, { controller: r, name: o, type: a })
              )).root = null),
              (n.nodes = []),
              (n.depth = 0),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && lg(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return og(sg(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return e._addModel({ assetID: n.assetID, config: n });
                    })
                    .then(function(t) {
                      var n = t.elUuid;
                      return (e.uuid = n), !0;
                    })
                    .then(function() {
                      return e._createChildren(
                        n.nodeInfo,
                        e.refs.obj.children[0],
                        0
                      );
                    })
                    .then(function() {
                      return (e.root = e.nodes[0]), !0;
                    });
                }
              },
              {
                key: "_addModel",
                value: function(e) {
                  var t = this,
                    n = e.assetID,
                    r = e.config;
                  return this._loadModel({ assetID: n, config: r }).then(
                    function(e) {
                      var n = e.obj;
                      return (
                        (t.refs.obj = new THREE.Object3D()),
                        t.refs.obj.add(n.scene.children[0].clone()),
                        { elUuid: t.refs.obj.uuid }
                      );
                    }
                  );
                }
              },
              {
                key: "_loadModel",
                value: function(e) {
                  var t = e.assetID;
                  return this.controller.assetManager.load(t);
                }
              },
              {
                key: "_createChildren",
                value: function(e, t, n) {
                  var r = this;
                  if (!e[t.name])
                    throw new Error(
                      "Object ".concat(t.name, " doesnt have it's node info")
                    );
                  n + 1 > this.depth && (this.depth = n + 1);
                  var i = {
                    obj: t,
                    userData: {
                      id: e[t.name].id,
                      type: e[t.name].type,
                      nodeID: e[t.name].nodeID
                    }
                  };
                  return this.controller
                    .createElement({ type: "Node", addable: !1, config: i })
                    .then(function(i) {
                      var a = i.element;
                      r.nodes = [].concat(rg(r.nodes), [a.uuid]);
                      var o = [];
                      return (
                        Object.keys(e[t.name].children).forEach(function(i) {
                          var a = t.children.find(function(e) {
                            return e.name === i;
                          });
                          if (!a)
                            throw new Error(
                              "Object with given name ".concat(
                                i,
                                " doesn't exist"
                              )
                            );
                          o = [].concat(rg(o), [
                            r._createChildren(e[t.name].children, a, n + 1)
                          ]);
                        }),
                        Promise.all(o)
                      );
                    });
                }
              },
              {
                key: "getInfo",
                value: function() {
                  var e = this,
                    t = { nodes: {} };
                  return (
                    this.nodes.forEach(function(n) {
                      t.nodes[n] = e.controller.getElement(n).getInfo();
                    }),
                    t
                  );
                }
              },
              {
                key: "_disposeChildren",
                value: function() {
                  var e = this;
                  this.nodes.forEach(function(t) {
                    e.controller.disposeElement({ elementID: t });
                  });
                }
              },
              {
                key: "dispose",
                value: function() {
                  this._disposeChildren(),
                    qv.disposeNode(this.refs.obj, !1),
                    (this.refs.obj = null);
                }
              }
            ]) && ig(n.prototype, r),
            i && ig(n, i),
            t
          );
        })(Iv);
        function ug(e) {
          return (ug =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function hg(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function dg(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function pg(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? dg(Object(n), !0).forEach(function(t) {
                  fg(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : dg(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function fg(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function mg(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function vg(e, t) {
          return !t || ("object" !== ug(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function gg(e, t, n) {
          return (gg =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = yg(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function yg(e) {
          return (yg = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function bg(e, t) {
          return (bg =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var xg = (function(e) {
          function t(e) {
            var n = e.controller,
              r = e.type,
              i = void 0 === r ? "Camera" : r,
              a = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              vg(this, yg(t).call(this, { controller: n, name: a, type: i }))
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && bg(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return gg(yg(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (
                        (e.controlsID = null),
                        (e.uuid = e._createCamera(n.cameraType, n)),
                        !0
                      );
                    });
                }
              },
              {
                key: "_createCamera",
                value: function(e) {
                  var t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : {},
                    n = null;
                  switch (e) {
                    case "PerspectiveCamera":
                      n = new THREE.PerspectiveCamera(45, 1, 1, 10);
                      break;
                    case "OrthographicCamera":
                      n = new THREE.OrthographicCamera(-1, 1, 1, -1, 1, 100);
                      break;
                    default:
                      throw new Error("Unsupported camera type ".concat(e));
                  }
                  return (
                    n.position.set(1, 1, 1),
                    (this.refs.obj = n),
                    (this.refs.obj.userData = pg({}, t.userData)),
                    (this.direction = new THREE.Vector3(0, 0, 0)),
                    this.refs.obj.uuid
                  );
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.refs.obj = null;
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = e.delegate,
                    u = void 0 === c || c,
                    h = this.refs.obj,
                    d = l,
                    p = o;
                  if (!l)
                    switch (n) {
                      case "direction":
                        var f;
                        null !== r &&
                          (u && this.controlsID
                            ? this.controller
                                .getElement(this.controlsID)
                                .setProperty({
                                  key: "target",
                                  value: r,
                                  valueType: i,
                                  delegate: !1
                                })
                            : ((f = this.direction).set.apply(f, hg(r)),
                              h.lookAt(this.direction)),
                          (d = !0));
                        break;
                      case "position":
                        var m;
                        u && this.controlsID
                          ? (this.controller
                              .getElement(this.controlsID)
                              .setProperty({
                                key: n,
                                value: r,
                                valueType: i,
                                delegate: !1
                              }),
                            (d = !0),
                            (p = !1))
                          : ((m = h.position).set.apply(m, hg(r)),
                            h.lookAt(this.direction),
                            (d = !0));
                        break;
                      case "rotation":
                      case "quaternion":
                      case "scale":
                        (d = !0), (p = !1);
                    }
                  var v = gg(yg(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: p,
                    ignore: d
                  });
                  return h.updateProjectionMatrix(), v;
                }
              },
              {
                key: "setControls",
                value: function(e) {
                  this.controlsID = e;
                }
              },
              {
                key: "getProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.valueType;
                  switch (n) {
                    case "direction":
                      var i = this.direction;
                      return [i.x, i.y, i.z];
                  }
                  return gg(yg(t.prototype), "getProperty", this).call(this, {
                    key: n,
                    valueType: r
                  });
                }
              }
            ]) && mg(n.prototype, r),
            i && mg(n, i),
            t
          );
        })(Iv);
        function wg(e, t) {
          if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function");
        }
        function _g(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Mg(e, t, n) {
          return t && _g(e.prototype, t), n && _g(e, n), e;
        }
        function Tg(e) {
          return (Tg = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Ag(e, t) {
          return (Ag =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        function Sg(e) {
          if (void 0 === e)
            throw new ReferenceError(
              "this hasn't been initialised - super() hasn't been called"
            );
          return e;
        }
        var Eg,
          Rg,
          Pg,
          Ig,
          Dg,
          Og,
          Cg,
          Lg,
          Ng,
          Fg,
          kg,
          Ug = (function() {
            function e() {
              wg(this, e), (this._listeners = {});
            }
            return (
              Mg(e, [
                {
                  key: "addEventListener",
                  value: function(e, t) {
                    var n = this._listeners;
                    void 0 === n[e] && (n[e] = []),
                      -1 === n[e].indexOf(t) && n[e].push(t);
                  }
                },
                {
                  key: "hasEventListener",
                  value: function(e, t) {
                    var n = this._listeners;
                    return void 0 !== n[e] && -1 !== n[e].indexOf(t);
                  }
                },
                {
                  key: "removeEventListener",
                  value: function(e, t) {
                    var n = this._listeners[e];
                    if (void 0 !== n) {
                      var r = n.indexOf(t);
                      -1 !== r && n.splice(r, 1);
                    }
                  }
                },
                {
                  key: "dispatchEvent",
                  value: function(e) {
                    var t = this._listeners[e.type];
                    if (void 0 !== t) {
                      e.target = this;
                      for (var n = t.slice(0), r = 0, i = n.length; r < i; r++)
                        n[r].call(this, e);
                    }
                  }
                }
              ]),
              e
            );
          })(),
          jg = 2 * Math.PI,
          Bg = {
            NONE: -1,
            ROTATE: 0,
            DOLLY: 1,
            TRUCK: 2,
            TOUCH_ROTATE: 3,
            TOUCH_DOLLY_TRUCK: 4,
            TOUCH_TRUCK: 5
          };
        function zg(e) {
          return isFinite(e) ? e : e < 0 ? -Number.MAX_VALUE : Number.MAX_VALUE;
        }
        function Vg(e) {
          return Math.abs(e) < Number.MAX_VALUE ? e : e * (1 / 0);
        }
        var Gg = (function(e) {
          function t(e, n) {
            var r,
              i =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : {};
            if (
              (wg(this, t),
              ((r = (function(e, t) {
                return !t || ("object" != typeof t && "function" != typeof t)
                  ? Sg(e)
                  : t;
              })(this, Tg(t).call(this)))._camera = e),
              (r._yAxisUpSpace = new Eg.Quaternion().setFromUnitVectors(
                r._camera.up,
                Rg
              )),
              (r._yAxisUpSpaceInverse = r._yAxisUpSpace.clone().inverse()),
              (r._state = Bg.NONE),
              (r.enabled = !0),
              r._camera.isPerspectiveCamera
                ? ((r.minDistance = 0), (r.maxDistance = 1 / 0))
                : r._camera.isOrthographicCamera &&
                  ((r.minZoom = 0), (r.maxZoom = 1 / 0)),
              (r.minPolarAngle = 0),
              (r.maxPolarAngle = Math.PI),
              (r.minAzimuthAngle = -1 / 0),
              (r.maxAzimuthAngle = 1 / 0),
              (r._boundary = new Eg.Box3(
                new Eg.Vector3(-1 / 0, -1 / 0, -1 / 0),
                new Eg.Vector3(1 / 0, 1 / 0, 1 / 0)
              )),
              (r.boundaryFriction = 0),
              (r._boundaryEnclosesCamera = !1),
              (r.dampingFactor = 0.05),
              (r.draggingDampingFactor = 0.25),
              (r.azimuthRotateSpeed = 1),
              (r.polarRotateSpeed = 1),
              (r.dollySpeed = 1),
              (r.truckSpeed = 2),
              (r.dollyToCursor = !1),
              (r.verticalDragToForward = !1),
              (r._domElement = n),
              (r._viewport = null),
              (r._target = new Eg.Vector3()),
              (r._targetEnd = new Eg.Vector3()),
              (r._spherical = new Eg.Spherical().setFromVector3(
                r._camera.position.clone().applyQuaternion(r._yAxisUpSpace)
              )),
              (r._sphericalEnd = r._spherical.clone()),
              (r._target0 = r._target.clone()),
              (r._position0 = r._camera.position.clone()),
              (r._zoom0 = r._camera.zoom),
              (r._dollyControlAmount = 0),
              (r._dollyControlCoord = new Eg.Vector2()),
              (r._hasUpdated = !0),
              r.update(0),
              !r._domElement || i.ignoreDOMEventListeners)
            )
              r._removeAllEventListeners = function() {};
            else {
              var a,
                o = function(e, t) {
                  if (
                    (t.set(0, 0),
                    (function(e) {
                      return "TouchEvent" in window && e instanceof TouchEvent;
                    })(e))
                  ) {
                    for (var n = 0; n < e.touches.length; n++)
                      (t.x += e.touches[n].clientX),
                        (t.y += e.touches[n].clientY);
                    return (
                      (t.x /= e.touches.length), (t.y /= e.touches.length), t
                    );
                  }
                  return t.set(e.clientX, e.clientY), t;
                },
                s = function(e) {
                  if (v.enabled) {
                    e.preventDefault();
                    var t = v._state;
                    switch (e.button) {
                      case Eg.MOUSE.LEFT:
                        v._state = Bg.ROTATE;
                        break;
                      case Eg.MOUSE.MIDDLE:
                        v._state = Bg.DOLLY;
                        break;
                      case Eg.MOUSE.RIGHT:
                        v._state = Bg.TRUCK;
                    }
                    t !== v._state && h(e);
                  }
                },
                l = function(e) {
                  if (v.enabled) {
                    e.preventDefault();
                    var t = v._state;
                    switch (e.touches.length) {
                      case 1:
                        v._state = Bg.TOUCH_ROTATE;
                        break;
                      case 2:
                        v._state = Bg.TOUCH_DOLLY_TRUCK;
                        break;
                      case 3:
                        v._state = Bg.TOUCH_TRUCK;
                    }
                    t !== v._state && h(e);
                  }
                },
                c = function(e) {
                  if (v.enabled) {
                    e.preventDefault();
                    var t,
                      n,
                      r,
                      i = 0 === navigator.platform.indexOf("Mac") ? -1 : -3;
                    (t =
                      void 0 !== e.wheelDelta
                        ? e.wheelDelta / 120
                        : 1 === e.deltaMode
                        ? e.deltaY / i
                        : e.deltaY / (10 * i)),
                      v.dollyToCursor &&
                        ((a = v._getClientRect(Cg)),
                        (n = ((e.clientX - a.x) / a.z) * 2 - 1),
                        (r = ((e.clientY - a.y) / a.w) * -2 + 1)),
                      m(-t, n, r),
                      v.dispatchEvent({ type: "control", originalEvent: e });
                  }
                },
                u = function(e) {
                  v.enabled && e.preventDefault();
                },
                h = function(e) {
                  if (v.enabled) {
                    if (
                      (e.preventDefault(),
                      o(e, Pg),
                      (a = v._getClientRect(Cg)),
                      g.copy(Pg),
                      v._state === Bg.TOUCH_DOLLY_TRUCK)
                    ) {
                      var t = Pg.x - e.touches[1].clientX,
                        n = Pg.y - e.touches[1].clientY,
                        r = Math.sqrt(t * t + n * n);
                      y.set(0, r);
                      var i =
                          0.5 * (e.touches[0].clientX + e.touches[1].clientX),
                        s = 0.5 * (e.touches[0].clientY + e.touches[1].clientY);
                      g.set(i, s);
                    }
                    document.addEventListener("mousemove", d, { passive: !1 }),
                      document.addEventListener("touchmove", d, {
                        passive: !1
                      }),
                      document.addEventListener("mouseup", p),
                      document.addEventListener("touchend", p),
                      v.dispatchEvent({
                        type: "controlstart",
                        originalEvent: e
                      });
                  }
                },
                d = function(e) {
                  if (v.enabled) {
                    e.preventDefault(), o(e, Pg);
                    var t = g.x - Pg.x,
                      n = g.y - Pg.y;
                    switch ((g.copy(Pg), v._state)) {
                      case Bg.ROTATE:
                      case Bg.TOUCH_ROTATE:
                        var r = (jg * v.azimuthRotateSpeed * t) / a.z,
                          i = (jg * v.polarRotateSpeed * n) / a.w;
                        v.rotate(r, i, !0);
                        break;
                      case Bg.DOLLY:
                        break;
                      case Bg.TOUCH_DOLLY_TRUCK:
                        var s = Pg.x - e.touches[1].clientX,
                          l = Pg.y - e.touches[1].clientY,
                          c = Math.sqrt(s * s + l * l),
                          u = y.y - c,
                          h = v.dollyToCursor ? ((g.x - a.x) / a.z) * 2 - 1 : 0,
                          d = v.dollyToCursor
                            ? ((g.y - a.y) / a.w) * -2 + 1
                            : 0;
                        m(u / 8, h, d), y.set(0, c), f(t, n);
                        break;
                      case Bg.TRUCK:
                      case Bg.TOUCH_TRUCK:
                        f(t, n);
                    }
                    v.dispatchEvent({ type: "control", originalEvent: e });
                  }
                },
                p = function e(t) {
                  v.enabled &&
                    ((v._state = Bg.NONE),
                    document.removeEventListener("mousemove", d, {
                      passive: !1
                    }),
                    document.removeEventListener("touchmove", d, {
                      passive: !1
                    }),
                    document.removeEventListener("mouseup", e),
                    document.removeEventListener("touchend", e),
                    v.dispatchEvent({ type: "controlend", originalEvent: t }));
                },
                f = function(e, t) {
                  if (v._camera.isPerspectiveCamera) {
                    var n = Ig.copy(v._camera.position).sub(v._target),
                      r = v._camera.fov * Eg.Math.DEG2RAD,
                      i = n.length() * Math.tan(r / 2),
                      o = (v.truckSpeed * e * i) / a.w,
                      s = (v.truckSpeed * t * i) / a.w;
                    v.verticalDragToForward
                      ? (v.truck(o, 0, !0), v.forward(-s, !0))
                      : v.truck(o, s, !0);
                  } else if (v._camera.isOrthographicCamera) {
                    var l =
                        (e * (v._camera.right - v._camera.left)) /
                        v._camera.zoom /
                        a.z,
                      c =
                        (t * (v._camera.top - v._camera.bottom)) /
                        v._camera.zoom /
                        a.w;
                    v.truck(l, c, !0);
                  }
                },
                m = function(e, t, n) {
                  var r = Math.pow(0.95, -e * v.dollySpeed);
                  if (v._camera.isPerspectiveCamera) {
                    var i = v._sphericalEnd.radius * r - v._sphericalEnd.radius,
                      a = v._sphericalEnd.radius;
                    v.dolly(i),
                      v.dollyToCursor &&
                        ((v._dollyControlAmount += v._sphericalEnd.radius - a),
                        v._dollyControlCoord.set(t, n));
                  } else
                    v._camera.isOrthographicCamera &&
                      ((v._camera.zoom = Math.max(
                        v.minZoom,
                        Math.min(v.maxZoom, v._camera.zoom * r)
                      )),
                      v._camera.updateProjectionMatrix(),
                      (v._hasUpdated = !0));
                },
                v = Sg(r),
                g = new Eg.Vector2(),
                y = new Eg.Vector2();
              r._domElement.addEventListener("mousedown", s),
                r._domElement.addEventListener("touchstart", l),
                r._domElement.addEventListener("wheel", c),
                r._domElement.addEventListener("contextmenu", u),
                (r._removeAllEventListeners = function() {
                  v._domElement.removeEventListener("mousedown", s),
                    v._domElement.removeEventListener("touchstart", l),
                    v._domElement.removeEventListener("wheel", c),
                    v._domElement.removeEventListener("contextmenu", u),
                    document.removeEventListener("mousemove", d),
                    document.removeEventListener("touchmove", d),
                    document.removeEventListener("mouseup", p),
                    document.removeEventListener("touchend", p);
                });
            }
            return r;
          }
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Ag(e, t);
            })(t, e),
            Mg(t, null, [
              {
                key: "install",
                value: function(e) {
                  (Eg = e.THREE),
                    (Rg = new Eg.Vector3(0, 1, 0)),
                    (Pg = new Eg.Vector2()),
                    (Ig = new Eg.Vector3()),
                    (Dg = new Eg.Vector3()),
                    (Og = new Eg.Vector3()),
                    (Cg = new Eg.Vector4()),
                    (Lg = new Eg.Vector3()),
                    (Ng = new Eg.Vector3()),
                    (Fg = new Eg.Spherical()),
                    (kg = new Eg.Spherical());
                }
              }
            ]),
            Mg(t, [
              {
                key: "rotate",
                value: function(e, t, n) {
                  this.rotateTo(
                    this._sphericalEnd.theta + e,
                    this._sphericalEnd.phi + t,
                    n
                  );
                }
              },
              {
                key: "rotateTo",
                value: function(e, t, n) {
                  var r = Math.max(
                      this.minAzimuthAngle,
                      Math.min(this.maxAzimuthAngle, e)
                    ),
                    i = Math.max(
                      this.minPolarAngle,
                      Math.min(this.maxPolarAngle, t)
                    );
                  (this._sphericalEnd.theta = r),
                    (this._sphericalEnd.phi = i),
                    this._sphericalEnd.makeSafe(),
                    n ||
                      ((this._spherical.theta = this._sphericalEnd.theta),
                      (this._spherical.phi = this._sphericalEnd.phi)),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "dolly",
                value: function(e, t) {
                  this._camera.isOrthographicCamera ||
                    this.dollyTo(this._sphericalEnd.radius + e, t);
                }
              },
              {
                key: "dollyTo",
                value: function(e, t) {
                  this._camera.isOrthographicCamera ||
                    ((this._sphericalEnd.radius = Eg.Math.clamp(
                      e,
                      this.minDistance,
                      this.maxDistance
                    )),
                    t || (this._spherical.radius = this._sphericalEnd.radius),
                    (this._hasUpdated = !0));
                }
              },
              {
                key: "pan",
                value: function(e, t, n) {
                  this.truck(e, t, n);
                }
              },
              {
                key: "truck",
                value: function(e, t, n) {
                  this._camera.updateMatrix(),
                    Lg.setFromMatrixColumn(this._camera.matrix, 0),
                    Ng.setFromMatrixColumn(this._camera.matrix, 1),
                    Lg.multiplyScalar(e),
                    Ng.multiplyScalar(-t);
                  var r = Ig.copy(Lg).add(Ng);
                  this._encloseToBoundary(
                    this._targetEnd,
                    r,
                    this.boundaryFriction
                  ),
                    n || this._target.copy(this._targetEnd),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "forward",
                value: function(e, t) {
                  Ig.setFromMatrixColumn(this._camera.matrix, 0),
                    Ig.crossVectors(this._camera.up, Ig),
                    Ig.multiplyScalar(e),
                    this._encloseToBoundary(
                      this._targetEnd,
                      Ig,
                      this.boundaryFriction
                    ),
                    t || this._target.copy(this._targetEnd),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "moveTo",
                value: function(e, t, n, r) {
                  this._targetEnd.set(e, t, n),
                    r || this._target.copy(this._targetEnd),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "fitTo",
                value: function(e, t) {
                  var n =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : {};
                  if (!this._camera.isOrthographicCamera) {
                    var r = n.paddingLeft || 0,
                      i = n.paddingRight || 0,
                      a = n.paddingBottom || 0,
                      o = n.paddingTop || 0,
                      s = e.isBox3 ? e.clone() : new Eg.Box3().setFromObject(e),
                      l = s.getSize(Ig),
                      c = l.x + r + i,
                      u = l.y + o + a,
                      h = l.z,
                      d = this.getDistanceToFit(c, u, h);
                    this.dollyTo(d, t);
                    var p = s.getCenter(Ig),
                      f = p.x - (0.5 * r - 0.5 * i),
                      m = p.y + (0.5 * o - 0.5 * a),
                      v = p.z;
                    this.moveTo(f, m, v, t),
                      this.normalizeRotations(),
                      this.rotateTo(0, 90 * Eg.Math.DEG2RAD, t);
                  }
                }
              },
              {
                key: "setLookAt",
                value: function(e, t, n, r, i, a, o) {
                  var s = Ig.set(e, t, n),
                    l = Dg.set(r, i, a);
                  this._targetEnd.copy(l),
                    this._sphericalEnd.setFromVector3(
                      s.sub(l).applyQuaternion(this._yAxisUpSpace)
                    ),
                    this.normalizeRotations(),
                    o ||
                      (this._target.copy(this._targetEnd),
                      this._spherical.copy(this._sphericalEnd)),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "lerpLookAt",
                value: function(e, t, n, r, i, a, o, s, l, c, u, h, d, p) {
                  var f = Ig.set(e, t, n),
                    m = Dg.set(r, i, a);
                  Fg.setFromVector3(
                    f.sub(m).applyQuaternion(this._yAxisUpSpace)
                  );
                  var v = Ig.set(c, u, h);
                  this._targetEnd.copy(m).lerp(v, d);
                  var g = Dg.set(o, s, l);
                  kg.setFromVector3(
                    g.sub(v).applyQuaternion(this._yAxisUpSpace)
                  );
                  var y = kg.theta - Fg.theta,
                    b = kg.phi - Fg.phi,
                    x = kg.radius - Fg.radius;
                  this._sphericalEnd.set(
                    Fg.radius + x * d,
                    Fg.phi + b * d,
                    Fg.theta + y * d
                  ),
                    this.normalizeRotations(),
                    p ||
                      (this._target.copy(this._targetEnd),
                      this._spherical.copy(this._sphericalEnd)),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "setPosition",
                value: function(e, t, n, r) {
                  this.setLookAt(
                    e,
                    t,
                    n,
                    this._targetEnd.x,
                    this._targetEnd.y,
                    this._targetEnd.z,
                    r
                  );
                }
              },
              {
                key: "setTarget",
                value: function(e, t, n, r) {
                  var i = this.getPosition(Ig);
                  this.setLookAt(i.x, i.y, i.z, e, t, n, r);
                }
              },
              {
                key: "setBoundary",
                value: function(e) {
                  if (!e)
                    return (
                      this._boundary.min.set(-1 / 0, -1 / 0, -1 / 0),
                      this._boundary.max.set(1 / 0, 1 / 0, 1 / 0),
                      void (this._hasUpdated = !0)
                    );
                  this._boundary.copy(e),
                    this._boundary.clampPoint(this._targetEnd, this._targetEnd),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "setViewport",
                value: function(e, t, n, r) {
                  null !== e
                    ? ((this._viewport = this._viewport || new Eg.Vector4()),
                      "number" == typeof e
                        ? this._viewport.set(e, t, n, r)
                        : this._viewport.copy(e))
                    : (this._viewport = null);
                }
              },
              {
                key: "getDistanceToFit",
                value: function(e, t, n) {
                  var r = this._camera,
                    i = e / t,
                    a = r.fov * Eg.Math.DEG2RAD,
                    o = r.aspect;
                  return (
                    (0.5 * (i < o ? t : e / o)) / Math.tan(0.5 * a) + 0.5 * n
                  );
                }
              },
              {
                key: "getTarget",
                value: function(e) {
                  return (e && e.isVector3 ? e : new Eg.Vector3()).copy(
                    this._targetEnd
                  );
                }
              },
              {
                key: "getPosition",
                value: function(e) {
                  return (e && e.isVector3 ? e : new Eg.Vector3())
                    .setFromSpherical(this._sphericalEnd)
                    .applyQuaternion(this._yAxisUpSpaceInverse)
                    .add(this._targetEnd);
                }
              },
              {
                key: "normalizeRotations",
                value: function() {
                  (this._sphericalEnd.theta = this._sphericalEnd.theta % jg),
                    (this._spherical.theta +=
                      jg *
                      Math.round(
                        (this._sphericalEnd.theta - this._spherical.theta) / jg
                      ));
                }
              },
              {
                key: "reset",
                value: function(e) {
                  this.setLookAt(
                    this._position0.x,
                    this._position0.y,
                    this._position0.z,
                    this._target0.x,
                    this._target0.y,
                    this._target0.z,
                    e
                  );
                }
              },
              {
                key: "saveState",
                value: function() {
                  this._target0.copy(this._target),
                    this._position0.copy(this._camera.position),
                    (this._zoom0 = this._camera.zoom);
                }
              },
              {
                key: "updateCameraUp",
                value: function() {
                  this._yAxisUpSpace.setFromUnitVectors(this._camera.up, Rg),
                    this._yAxisUpSpaceInverse
                      .copy(this._yAxisUpSpace)
                      .inverse();
                }
              },
              {
                key: "update",
                value: function(e) {
                  var t =
                      this._state === Bg.NONE
                        ? this.dampingFactor
                        : this.draggingDampingFactor,
                    n = 1 - Math.exp((-t * e) / 0.016),
                    r = this._sphericalEnd.theta - this._spherical.theta,
                    i = this._sphericalEnd.phi - this._spherical.phi,
                    a = this._sphericalEnd.radius - this._spherical.radius,
                    o = Ig.subVectors(this._targetEnd, this._target);
                  if (
                    (Math.abs(r) > 0.001 ||
                    Math.abs(i) > 0.001 ||
                    Math.abs(a) > 0.001 ||
                    Math.abs(o.x) > 0.001 ||
                    Math.abs(o.y) > 0.001 ||
                    Math.abs(o.z) > 0.001
                      ? (this._spherical.set(
                          this._spherical.radius + a * n,
                          this._spherical.phi + i * n,
                          this._spherical.theta + r * n
                        ),
                        this._target.add(o.multiplyScalar(n)),
                        (this._hasUpdated = !0))
                      : (this._spherical.copy(this._sphericalEnd),
                        this._target.copy(this._targetEnd)),
                    0 !== this._dollyControlAmount)
                  ) {
                    if (this._camera.isPerspectiveCamera) {
                      var s = Ig.copy(
                          Ig.setFromSpherical(
                            this._sphericalEnd
                          ).applyQuaternion(this._yAxisUpSpaceInverse)
                        )
                          .normalize()
                          .negate(),
                        l = Dg.copy(s)
                          .cross(Og.copy(this._camera.up))
                          .normalize();
                      0 === l.lengthSq() && (l.x = 1);
                      var c = Og.crossVectors(l, s),
                        u =
                          this._sphericalEnd.radius *
                          Math.tan(this._camera.fov * Eg.Math.DEG2RAD * 0.5),
                        h =
                          (this._sphericalEnd.radius -
                            this._dollyControlAmount -
                            this._sphericalEnd.radius) /
                          this._sphericalEnd.radius,
                        d = Ig.copy(this._targetEnd)
                          .add(
                            l.multiplyScalar(
                              this._dollyControlCoord.x *
                                u *
                                this._camera.aspect
                            )
                          )
                          .add(c.multiplyScalar(this._dollyControlCoord.y * u));
                      this._targetEnd.lerp(d, h),
                        this._target.copy(this._targetEnd);
                    }
                    this._dollyControlAmount = 0;
                  }
                  this._spherical.makeSafe(),
                    this._camera.position
                      .setFromSpherical(this._spherical)
                      .applyQuaternion(this._yAxisUpSpaceInverse)
                      .add(this._target),
                    this._camera.lookAt(this._target),
                    this._boundaryEnclosesCamera &&
                      this._encloseToBoundary(
                        this._camera.position.copy(this._target),
                        Ig.setFromSpherical(this._spherical).applyQuaternion(
                          this._yAxisUpSpaceInverse
                        ),
                        1
                      );
                  var p = this._hasUpdated;
                  return (
                    (this._hasUpdated = !1),
                    p && this.dispatchEvent({ type: "update" }),
                    p
                  );
                }
              },
              {
                key: "toJSON",
                value: function() {
                  return JSON.stringify({
                    enabled: this.enabled,
                    minDistance: this.minDistance,
                    maxDistance: zg(this.maxDistance),
                    minPolarAngle: this.minPolarAngle,
                    maxPolarAngle: zg(this.maxPolarAngle),
                    minAzimuthAngle: zg(this.minAzimuthAngle),
                    maxAzimuthAngle: zg(this.maxAzimuthAngle),
                    dampingFactor: this.dampingFactor,
                    draggingDampingFactor: this.draggingDampingFactor,
                    dollySpeed: this.dollySpeed,
                    truckSpeed: this.truckSpeed,
                    dollyToCursor: this.dollyToCursor,
                    verticalDragToForward: this.verticalDragToForward,
                    target: this._targetEnd.toArray(),
                    position: this._camera.position.toArray(),
                    target0: this._target0.toArray(),
                    position0: this._position0.toArray()
                  });
                }
              },
              {
                key: "fromJSON",
                value: function(e, t) {
                  var n = JSON.parse(e),
                    r = new Eg.Vector3().fromArray(n.position);
                  (this.enabled = n.enabled),
                    (this.minDistance = n.minDistance),
                    (this.maxDistance = Vg(n.maxDistance)),
                    (this.minPolarAngle = n.minPolarAngle),
                    (this.maxPolarAngle = Vg(n.maxPolarAngle)),
                    (this.minAzimuthAngle = Vg(n.minAzimuthAngle)),
                    (this.maxAzimuthAngle = Vg(n.maxAzimuthAngle)),
                    (this.dampingFactor = n.dampingFactor),
                    (this.draggingDampingFactor = n.draggingDampingFactor),
                    (this.dollySpeed = n.dollySpeed),
                    (this.truckSpeed = n.truckSpeed),
                    (this.dollyToCursor = n.dollyToCursor),
                    (this.verticalDragToForward = n.verticalDragToForward),
                    this._target0.fromArray(n.target0),
                    this._position0.fromArray(n.position0),
                    this._targetEnd.fromArray(n.target),
                    this._sphericalEnd.setFromVector3(
                      r.sub(this._target0).applyQuaternion(this._yAxisUpSpace)
                    ),
                    t ||
                      (this._target.copy(this._targetEnd),
                      this._spherical.copy(this._sphericalEnd)),
                    (this._hasUpdated = !0);
                }
              },
              {
                key: "dispose",
                value: function() {
                  this._removeAllEventListeners();
                }
              },
              {
                key: "_encloseToBoundary",
                value: function(e, t, n) {
                  var r = t.lengthSq();
                  if (0 === r) return e;
                  var i = Dg.copy(t).add(e),
                    a = this._boundary.clampPoint(i, Og).sub(i),
                    o = a.lengthSq();
                  if (0 === o) return e.add(t);
                  if (o === r) return e;
                  if (0 === n) return e.add(t).add(a);
                  var s = 1 + (n * o) / t.dot(a);
                  return e
                    .add(Dg.copy(t).multiplyScalar(s))
                    .add(a.multiplyScalar(1 - n));
                }
              },
              {
                key: "_getClientRect",
                value: function(e) {
                  var t = this._domElement.getBoundingClientRect();
                  return (
                    (e.x = t.left),
                    (e.y = t.top),
                    this._viewport
                      ? ((e.x += this._viewport.x),
                        (e.y += t.height - this._viewport.w - this._viewport.y),
                        (e.z = this._viewport.z),
                        (e.w = this._viewport.w))
                      : ((e.z = t.width), (e.w = t.height)),
                    e
                  );
                }
              },
              {
                key: "phiSpeed",
                set: function(e) {
                  this.azimuthRotateSpeed = e;
                }
              },
              {
                key: "thetaSpeed",
                set: function(e) {
                  this.polarRotateSpeed = e;
                }
              },
              {
                key: "boundaryEnclosesCamera",
                get: function() {
                  return this._boundaryEnclosesCamera;
                },
                set: function(e) {
                  (this._boundaryEnclosesCamera = e), (this._hasUpdated = !0);
                }
              }
            ]),
            t
          );
        })(Ug);
        function Hg(e) {
          return (Hg =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Xg(e, t) {
          return (
            (function(e) {
              if (Array.isArray(e)) return e;
            })(e) ||
            (function(e, t) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              ) {
                var n = [],
                  r = !0,
                  i = !1,
                  a = void 0;
                try {
                  for (
                    var o, s = e[Symbol.iterator]();
                    !(r = (o = s.next()).done) &&
                    (n.push(o.value), !t || n.length !== t);
                    r = !0
                  );
                } catch (e) {
                  (i = !0), (a = e);
                } finally {
                  try {
                    r || null == s.return || s.return();
                  } finally {
                    if (i) throw a;
                  }
                }
                return n;
              }
            })(e, t) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to destructure non-iterable instance"
              );
            })()
          );
        }
        function Wg(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Yg(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function qg(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Qg(e, t) {
          return !t || ("object" !== Hg(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Zg(e, t, n) {
          return (Zg =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Jg(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Jg(e) {
          return (Jg = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Kg(e, t) {
          return (Kg =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var $g = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "CameraControls" : i,
              o = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = Qg(
                this,
                Jg(t).call(this, {
                  controller: r,
                  name: o,
                  type: a,
                  updatable: !0
                })
              )).state = "idle"),
              (n.updateDelay = 150),
              (n.transitionEnabled = !1),
              (n.autoRotate = !1),
              (n.autoRotateSpeed = 1),
              n
            );
          }
          var n, i, a;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Kg(e, t);
            })(t, e),
            (n = t),
            (i = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return Zg(Jg(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      (e.container = n.container),
                        (e.onElementChanged = n.onElementChanged),
                        (e.cameraID = n.cameraID),
                        (e.targetID = null),
                        (e.uuid = E()()),
                        (e.userData = n.userData);
                      var t = e.controller.getElement(n.cameraID);
                      if (t) {
                        var r = e.controller.getObject(n.cameraID);
                        e._createCameraControls(r), t.setControls(e.uuid);
                      }
                      return !0;
                    });
                }
              },
              {
                key: "update",
                value: function(e) {
                  this.autoRotate &&
                    "idle" === this.state &&
                    this.refs.obj.rotate(e * this.autoRotateSpeed, 0, !1),
                    this.refs.obj.update(e);
                }
              },
              {
                key: "_createCameraControls",
                value: function(e) {
                  return (
                    Gg.install({ THREE: r }),
                    (this.refs.obj = new Gg(e, this.container)),
                    (this._onControlStart = this._onControlStart.bind(this)),
                    (this._onControl = this._onControl.bind(this)),
                    (this._onControlEnd = this._onControlEnd.bind(this)),
                    (this._onUpdate = this._onUpdate.bind(this)),
                    this._updateNotifyReset(),
                    this.refs.obj.addEventListener(
                      "controlstart",
                      this._onControlStart,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "control",
                      this._onControl,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "controlend",
                      this._onControlEnd,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "update",
                      this._onUpdate,
                      !1
                    ),
                    (this.refs.obj.userData = (function(e) {
                      for (var t = 1; t < arguments.length; t++) {
                        var n = null != arguments[t] ? arguments[t] : {};
                        t % 2
                          ? Wg(Object(n), !0).forEach(function(t) {
                              Yg(e, t, n[t]);
                            })
                          : Object.getOwnPropertyDescriptors
                          ? Object.defineProperties(
                              e,
                              Object.getOwnPropertyDescriptors(n)
                            )
                          : Wg(Object(n)).forEach(function(t) {
                              Object.defineProperty(
                                e,
                                t,
                                Object.getOwnPropertyDescriptor(n, t)
                              );
                            });
                      }
                      return e;
                    })({}, this.userData)),
                    (this.refs.obj.uuid = this.uuid),
                    this.updateCameraData(),
                    this.refs.obj.uuid
                  );
                }
              },
              {
                key: "_onControlStart",
                value: function(e) {
                  document.dispatchEvent(new Event("pulseUpdate")),
                    this._notifyChangedImmediate(),
                    this.setProperty({ key: "state", value: "dragging" }),
                    document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "_onControl",
                value: function(e) {
                  document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "_onControlEnd",
                value: function(e) {
                  document.dispatchEvent(new Event("pulseUpdate")),
                    this._notifyChangedImmediate(),
                    this.setProperty({ key: "state", value: "idle" });
                }
              },
              {
                key: "_onUpdate",
                value: function(e) {
                  this.refs.obj &&
                    (document.dispatchEvent(new Event("pulseUpdate")),
                    this._notifyChanged());
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this.controller.getElement(this.cameraID);
                  e && e.setControls(null),
                    this.refs.obj &&
                      (this.refs.obj.removeEventListener(
                        "controlstart",
                        this._onControlStart,
                        !1
                      ),
                      this.refs.obj.removeEventListener(
                        "control",
                        this._onControl,
                        !1
                      ),
                      this.refs.obj.removeEventListener(
                        "controlend",
                        this._onControlEnd,
                        !1
                      ),
                      this.refs.obj.removeEventListener(
                        "update",
                        this._onUpdate,
                        !1
                      ),
                      this.refs.obj.dispose()),
                    (this.refs.obj = null);
                }
              },
              {
                key: "setCamera",
                value: function(e) {
                  this.cameraID &&
                    this.controller.getElement(this.cameraID).setControls(null);
                  var t = this.controller.getElement(e);
                  (this.cameraID = e),
                    this.dispose(),
                    this._createCameraControls(t.getObject()),
                    t.setControls(this.uuid);
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = this.refs.obj,
                    u = l,
                    h = o;
                  if (!l)
                    switch (n) {
                      case "polarAngle":
                        null !== r &&
                          (c.rotateTo(
                            c._spherical.theta,
                            r,
                            this.transitionEnabled
                          ),
                          (u = !0));
                        break;
                      case "azimuthalAngle":
                        null !== r &&
                          (c.rotateTo(
                            r,
                            c._spherical.phi,
                            this.transitionEnabled
                          ),
                          (u = !0));
                        break;
                      case "radius":
                        null !== r &&
                          (c.dollyTo(r, this.transitionEnabled), (u = !0));
                        break;
                      case "target":
                        null !== r &&
                          c.setTarget(r[0], r[1], r[2], this.transitionEnabled),
                          (u = !0);
                        break;
                      case "state":
                        (this.state = r), (u = !0);
                        break;
                      case "updateDelay":
                        (this.updateDelay = r),
                          this._updateNotifyReset(),
                          (u = !0);
                        break;
                      case "transitionEnabled":
                        (this.transitionEnabled = r), (u = !0);
                        break;
                      case "autoRotate":
                        (this.autoRotate = r), (u = !0);
                        break;
                      case "autoRotateSpeed":
                        (this.autoRotateSpeed = r), (u = !0);
                        break;
                      case "position":
                        c.setPosition(r[0], r[1], r[2], this.transitionEnabled),
                          (h = !1),
                          (u = !0);
                    }
                  return Zg(Jg(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: h,
                    ignore: u
                  });
                }
              },
              {
                key: "setTargetElement",
                value: function(e) {
                  (this.targetID = e), this.setTargetFromPosition();
                }
              },
              {
                key: "updateCameraData",
                value: function() {
                  var e = this.controller.getElement(this.cameraID);
                  if (!e)
                    throw new Error(
                      "Camera ".concat(this.cameraID, " is not valid")
                    );
                  var t = Xg(
                      e.getProperty({
                        key: "position",
                        valueType: "coordinate3"
                      }),
                      3
                    ),
                    n = t[0],
                    r = t[1],
                    i = t[2],
                    a = Xg(
                      e.getProperty({
                        key: "direction",
                        valueType: "coordinate3"
                      }),
                      3
                    ),
                    o = a[0],
                    s = a[1],
                    l = a[2];
                  this.refs.obj.setPosition(n, r, i, !1),
                    this.refs.obj.setTarget(o, s, l, !1);
                }
              },
              {
                key: "getProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.valueType,
                    i = this.refs.obj;
                  if (!i) return null;
                  switch (n) {
                    case "polarAngle":
                      return i._spherical.phi;
                    case "azimuthalAngle":
                      return i._spherical.theta;
                    case "radius":
                      return i._spherical.radius;
                    case "target":
                      var a = i.getTarget();
                      return [a.x, a.y, a.z];
                  }
                  return Zg(Jg(t.prototype), "getProperty", this).call(this, {
                    key: n,
                    valueType: r
                  });
                }
              },
              {
                key: "_updateNotifyReset",
                value: function() {
                  var e = this;
                  this._notifyChanged = qv
                    .debounced(this.updateDelay, function() {
                      e._notifyChangedImmediate();
                    })
                    .bind(this);
                }
              },
              {
                key: "_notifyChangedImmediate",
                value: function() {
                  var e = this.controller.getElement(this.cameraID);
                  e &&
                    (e.setProperty({
                      key: "position",
                      value: e.getProperty({
                        key: "position",
                        valueType: "coordinate3"
                      }),
                      valueType: "coordinate3",
                      ignore: !0,
                      delegate: !1
                    }),
                    e.setProperty({
                      key: "direction",
                      value: this.getProperty({
                        key: "target",
                        valueType: "float"
                      }),
                      valueType: "coordinate3",
                      delegate: !1
                    }),
                    this.setProperty({
                      key: "polarAngle",
                      value: this.getProperty({
                        key: "polarAngle",
                        valueType: "float"
                      }),
                      valueType: "float",
                      ignore: !0
                    }),
                    this.setProperty({
                      key: "azimuthalAngle",
                      value: this.getProperty({
                        key: "azimuthalAngle",
                        valueType: "float"
                      }),
                      valueType: "float",
                      ignore: !0
                    }),
                    this.setProperty({
                      key: "radius",
                      value: this.getProperty({
                        key: "radius",
                        valueType: "float"
                      }),
                      valueType: "float",
                      ignore: !0
                    }),
                    this.setProperty({
                      key: "target",
                      value: this.getProperty({
                        key: "target",
                        valueType: "coordinate3"
                      }),
                      valueType: "coordinate3",
                      ignore: !0
                    }));
                }
              },
              {
                key: "setTargetFromPosition",
                value: function() {
                  if (this.targetID) {
                    var e = this.controller
                        .getElement(this.targetID)
                        .getObject(),
                      t = new ea();
                    e.getWorldPosition(t);
                    var n = t.x,
                      r = t.y,
                      i = t.z;
                    this.setProperty({
                      key: "target",
                      value: [n, r, i],
                      valueType: "coordinate3"
                    });
                  } else
                    this.setProperty({
                      key: "target",
                      value: [0, 0, 0],
                      valueType: "coordinate3"
                    });
                }
              }
            ]) && qg(n.prototype, i),
            a && qg(n, a),
            t
          );
        })(bv);
        function ey(e) {
          return (ey =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function ty(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function ny(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function ry(e, t) {
          return !t || ("object" !== ey(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function iy(e, t, n) {
          return (iy =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = ay(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function ay(e) {
          return (ay = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function oy(e, t) {
          return (oy =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var sy = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "Material" : i,
              o = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = ry(
                this,
                ay(t).call(this, {
                  controller: r,
                  name: o,
                  type: a,
                  updatable: !0
                })
              )).precisionPicking = !1),
              (n.needsUpdate = !1),
              n
            );
          }
          var n, i, a;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && oy(e, t);
            })(t, e),
            (n = t),
            (i = [
              {
                key: "update",
                value: function() {
                  var e = this;
                  this.needsUpdate &&
                    this.refs.obj &&
                    ("CompoundMaterial" === this.materialType
                      ? this.elements.forEach(function(t) {
                          e.controller.getElement(t).update();
                        })
                      : (this.refs.obj.needsUpdate = !0),
                    (this.needsUpdate = !1));
                }
              },
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return iy(ay(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (
                        (e.materialType = n.materialType),
                        (e.elements = []),
                        (e.textures = {}),
                        (e.uuid = e._createMaterial(
                          n.materialType,
                          n.materialIDs,
                          n.userData
                        )),
                        !0
                      );
                    });
                }
              },
              {
                key: "_createMaterial",
                value: function(e) {
                  var t = this,
                    n =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : [],
                    i = arguments.length > 2 ? arguments[2] : void 0;
                  return "CompoundMaterial" === e
                    ? ((this.materialIDs = n),
                      (this.refs.obj = n.map(function(e) {
                        return t.controller.getObject(e);
                      })),
                      E()())
                    : ((this.refs.obj = new r[e]({ color: "#ffffff" })),
                      (this.refs.obj.userData = i),
                      this.refs.obj.uuid);
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  "CompoundMaterial" !== this.materialType &&
                    (this.refs.obj.dispose(),
                    Object.keys(this.textures).forEach(function(t) {
                      e._setMapRef(null, t);
                    })),
                    (this.refs.obj = null);
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = this.refs.obj;
                  switch (n) {
                    case "precisionPicking":
                      (this.precisionPicking = r), (l = !0);
                      break;
                    case "sheen":
                      null === r && ((c[n] = null), (l = !0));
                  }
                  var u = iy(ay(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: o,
                    ignore: l
                  });
                  return this.update(), u;
                }
              },
              {
                key: "setMaterials",
                value: function() {
                  var e = this,
                    t =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : [];
                  if ("CompoundMaterial" !== this.materialType)
                    throw new Error(
                      "Can't set child materials to material "
                        .concat(this.uuid, " of type ")
                        .concat(this.materialType)
                    );
                  this.refs.obj.splice(0),
                    (this.materialIDs = t),
                    t.forEach(function(t) {
                      var n = e.controller.getObject(t);
                      e.refs.obj.push(n);
                    }),
                    this.update();
                }
              },
              {
                key: "testForMaterialTransparency",
                value: function() {
                  var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : null;
                  if (
                    this.precisionPicking &&
                    "SpriteMaterial" === this.materialType &&
                    e
                  ) {
                    var t = this.refs.obj.map;
                    if (t) {
                      var n = t.image.width,
                        r = t.image.height,
                        i = this.controller.viewer.renderer.renderer,
                        a = new la(n, r),
                        o = new Fa(),
                        s = new Sp(n / -2, n / 2, r / 2, r / -2, -1, 1);
                      o.add(s);
                      var l = new Zs(n, r),
                        c = new Lo({ map: t });
                      c.side = qt;
                      var u = new ys(l, c);
                      o.add(u),
                        i.setRenderTarget(a),
                        i.render(o, s),
                        i.setRenderTarget(null);
                      var h = new Uint8Array(4),
                        d = Math.round(n * e.x),
                        p = Math.round(r * e.y);
                      return (
                        i.readRenderTargetPixels(a, d, p, 1, 1, h),
                        l.dispose(),
                        c.dispose(),
                        a.dispose(),
                        0 !== h[3]
                      );
                    }
                  }
                  return !0;
                }
              },
              {
                key: "setMap",
                value: function(e, t) {
                  if ("CompoundMaterial" === this.materialType)
                    throw new Error(
                      "Can't set texture to compound material ".concat(
                        this.uuid
                      )
                    );
                  var n = this.refs.obj;
                  if (null !== e) {
                    var r = this.controller.getElement(e);
                    if (!r)
                      throw new Error(
                        "Texture ".concat(e, " as ").concat(t, " doesnt exist")
                      );
                    var i = {};
                    "envMap" === t &&
                      (i.usePMREM =
                        "MeshStandardMaterial" === this.materialType ||
                        "MeshPhysicalMaterial" === this.materialType),
                      (n[t] = r.getObject(i));
                  } else n[t] = null;
                  this._setMapRef(e, t),
                    (this.needsUpdate = !0),
                    document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "_setMapRef",
                value: function(e, t) {
                  if (this.textures[t]) {
                    var n = this.textures[t],
                      r = this.controller.getElement(n);
                    r && r.removeMaterial(this.uuid, t);
                  }
                  if (((this.textures[t] = e), e)) {
                    var i = this.controller.getElement(e);
                    i && i.addMaterial(this.uuid, t);
                  }
                }
              },
              {
                key: "notify",
                value: function(e) {
                  var t = e.elementID;
                  switch (e.action) {
                    case "add":
                      (this.elements = [].concat(ty(this.elements), [t])),
                        (this.elements = ty(new Set(this.elements)));
                      break;
                    case "remove":
                      this.elements = this.elements.filter(function(e) {
                        return e !== t;
                      });
                  }
                }
              }
            ]) && ny(n.prototype, i),
            a && ny(n, a),
            t
          );
        })(bv);
        function ly(e) {
          return (ly =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function cy(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function uy(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function hy(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? uy(Object(n), !0).forEach(function(t) {
                  dy(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : uy(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function dy(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function py(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function fy(e, t) {
          return !t || ("object" !== ly(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function my(e, t, n) {
          return (my =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = vy(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function vy(e) {
          return (vy = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function gy(e, t) {
          return (gy =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var yy,
          by,
          xy,
          wy,
          _y,
          My = (function(e) {
            function t(e) {
              var n = e.controller,
                r = e.type,
                i = void 0 === r ? "Light" : r,
                a = e.name;
              return (
                (function(e, t) {
                  if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function");
                })(this, t),
                fy(this, vy(t).call(this, { controller: n, name: a, type: i }))
              );
            }
            var n, i, a;
            return (
              (function(e, t) {
                if ("function" != typeof t && null !== t)
                  throw new TypeError(
                    "Super expression must either be null or a function"
                  );
                (e.prototype = Object.create(t && t.prototype, {
                  constructor: { value: e, writable: !0, configurable: !0 }
                })),
                  t && gy(e, t);
              })(t, e),
              (n = t),
              (i = [
                {
                  key: "init",
                  value: function() {
                    var e = this,
                      n =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : {};
                    return my(vy(t.prototype), "init", this)
                      .call(this, n)
                      .then(function() {
                        return (
                          (e.lightType = n.lightType),
                          (e.helperSize = 1),
                          (e.uuid = e._createLight(e.lightType, n)),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "_createLight",
                  value: function(e) {
                    var t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : {};
                    return (
                      (this.refs.obj = new r[e]()),
                      (this.refs.obj.userData = hy({}, t.userData)),
                      this.refs.obj.uuid
                    );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    this.refs.obj = null;
                  }
                },
                {
                  key: "setProperty",
                  value: function(e) {
                    var n,
                      r = e.key,
                      i = e.value,
                      a = e.valueType,
                      o = e.notify,
                      s = void 0 === o || o,
                      l = e.ignore,
                      c = void 0 !== l && l,
                      u = this.refs.obj,
                      h = c;
                    switch (r) {
                      case "shadowMapSize":
                        (n = u.shadow.mapSize).set.apply(n, cy(i)), (h = !0);
                        break;
                      case "target":
                        u.lookAt.apply(u, cy(i)), (h = !0);
                        break;
                      case "helperSize":
                        (this.helperSize = i), (h = !0);
                        break;
                      case "intensity":
                        (u[r] = i),
                          this._hasPower() &&
                            my(vy(t.prototype), "setProperty", this).call(
                              this,
                              {
                                key: "power",
                                value: u.power,
                                valueType: "range",
                                ignore: !0
                              }
                            ),
                          (h = !0);
                        break;
                      case "power":
                        (u[r] = i),
                          this._hasPower() &&
                            my(vy(t.prototype), "setProperty", this).call(
                              this,
                              {
                                key: "intensity",
                                value: u.intensity,
                                valueType: "range",
                                ignore: !0
                              }
                            ),
                          (h = !0);
                    }
                    return my(vy(t.prototype), "setProperty", this).call(this, {
                      key: r,
                      value: i,
                      valueType: a,
                      notify: s,
                      ignore: h
                    });
                  }
                },
                {
                  key: "_hasPower",
                  value: function() {
                    return (
                      "PointLight" === this.lightType ||
                      "SpotLight" === this.lightType
                    );
                  }
                }
              ]) && py(n.prototype, i),
              a && py(n, a),
              t
            );
          })(Iv),
          Ty = (function() {
            var e,
              t =
                (((e = new Cs({
                  defines: { SAMPLES_PER_LEVEL: 20 },
                  uniforms: {
                    faceIndex: { value: 0 },
                    roughness: { value: 0.5 },
                    mapSize: { value: 0.5 },
                    envMap: { value: null },
                    tFlip: { value: -1 }
                  },
                  vertexShader:
                    "varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",
                  fragmentShader:
                    "#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform float tFlip;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tvec3 correctedDirection = vec3( tFlip * sampleDirection.x, sampleDirection.yz );\n\t\t\t\t\tmat3 vecSpace = matrixFromVector( normalize( correctedDirection ) );\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap, vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",
                  blending: en
                })).type = "PMREMGenerator"),
                e),
              n = new Sp(-1, 1, 1, -1, 0, 1e3),
              r = new Fa(),
              i = new ys(new Zs(2, 2, 0), t);
            (i.material.side = qt), r.add(i), r.add(n);
            var a = function(e, t, n) {
              (this.sourceTexture = e),
                (this.resolution = void 0 !== n ? n : 256),
                (this.samplesPerLevel = void 0 !== t ? t : 32);
              var r =
                this.sourceTexture.encoding === ci ||
                this.sourceTexture.encoding === hi ||
                this.sourceTexture.encoding === ui;
              (this.sourceTexture.minFilter = r ? nr : Jn),
                (this.sourceTexture.magFilter = r ? nr : Jn),
                (this.sourceTexture.generateMipmaps =
                  this.sourceTexture.generateMipmaps && r),
                (this.cubeLods = []);
              var i = this.resolution,
                a = {
                  format: this.sourceTexture.format,
                  magFilter: this.sourceTexture.magFilter,
                  minFilter: this.sourceTexture.minFilter,
                  type: this.sourceTexture.type,
                  generateMipmaps: this.sourceTexture.generateMipmaps,
                  anisotropy: this.sourceTexture.anisotropy,
                  encoding: this.sourceTexture.encoding
                };
              this.numLods = Math.log(i) / Math.log(2) - 2;
              for (var o = 0; o < this.numLods; o++) {
                var s = new js(i, i, a);
                (s.texture.name = "PMREMGenerator.cube" + o),
                  this.cubeLods.push(s),
                  (i = Math.max(16, i / 2));
              }
            };
            return (
              (a.prototype = {
                constructor: a,
                update: function(e) {
                  var n = this.sourceTexture.isCubeTexture ? -1 : 1;
                  (t.defines.SAMPLES_PER_LEVEL = this.samplesPerLevel),
                    (t.uniforms.faceIndex.value = 0),
                    (t.uniforms.envMap.value = this.sourceTexture),
                    (t.envMap = this.sourceTexture),
                    (t.needsUpdate = !0);
                  var r = e.gammaInput,
                    i = e.gammaOutput,
                    a = e.toneMapping,
                    o = e.toneMappingExposure,
                    s = e.getRenderTarget();
                  (e.toneMapping = Nn),
                    (e.toneMappingExposure = 1),
                    (e.gammaInput = !1),
                    (e.gammaOutput = !1);
                  for (var l = 0; l < this.numLods; l++) {
                    var c = l / (this.numLods - 1);
                    (t.uniforms.roughness.value = 0.9 * c),
                      (t.uniforms.tFlip.value = 0 == l ? n : 1);
                    var u = this.cubeLods[l].width;
                    (t.uniforms.mapSize.value = u),
                      this.renderToCubeMapTarget(e, this.cubeLods[l]),
                      l < 5 &&
                        (t.uniforms.envMap.value = this.cubeLods[l].texture);
                  }
                  e.setRenderTarget(s),
                    (e.toneMapping = a),
                    (e.toneMappingExposure = o),
                    (e.gammaInput = r),
                    (e.gammaOutput = i);
                },
                renderToCubeMapTarget: function(e, t) {
                  for (var n = 0; n < 6; n++)
                    this.renderToCubeMapTargetFace(e, t, n);
                },
                renderToCubeMapTargetFace: function(e, i, a) {
                  (t.uniforms.faceIndex.value = a),
                    e.setRenderTarget(i, a),
                    e.clear(),
                    e.render(r, n);
                },
                dispose: function() {
                  for (var e = 0, n = this.cubeLods.length; e < n; e++)
                    this.cubeLods[e].dispose();
                  t.dispose();
                }
              }),
              a
            );
          })(),
          Ay =
            ((by = new Sp()),
            (xy = new Fa()),
            ((yy = new Cs({
              uniforms: {
                faceIndex: { value: 0 },
                mapSize: { value: 0 },
                envMap: { value: null },
                testColor: { value: new ea(1, 1, 1) }
              },
              vertexShader:
                "precision highp float;        varying vec2 vUv;        void main() {          vUv = uv;          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );        }",
              fragmentShader:
                "precision highp float;        varying vec2 vUv;        uniform samplerCube envMap;        uniform float mapSize;        uniform vec3 testColor;        uniform int faceIndex;                void main() {          vec3 sampleDirection;          vec2 uv = vUv;          uv = uv * 2.0 - 1.0;          uv.y *= -1.0;          if(faceIndex == 0) {            sampleDirection = normalize(vec3(1.0, uv.y, -uv.x));          } else if(faceIndex == 1) {            sampleDirection = normalize(vec3(uv.x, 1.0, uv.y));          } else if(faceIndex == 2) {            sampleDirection = normalize(vec3(uv.x, uv.y, 1.0));          } else if(faceIndex == 3) {            sampleDirection = normalize(vec3(-1.0, uv.y, uv.x));          } else if(faceIndex == 4) {            sampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));          } else {            sampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));          }          vec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );          gl_FragColor = linearToOutputTexel( color );        }",
              blending: en
            })).type = "PMREMCubeUVPacker"),
            (wy = yy),
            ((_y = function(e) {
              this.cubeLods = e;
              var t = 4 * e[0].width,
                n = e[0].texture,
                r = {
                  format: n.format,
                  magFilter: n.magFilter,
                  minFilter: n.minFilter,
                  type: n.type,
                  generateMipmaps: n.generateMipmaps,
                  anisotropy: n.anisotropy,
                  encoding: n.encoding === di ? mi : n.encoding
                };
              r.encoding === mi && ((r.magFilter = nr), (r.minFilter = nr)),
                (this.CubeUVRenderTarget = new la(t, t, r)),
                (this.CubeUVRenderTarget.texture.name =
                  "PMREMCubeUVPacker.cubeUv"),
                (this.CubeUVRenderTarget.texture.mapping = Wn),
                (this.objects = []);
              var i = new Zs(1, 1),
                a = [];
              a.push(new Zi(0, 0)),
                a.push(new Zi(1, 0)),
                a.push(new Zi(2, 0)),
                a.push(new Zi(0, 1)),
                a.push(new Zi(1, 1)),
                a.push(new Zi(2, 1));
              var o = t;
              t = e[0].width;
              var s = 0,
                l = 4;
              this.numLods = Math.log(e[0].width) / Math.log(2) - 2;
              for (var c = 0; c < this.numLods; c++) {
                var u = 0.5 * (o - o / l);
                t > 16 && (l *= 2);
                for (
                  var h = t > 16 ? 6 : 1, d = 0, p = 0, f = t, m = 0;
                  m < h;
                  m++
                ) {
                  for (var v = 0; v < 6; v++) {
                    var g = wy.clone();
                    (g.uniforms.envMap.value = this.cubeLods[c].texture),
                      (g.envMap = this.cubeLods[c].texture),
                      (g.uniforms.faceIndex.value = v),
                      (g.uniforms.mapSize.value = f);
                    var y = new ys(i, g);
                    (y.position.x = a[v].x * f - u + d),
                      (y.position.y = a[v].y * f - u + s + p),
                      (y.material.side = Yt),
                      y.scale.setScalar(f),
                      this.objects.push(y);
                  }
                  (p += 1.75 * f), (d += 1.25 * f), (f /= 2);
                }
                (s += 2 * t), t > 16 && (t /= 2);
              }
            }).prototype = {
              constructor: _y,
              update: function(e) {
                var t = 4 * this.cubeLods[0].width;
                (by.left = 0.5 * -t),
                  (by.right = 0.5 * t),
                  (by.top = 0.5 * -t),
                  (by.bottom = 0.5 * t),
                  (by.near = 0),
                  (by.far = 1),
                  by.updateProjectionMatrix();
                for (var n = 0; n < this.objects.length; n++)
                  xy.add(this.objects[n]);
                var r = e.gammaInput,
                  i = e.gammaOutput,
                  a = e.toneMapping,
                  o = e.toneMappingExposure,
                  s = e.getRenderTarget();
                for (
                  e.gammaInput = !1,
                    e.gammaOutput = !1,
                    e.toneMapping = Nn,
                    e.toneMappingExposure = 1,
                    e.setRenderTarget(this.CubeUVRenderTarget),
                    e.render(xy, by),
                    e.setRenderTarget(s),
                    e.toneMapping = a,
                    e.toneMappingExposure = o,
                    e.gammaInput = r,
                    e.gammaOutput = i,
                    n = 0;
                  n < this.objects.length;
                  n++
                )
                  xy.remove(this.objects[n]);
              },
              dispose: function() {
                for (var e = 0, t = this.objects.length; e < t; e++)
                  this.objects[e].material.dispose();
                this.objects[0].geometry.dispose();
              }
            }),
            _y);
        function Sy(e) {
          return (Sy =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Ey(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function Ry(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Py(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? Ry(Object(n), !0).forEach(function(t) {
                  Iy(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : Ry(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function Iy(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Dy(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Oy(e, t) {
          return !t || ("object" !== Sy(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Cy(e, t, n) {
          return (Cy =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Ly(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Ly(e) {
          return (Ly = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Ny(e, t) {
          return (Ny =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Fy = (function(e) {
          function t(e) {
            var n = e.controller,
              r = e.type,
              i = void 0 === r ? "Texture" : r,
              a = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              Oy(
                this,
                Ly(t).call(this, {
                  controller: n,
                  name: a,
                  type: i,
                  updatable: !0
                })
              )
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Ny(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return (
                    (this.textureType = n.textureType),
                    (this.resolution = n.resolution || 512),
                    (this.useLegacy = n.useLegacy || !1),
                    (this.needsUpdate = !0),
                    (this.cubeMapNeedsUpdate = !0),
                    (this.cubeRenderTargetClean = null),
                    (this.cubeRenderTarget = null),
                    (this.materials = {}),
                    (this.usedAsBackground = !1),
                    Cy(Ly(t.prototype), "init", this)
                      .call(this, n)
                      .then(function() {
                        return e._addTexture({ assetID: n.assetID });
                      })
                      .then(function(t) {
                        var r = t.elementID;
                        return (
                          (e.uuid = r),
                          (e.refs.obj.userData = Py({}, n.userData)),
                          e.refs.obj.image &&
                            (!qv.powerOfTwo(e.refs.obj.image.width) ||
                              qv.powerOfTwo(e.refs.obj.image.height)),
                          !0
                        );
                      })
                  );
                }
              },
              {
                key: "_addTexture",
                value: function(e) {
                  var t = this,
                    n = e.assetID;
                  return this.loadTexture({ assetID: n }).then(function(e) {
                    return (t.refs.obj = e.obj.clone()), { elementID: E()() };
                  });
                }
              },
              {
                key: "loadTexture",
                value: function(e) {
                  var t = e.assetID;
                  return this.controller.assetManager.load(t);
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.cubeRenderTargetClean &&
                    (this.cubeRenderTargetClean.dispose(),
                    (this.cubeRenderTargetClean = null)),
                    this.cubeRenderTarget &&
                      (this.cubeRenderTarget.dispose(),
                      (this.cubeRenderTarget = null)),
                    this.refs.background &&
                      (this.refs.background.dispose(),
                      (this.refs.background = null)),
                    this.refs.obj.dispose(),
                    (this.refs.obj = null);
                }
              },
              {
                key: "getObject",
                value: function(e) {
                  var t = e.usePMREM;
                  return (
                    this.update(),
                    this._isEquirectangular() && !this.useLegacy
                      ? t
                        ? this.cubeRenderTarget.texture
                        : this.cubeRenderTargetClean.texture
                      : this._isCube() && !this.useLegacy && t
                      ? this.cubeRenderTarget.texture
                      : this.refs.obj
                  );
                }
              },
              {
                key: "getBackground",
                value: function() {
                  return (
                    this.update(),
                    this._isEquirectangular() && !this.useLegacy
                      ? this.cubeRenderTargetClean
                      : this.refs.obj
                  );
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = this.refs.obj,
                    u = l;
                  switch (n) {
                    case "resolution":
                      (this._isEquirectangular() || this._isCube()) &&
                        this.resolution !== r &&
                        ((this.resolution = r), (this.cubeMapNeedsUpdate = !0)),
                        (u = !0);
                      break;
                    case "useLegacy":
                      (this._isEquirectangular() || this._isCube()) &&
                        this.useLegacy !== r &&
                        ((this.useLegacy = r), (this.cubeMapNeedsUpdate = !0)),
                        (u = !0);
                      break;
                    case "unpackAlignment":
                      (c[n] = parseInt(r)), (u = !0);
                      break;
                    case "encoding":
                    case "mapping":
                    case "type":
                    case "flipY":
                    case "magFilter":
                    case "minFilter":
                    case "generateMipmaps":
                      (this._isEquirectangular() || this._isCube()) &&
                        c[n] !== r &&
                        (this.cubeMapNeedsUpdate = !0);
                  }
                  var h = Cy(Ly(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: o,
                    ignore: u
                  });
                  return (this.needsUpdate = !0), h;
                }
              },
              {
                key: "_updateCubeMap",
                value: function() {
                  var e = this.controller.viewer.renderer.renderer,
                    t = this.refs.obj,
                    n = t;
                  if (this._isEquirectangular()) {
                    this.cubeRenderTargetClean &&
                      this.cubeRenderTargetClean.dispose();
                    var r = this.resolution;
                    (this.cubeRenderTargetClean = new THREE.WebGLRenderTargetCube(
                      r,
                      r
                    )),
                      this.cubeRenderTargetClean.fromEquirectangularTexture(
                        e,
                        t
                      ),
                      (n = this.cubeRenderTargetClean.texture);
                  }
                  var i = new Ty(n);
                  i.update(e);
                  var a = new Ay(i.cubeLods);
                  a.update(e),
                    this.cubeRenderTarget && this.cubeRenderTarget.dispose(),
                    (this.cubeRenderTarget = a.CubeUVRenderTarget),
                    i.dispose(),
                    a.dispose();
                }
              },
              {
                key: "update",
                value: function() {
                  this.needsUpdate &&
                    ((this.refs.obj.needsUpdate = !0),
                    (this._isEquirectangular() || this._isCube()) &&
                      this.cubeMapNeedsUpdate &&
                      (this.useLegacy || this._updateCubeMap(),
                      (this.cubeMapNeedsUpdate = !1),
                      this._resetMapOnMaterials(),
                      this.usedAsBackground &&
                        this.controller
                          .getSingleElement("Scene")
                          .updateBackground()),
                    (this.needsUpdate = !1));
                }
              },
              {
                key: "_resetMapOnMaterials",
                value: function() {
                  var e = this;
                  Object.keys(this.materials).forEach(function(t) {
                    e.materials[t].forEach(function(n) {
                      var r = e.controller.getElement(n);
                      r && r.setMap(e.uuid, t);
                    });
                  });
                }
              },
              {
                key: "addMaterial",
                value: function(e, t) {
                  this.materials[t] || (this.materials[t] = []),
                    (this.materials[t] = Ey(
                      new Set([].concat(Ey(this.materials[t]), [e]))
                    ));
                }
              },
              {
                key: "removeMaterial",
                value: function(e, t) {
                  this.materials[t] &&
                    (this.materials[t] = this.materials[t].filter(function(t) {
                      return e !== t;
                    }));
                }
              },
              {
                key: "_isBasic",
                value: function() {
                  return (
                    "Basic" === this.textureType ||
                    "BasicHDR" === this.textureType ||
                    "BasicEXR" === this.textureType
                  );
                }
              },
              {
                key: "_isEquirectangular",
                value: function() {
                  return (
                    "Equirectangular" === this.textureType ||
                    "EquirectangularHDR" === this.textureType ||
                    "EquirectangularEXR" === this.textureType
                  );
                }
              },
              {
                key: "_isCube",
                value: function() {
                  return (
                    "Cube" === this.textureType ||
                    "CubeHDR" === this.textureType
                  );
                }
              }
            ]) && Dy(n.prototype, r),
            i && Dy(n, i),
            t
          );
        })(bv);
        function ky(e) {
          return (ky =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Uy(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function jy(e, t) {
          return !t || ("object" !== ky(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function By(e) {
          return (By = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function zy(e, t) {
          return (zy =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Vy = (function(e) {
            function t(e) {
              var n = e.controller,
                r = e.type,
                i = void 0 === r ? "Scene" : r,
                a = e.name,
                o = e.disposable,
                s = void 0 !== o && o;
              return (
                (function(e, t) {
                  if (!(e instanceof t))
                    throw new TypeError("Cannot call a class as a function");
                })(this, t),
                jy(
                  this,
                  By(t).call(this, {
                    controller: n,
                    name: a,
                    type: i,
                    addable: !1,
                    disposable: s
                  })
                )
              );
            }
            var n, r, i;
            return (
              (function(e, t) {
                if ("function" != typeof t && null !== t)
                  throw new TypeError(
                    "Super expression must either be null or a function"
                  );
                (e.prototype = Object.create(t && t.prototype, {
                  constructor: { value: e, writable: !0, configurable: !0 }
                })),
                  t && zy(e, t);
              })(t, e),
              (n = t),
              (r = [
                {
                  key: "init",
                  value: function() {
                    var e = this;
                    return Promise.resolve(!0).then(function() {
                      return (e.uuid = e._createScene()), !0;
                    });
                  }
                },
                {
                  key: "_createScene",
                  value: function() {
                    return (
                      (this.refs.obj = new Fa()),
                      (window.scene = this.refs.obj),
                      (this.backgroundType = "Transparent"),
                      (this.currentBackgroundTextureID = null),
                      this.refs.obj.uuid
                    );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    this.refs.obj = null;
                  }
                },
                {
                  key: "getInfo",
                  value: function() {
                    return { userData: this.refs.obj.userData };
                  }
                },
                {
                  key: "setBackground",
                  value: function(e) {
                    var t = e.type,
                      n = e.color,
                      r = void 0 === n ? null : n,
                      i = e.textureID,
                      a = void 0 === i ? null : i;
                    switch (((this.backgroundType = t), t)) {
                      case "Transparent":
                        this.refs.obj.background = null;
                        break;
                      case "Color":
                        this.refs.obj.background = new Eo(r);
                        break;
                      case "Skybox":
                        if (this.currentBackgroundTextureID) {
                          var o = this.controller.getElement(
                            this.currentBackgroundTextureID
                          );
                          o && (o.usedAsBackground = !1);
                        }
                        (this.currentBackgroundTextureID = a),
                          this.updateBackground();
                        break;
                      default:
                        throw new Error(
                          "Unknown background type ".concat(this.backgroundType)
                        );
                    }
                    return !0;
                  }
                },
                {
                  key: "updateBackground",
                  value: function() {
                    switch (this.backgroundType) {
                      case "Skybox":
                        var e = this.controller.getElement(
                          this.currentBackgroundTextureID
                        );
                        e
                          ? ((this.refs.obj.background = e.getBackground()),
                            (e.usedAsBackground = !0))
                          : (this.refs.obj.background = null);
                    }
                  }
                }
              ]) && Uy(n.prototype, r),
              i && Uy(n, i),
              t
            );
          })(Iv),
          Gy = function(e, t) {
            void 0 === t && (t = document), Na.call(this), (this.visible = !1);
            var n = new Hy();
            this.add(n);
            var r = new Xy();
            this.add(r);
            var i = this;
            j("camera", e),
              j("object", void 0),
              j("enabled", !0),
              j("axis", null),
              j("mode", "translate"),
              j("translationSnap", null),
              j("rotationSnap", null),
              j("space", "world"),
              j("size", 1),
              j("dragging", !1),
              j("showX", !0),
              j("showY", !0),
              j("showZ", !0);
            var a = { type: "change" },
              o = { type: "mouseDown" },
              s = { type: "mouseUp", mode: i.mode },
              l = { type: "objectChange" },
              c = new Of(),
              u = new ea(),
              h = new ea(),
              d = new Ji(),
              p = {
                X: new ea(1, 0, 0),
                Y: new ea(0, 1, 0),
                Z: new ea(0, 0, 1)
              },
              f = new ea(),
              m = new ea(),
              v = new ea(),
              g = new ea(),
              y = new ea(),
              b = new ea(),
              x = 0,
              w = new ea(),
              _ = new Ji(),
              M = new ea(),
              T = new ea(),
              A = new Ji(),
              S = new Ji(),
              E = new ea(),
              R = new ea(),
              P = new Ji(),
              I = new ea(),
              D = new ea(),
              O = new Ji(),
              C = new Ji(),
              L = new ea(),
              N = new ea(),
              F = new ea(),
              k = new Ji(),
              U = new ea();
            function j(e, t) {
              var o = t;
              Object.defineProperty(i, e, {
                get: function() {
                  return void 0 !== o ? o : t;
                },
                set: function(t) {
                  o !== t &&
                    ((o = t),
                    (r[e] = t),
                    (n[e] = t),
                    i.dispatchEvent({ type: e + "-changed", value: t }),
                    i.dispatchEvent(a));
                }
              }),
                (i[e] = t),
                (r[e] = t),
                (n[e] = t);
            }
            function B(e) {
              if (document.pointerLockElement)
                return { x: 0, y: 0, button: e.button };
              var n = e.changedTouches ? e.changedTouches[0] : e,
                r = t.getBoundingClientRect();
              return {
                x: ((n.clientX - r.left) / r.width) * 2 - 1,
                y: (-(n.clientY - r.top) / r.height) * 2 + 1,
                button: e.button
              };
            }
            function z(e) {
              i.enabled && i.pointerHover(B(e));
            }
            function V(e) {
              i.enabled &&
                (document.addEventListener("mousemove", G, !1),
                i.pointerHover(B(e)),
                i.pointerDown(B(e)));
            }
            function G(e) {
              i.enabled && i.pointerMove(B(e));
            }
            function H(e) {
              i.enabled &&
                (document.removeEventListener("mousemove", G, !1),
                i.pointerUp(B(e)));
            }
            j("worldPosition", D),
              j("worldPositionStart", R),
              j("worldQuaternion", O),
              j("worldQuaternionStart", P),
              j("cameraPosition", w),
              j("cameraQuaternion", _),
              j("pointStart", f),
              j("pointEnd", m),
              j("rotationAxis", g),
              j("rotationAngle", x),
              j("eye", N),
              t.addEventListener("mousedown", V, !1),
              t.addEventListener("touchstart", V, !1),
              t.addEventListener("mousemove", z, !1),
              t.addEventListener("touchmove", z, !1),
              t.addEventListener("touchmove", G, !1),
              document.addEventListener("mouseup", H, !1),
              t.addEventListener("touchend", H, !1),
              t.addEventListener("touchcancel", H, !1),
              t.addEventListener("touchleave", H, !1),
              (this.dispose = function() {
                t.removeEventListener("mousedown", V),
                  t.removeEventListener("touchstart", V),
                  t.removeEventListener("mousemove", z),
                  document.removeEventListener("mousemove", G),
                  t.removeEventListener("touchmove", z),
                  t.removeEventListener("touchmove", G),
                  document.removeEventListener("mouseup", H),
                  t.removeEventListener("touchend", H),
                  t.removeEventListener("touchcancel", H),
                  t.removeEventListener("touchleave", H),
                  this.traverse(function(e) {
                    e.geometry && e.geometry.dispose(),
                      e.material && e.material.dispose();
                  });
              }),
              (this.attach = function(e) {
                return (this.object = e), (this.visible = !0), this;
              }),
              (this.detach = function() {
                return (
                  (this.object = void 0),
                  (this.visible = !1),
                  (this.axis = null),
                  this
                );
              }),
              (this.updateMatrixWorld = function() {
                void 0 !== this.object &&
                  (this.object.updateMatrixWorld(),
                  this.object.parent.matrixWorld.decompose(T, A, E),
                  this.object.matrixWorld.decompose(D, O, L),
                  S.copy(A).inverse(),
                  C.copy(O).inverse()),
                  this.camera.updateMatrixWorld(),
                  this.camera.matrixWorld.decompose(w, _, M),
                  N.copy(w)
                    .sub(D)
                    .normalize(),
                  Na.prototype.updateMatrixWorld.call(this);
              }),
              (this.pointerHover = function(e) {
                if (
                  void 0 !== this.object &&
                  !0 !== this.dragging &&
                  (void 0 === e.button || 0 === e.button)
                ) {
                  c.setFromCamera(e, this.camera);
                  var t =
                    c.intersectObjects(n.picker[this.mode].children, !0)[0] ||
                    !1;
                  this.axis = t ? t.object.name : null;
                }
              }),
              (this.pointerDown = function(e) {
                if (
                  !(
                    void 0 === this.object ||
                    !0 === this.dragging ||
                    (void 0 !== e.button && 0 !== e.button) ||
                    (0 !== e.button && void 0 !== e.button) ||
                    null === this.axis
                  )
                ) {
                  c.setFromCamera(e, this.camera);
                  var t = c.intersectObjects([r], !0)[0] || !1;
                  if (t) {
                    var n = this.space;
                    if (
                      ("scale" === this.mode
                        ? (n = "local")
                        : ("E" !== this.axis &&
                            "XYZE" !== this.axis &&
                            "XYZ" !== this.axis) ||
                          (n = "world"),
                      "local" === n && "rotate" === this.mode)
                    ) {
                      var i = this.rotationSnap;
                      "X" === this.axis &&
                        i &&
                        (this.object.rotation.x =
                          Math.round(this.object.rotation.x / i) * i),
                        "Y" === this.axis &&
                          i &&
                          (this.object.rotation.y =
                            Math.round(this.object.rotation.y / i) * i),
                        "Z" === this.axis &&
                          i &&
                          (this.object.rotation.z =
                            Math.round(this.object.rotation.z / i) * i);
                    }
                    this.object.updateMatrixWorld(),
                      this.object.parent.updateMatrixWorld(),
                      F.copy(this.object.position),
                      k.copy(this.object.quaternion),
                      U.copy(this.object.scale),
                      this.object.matrixWorld.decompose(R, P, I),
                      f.copy(t.point).sub(R);
                  }
                  (this.dragging = !0),
                    (o.mode = this.mode),
                    this.dispatchEvent(o);
                }
              }),
              (this.pointerMove = function(e) {
                var t = this.axis,
                  n = this.mode,
                  i = this.object,
                  o = this.space;
                if (
                  ("scale" === n
                    ? (o = "local")
                    : ("E" !== t && "XYZE" !== t && "XYZ" !== t) ||
                      (o = "world"),
                  void 0 !== i &&
                    null !== t &&
                    !1 !== this.dragging &&
                    (void 0 === e.button || 0 === e.button))
                ) {
                  c.setFromCamera(e, this.camera);
                  var s = c.intersectObjects([r], !0)[0] || !1;
                  if (!1 !== s) {
                    if ((m.copy(s.point).sub(R), "translate" === n))
                      v.copy(m).sub(f),
                        "local" === o && "XYZ" !== t && v.applyQuaternion(C),
                        -1 === t.indexOf("X") && (v.x = 0),
                        -1 === t.indexOf("Y") && (v.y = 0),
                        -1 === t.indexOf("Z") && (v.z = 0),
                        "local" === o && "XYZ" !== t
                          ? v.applyQuaternion(k).divide(E)
                          : v.applyQuaternion(S).divide(E),
                        i.position.copy(v).add(F),
                        this.translationSnap &&
                          ("local" === o &&
                            (i.position.applyQuaternion(d.copy(k).inverse()),
                            -1 !== t.search("X") &&
                              (i.position.x =
                                Math.round(
                                  i.position.x / this.translationSnap
                                ) * this.translationSnap),
                            -1 !== t.search("Y") &&
                              (i.position.y =
                                Math.round(
                                  i.position.y / this.translationSnap
                                ) * this.translationSnap),
                            -1 !== t.search("Z") &&
                              (i.position.z =
                                Math.round(
                                  i.position.z / this.translationSnap
                                ) * this.translationSnap),
                            i.position.applyQuaternion(k)),
                          "world" === o &&
                            (i.parent &&
                              i.position.add(
                                u.setFromMatrixPosition(i.parent.matrixWorld)
                              ),
                            -1 !== t.search("X") &&
                              (i.position.x =
                                Math.round(
                                  i.position.x / this.translationSnap
                                ) * this.translationSnap),
                            -1 !== t.search("Y") &&
                              (i.position.y =
                                Math.round(
                                  i.position.y / this.translationSnap
                                ) * this.translationSnap),
                            -1 !== t.search("Z") &&
                              (i.position.z =
                                Math.round(
                                  i.position.z / this.translationSnap
                                ) * this.translationSnap),
                            i.parent &&
                              i.position.sub(
                                u.setFromMatrixPosition(i.parent.matrixWorld)
                              )));
                    else if ("scale" === n) {
                      if (-1 !== t.search("XYZ")) {
                        var w = m.length() / f.length();
                        m.dot(f) < 0 && (w *= -1), h.set(w, w, w);
                      } else
                        u.copy(f),
                          h.copy(m),
                          u.applyQuaternion(C),
                          h.applyQuaternion(C),
                          h.divide(u),
                          -1 === t.search("X") && (h.x = 1),
                          -1 === t.search("Y") && (h.y = 1),
                          -1 === t.search("Z") && (h.z = 1);
                      i.scale.copy(U).multiply(h);
                    } else if ("rotate" === n) {
                      v.copy(m).sub(f);
                      var _ =
                        20 /
                        D.distanceTo(
                          u.setFromMatrixPosition(this.camera.matrixWorld)
                        );
                      "E" === t
                        ? (g.copy(N),
                          (x = m.angleTo(f)),
                          y.copy(f).normalize(),
                          b.copy(m).normalize(),
                          (x *= b.cross(y).dot(N) < 0 ? 1 : -1))
                        : "XYZE" === t
                        ? (g
                            .copy(v)
                            .cross(N)
                            .normalize(),
                          (x = v.dot(u.copy(g).cross(this.eye)) * _))
                        : ("X" !== t && "Y" !== t && "Z" !== t) ||
                          (g.copy(p[t]),
                          u.copy(p[t]),
                          "local" === o && u.applyQuaternion(O),
                          (x = v.dot(u.cross(N).normalize()) * _)),
                        this.rotationSnap &&
                          (x =
                            Math.round(x / this.rotationSnap) *
                            this.rotationSnap),
                        (this.rotationAngle = x),
                        "local" === o && "E" !== t && "XYZE" !== t
                          ? (i.quaternion.copy(k),
                            i.quaternion
                              .multiply(d.setFromAxisAngle(g, x))
                              .normalize())
                          : (g.applyQuaternion(S),
                            i.quaternion.copy(d.setFromAxisAngle(g, x)),
                            i.quaternion.multiply(k).normalize());
                    }
                    this.dispatchEvent(a), this.dispatchEvent(l);
                  }
                }
              }),
              (this.pointerUp = function(e) {
                (void 0 !== e.button && 0 !== e.button) ||
                  (this.dragging &&
                    null !== this.axis &&
                    ((s.mode = this.mode), this.dispatchEvent(s)),
                  (this.dragging = !1),
                  void 0 === e.button && (this.axis = null));
              }),
              (this.getMode = function() {
                return i.mode;
              }),
              (this.setMode = function(e) {
                i.mode = e;
              }),
              (this.setTranslationSnap = function(e) {
                i.translationSnap = e;
              }),
              (this.setRotationSnap = function(e) {
                i.rotationSnap = e;
              }),
              (this.setSize = function(e) {
                i.size = e;
              }),
              (this.setSpace = function(e) {
                i.space = e;
              }),
              (this.update = function() {});
          };
        Gy.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: Gy,
          isTransformControls: !0
        });
        var Hy = function() {
          Na.call(this), (this.type = "TransformControlsGizmo");
          var e = new Lo({
              depthTest: !1,
              depthWrite: !1,
              transparent: !0,
              side: qt,
              fog: !1
            }),
            t = new Du({
              depthTest: !1,
              depthWrite: !1,
              transparent: !0,
              linewidth: 1,
              fog: !1
            }),
            n = e.clone();
          n.opacity = 0.15;
          var r = e.clone();
          r.opacity = 0.33;
          var i = e.clone();
          i.color.set(16711680);
          var a = e.clone();
          a.color.set(65280);
          var o = e.clone();
          o.color.set(255);
          var s = e.clone();
          s.opacity = 0.25;
          var l = s.clone();
          l.color.set(16776960);
          var c = s.clone();
          c.color.set(65535);
          var u = s.clone();
          u.color.set(16711935), e.clone().color.set(16776960);
          var h = t.clone();
          h.color.set(16711680);
          var d = t.clone();
          d.color.set(65280);
          var p = t.clone();
          p.color.set(255);
          var f = t.clone();
          f.color.set(65535);
          var m = t.clone();
          m.color.set(16711935);
          var v = t.clone();
          v.color.set(16776960);
          var g = t.clone();
          g.color.set(7895160);
          var y = v.clone();
          y.opacity = 0.25;
          var b = new od(0, 0.05, 0.2, 12, 1, !1),
            x = new Es(0.125, 0.125, 0.125),
            w = new es();
          w.setAttribute("position", new Go([0, 0, 0, 1, 0, 0], 3));
          var _,
            M = function(e, t) {
              for (var n = new es(), r = [], i = 0; i <= 64 * t; ++i)
                r.push(
                  0,
                  Math.cos((i / 32) * Math.PI) * e,
                  Math.sin((i / 32) * Math.PI) * e
                );
              return n.setAttribute("position", new Go(r, 3)), n;
            },
            T = {
              X: [
                [new ys(b, i), [1, 0, 0], [0, 0, -Math.PI / 2], null, "fwd"],
                [new ys(b, i), [1, 0, 0], [0, 0, Math.PI / 2], null, "bwd"],
                [new ku(w, h)]
              ],
              Y: [
                [new ys(b, a), [0, 1, 0], null, null, "fwd"],
                [new ys(b, a), [0, 1, 0], [Math.PI, 0, 0], null, "bwd"],
                [new ku(w, d), null, [0, 0, Math.PI / 2]]
              ],
              Z: [
                [new ys(b, o), [0, 0, 1], [Math.PI / 2, 0, 0], null, "fwd"],
                [new ys(b, o), [0, 0, 1], [-Math.PI / 2, 0, 0], null, "bwd"],
                [new ku(w, p), null, [0, -Math.PI / 2, 0]]
              ],
              XYZ: [[new ys(new sh(0.1, 0), s.clone()), [0, 0, 0], [0, 0, 0]]],
              XY: [
                [new ys(new Zs(0.295, 0.295), l.clone()), [0.15, 0.15, 0]],
                [new ku(w, v), [0.18, 0.3, 0], null, [0.125, 1, 1]],
                [
                  new ku(w, v),
                  [0.3, 0.18, 0],
                  [0, 0, Math.PI / 2],
                  [0.125, 1, 1]
                ]
              ],
              YZ: [
                [
                  new ys(new Zs(0.295, 0.295), c.clone()),
                  [0, 0.15, 0.15],
                  [0, Math.PI / 2, 0]
                ],
                [
                  new ku(w, f),
                  [0, 0.18, 0.3],
                  [0, 0, Math.PI / 2],
                  [0.125, 1, 1]
                ],
                [
                  new ku(w, f),
                  [0, 0.3, 0.18],
                  [0, -Math.PI / 2, 0],
                  [0.125, 1, 1]
                ]
              ],
              XZ: [
                [
                  new ys(new Zs(0.295, 0.295), u.clone()),
                  [0.15, 0, 0.15],
                  [-Math.PI / 2, 0, 0]
                ],
                [new ku(w, m), [0.18, 0, 0.3], null, [0.125, 1, 1]],
                [
                  new ku(w, m),
                  [0.3, 0, 0.18],
                  [0, -Math.PI / 2, 0],
                  [0.125, 1, 1]
                ]
              ]
            },
            A = {
              X: [
                [
                  new ys(new od(0.2, 0, 1, 4, 1, !1), n),
                  [0.6, 0, 0],
                  [0, 0, -Math.PI / 2]
                ]
              ],
              Y: [[new ys(new od(0.2, 0, 1, 4, 1, !1), n), [0, 0.6, 0]]],
              Z: [
                [
                  new ys(new od(0.2, 0, 1, 4, 1, !1), n),
                  [0, 0, 0.6],
                  [Math.PI / 2, 0, 0]
                ]
              ],
              XYZ: [[new ys(new sh(0.2, 0), n)]],
              XY: [[new ys(new Zs(0.4, 0.4), n), [0.2, 0.2, 0]]],
              YZ: [
                [
                  new ys(new Zs(0.4, 0.4), n),
                  [0, 0.2, 0.2],
                  [0, Math.PI / 2, 0]
                ]
              ],
              XZ: [
                [
                  new ys(new Zs(0.4, 0.4), n),
                  [0.2, 0, 0.2],
                  [-Math.PI / 2, 0, 0]
                ]
              ]
            },
            S = {
              START: [[new ys(new sh(0.01, 2), r), null, null, null, "helper"]],
              END: [[new ys(new sh(0.01, 2), r), null, null, null, "helper"]],
              DELTA: [
                [
                  new ku(
                    ((_ = new es()),
                    _.setAttribute("position", new Go([0, 0, 0, 1, 1, 1], 3)),
                    _),
                    r
                  ),
                  null,
                  null,
                  null,
                  "helper"
                ]
              ],
              X: [
                [
                  new ku(w, r.clone()),
                  [-1e3, 0, 0],
                  null,
                  [1e6, 1, 1],
                  "helper"
                ]
              ],
              Y: [
                [
                  new ku(w, r.clone()),
                  [0, -1e3, 0],
                  [0, 0, Math.PI / 2],
                  [1e6, 1, 1],
                  "helper"
                ]
              ],
              Z: [
                [
                  new ku(w, r.clone()),
                  [0, 0, -1e3],
                  [0, -Math.PI / 2, 0],
                  [1e6, 1, 1],
                  "helper"
                ]
              ]
            },
            E = {
              X: [
                [new ku(M(1, 0.5), h)],
                [new ys(new sh(0.04, 0), i), [0, 0, 0.99], null, [1, 3, 1]]
              ],
              Y: [
                [new ku(M(1, 0.5), d), null, [0, 0, -Math.PI / 2]],
                [new ys(new sh(0.04, 0), a), [0, 0, 0.99], null, [3, 1, 1]]
              ],
              Z: [
                [new ku(M(1, 0.5), p), null, [0, Math.PI / 2, 0]],
                [new ys(new sh(0.04, 0), o), [0.99, 0, 0], null, [1, 3, 1]]
              ],
              E: [
                [new ku(M(1.25, 1), y), null, [0, Math.PI / 2, 0]],
                [
                  new ys(new od(0.03, 0, 0.15, 4, 1, !1), y),
                  [1.17, 0, 0],
                  [0, 0, -Math.PI / 2],
                  [1, 1, 0.001]
                ],
                [
                  new ys(new od(0.03, 0, 0.15, 4, 1, !1), y),
                  [-1.17, 0, 0],
                  [0, 0, Math.PI / 2],
                  [1, 1, 0.001]
                ],
                [
                  new ys(new od(0.03, 0, 0.15, 4, 1, !1), y),
                  [0, -1.17, 0],
                  [Math.PI, 0, 0],
                  [1, 1, 0.001]
                ],
                [
                  new ys(new od(0.03, 0, 0.15, 4, 1, !1), y),
                  [0, 1.17, 0],
                  [0, 0, 0],
                  [1, 1, 0.001]
                ]
              ],
              XYZE: [[new ku(M(1, 1), g), null, [0, Math.PI / 2, 0]]]
            },
            R = {
              AXIS: [
                [
                  new ku(w, r.clone()),
                  [-1e3, 0, 0],
                  null,
                  [1e6, 1, 1],
                  "helper"
                ]
              ]
            },
            P = {
              X: [
                [
                  new ys(new gh(1, 0.1, 4, 24), n),
                  [0, 0, 0],
                  [0, -Math.PI / 2, -Math.PI / 2]
                ]
              ],
              Y: [
                [
                  new ys(new gh(1, 0.1, 4, 24), n),
                  [0, 0, 0],
                  [Math.PI / 2, 0, 0]
                ]
              ],
              Z: [
                [
                  new ys(new gh(1, 0.1, 4, 24), n),
                  [0, 0, 0],
                  [0, 0, -Math.PI / 2]
                ]
              ],
              E: [[new ys(new gh(1.25, 0.1, 2, 24), n)]],
              XYZE: [[new ys(new Zh(0.7, 10, 8), n)]]
            },
            I = {
              X: [
                [new ys(x, i), [0.8, 0, 0], [0, 0, -Math.PI / 2]],
                [new ku(w, h), null, null, [0.8, 1, 1]]
              ],
              Y: [
                [new ys(x, a), [0, 0.8, 0]],
                [new ku(w, d), null, [0, 0, Math.PI / 2], [0.8, 1, 1]]
              ],
              Z: [
                [new ys(x, o), [0, 0, 0.8], [Math.PI / 2, 0, 0]],
                [new ku(w, p), null, [0, -Math.PI / 2, 0], [0.8, 1, 1]]
              ],
              XY: [
                [new ys(x, l), [0.85, 0.85, 0], null, [2, 2, 0.2]],
                [new ku(w, v), [0.855, 0.98, 0], null, [0.125, 1, 1]],
                [
                  new ku(w, v),
                  [0.98, 0.855, 0],
                  [0, 0, Math.PI / 2],
                  [0.125, 1, 1]
                ]
              ],
              YZ: [
                [new ys(x, c), [0, 0.85, 0.85], null, [0.2, 2, 2]],
                [
                  new ku(w, f),
                  [0, 0.855, 0.98],
                  [0, 0, Math.PI / 2],
                  [0.125, 1, 1]
                ],
                [
                  new ku(w, f),
                  [0, 0.98, 0.855],
                  [0, -Math.PI / 2, 0],
                  [0.125, 1, 1]
                ]
              ],
              XZ: [
                [new ys(x, u), [0.85, 0, 0.85], null, [2, 0.2, 2]],
                [new ku(w, m), [0.855, 0, 0.98], null, [0.125, 1, 1]],
                [
                  new ku(w, m),
                  [0.98, 0, 0.855],
                  [0, -Math.PI / 2, 0],
                  [0.125, 1, 1]
                ]
              ],
              XYZX: [
                [new ys(new Es(0.125, 0.125, 0.125), s.clone()), [1.1, 0, 0]]
              ],
              XYZY: [
                [new ys(new Es(0.125, 0.125, 0.125), s.clone()), [0, 1.1, 0]]
              ],
              XYZZ: [
                [new ys(new Es(0.125, 0.125, 0.125), s.clone()), [0, 0, 1.1]]
              ]
            },
            D = {
              X: [
                [
                  new ys(new od(0.2, 0, 0.8, 4, 1, !1), n),
                  [0.5, 0, 0],
                  [0, 0, -Math.PI / 2]
                ]
              ],
              Y: [[new ys(new od(0.2, 0, 0.8, 4, 1, !1), n), [0, 0.5, 0]]],
              Z: [
                [
                  new ys(new od(0.2, 0, 0.8, 4, 1, !1), n),
                  [0, 0, 0.5],
                  [Math.PI / 2, 0, 0]
                ]
              ],
              XY: [[new ys(x, n), [0.85, 0.85, 0], null, [3, 3, 0.2]]],
              YZ: [[new ys(x, n), [0, 0.85, 0.85], null, [0.2, 3, 3]]],
              XZ: [[new ys(x, n), [0.85, 0, 0.85], null, [3, 0.2, 3]]],
              XYZX: [[new ys(new Es(0.2, 0.2, 0.2), n), [1.1, 0, 0]]],
              XYZY: [[new ys(new Es(0.2, 0.2, 0.2), n), [0, 1.1, 0]]],
              XYZZ: [[new ys(new Es(0.2, 0.2, 0.2), n), [0, 0, 1.1]]]
            },
            O = {
              X: [
                [
                  new ku(w, r.clone()),
                  [-1e3, 0, 0],
                  null,
                  [1e6, 1, 1],
                  "helper"
                ]
              ],
              Y: [
                [
                  new ku(w, r.clone()),
                  [0, -1e3, 0],
                  [0, 0, Math.PI / 2],
                  [1e6, 1, 1],
                  "helper"
                ]
              ],
              Z: [
                [
                  new ku(w, r.clone()),
                  [0, 0, -1e3],
                  [0, -Math.PI / 2, 0],
                  [1e6, 1, 1],
                  "helper"
                ]
              ]
            },
            C = function(e) {
              var t = new Na();
              for (var n in e)
                for (var r = e[n].length; r--; ) {
                  var i = e[n][r][0].clone(),
                    a = e[n][r][1],
                    o = e[n][r][2],
                    s = e[n][r][3],
                    l = e[n][r][4];
                  (i.name = n),
                    (i.tag = l),
                    a && i.position.set(a[0], a[1], a[2]),
                    o && i.rotation.set(o[0], o[1], o[2]),
                    s && i.scale.set(s[0], s[1], s[2]),
                    i.updateMatrix();
                  var c = i.geometry.clone();
                  c.applyMatrix(i.matrix),
                    (i.geometry = c),
                    (i.renderOrder = 1 / 0),
                    i.position.set(0, 0, 0),
                    i.rotation.set(0, 0, 0),
                    i.scale.set(1, 1, 1),
                    t.add(i);
                }
              return t;
            },
            L = new ea(0, 0, 0),
            N = new xa(),
            F = new ea(0, 1, 0),
            k = new ea(0, 0, 0),
            U = new ga(),
            j = new Ji(),
            B = new Ji(),
            z = new Ji(),
            V = new ea(1, 0, 0),
            G = new ea(0, 1, 0),
            H = new ea(0, 0, 1);
          (this.gizmo = {}),
            (this.picker = {}),
            (this.helper = {}),
            this.add((this.gizmo.translate = C(T))),
            this.add((this.gizmo.rotate = C(E))),
            this.add((this.gizmo.scale = C(I))),
            this.add((this.picker.translate = C(A))),
            this.add((this.picker.rotate = C(P))),
            this.add((this.picker.scale = C(D))),
            this.add((this.helper.translate = C(S))),
            this.add((this.helper.rotate = C(R))),
            this.add((this.helper.scale = C(O))),
            (this.picker.translate.visible = !1),
            (this.picker.rotate.visible = !1),
            (this.picker.scale.visible = !1),
            (this.updateMatrixWorld = function() {
              var e = this.space;
              "scale" === this.mode && (e = "local");
              var t = "local" === e ? this.worldQuaternion : z;
              (this.gizmo.translate.visible = "translate" === this.mode),
                (this.gizmo.rotate.visible = "rotate" === this.mode),
                (this.gizmo.scale.visible = "scale" === this.mode),
                (this.helper.translate.visible = "translate" === this.mode),
                (this.helper.rotate.visible = "rotate" === this.mode),
                (this.helper.scale.visible = "scale" === this.mode);
              var n = [];
              n = (n = (n = n.concat(this.picker[this.mode].children)).concat(
                this.gizmo[this.mode].children
              )).concat(this.helper[this.mode].children);
              for (var r = 0; r < n.length; r++) {
                var i = n[r];
                (i.visible = !0),
                  i.rotation.set(0, 0, 0),
                  i.position.copy(this.worldPosition);
                var a = this.worldPosition.distanceTo(this.cameraPosition);
                i.scale.set(1, 1, 1).multiplyScalar((a * this.size) / 7),
                  "helper" !== i.tag
                    ? (i.quaternion.copy(t),
                      "translate" === this.mode || "scale" === this.mode
                        ? (("X" !== i.name && "XYZX" !== i.name) ||
                            (Math.abs(
                              F.copy(V)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.99 &&
                              (i.scale.set(1e-10, 1e-10, 1e-10),
                              (i.visible = !1))),
                          ("Y" !== i.name && "XYZY" !== i.name) ||
                            (Math.abs(
                              F.copy(G)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.99 &&
                              (i.scale.set(1e-10, 1e-10, 1e-10),
                              (i.visible = !1))),
                          ("Z" !== i.name && "XYZZ" !== i.name) ||
                            (Math.abs(
                              F.copy(H)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.99 &&
                              (i.scale.set(1e-10, 1e-10, 1e-10),
                              (i.visible = !1))),
                          "XY" === i.name &&
                            Math.abs(
                              F.copy(H)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) < 0.2 &&
                            (i.scale.set(1e-10, 1e-10, 1e-10),
                            (i.visible = !1)),
                          "YZ" === i.name &&
                            Math.abs(
                              F.copy(V)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) < 0.2 &&
                            (i.scale.set(1e-10, 1e-10, 1e-10),
                            (i.visible = !1)),
                          "XZ" === i.name &&
                            Math.abs(
                              F.copy(G)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) < 0.2 &&
                            (i.scale.set(1e-10, 1e-10, 1e-10),
                            (i.visible = !1)),
                          -1 !== i.name.search("X") &&
                            (F.copy(V)
                              .applyQuaternion(t)
                              .dot(this.eye) < 0
                              ? "fwd" === i.tag
                                ? (i.visible = !1)
                                : (i.scale.x *= -1)
                              : "bwd" === i.tag && (i.visible = !1)),
                          -1 !== i.name.search("Y") &&
                            (F.copy(G)
                              .applyQuaternion(t)
                              .dot(this.eye) < 0
                              ? "fwd" === i.tag
                                ? (i.visible = !1)
                                : (i.scale.y *= -1)
                              : "bwd" === i.tag && (i.visible = !1)),
                          -1 !== i.name.search("Z") &&
                            (F.copy(H)
                              .applyQuaternion(t)
                              .dot(this.eye) < 0
                              ? "fwd" === i.tag
                                ? (i.visible = !1)
                                : (i.scale.z *= -1)
                              : "bwd" === i.tag && (i.visible = !1)))
                        : "rotate" === this.mode &&
                          (B.copy(t),
                          F.copy(this.eye).applyQuaternion(j.copy(t).inverse()),
                          -1 !== i.name.search("E") &&
                            i.quaternion.setFromRotationMatrix(
                              U.lookAt(this.eye, k, G)
                            ),
                          "X" === i.name &&
                            (j.setFromAxisAngle(V, Math.atan2(-F.y, F.z)),
                            j.multiplyQuaternions(B, j),
                            i.quaternion.copy(j)),
                          "Y" === i.name &&
                            (j.setFromAxisAngle(G, Math.atan2(F.x, F.z)),
                            j.multiplyQuaternions(B, j),
                            i.quaternion.copy(j)),
                          "Z" === i.name &&
                            (j.setFromAxisAngle(H, Math.atan2(F.y, F.x)),
                            j.multiplyQuaternions(B, j),
                            i.quaternion.copy(j))),
                      (i.visible =
                        i.visible &&
                        (-1 === i.name.indexOf("X") || this.showX)),
                      (i.visible =
                        i.visible &&
                        (-1 === i.name.indexOf("Y") || this.showY)),
                      (i.visible =
                        i.visible &&
                        (-1 === i.name.indexOf("Z") || this.showZ)),
                      (i.visible =
                        i.visible &&
                        (-1 === i.name.indexOf("E") ||
                          (this.showX && this.showY && this.showZ))),
                      (i.material._opacity =
                        i.material._opacity || i.material.opacity),
                      (i.material._color =
                        i.material._color || i.material.color.clone()),
                      i.material.color.copy(i.material._color),
                      (i.material.opacity = i.material._opacity),
                      this.enabled
                        ? this.axis &&
                          (i.name === this.axis
                            ? ((i.material.opacity = 1),
                              i.material.color.lerp(new Eo(1, 1, 1), 0.5))
                            : this.axis.split("").some(function(e) {
                                return i.name === e;
                              })
                            ? ((i.material.opacity = 1),
                              i.material.color.lerp(new Eo(1, 1, 1), 0.5))
                            : ((i.material.opacity *= 0.25),
                              i.material.color.lerp(new Eo(1, 1, 1), 0.5)))
                        : ((i.material.opacity *= 0.5),
                          i.material.color.lerp(new Eo(1, 1, 1), 0.5)))
                    : ((i.visible = !1),
                      "AXIS" === i.name
                        ? (i.position.copy(this.worldPositionStart),
                          (i.visible = !!this.axis),
                          "X" === this.axis &&
                            (j.setFromEuler(N.set(0, 0, 0)),
                            i.quaternion.copy(t).multiply(j),
                            Math.abs(
                              F.copy(V)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.9 && (i.visible = !1)),
                          "Y" === this.axis &&
                            (j.setFromEuler(N.set(0, 0, Math.PI / 2)),
                            i.quaternion.copy(t).multiply(j),
                            Math.abs(
                              F.copy(G)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.9 && (i.visible = !1)),
                          "Z" === this.axis &&
                            (j.setFromEuler(N.set(0, Math.PI / 2, 0)),
                            i.quaternion.copy(t).multiply(j),
                            Math.abs(
                              F.copy(H)
                                .applyQuaternion(t)
                                .dot(this.eye)
                            ) > 0.9 && (i.visible = !1)),
                          "XYZE" === this.axis &&
                            (j.setFromEuler(N.set(0, Math.PI / 2, 0)),
                            F.copy(this.rotationAxis),
                            i.quaternion.setFromRotationMatrix(
                              U.lookAt(k, F, G)
                            ),
                            i.quaternion.multiply(j),
                            (i.visible = this.dragging)),
                          "E" === this.axis && (i.visible = !1))
                        : "START" === i.name
                        ? (i.position.copy(this.worldPositionStart),
                          (i.visible = this.dragging))
                        : "END" === i.name
                        ? (i.position.copy(this.worldPosition),
                          (i.visible = this.dragging))
                        : "DELTA" === i.name
                        ? (i.position.copy(this.worldPositionStart),
                          i.quaternion.copy(this.worldQuaternionStart),
                          L.set(1e-10, 1e-10, 1e-10)
                            .add(this.worldPositionStart)
                            .sub(this.worldPosition)
                            .multiplyScalar(-1),
                          L.applyQuaternion(
                            this.worldQuaternionStart.clone().inverse()
                          ),
                          i.scale.copy(L),
                          (i.visible = this.dragging))
                        : (i.quaternion.copy(t),
                          this.dragging
                            ? i.position.copy(this.worldPositionStart)
                            : i.position.copy(this.worldPosition),
                          this.axis &&
                            (i.visible = -1 !== this.axis.search(i.name))));
              }
              Na.prototype.updateMatrixWorld.call(this);
            });
        };
        Hy.prototype = Object.assign(Object.create(Na.prototype), {
          constructor: Hy,
          isTransformControlsGizmo: !0
        });
        var Xy = function() {
          ys.call(
            this,
            new Zs(1e5, 1e5, 2, 2),
            new Lo({
              visible: !1,
              wireframe: !0,
              side: qt,
              transparent: !0,
              opacity: 0.1
            })
          ),
            (this.type = "TransformControlsPlane");
          var e = new ea(1, 0, 0),
            t = new ea(0, 1, 0),
            n = new ea(0, 0, 1),
            r = new ea(),
            i = new ea(),
            a = new ea(),
            o = new ga(),
            s = new Ji();
          this.updateMatrixWorld = function() {
            var l = this.space;
            switch (
              (this.position.copy(this.worldPosition),
              "scale" === this.mode && (l = "local"),
              e
                .set(1, 0, 0)
                .applyQuaternion("local" === l ? this.worldQuaternion : s),
              t
                .set(0, 1, 0)
                .applyQuaternion("local" === l ? this.worldQuaternion : s),
              n
                .set(0, 0, 1)
                .applyQuaternion("local" === l ? this.worldQuaternion : s),
              a.copy(t),
              this.mode)
            ) {
              case "translate":
              case "scale":
                switch (this.axis) {
                  case "X":
                    a.copy(this.eye).cross(e), i.copy(e).cross(a);
                    break;
                  case "Y":
                    a.copy(this.eye).cross(t), i.copy(t).cross(a);
                    break;
                  case "Z":
                    a.copy(this.eye).cross(n), i.copy(n).cross(a);
                    break;
                  case "XY":
                    i.copy(n);
                    break;
                  case "YZ":
                    i.copy(e);
                    break;
                  case "XZ":
                    a.copy(n), i.copy(t);
                    break;
                  case "XYZ":
                  case "E":
                    i.set(0, 0, 0);
                }
                break;
              case "rotate":
              default:
                i.set(0, 0, 0);
            }
            0 === i.length()
              ? this.quaternion.copy(this.cameraQuaternion)
              : (o.lookAt(r.set(0, 0, 0), i, a),
                this.quaternion.setFromRotationMatrix(o)),
              Na.prototype.updateMatrixWorld.call(this);
          };
        };
        function Wy(e) {
          return (Wy =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Yy(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function qy(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Qy(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Zy(e, t) {
          return !t || ("object" !== Wy(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Jy(e, t, n) {
          return (Jy =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Ky(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Ky(e) {
          return (Ky = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function $y(e, t) {
          return ($y =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        Xy.prototype = Object.assign(Object.create(ys.prototype), {
          constructor: Xy,
          isTransformControlsPlane: !0
        });
        var eb = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "TransformControls" : i,
              o = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = Zy(
                this,
                Ky(t).call(this, { controller: r, name: o, type: a })
              )).targetElementID = null),
              (n.state = "idle"),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && $y(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return Jy(Ky(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      var t = e.controller.getObject(n.cameraID),
                        r = n.container,
                        i = n.userData;
                      return (
                        (e.onElementChanged = n.onElementChanged),
                        (e.uuid = e._createTransformControls({
                          camera: t,
                          container: r,
                          userData: i
                        })),
                        (e.useClone = !0),
                        !0
                      );
                    });
                }
              },
              {
                key: "attach",
                value: function(e) {
                  if (this.active && this.targetElementID !== e) {
                    this.targetElementID = e;
                    var t = this._getTargetObj();
                    this.refs.obj.attach(t);
                  }
                }
              },
              {
                key: "detach",
                value: function() {
                  this.active &&
                    this.targetElementID &&
                    (this.refs.obj.detach(),
                    this._releaseTargetObj(),
                    (this.targetElementID = null));
                }
              },
              {
                key: "_createTransformControls",
                value: function(e) {
                  var t = e.camera,
                    n = e.container,
                    r = e.userData;
                  return (
                    (this.refs.obj = new Gy(t, n)),
                    (this.refs.obj.uuid = E()()),
                    (this._onChanged = this._onChanged.bind(this)),
                    (this._onDraggingChanged = this._onDraggingChanged.bind(
                      this
                    )),
                    this.refs.obj.addEventListener(
                      "change",
                      this._onChanged,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "dragging-changed",
                      this._onDraggingChanged,
                      !1
                    ),
                    (this.refs.obj.userData = (function(e) {
                      for (var t = 1; t < arguments.length; t++) {
                        var n = null != arguments[t] ? arguments[t] : {};
                        t % 2
                          ? Yy(Object(n), !0).forEach(function(t) {
                              qy(e, t, n[t]);
                            })
                          : Object.getOwnPropertyDescriptors
                          ? Object.defineProperties(
                              e,
                              Object.getOwnPropertyDescriptors(n)
                            )
                          : Yy(Object(n)).forEach(function(t) {
                              Object.defineProperty(
                                e,
                                t,
                                Object.getOwnPropertyDescriptor(n, t)
                              );
                            });
                      }
                      return e;
                    })({}, r)),
                    (this.active = !0),
                    this.refs.obj.uuid
                  );
                }
              },
              {
                key: "_onChanged",
                value: function() {
                  document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "_onDraggingChanged",
                value: function(e) {
                  e.value ? this._startDragging(e) : this._stopDragging(e),
                    this.setProperty({
                      key: "state",
                      value: e.value ? "dragging" : "idle"
                    }),
                    document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.refs.obj.removeEventListener(
                    "change",
                    this._onChanged,
                    !1
                  ),
                    this.refs.obj.removeEventListener(
                      "dragging-changed",
                      this._onDraggingChanged,
                      !1
                    ),
                    this.refs.obj.dispose(),
                    (this.refs.obj = null);
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = this.refs.obj,
                    u = l;
                  switch (n) {
                    case "mode":
                      c.setMode(r), (u = !0);
                      break;
                    case "space":
                      c.setSpace(r), (u = !0);
                      break;
                    case "size":
                      c.setSize(r), (u = !0);
                      break;
                    case "showX":
                      (c.showX = r), (u = !0);
                      break;
                    case "showY":
                      (c.showY = r), (u = !0);
                      break;
                    case "showZ":
                      (c.showZ = r), (u = !0);
                      break;
                    case "translationSnap":
                      c.setTranslationSnap(r), (u = !0);
                      break;
                    case "rotationSnap":
                      c.setRotationSnap(r), (u = !0);
                      break;
                    case "state":
                      (this.state = r), (u = !0);
                  }
                  return Jy(Ky(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: o,
                    ignore: u
                  });
                }
              },
              {
                key: "_getTargetObj",
                value: function() {
                  return this.useClone
                    ? this._createTransformClone(this.targetElementID)
                    : this.controller.getElement(this.targetElementID).getRefs()
                        .obj;
                }
              },
              {
                key: "_createTransformClone",
                value: function(e) {
                  var t = this.controller.getElement(e),
                    n = t.getRefs();
                  switch (t.type) {
                    case "Node":
                    case "Sprite":
                      (n.transformClone = n.obj.clone()),
                        this._setupCloneMaterials(n.transformClone);
                      break;
                    case "Light":
                    case "Camera":
                      n.transformClone = n.obj.clone();
                  }
                  return n.transformClone
                    ? ((n.transformClone.visible = !1),
                      n.obj.parent.add(n.transformClone),
                      n.transformClone)
                    : null;
                }
              },
              {
                key: "_setupCloneMaterials",
                value: function(e) {
                  var t = this;
                  e.material &&
                    (Array.isArray(e.material)
                      ? (e.material = e.material.map(function(e) {
                          var t = e.clone();
                          return (
                            (t.transparent = !0), (t.opacity = e.opacity / 2), t
                          );
                        }))
                      : ((e.material = e.material.clone()),
                        (e.material.transparent = !0),
                        (e.material.opacity /= 2))),
                    e.children.forEach(function(e) {
                      return t._setupCloneMaterials(e);
                    });
                }
              },
              {
                key: "_releaseTargetObj",
                value: function() {
                  this.useClone && this._disposeTransformClone();
                }
              },
              {
                key: "_disposeTransformClone",
                value: function() {
                  var e = this.controller.getElement(this.targetElementID),
                    t = e.getRefs();
                  if (t.transformClone) {
                    switch ((t.obj.parent.remove(t.transformClone), e.type)) {
                      case "Node":
                      case "Sprite":
                        qv.disposeNode(t.transformClone);
                    }
                    t.transformClone = null;
                  }
                }
              },
              {
                key: "_startDragging",
                value: function() {
                  var e = this.controller
                    .getElement(this.targetElementID)
                    .getRefs();
                  this.useClone &&
                    e.transformClone &&
                    (e.transformClone.visible = !0);
                }
              },
              {
                key: "_stopDragging",
                value: function() {
                  var e = this.controller
                    .getElement(this.targetElementID)
                    .getRefs();
                  if (
                    (this.useClone &&
                      e.transformClone &&
                      (e.transformClone.visible = !1),
                    this._updateTargetObj(),
                    this.onElementChanged)
                  ) {
                    var t = this.refs.obj.object,
                      n = t.position,
                      r = n.x,
                      i = n.y,
                      a = n.z,
                      o = t.rotation,
                      s = o.x,
                      l = o.y,
                      c = o.z,
                      u = t.quaternion,
                      h = u.x,
                      d = u.y,
                      p = u.z,
                      f = u.w,
                      m = t.scale,
                      v = m.x,
                      g = m.y,
                      y = m.z;
                    this.onElementChanged({
                      elementID: this.targetElementID,
                      properties: [
                        { key: "position", value: [r, i, a] },
                        { key: "rotation", value: [s, l, c] },
                        { key: "quaternion", value: [h, d, p, f] },
                        { key: "scale", value: [v, g, y] }
                      ]
                    });
                  }
                }
              },
              {
                key: "_updateTargetObj",
                value: function() {
                  var e = this.controller.getElement(this.targetElementID);
                  this.useClone
                    ? this._updateFromTransformClone()
                    : "Camera" === e.type &&
                      e.getRefs().obj.lookAt(e.direction);
                }
              },
              {
                key: "_updateFromTransformClone",
                value: function() {
                  var e = this.controller.getElement(this.targetElementID),
                    t = e.getRefs();
                  t.transformClone &&
                    (t.obj.position.copy(t.transformClone.position),
                    "Camera" === e.type
                      ? t.obj.lookAt(e.direction)
                      : (t.obj.quaternion.copy(t.transformClone.quaternion),
                        t.obj.scale.copy(t.transformClone.scale)));
                }
              }
            ]) && Qy(n.prototype, r),
            i && Qy(n, i),
            t
          );
        })(Iv);
        function tb(e) {
          return (tb =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function nb(e, t, n) {
          return (nb = (function() {
            if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
            if (Reflect.construct.sham) return !1;
            if ("function" == typeof Proxy) return !0;
            try {
              return (
                Date.prototype.toString.call(
                  Reflect.construct(Date, [], function() {})
                ),
                !0
              );
            } catch (e) {
              return !1;
            }
          })()
            ? Reflect.construct
            : function(e, t, n) {
                var r = [null];
                r.push.apply(r, t);
                var i = new (Function.bind.apply(e, r))();
                return n && sb(i, n.prototype), i;
              }).apply(null, arguments);
        }
        function rb(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function ib(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function ab(e, t) {
          return !t || ("object" !== tb(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function ob(e) {
          return (ob = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function sb(e, t) {
          return (sb =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var lb = (function(e) {
          function t(e) {
            var n,
              r = e.camera,
              i = e.domElement,
              a = e.object,
              o = void 0 === a ? null : a,
              s = e.mode,
              l = void 0 === s ? "Translate" : s,
              c = e.rotationSpeed,
              u = void 0 === c ? 0.1 : c,
              h = e.rotationSpeedTouch,
              d = void 0 === h ? 0.3 : h,
              p = e.rotationUpAxis,
              f = void 0 === p ? [0, 0, 1] : p,
              m = e.rotationRightAxis,
              v = void 0 === m ? [0, 1, 0] : m,
              g = e.rotationScope,
              y = void 0 === g ? "World" : g,
              b = e.horizontalRotationEnabled,
              x = void 0 === b || b,
              w = e.verticalRotationEnabled,
              _ = void 0 === w || w;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = ab(this, ob(t).call(this))).enabled = !0),
              (n.mode = l),
              (n._camera = r),
              (n._domElement = i),
              (n._object = o),
              (n._isDragging = !1),
              (n._plane = new ho()),
              (n._raycaster = new Of()),
              (n._mouse = new Zi()),
              (n._offset = new ea()),
              (n._intersection = new ea()),
              (n._worldPosition = new ea()),
              (n._inverseMatrix = new ga()),
              (n._rotationSpeed = u),
              (n._rotationSpeedTouch = d),
              (n._horizontalRotationEnabled = x),
              (n._verticalRotationEnabled = _),
              (n._rotationUpAxis = nb(ea, rb(f))),
              (n._rotationRightAxis = nb(ea, rb(v))),
              (n._rotationScope = y),
              (n.maxRotationAngles = {
                x: { enabled: !1, from: Math.PI / 8, to: Math.PI / 8 },
                y: { enabled: !1, from: Math.PI / 4, to: Math.PI / 4 }
              }),
              (n.mouseFlags = { MOUSEDOWN: 0, MOUSEMOVE: 1 }),
              (n.flag = null),
              (n.previousMousePosition = { x: 0, y: 0 }),
              n.activate(),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && sb(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "activate",
                value: function() {
                  (this.onMouseDown = this.onMouseDown.bind(this)),
                    (this.onMouseMove = this.onMouseMove.bind(this)),
                    (this.onMouseUp = this.onMouseUp.bind(this)),
                    (this.onTouchStart = this.onTouchStart.bind(this)),
                    (this.onTouchMove = this.onTouchMove.bind(this)),
                    (this.onTouchEnd = this.onTouchEnd.bind(this)),
                    (this.onMouseLeave = this.onMouseLeave.bind(this)),
                    this._domElement.addEventListener(
                      "mousedown",
                      this.onMouseDown,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "mousemove",
                      this.onMouseMove,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "mouseup",
                      this.onMouseUp,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "touchstart",
                      this.onTouchStart,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "touchmove",
                      this.onTouchMove,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "touchend",
                      this.onTouchEnd,
                      !1
                    ),
                    this._domElement.addEventListener(
                      "mouseleave",
                      this.onMouseLeave,
                      !1
                    );
                }
              },
              {
                key: "deactivate",
                value: function() {
                  this._domElement.removeEventListener(
                    "mousedown",
                    this.onMouseDown,
                    !1
                  ),
                    this._domElement.removeEventListener(
                      "mousemove",
                      this.onMouseMove,
                      !1
                    ),
                    this._domElement.removeEventListener(
                      "mouseup",
                      this.onMouseUp,
                      !1
                    ),
                    this._domElement.removeEventListener(
                      "touchstart",
                      this.onTouchStart,
                      !1
                    ),
                    this._domElement.removeEventListener(
                      "touchmove",
                      this.onTouchMove,
                      !1
                    ),
                    this._domElement.removeEventListener(
                      "touchend",
                      this.onTouchEnd,
                      !1
                    ),
                    this._domElement.removeEventListener(
                      "mouseleave",
                      this.onMouseLeave,
                      !1
                    );
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.deactivate();
                }
              },
              {
                key: "onMouseMove",
                value: function(e) {
                  if (
                    (e.preventDefault(),
                    this._object && this.enabled && this._isDragging)
                  ) {
                    if ("Translate" === this.mode) {
                      var t = this._domElement.getBoundingClientRect();
                      (this._mouse.x =
                        ((e.clientX - t.left) / this._domElement.clientWidth) *
                          2 -
                        1),
                        (this._mouse.y =
                          (-(e.clientY - t.top) /
                            this._domElement.clientHeight) *
                            2 +
                          1),
                        this._raycaster.setFromCamera(
                          this._mouse,
                          this._camera
                        ),
                        this._raycaster.ray.intersectPlane(
                          this._plane,
                          this._intersection
                        ) &&
                          this._object.position.copy(
                            this._intersection
                              .sub(this._offset)
                              .applyMatrix4(this._inverseMatrix)
                          );
                    } else if ("Rotate" === this.mode) {
                      var n = {
                        x: e.offsetX - this.previousMousePosition.x,
                        y: e.offsetY - this.previousMousePosition.y
                      };
                      (this.previousMousePosition = {
                        x: e.offsetX,
                        y: e.offsetY
                      }),
                        this._horizontalRotationEnabled &&
                          0 !== n.x &&
                          ("World" === this._rotationScope
                            ? this._object.rotateOnWorldAxis(
                                this._rotationUpAxis,
                                Math.sign(n.x) * this._rotationSpeed
                              )
                            : this._object.rotateOnAxis(
                                this._rotationUpAxis,
                                Math.sign(n.x) * this._rotationSpeed
                              ),
                          (this._object.matrixWorldNeedsUpdate = !0),
                          (this.flag = this.mouseFlags.MOUSEMOVE)),
                        this._verticalRotationEnabled &&
                          0 !== n.y &&
                          ("World" === this._rotationScope
                            ? this._object.rotateOnWorldAxis(
                                this._rotationRightAxis,
                                Math.sign(n.y) * this._rotationSpeed
                              )
                            : this._object.rotateOnAxis(
                                this._rotationRightAxis,
                                Math.sign(n.y) * this._rotationSpeed
                              ),
                          (this._object.matrixWorldNeedsUpdate = !0),
                          (this.flag = this.mouseFlags.MOUSEMOVE));
                    }
                    this.emitDispatchEvent("change");
                  }
                }
              },
              {
                key: "onMouseDown",
                value: function(e) {
                  if ((e.preventDefault(), this._object && this.enabled)) {
                    if ("Translate" === this.mode) {
                      this._inverseMatrix.getInverse(
                        this._object.parent.matrixWorld
                      ),
                        this._worldPosition.setFromMatrixPosition(
                          this._object.matrixWorld
                        );
                      var t = this._domElement.getBoundingClientRect();
                      (this._mouse.x =
                        ((e.clientX - t.left) / this._domElement.clientWidth) *
                          2 -
                        1),
                        (this._mouse.y =
                          (-(e.clientY - t.top) /
                            this._domElement.clientHeight) *
                            2 +
                          1),
                        this._raycaster.setFromCamera(
                          this._mouse,
                          this._camera
                        ),
                        this._raycaster.ray.intersectPlane(
                          this._plane,
                          this._intersection
                        ) &&
                          this._offset
                            .copy(this._intersection)
                            .sub(this._worldPosition);
                    } else
                      "Rotate" === this.mode &&
                        (this.flag = this.mouseFlags.MOUSEDOWN);
                    (this._isDragging = !0), this.emitDispatchEvent("start");
                  }
                }
              },
              {
                key: "onMouseUp",
                value: function(e) {
                  e.preventDefault(),
                    this._object &&
                      this._isDragging &&
                      ("Translate" === this.mode ||
                        ("Rotate" === this.mode &&
                          (this.previousMousePosition = { x: 0, y: 0 })),
                      (this._isDragging = !1),
                      this.emitDispatchEvent("end"));
                }
              },
              {
                key: "onMouseLeave",
                value: function(e) {
                  e.preventDefault(),
                    this._object &&
                      this._isDragging &&
                      ("Translate" === this.mode ||
                        ("Rotate" === this.mode &&
                          (this.previousMousePosition = { x: 0, y: 0 })),
                      (this._isDragging = !1),
                      this.emitDispatchEvent("end"));
                }
              },
              {
                key: "onTouchStart",
                value: function(e) {
                  e.preventDefault();
                  var t = e.changedTouches[0];
                  if (this._object && this.enabled) {
                    if ("Translate" === this.mode) {
                      var n = this._domElement.getBoundingClientRect();
                      (this._mouse.x =
                        ((t.clientX - n.left) / this._domElement.clientWidth) *
                          2 -
                        1),
                        (this._mouse.y =
                          (-(t.clientY - n.top) /
                            this._domElement.clientHeight) *
                            2 +
                          1),
                        this._raycaster.setFromCamera(
                          this._mouse,
                          this._camera
                        ),
                        this._raycaster.ray.intersectPlane(
                          this._plane,
                          this._intersection
                        ) &&
                          (this._inverseMatrix.getInverse(
                            this._object.parent.matrixWorld
                          ),
                          this._offset
                            .copy(this._intersection)
                            .sub(
                              this._worldPosition.setFromMatrixPosition(
                                this._object.matrixWorld
                              )
                            ));
                    } else
                      "Rotate" === this.mode &&
                        ((this.flag = this.mouseFlags.MOUSEDOWN),
                        (this.totalDeltaMove = { x: 0, y: 0 }),
                        (this.previousMousePosition = {
                          x: t.pageX,
                          y: t.pageY
                        }));
                    (this._isDragging = !0), this.emitDispatchEvent("start");
                  }
                }
              },
              {
                key: "onTouchEnd",
                value: function(e) {
                  e.preventDefault(),
                    this._object &&
                      this._isDragging &&
                      ("Translate" === this.mode ||
                        ("Rotate" === this.mode &&
                          (this.previousMousePosition = { x: 0, y: 0 })),
                      (this._isDragging = !1),
                      this.emitDispatchEvent("end"));
                }
              },
              {
                key: "onTouchMove",
                value: function(e) {
                  e.preventDefault();
                  var t = e.changedTouches[0];
                  if (this._object && this.enabled && this._isDragging) {
                    if ("Translate" === this.mode) {
                      var n = this._domElement.getBoundingClientRect();
                      (this._mouse.x =
                        ((t.clientX - n.left) / this._domElement.clientWidth) *
                          2 -
                        1),
                        (this._mouse.y =
                          (-(t.clientY - n.top) /
                            this._domElement.clientHeight) *
                            2 +
                          1),
                        this._raycaster.setFromCamera(
                          this._mouse,
                          this._camera
                        ),
                        this._raycaster.ray.intersectPlane(
                          this._plane,
                          this._intersection
                        ) &&
                          this._object.position.copy(
                            this._intersection
                              .sub(this._offset)
                              .applyMatrix4(this._inverseMatrix)
                          );
                    } else if ("Rotate" === this.mode) {
                      var r = {
                        x: t.pageX - this.previousMousePosition.x,
                        y: t.pageY - this.previousMousePosition.y
                      };
                      (this.previousMousePosition = { x: t.pageX, y: t.pageY }),
                        this._horizontalRotationEnabled &&
                          0 !== r.x &&
                          ("World" === this._rotationScope
                            ? this._object.rotateOnWorldAxis(
                                this._rotationUpAxis,
                                Math.sign(r.x) * this._rotationSpeedTouch
                              )
                            : this._object.rotateOnAxis(
                                this._rotationUpAxis,
                                Math.sign(r.x) * this._rotationSpeedTouch
                              ),
                          (this._object.matrixWorldNeedsUpdate = !0),
                          (this.flag = this.mouseFlags.MOUSEMOVE)),
                        this._verticalRotationEnabled &&
                          0 !== r.y &&
                          ("World" === this._rotationScope
                            ? this._object.rotateOnWorldAxis(
                                this._rotationRightAxis,
                                Math.sign(r.y) * this._rotationSpeedTouch
                              )
                            : this._object.rotateOnAxis(
                                this._rotationRightAxis,
                                Math.sign(r.y) * this._rotationSpeedTouch
                              ),
                          (this._object.matrixWorldNeedsUpdate = !0),
                          (this.flag = this.mouseFlags.MOUSEMOVE));
                    }
                    this.emitDispatchEvent("change");
                  }
                }
              },
              {
                key: "isWithinMaxAngle",
                value: function(e, t) {
                  return (
                    !this.maxRotationAngles[t].enabled ||
                    (-1 * this.maxRotationAngles[t].from <
                      this.mesh.rotation[t] + e &&
                      this.mesh.rotation[t] + e < this.maxRotationAngles[t].to)
                  );
                }
              },
              {
                key: "isBetween",
                value: function(e, t, n) {
                  return (
                    (t = t - e < 0 ? t - e + 2 * Math.PI : t - e),
                    (n = n - e < 0 ? n - e + 2 * Math.PI : n - e) < t
                  );
                }
              },
              {
                key: "emitDispatchEvent",
                value: function(e) {
                  var t = this._object.position,
                    n = t.x,
                    r = t.y,
                    i = t.z,
                    a = this._object.rotation,
                    o = a.x,
                    s = a.y,
                    l = a.z,
                    c = this._object.quaternion,
                    u = c.x,
                    h = c.y,
                    d = c.z,
                    p = c.w;
                  this.dispatchEvent({
                    type: e,
                    position: [n, r, i],
                    rotation: [o, s, l],
                    quaternion: [u, h, d, p]
                  });
                }
              },
              {
                key: "object",
                get: function() {
                  return this._object;
                },
                set: function(e) {
                  (this._object = e),
                    (this._isDragging = !1),
                    "Translate" === this.mode &&
                      this._plane.setFromNormalAndCoplanarPoint(
                        this._camera.getWorldDirection(this._plane.normal),
                        this._worldPosition.setFromMatrixPosition(
                          this._object.matrixWorld
                        )
                      );
                }
              }
            ]) && ib(n.prototype, r),
            i && ib(n, i),
            t
          );
        })(Wi);
        function cb(e) {
          return (cb =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function ub(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function hb(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function db(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function pb(e, t) {
          return !t || ("object" !== cb(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function fb(e, t, n) {
          return (fb =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = mb(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function mb(e) {
          return (mb = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function vb(e, t) {
          return (vb =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var gb = (function(e) {
          function t(e) {
            var n,
              r = e.controller,
              i = e.type,
              a = void 0 === i ? "ObjectControls" : i,
              o = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = pb(
                this,
                mb(t).call(this, {
                  controller: r,
                  name: o,
                  type: a,
                  updatable: !1
                })
              )).state = "idle"),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && vb(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return fb(mb(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (
                        (e.onElementChanged = n.onElementChanged),
                        (e.cameraID = n.cameraID),
                        (e.targetElementID = null),
                        (e.uuid = e._createObjectControls(n)),
                        !0
                      );
                    });
                }
              },
              {
                key: "update",
                value: function() {
                  this.refs.obj.update();
                }
              },
              {
                key: "_createObjectControls",
                value: function(e) {
                  var t = this.controller.getObject(e.cameraID),
                    n = e.container;
                  return (
                    (this.refs.obj = new lb({
                      camera: t,
                      domElement: n,
                      mode: "Rotate"
                    })),
                    (this.refs.obj.uuid = E()()),
                    (this._onChangeStarted = this._onChangeStarted.bind(this)),
                    (this._onChanged = this._onChanged.bind(this)),
                    (this._onChangeEnded = this._onChangeEnded.bind(this)),
                    this.refs.obj.addEventListener(
                      "start",
                      this._onChangeStarted,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "change",
                      this._onChanged,
                      !1
                    ),
                    this.refs.obj.addEventListener(
                      "end",
                      this._onChangeEnded,
                      !1
                    ),
                    (this.refs.obj.userData = (function(e) {
                      for (var t = 1; t < arguments.length; t++) {
                        var n = null != arguments[t] ? arguments[t] : {};
                        t % 2
                          ? ub(Object(n), !0).forEach(function(t) {
                              hb(e, t, n[t]);
                            })
                          : Object.getOwnPropertyDescriptors
                          ? Object.defineProperties(
                              e,
                              Object.getOwnPropertyDescriptors(n)
                            )
                          : ub(Object(n)).forEach(function(t) {
                              Object.defineProperty(
                                e,
                                t,
                                Object.getOwnPropertyDescriptor(n, t)
                              );
                            });
                      }
                      return e;
                    })({}, e.userData)),
                    this.refs.obj.uuid
                  );
                }
              },
              {
                key: "_onChanged",
                value: function() {
                  document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "_onChangeStarted",
                value: function() {
                  document.dispatchEvent(new Event("pulseUpdate")),
                    this.targetElementID &&
                      this.setProperty({ key: "state", value: "dragging" });
                }
              },
              {
                key: "_onChangeEnded",
                value: function(e) {
                  document.dispatchEvent(new Event("pulseUpdate")),
                    this.targetElementID &&
                      (this.onElementChanged({
                        elementID: this.targetElementID,
                        properties: [
                          { key: "position", value: e.position },
                          { key: "rotation", value: e.rotation },
                          { key: "quaternion", value: e.quaternion }
                        ]
                      }),
                      this.setProperty({ key: "state", value: "idle" }));
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.refs.obj.removeEventListener(
                    "start",
                    this._onChangeStarted,
                    !1
                  ),
                    this.refs.obj.removeEventListener(
                      "change",
                      this._onChanged,
                      !1
                    ),
                    this.refs.obj.removeEventListener(
                      "end",
                      this._onChangeEnded,
                      !1
                    ),
                    this.refs.obj.dispose(),
                    (this.refs.obj = null);
                }
              },
              {
                key: "setTargetElement",
                value: function(e) {
                  (this.targetElementID = e),
                    (this.refs.obj.object = e
                      ? this.controller.getObject(e)
                      : null);
                }
              },
              {
                key: "setProperty",
                value: function(e) {
                  var n = e.key,
                    r = e.value,
                    i = e.valueType,
                    a = e.notify,
                    o = void 0 === a || a,
                    s = e.ignore,
                    l = void 0 !== s && s,
                    c = this.refs.obj,
                    u = l;
                  switch (n) {
                    case "mode":
                      (c.mode = r), (u = !0);
                      break;
                    case "state":
                      (this.state = r), (u = !0);
                  }
                  return fb(mb(t.prototype), "setProperty", this).call(this, {
                    key: n,
                    value: r,
                    valueType: i,
                    notify: o,
                    ignore: u
                  });
                }
              }
            ]) && db(n.prototype, r),
            i && db(n, i),
            t
          );
        })(bv);
        function yb(e) {
          return (yb =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function bb(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function xb(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? bb(Object(n), !0).forEach(function(t) {
                  wb(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : bb(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function wb(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function _b(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Mb(e, t) {
          return !t || ("object" !== yb(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Tb(e, t, n) {
          return (Tb =
            "undefined" != typeof Reflect && Reflect.get
              ? Reflect.get
              : function(e, t, n) {
                  var r = (function(e, t) {
                    for (
                      ;
                      !Object.prototype.hasOwnProperty.call(e, t) &&
                      null !== (e = Ab(e));

                    );
                    return e;
                  })(e, t);
                  if (r) {
                    var i = Object.getOwnPropertyDescriptor(r, t);
                    return i.get ? i.get.call(n) : i.value;
                  }
                })(e, t, n || e);
        }
        function Ab(e) {
          return (Ab = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Sb(e, t) {
          return (Sb =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Eb = (function(e) {
          function t(e) {
            var n = e.controller,
              r = e.type,
              i = void 0 === r ? "Sprite" : r,
              a = e.name;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              Mb(this, Ab(t).call(this, { controller: n, name: a, type: i }))
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Sb(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this,
                    n =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : {};
                  return Tb(Ab(t.prototype), "init", this)
                    .call(this, n)
                    .then(function() {
                      return (e.uuid = e._createSprite(n)), !0;
                    });
                }
              },
              {
                key: "_createSprite",
                value: function() {
                  var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : {};
                  return (
                    (this.refs.obj = new vu()),
                    (this.refs.obj.userData = xb({}, e.userData)),
                    this.refs.obj.uuid
                  );
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.refs.obj = null;
                }
              }
            ]) && _b(n.prototype, r),
            i && _b(n, i),
            t
          );
        })(Iv);
        function Rb(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function Pb(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var Ib = (function() {
          function e(t) {
            var n = t.viewer,
              r = t.sceneManager,
              i = t.assetManager,
              a = t.singles,
              o = void 0 === a ? [] : a;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.viewer = n),
              (this.sceneManager = r),
              (this.assetManager = i),
              (this.elements = new Map()),
              (this.elementsByType = new Map()),
              (this.elementsByName = new Map()),
              (this.updatables = []),
              (this.singles = o),
              (this.delta = 0),
              (this.subscribers = this.createSubscriberEntry());
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function() {
                  return (this.clock = new nf()), Promise.resolve(!0);
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    return (
                      e.elements.forEach(function(t, n) {
                        e.disposeElement({ elementID: n });
                      }),
                      !0
                    );
                  });
                }
              },
              {
                key: "update",
                value: function(e) {
                  var t = this;
                  (this.delta = e),
                    this.updatables.forEach(function(e) {
                      t.updateElement(e);
                    });
                }
              },
              {
                key: "updateElement",
                value: function(e) {
                  var t =
                      arguments.length > 1 &&
                      void 0 !== arguments[1] &&
                      arguments[1],
                    n = this.getElement(e);
                  t && (n.needsUpdate = !0), n.update(this.delta);
                }
              },
              {
                key: "updateElements",
                value: function(e) {
                  var t = this,
                    n =
                      arguments.length > 1 &&
                      void 0 !== arguments[1] &&
                      arguments[1],
                    r = this.getElementIdsByType(e);
                  r.forEach(function(e) {
                    t.updateElement(e, n);
                  });
                }
              },
              {
                key: "createElement",
                value: function(e) {
                  var t = this,
                    n = e.type,
                    r = e.name,
                    i = void 0 === r ? null : r,
                    a = e.addable,
                    o = e.updatable,
                    s = e.disposable,
                    l = e.add,
                    c = void 0 === l || l,
                    u = e.config,
                    h = void 0 === u ? {} : u,
                    d = [];
                  this.singles.includes(n) &&
                    this.getElementIdsByType(n).forEach(function(e) {
                      d = [].concat(Rb(d), [
                        t.disposeElement({ elementID: e })
                      ]);
                    });
                  var p = null;
                  switch (n) {
                    case "Scene":
                      p = new Vy({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Grid":
                      p = new jv({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Axes":
                      p = new tg({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Model":
                      p = new cg({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Node":
                      p = new Iv({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Material":
                      p = new sy({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Texture":
                      p = new Fy({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Light":
                      p = new My({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Sprite":
                      p = new Eb({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "Camera":
                      p = new xg({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "CameraControls":
                      p = new $g({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "TransformControls":
                      p = new eb({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    case "ObjectControls":
                      p = new gb({
                        controller: this,
                        name: i,
                        addable: a,
                        updatable: o,
                        disposable: s
                      });
                      break;
                    default:
                      throw new Error(
                        "Not valid type ".concat(n, " of element")
                      );
                  }
                  return Promise.all(d)
                    .then(function() {
                      return p.init(h);
                    })
                    .then(function() {
                      return (
                        t.attachElement(p),
                        c &&
                          t.addElement({
                            elementID: p.uuid,
                            parentID: h.parentID || null
                          }),
                        { element: p }
                      );
                    });
                }
              },
              {
                key: "attachElement",
                value: function(e) {
                  this.elements.set(e.uuid, e),
                    this.elementsByType.get(e.type) ||
                      this.elementsByType.set(e.type, []);
                  var t = this.elementsByType.get(e.type);
                  this.elementsByType.set(e.type, [].concat(Rb(t), [e.uuid])),
                    e.name && this.elementsByName.set(e.name, e.uuid),
                    e.updatable &&
                      (this.updatables = [].concat(Rb(this.updatables), [
                        e.uuid
                      ]));
                }
              },
              {
                key: "detachElement",
                value: function(e) {
                  this.elements.delete(e.uuid);
                  var t = this.elementsByType.get(e.type).filter(function(t) {
                    return t !== e.uuid;
                  });
                  e.updatable &&
                    (this.updatables = this.updatables.filter(function(t) {
                      return t !== e.uuid;
                    })),
                    e.name && this.elementsByName.delete(e.uuid),
                    this.elementsByType.set(e.type, t);
                }
              },
              {
                key: "disposeElement",
                value: function(e) {
                  var t = e.elementID,
                    n = e.remove,
                    r = void 0 === n || n,
                    i = this.getElement(t);
                  i &&
                    i.disposable &&
                    (r && this.removeElement({ elementID: t }),
                    i.dispose(),
                    this.detachElement(i));
                }
              },
              {
                key: "getElement",
                value: function(e) {
                  return this.elements.get(e) || null;
                }
              },
              {
                key: "getSingleElement",
                value: function(e) {
                  if (!this.singles.includes(e))
                    throw new Error(
                      "Element of type ".concat(e, " is not single")
                    );
                  var t = this.getElementIdsByType(e)[0];
                  return this.getElement(t) || null;
                }
              },
              {
                key: "getElementByName",
                value: function(e) {
                  return this.elementsByName.get(e)
                    ? this.getElement(this.elementsByName.get(e))
                    : null;
                }
              },
              {
                key: "getObject",
                value: function(e) {
                  var t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : {},
                    n = this.getElement(e);
                  return n ? n.getObject(t) : null;
                }
              },
              {
                key: "getElementIdsByType",
                value: function(e) {
                  return this.elementsByType.get(e) || [];
                }
              },
              {
                key: "addElement",
                value: function(e) {
                  var t = e.elementID,
                    n = e.parentID,
                    r = this.getElement(t);
                  if (r.addable) {
                    var i = n
                      ? this.getElement(n)
                      : this.getSingleElement("Scene");
                    r.add({ parent: i });
                  }
                }
              },
              {
                key: "removeElement",
                value: function(e) {
                  var t = e.elementID,
                    n = this.getElement(t);
                  n.addable && n.remove();
                }
              },
              {
                key: "setProperties",
                value: function(e) {
                  var t = e.elementID,
                    n = e.properties,
                    r = e.notify,
                    i = void 0 === r || r,
                    a = this.getElement(t);
                  return (
                    document.dispatchEvent(new Event("pulseUpdate")),
                    a.setProperties({ properties: n, notify: i })
                  );
                }
              },
              {
                key: "notify",
                value: function(e) {
                  var t,
                    n = e.notifyType,
                    r = e.elementID,
                    i = e.properties,
                    a = e.emit,
                    o = [],
                    s = this.getElement(r),
                    l = this.subscribers[n];
                  if (l) {
                    var c = l[s.type];
                    return c
                      ? (c.handlers.forEach(function(e) {
                          (t = e.callback({
                            elementID: r,
                            properties: i,
                            emit: a
                          })),
                            (o = [].concat(Rb(o), Rb(t)));
                        }),
                        o)
                      : (l.handlers.forEach(function(e) {
                          (t = e.callback({
                            elementID: r,
                            properties: i,
                            emit: a
                          })),
                            (o = [].concat(Rb(o), Rb(t)));
                        }),
                        o);
                  }
                  return (
                    this.subscribers.handlers.forEach(function(e) {
                      (t = e.callback({
                        elementID: r,
                        properties: i,
                        emit: a
                      })),
                        (o = [].concat(Rb(o), Rb(t)));
                    }),
                    o
                  );
                }
              },
              {
                key: "createSubscriberEntry",
                value: function() {
                  return { handlers: [] };
                }
              },
              {
                key: "addSubscriberEntry",
                value: function(e, t) {
                  var n = e;
                  return (
                    n || (n = this.createSubscriberEntry()),
                    t && (n.handlers = [].concat(Rb(n.handlers), [t])),
                    n
                  );
                }
              },
              {
                key: "removeSubscriberEntry",
                value: function(e, t) {
                  return e.filter(function(e) {
                    return e.id !== t;
                  });
                }
              },
              {
                key: "addSubscriber",
                value: function(e) {
                  var t = e.notifyType,
                    n = e.elementType,
                    r = e.callback,
                    i = E()(),
                    a = { id: i, callback: r };
                  this.subscribers = this.addSubscriberEntry(
                    this.subscribers,
                    t ? null : a
                  );
                  var o = !t;
                  return (
                    o ||
                      ((this.subscribers[t] = this.addSubscriberEntry(
                        this.subscribers[t],
                        n ? null : a
                      )),
                      (o = !n)),
                    o ||
                      (this.subscribers[t][n] = this.addSubscriberEntry(
                        this.subscribers[t][n],
                        a
                      )),
                    i
                  );
                }
              },
              {
                key: "removeSubscriber",
                value: function(e) {
                  var t = e.notifyType,
                    n = e.elementType,
                    r = e.id,
                    i = !1;
                  t ||
                    (this.removeSubscriberEntry(this.subscribers, r), (i = !0)),
                    i ||
                      n ||
                      (this.removeSubscriberEntry(this.subscribers[t], r),
                      (i = !0)),
                    i || this.removeSubscriberEntry(this.subscribers[t][n], r);
                }
              }
            ]) && Pb(t.prototype, n),
            r && Pb(t, r),
            e
          );
        })();
        function Db(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Ob(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? Db(Object(n), !0).forEach(function(t) {
                  Cb(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : Db(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function Cb(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Lb(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var Nb = (function() {
          function e(t) {
            var n = t.viewer,
              i = t.onElementChanged,
              a = void 0 === i ? null : i;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.viewer = n),
              (this.assetManager = this.viewer.assetManager),
              (this.sceneController = new Ib({
                viewer: n,
                sceneManager: this,
                assetManager: this.viewer.assetManager,
                singles: [
                  "Scene",
                  "Grid",
                  "Axes",
                  "CameraControls",
                  "TransformControls",
                  "ObjectControls"
                ]
              })),
              (window.sceneController = this.sceneController),
              (this.currentCameraID = null),
              (this.currentCameraControlsID = null),
              (this.onElementChanged = a),
              (window.THREE = r);
          }
          var t, n, i;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function(e) {
                  var t = this,
                    n = e.bgType,
                    r = void 0 === n ? "Transparent" : n,
                    i = e.bgColor,
                    a = void 0 === i ? "#ffffff" : i;
                  return Promise.resolve(!0)
                    .then(function() {
                      return t.sceneController.init();
                    })
                    .then(function() {
                      return t.sceneController.createElement({ type: "Scene" });
                    })
                    .then(function(e) {
                      return e.element.setBackground({ type: r, color: a });
                    })
                    .then(function() {
                      return t.sceneController.createElement({
                        type: "Material",
                        name: "DefaultMaterial",
                        config: { materialType: "MeshStandardMaterial" }
                      });
                    })
                    .then(function(e) {
                      var n = e.element;
                      return (
                        t.sceneController.setProperties({
                          elementID: n.uuid,
                          properties: [
                            {
                              key: "color",
                              value: "#999999",
                              valueType: "color"
                            }
                          ]
                        }),
                        !0
                      );
                    })
                    .then(function() {
                      return t.sceneController.createElement({
                        type: "Camera",
                        name: "DefaultCamera",
                        config: {
                          cameraType: "PerspectiveCamera",
                          userData: {}
                        }
                      });
                    })
                    .then(function(e) {
                      var n = e.element;
                      return t.setCurrentCamera(n.uuid);
                    })
                    .then(function() {
                      return (
                        t.sceneController.addSubscriber({
                          notifyType: "propertyUpdated",
                          elementType: null,
                          callback: function(e) {
                            return t._onElementChanged(e);
                          }
                        }),
                        t.sceneController.addSubscriber({
                          notifyType: "propertyUpdated",
                          elementType: "Node",
                          callback: function(e) {
                            return t._onNodePropertiesChanged(e);
                          }
                        }),
                        !0
                      );
                    });
                }
              },
              {
                key: "update",
                value: function(e) {
                  this.sceneController.update(e);
                }
              },
              {
                key: "resize",
                value: function(e, t) {
                  this.camera &&
                    ((this.camera.aspect = e / t),
                    this.camera.updateProjectionMatrix());
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return (
                    !this.sceneController ||
                    this.sceneController.dispose().then(function() {
                      return (e.sceneController = null), !0;
                    })
                  );
                }
              },
              {
                key: "addElement",
                value: function(e) {
                  var t = e.type,
                    n = e.config,
                    r = void 0 === n ? {} : n;
                  return this.sceneController
                    .createElement({ type: t, config: r })
                    .then(function(e) {
                      var t = e.element;
                      return Promise.resolve({ elUuid: t.uuid });
                    });
                }
              },
              {
                key: "removeElement",
                value: function(e) {
                  var t = e.elUuid;
                  return (
                    this.sceneController.disposeElement({ elementID: t }),
                    Promise.resolve(!0)
                  );
                }
              },
              {
                key: "addMaterial",
                value: function(e) {
                  var t = e.name,
                    n = void 0 === t ? "" : t,
                    r = e.type,
                    i = e.materialIDs,
                    a = void 0 === i ? [] : i,
                    o = e.userData,
                    s = void 0 === o ? {} : o;
                  return this.addElement({
                    type: "Material",
                    name: n,
                    config: { materialType: r, materialIDs: a, userData: s }
                  });
                }
              },
              {
                key: "setMapForMaterial",
                value: function(e) {
                  var t = e.materialUuid,
                    n = e.textureUuid,
                    r = e.mapType,
                    i = this.getElement(t);
                  if (!i)
                    throw new Error(
                      "Material for uuid ".concat(t, " doesnt exist")
                    );
                  i.setMap(n, r);
                }
              },
              {
                key: "setMaterialForObject",
                value: function(e) {
                  var t = e.objUuid,
                    n = e.materialUuid,
                    r = this.getElement(t),
                    i = this.getElement(n);
                  r.setMaterial(i);
                }
              },
              {
                key: "getMaterialForObject",
                value: function(e) {
                  var t = this.getElement(e);
                  return t && "Node" === t.type && t.materialID
                    ? t.materialID
                    : null;
                }
              },
              {
                key: "setCurrentCamera",
                value: function(e) {
                  return (
                    (this.currentCameraID = e),
                    (this.viewer.renderer.composerNeedsReset = !0),
                    !0
                  );
                }
              },
              {
                key: "attachCameraControls",
                value: function(e) {
                  var t = this;
                  return this.addElement({
                    type: "CameraControls",
                    single: !0,
                    config: {
                      cameraID: e.cameraID,
                      container: this.viewer.container,
                      userData: e.userData,
                      onElementChanged: function(e) {
                        return t.onElementChanged(e);
                      }
                    }
                  }).then(function(e) {
                    var n = e.elUuid;
                    return (t.currentCameraControlsID = n), { elUuid: n };
                  });
                }
              },
              {
                key: "detachCameraControls",
                value: function(e) {
                  if (e) {
                    var t = this.getElement(e).cameraID;
                    return (
                      this.getElement(t).setControls(null),
                      e === this.currentCameraControlsID &&
                        (this.currentCameraControlsID = null),
                      this.removeElement({ elUuid: e })
                    );
                  }
                  return Promise.resolve(!0);
                }
              },
              {
                key: "setCameraControlsTargetCamera",
                value: function(e, t) {
                  var n = this.getElement(e);
                  if (!n)
                    throw new Error(
                      "Camera controls element ".concat(e, " doesn't exist")
                    );
                  if (!this.getElement(t))
                    throw new Error(
                      "Camera element ".concat(t, " doesn't exist")
                    );
                  n.setCamera(t);
                }
              },
              {
                key: "setCameraControlsTargetElement",
                value: function(e, t) {
                  this.getElement(e).setTargetElement(t);
                }
              },
              {
                key: "attachObjectControls",
                value: function(e) {
                  var t = this;
                  return this.sceneController.createElement({
                    type: "ObjectControls",
                    config: {
                      container: this.viewer.container,
                      cameraID: this.cameraID,
                      userData: Ob({}, e.userData),
                      onElementChanged: function(e) {
                        return t.onElementChanged(e);
                      }
                    }
                  });
                }
              },
              {
                key: "detachObjectControls",
                value: function() {
                  return (
                    this.objectControlsID &&
                      this.sceneController.disposeElement({
                        elementID: this.objectControlsID
                      }),
                    Promise.resolve(!0)
                  );
                }
              },
              {
                key: "setObjectControlsTargetElement",
                value: function(e) {
                  var t = this.sceneController.getSingleElement(
                    "ObjectControls"
                  );
                  t && t.setTargetElement(e);
                }
              },
              {
                key: "attachTransformControls",
                value: function(e) {
                  var t = this;
                  return this.sceneController.createElement({
                    type: "TransformControls",
                    config: {
                      container: this.viewer.container,
                      cameraID: this.cameraID,
                      userData: Ob({}, e.userData),
                      onElementChanged: function(e) {
                        return t.onElementChanged(e);
                      }
                    }
                  });
                }
              },
              {
                key: "detachTransformControls",
                value: function() {
                  var e = this.getSingleElementID("TransformControls");
                  return (
                    e && this.sceneController.disposeElement({ elementID: e }),
                    Promise.resolve(!0)
                  );
                }
              },
              {
                key: "attachObjectToTransform",
                value: function(e) {
                  var t = this.sceneController.getSingleElement(
                    "TransformControls"
                  );
                  t && t.attach(e);
                }
              },
              {
                key: "detachObjectFromTransform",
                value: function() {
                  var e = this.sceneController.getSingleElement(
                    "TransformControls"
                  );
                  e && e.detach();
                }
              },
              {
                key: "setProperties",
                value: function(e) {
                  var t = e.elementID,
                    n = e.properties,
                    r = e.notify,
                    i = void 0 === r || r;
                  return this.sceneController.setProperties({
                    elementID: t,
                    properties: n,
                    notify: i
                  });
                }
              },
              {
                key: "setElementActive",
                value: function(e, t) {
                  this.getElement(e).setActive(t),
                    document.dispatchEvent(new Event("pulseUpdate"));
                }
              },
              {
                key: "setParentElement",
                value: function(e) {
                  var t = e.elementID,
                    n = e.parentID;
                  this.sceneController.addElement({
                    elementID: t,
                    parentID: n
                  });
                }
              },
              {
                key: "setBackground",
                value: function(e) {
                  return (
                    this.sceneController
                      .getSingleElement("Scene")
                      .setBackground(e),
                    !0
                  );
                }
              },
              {
                key: "getObject",
                value: function(e) {
                  var t = this.sceneController.getObject(e);
                  if (!t) throw new Error("Unknown element ".concat(e));
                  return t;
                }
              },
              {
                key: "getElement",
                value: function(e) {
                  return this.sceneController.getElement(e);
                }
              },
              {
                key: "getSingleElementID",
                value: function(e) {
                  return this.sceneController.getElementIdsByType(e)[0] || null;
                }
              },
              {
                key: "getElementInfo",
                value: function(e) {
                  var t = this.sceneController.getElement(e);
                  if (!t) throw new Error("Unknown element ".concat(e));
                  return t.getInfo();
                }
              },
              {
                key: "getBoundingBox",
                value: function(e) {
                  var t = this.getObject(e);
                  return new Za().setFromObject(t);
                }
              },
              {
                key: "isElementActive",
                value: function(e) {
                  var t = this.getElement(e);
                  return t && t.isActive();
                }
              },
              {
                key: "updateElement",
                value: function(e) {
                  var t =
                    arguments.length > 1 &&
                    void 0 !== arguments[1] &&
                    arguments[1];
                  this.sceneController.updateElement(e, t);
                }
              },
              {
                key: "updateElements",
                value: function(e) {
                  var t =
                    arguments.length > 1 &&
                    void 0 !== arguments[1] &&
                    arguments[1];
                  this.sceneController.updateElements(e, t);
                }
              },
              {
                key: "testForMaterialTransparency",
                value: function(e) {
                  var t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : null,
                    n = this.getElement(e);
                  return !!n && n.testForMaterialTransparency(t);
                }
              },
              {
                key: "_onNodePropertiesChanged",
                value: function(e) {
                  var t = e.elementID,
                    n = e.properties,
                    r = e.emit,
                    i = this.getElement(this.currentCameraControlsID);
                  i &&
                    null !== i.targetID &&
                    i.targetID === t &&
                    n.forEach(function(e) {
                      "position" === e.key && i.setTargetFromPosition();
                    });
                  var a = { elementID: t, properties: n, emit: r };
                  return r && this.onElementChanged(a), [a];
                }
              },
              {
                key: "_onElementChanged",
                value: function(e) {
                  var t = { elementID: e.elementID, properties: e.properties };
                  return e.emit && this.onElementChanged(t), [t];
                }
              },
              {
                key: "scene",
                get: function() {
                  var e = this.sceneController.getSingleElement("Scene");
                  return e ? e.getObject() : null;
                }
              },
              {
                key: "camera",
                get: function() {
                  return this.cameraID
                    ? this.sceneController.getObject(this.cameraID)
                    : null;
                }
              },
              {
                key: "cameraID",
                get: function() {
                  return this.currentCameraID;
                }
              },
              {
                key: "cameraControlsID",
                get: function() {
                  return this.currentCameraControlsID;
                }
              },
              {
                key: "transformControlsID",
                get: function() {
                  return this.getSingleElementID("TransformControls");
                }
              },
              {
                key: "objectControlsID",
                get: function() {
                  return this.getSingleElementID("ObjectControls");
                }
              },
              {
                key: "defaultMaterial",
                get: function() {
                  return this.sceneController
                    .getElementByName("DefaultMaterial")
                    .getObject();
                }
              }
            ]) && Lb(t.prototype, n),
            i && Lb(t, i),
            e
          );
        })();
        function Fb(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var kb = (function() {
            function e(t) {
              var n = t.container,
                r = t.sceneManager,
                i = t.clickTimeout,
                a = void 0 === i ? 250 : i,
                o = t.touchTimeout,
                s = void 0 === o ? 250 : o,
                l = t.hoverPeriod,
                c = void 0 === l ? 50 : l,
                u = t.clickDelta,
                h = void 0 === u ? 3 : u,
                d = t.touchDelta,
                p = void 0 === d ? 5 : d,
                f = t.onMouseDown,
                m = void 0 === f ? null : f,
                v = t.onMouseUp,
                g = void 0 === v ? null : v,
                y = t.onMouseMove,
                b = void 0 === y ? null : y,
                x = t.onMouseEnter,
                w = void 0 === x ? null : x,
                _ = t.onMouseLeave,
                M = void 0 === _ ? null : _,
                T = t.onMouseClick,
                A = void 0 === T ? null : T;
              !(function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, e),
                (this.sceneManager = r),
                (this.container = n),
                (this.hoverEnabled = !0),
                (this.onMouseDown = m),
                (this.onMouseUp = g),
                (this.onMouseMove = b),
                (this.onMouseEnter = w),
                (this.onMouseLeave = M),
                (this.onMouseClick = A),
                this.reset(),
                this.updateConfig({
                  clickTimeout: a,
                  touchTimeout: s,
                  hoverPeriod: c,
                  clickDelta: h,
                  touchDelta: p
                });
            }
            var t, n, r;
            return (
              (t = e),
              (n = [
                {
                  key: "reset",
                  value: function() {
                    (this.raycaster = new Of()),
                      (this.mousePos = new Zi()),
                      (this.mouseDown = !1),
                      (this.mouseDownX = null),
                      (this.mouseDownY = null),
                      (this.mouseUpX = null),
                      (this.mouseUpY = null),
                      (this.touchDown = !1),
                      (this.touchStartX = null),
                      (this.touchStartY = null),
                      (this.touchEndX = null),
                      (this.touchEndY = null),
                      this._bindEventListeners();
                  }
                },
                {
                  key: "_bindEventListeners",
                  value: function() {
                    (this.onContainerTouchStart = this.onContainerTouchStart.bind(
                      this
                    )),
                      (this.onContainerTouchEnd = this.onContainerTouchEnd.bind(
                        this
                      )),
                      (this.onContainerMouseDown = this.onContainerMouseDown.bind(
                        this
                      )),
                      (this.onContainerMouseUp = this.onContainerMouseUp.bind(
                        this
                      )),
                      (this.onContainerMouseMove = this.onContainerMouseMove.bind(
                        this
                      )),
                      (this.onContainerMouseEnter = this.onContainerMouseEnter.bind(
                        this
                      )),
                      (this.onContainerMouseLeave = this.onContainerMouseLeave.bind(
                        this
                      )),
                      this.container.addEventListener(
                        "touchstart",
                        this.onContainerTouchStart,
                        !1
                      ),
                      this.container.addEventListener(
                        "touchend",
                        this.onContainerTouchEnd,
                        !1
                      ),
                      this.container.addEventListener(
                        "mousedown",
                        this.onContainerMouseDown,
                        !1
                      ),
                      this.container.addEventListener(
                        "mouseup",
                        this.onContainerMouseUp,
                        !1
                      ),
                      this.container.addEventListener(
                        "mousemove",
                        this.onContainerMouseMove,
                        !1
                      ),
                      this.container.addEventListener(
                        "mouseenter",
                        this.onContainerMouseEnter,
                        !1
                      ),
                      this.container.addEventListener(
                        "mouseleave",
                        this.onContainerMouseLeave,
                        !1
                      );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    var e = this;
                    return Promise.resolve(!0).then(function() {
                      return (
                        e._unbindEventListeners(), (e.raycaster = null), !0
                      );
                    });
                  }
                },
                {
                  key: "_unbindEventListeners",
                  value: function() {
                    this.container.removeEventListener(
                      "touchstart",
                      this.onContainerTouchStart,
                      !1
                    ),
                      this.container.removeEventListener(
                        "touchend",
                        this.onContainerTouchEnd,
                        !1
                      ),
                      this.container.removeEventListener(
                        "mousedown",
                        this.onContainerMouseDown,
                        !1
                      ),
                      this.container.removeEventListener(
                        "mouseup",
                        this.onContainerMouseUp,
                        !1
                      ),
                      this.container.removeEventListener(
                        "mousemove",
                        this.onContainerMouseMove,
                        !1
                      ),
                      this.container.removeEventListener(
                        "mouseenter",
                        this.onContainerMouseEnter,
                        !1
                      ),
                      this.container.removeEventListener(
                        "mouseleave",
                        this.onContainerMouseLeave,
                        !1
                      );
                  }
                },
                {
                  key: "onContainerMouseMove",
                  value: function(e) {
                    var t = this;
                    if (this.hoverEnabled && !this.mouseDown) {
                      var n = this._findIntersected(e.clientX, e.clientY);
                      this.onMouseMove &&
                        this.onMouseMove({ event: e, intersects: n });
                    }
                    this.hoverEnabled &&
                      ((this.hoverEnabled = !1),
                      setTimeout(function() {
                        t.hoverEnabled = !0;
                      }, this.hoverPeriod));
                  }
                },
                {
                  key: "onContainerMouseDown",
                  value: function(e) {
                    var t = this;
                    (this.mouseDown = !0),
                      (this.mouseDownX = e.clientX),
                      (this.mouseDownY = e.clientY);
                    var n = this._findIntersected(e.clientX, e.clientY);
                    this.onMouseDown &&
                      this.onMouseDown({ event: e, intersects: n }),
                      setTimeout(function() {
                        !t.mouseDown &&
                          Math.abs(t.mouseDownX - t.mouseUpX) <= t.clickDelta &&
                          Math.abs(t.mouseDownY - t.mouseUpY) <= t.clickDelta &&
                          t.onMouseClick &&
                          t.onMouseClick({
                            event: e,
                            button: e.button,
                            shiftKey: e.shiftKey,
                            intersects: n
                          });
                      }, this.clickTimeout);
                  }
                },
                {
                  key: "onContainerMouseUp",
                  value: function(e) {
                    (this.mouseDown = !1),
                      (this.mouseUpX = e.clientX),
                      (this.mouseUpY = e.clientY);
                    var t = this._findIntersected(e.clientX, e.clientY);
                    this.onMouseUp &&
                      this.onMouseUp({ event: e, intersects: t }),
                      this.onMouseMove &&
                        this.onMouseMove({ event: e, intersects: t });
                  }
                },
                {
                  key: "onContainerMouseEnter",
                  value: function(e) {
                    this.onMouseEnter && this.onMouseEnter({ event: e });
                  }
                },
                {
                  key: "onContainerMouseLeave",
                  value: function(e) {
                    this.onMouseLeave && this.onMouseLeave({ event: e }),
                      this.onMouseMove &&
                        this.onMouseMove({ event: e, intersects: [] });
                  }
                },
                {
                  key: "onContainerTouchStart",
                  value: function(e) {
                    var t = this;
                    e.preventDefault(),
                      (this.touchDown = !0),
                      (this.touchStartX = e.changedTouches[0].clientX),
                      (this.touchStartY = e.changedTouches[0].clientY);
                    var n = this._findIntersected(
                      e.changedTouches[0].clientX,
                      e.changedTouches[0].clientY
                    );
                    this.onMouseDown &&
                      this.onMouseDown({ event: e, intersects: n }),
                      setTimeout(function() {
                        !t.touchDown &&
                          Math.abs(t.touchStartX - t.touchEndX) <=
                            t.touchDelta &&
                          Math.abs(t.touchStartY - t.touchEndY) <=
                            t.touchDelta &&
                          t.onMouseClick &&
                          t.onMouseClick({
                            event: e,
                            button: 0,
                            shiftKey: e.shiftKey,
                            intersects: n
                          });
                      }, this.touchTimeout);
                  }
                },
                {
                  key: "updateConfig",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : {};
                    Object.keys(t).forEach(function(n) {
                      switch (n) {
                        case "clickTimeout":
                        case "touchTimeout":
                        case "hoverPeriod":
                        case "clickDelta":
                        case "touchDelta":
                          e[n] = t[n];
                      }
                    });
                  }
                },
                {
                  key: "onContainerTouchEnd",
                  value: function(e) {
                    e.preventDefault(),
                      (this.touchDown = !1),
                      (this.touchEndX = e.changedTouches[0].clientX),
                      (this.touchEndY = e.changedTouches[0].clientY);
                    var t = this._findIntersected(
                      e.changedTouches[0].clientX,
                      e.changedTouches[0].clientY
                    );
                    this.onMouseUp &&
                      this.onMouseUp({ event: e, intersects: t });
                  }
                },
                {
                  key: "_findIntersected",
                  value: function(e, t) {
                    var n = this.sceneManager,
                      r = n.scene,
                      i = n.camera;
                    if (!r || !i) return [];
                    var a = this.container.getBoundingClientRect();
                    return (
                      (this.mousePos.x =
                        ((e - a.left) / this.container.clientWidth) * 2 - 1),
                      (this.mousePos.y =
                        (-(t - a.top) / this.container.clientHeight) * 2 + 1),
                      this.raycaster.setFromCamera(this.mousePos, i),
                      this.raycaster.intersectObjects(r.children, !0)
                    );
                  }
                }
              ]) && Fb(t.prototype, n),
              r && Fb(t, r),
              e
            );
          })(),
          Ub = n(21),
          jb = n.n(Ub),
          Bb = {
            uniforms: { tDiffuse: { value: null }, opacity: { value: 1 } },
            vertexShader: [
              "varying vec2 vUv;",
              "void main() {",
              "\tvUv = uv;",
              "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
              "}"
            ].join("\n"),
            fragmentShader: [
              "uniform float opacity;",
              "uniform sampler2D tDiffuse;",
              "varying vec2 vUv;",
              "void main() {",
              "\tvec4 texel = texture2D( tDiffuse, vUv );",
              "\tgl_FragColor = opacity * texel;",
              "}"
            ].join("\n")
          };
        function zb() {
          (this.enabled = !0),
            (this.needsSwap = !0),
            (this.clear = !1),
            (this.renderToScreen = !1);
        }
        Object.assign(zb.prototype, {
          setSize: function() {},
          render: function() {}
        }),
          (zb.FullScreenQuad = (function() {
            var e = new Sp(-1, 1, 1, -1, 0, 1),
              t = new Zs(2, 2),
              n = function(e) {
                this._mesh = new ys(t, e);
              };
            return (
              Object.defineProperty(n.prototype, "material", {
                get: function() {
                  return this._mesh.material;
                },
                set: function(e) {
                  this._mesh.material = e;
                }
              }),
              Object.assign(n.prototype, {
                render: function(t) {
                  t.render(this._mesh, e);
                }
              }),
              n
            );
          })());
        var Vb = function(e, t) {
          zb.call(this),
            (this.textureID = void 0 !== t ? t : "tDiffuse"),
            e instanceof Cs
              ? ((this.uniforms = e.uniforms), (this.material = e))
              : e &&
                ((this.uniforms = Is.clone(e.uniforms)),
                (this.material = new Cs({
                  defines: Object.assign({}, e.defines),
                  uniforms: this.uniforms,
                  vertexShader: e.vertexShader,
                  fragmentShader: e.fragmentShader
                }))),
            (this.fsQuad = new zb.FullScreenQuad(this.material));
        };
        Vb.prototype = Object.assign(Object.create(zb.prototype), {
          constructor: Vb,
          render: function(e, t, n) {
            this.uniforms[this.textureID] &&
              (this.uniforms[this.textureID].value = n.texture),
              (this.fsQuad.material = this.material),
              this.renderToScreen
                ? (e.setRenderTarget(null), this.fsQuad.render(e))
                : (e.setRenderTarget(t),
                  this.clear &&
                    e.clear(
                      e.autoClearColor,
                      e.autoClearDepth,
                      e.autoClearStencil
                    ),
                  this.fsQuad.render(e));
          }
        });
        var Gb = function(e, t) {
          zb.call(this),
            (this.scene = e),
            (this.camera = t),
            (this.clear = !0),
            (this.needsSwap = !1),
            (this.inverse = !1);
        };
        Gb.prototype = Object.assign(Object.create(zb.prototype), {
          constructor: Gb,
          render: function(e, t, n) {
            var r,
              i,
              a = e.getContext(),
              o = e.state;
            o.buffers.color.setMask(!1),
              o.buffers.depth.setMask(!1),
              o.buffers.color.setLocked(!0),
              o.buffers.depth.setLocked(!0),
              this.inverse ? ((r = 0), (i = 1)) : ((r = 1), (i = 0)),
              o.buffers.stencil.setTest(!0),
              o.buffers.stencil.setOp(a.REPLACE, a.REPLACE, a.REPLACE),
              o.buffers.stencil.setFunc(a.ALWAYS, r, 4294967295),
              o.buffers.stencil.setClear(i),
              o.buffers.stencil.setLocked(!0),
              e.setRenderTarget(n),
              this.clear && e.clear(),
              e.render(this.scene, this.camera),
              e.setRenderTarget(t),
              this.clear && e.clear(),
              e.render(this.scene, this.camera),
              o.buffers.color.setLocked(!1),
              o.buffers.depth.setLocked(!1),
              o.buffers.stencil.setLocked(!1),
              o.buffers.stencil.setFunc(a.EQUAL, 1, 4294967295),
              o.buffers.stencil.setOp(a.KEEP, a.KEEP, a.KEEP),
              o.buffers.stencil.setLocked(!0);
          }
        });
        var Hb = function() {
          zb.call(this), (this.needsSwap = !1);
        };
        (Hb.prototype = Object.create(zb.prototype)),
          Object.assign(Hb.prototype, {
            render: function(e) {
              e.state.buffers.stencil.setLocked(!1),
                e.state.buffers.stencil.setTest(!1);
            }
          });
        var Xb = function(e, t) {
          if (((this.renderer = e), void 0 === t)) {
            var n = {
                minFilter: nr,
                magFilter: nr,
                format: wr,
                stencilBuffer: !1
              },
              r = e.getSize(new Zi());
            (this._pixelRatio = e.getPixelRatio()),
              (this._width = r.width),
              (this._height = r.height),
              ((t = new la(
                this._width * this._pixelRatio,
                this._height * this._pixelRatio,
                n
              )).texture.name = "EffectComposer.rt1");
          } else
            (this._pixelRatio = 1),
              (this._width = t.width),
              (this._height = t.height);
          (this.renderTarget1 = t),
            (this.renderTarget2 = t.clone()),
            (this.renderTarget2.texture.name = "EffectComposer.rt2"),
            (this.writeBuffer = this.renderTarget1),
            (this.readBuffer = this.renderTarget2),
            (this.renderToScreen = !0),
            (this.passes = []),
            (this.copyPass = new Vb(Bb)),
            (this.clock = new nf());
        };
        Object.assign(Xb.prototype, {
          swapBuffers: function() {
            var e = this.readBuffer;
            (this.readBuffer = this.writeBuffer), (this.writeBuffer = e);
          },
          addPass: function(e) {
            this.passes.push(e),
              e.setSize(
                this._width * this._pixelRatio,
                this._height * this._pixelRatio
              );
          },
          insertPass: function(e, t) {
            this.passes.splice(t, 0, e);
          },
          isLastEnabledPass: function(e) {
            for (var t = e + 1; t < this.passes.length; t++)
              if (this.passes[t].enabled) return !1;
            return !0;
          },
          render: function(e) {
            void 0 === e && (e = this.clock.getDelta());
            var t,
              n,
              r = this.renderer.getRenderTarget(),
              i = !1,
              a = this.passes.length;
            for (n = 0; n < a; n++)
              if (!1 !== (t = this.passes[n]).enabled) {
                if (
                  ((t.renderToScreen =
                    this.renderToScreen && this.isLastEnabledPass(n)),
                  t.render(
                    this.renderer,
                    this.writeBuffer,
                    this.readBuffer,
                    e,
                    i
                  ),
                  t.needsSwap)
                ) {
                  if (i) {
                    var o = this.renderer.getContext(),
                      s = this.renderer.state.buffers.stencil;
                    s.setFunc(o.NOTEQUAL, 1, 4294967295),
                      this.copyPass.render(
                        this.renderer,
                        this.writeBuffer,
                        this.readBuffer,
                        e
                      ),
                      s.setFunc(o.EQUAL, 1, 4294967295);
                  }
                  this.swapBuffers();
                }
                void 0 !== Gb &&
                  (t instanceof Gb ? (i = !0) : t instanceof Hb && (i = !1));
              }
            this.renderer.setRenderTarget(r);
          },
          reset: function(e) {
            if (void 0 === e) {
              var t = this.renderer.getSize(new Zi());
              (this._pixelRatio = this.renderer.getPixelRatio()),
                (this._width = t.width),
                (this._height = t.height),
                (e = this.renderTarget1.clone()).setSize(
                  this._width * this._pixelRatio,
                  this._height * this._pixelRatio
                );
            }
            this.renderTarget1.dispose(),
              this.renderTarget2.dispose(),
              (this.renderTarget1 = e),
              (this.renderTarget2 = e.clone()),
              (this.writeBuffer = this.renderTarget1),
              (this.readBuffer = this.renderTarget2);
          },
          setSize: function(e, t) {
            (this._width = e), (this._height = t);
            var n = this._width * this._pixelRatio,
              r = this._height * this._pixelRatio;
            this.renderTarget1.setSize(n, r), this.renderTarget2.setSize(n, r);
            for (var i = 0; i < this.passes.length; i++)
              this.passes[i].setSize(n, r);
          },
          setPixelRatio: function(e) {
            (this._pixelRatio = e), this.setSize(this._width, this._height);
          }
        });
        var Wb = function() {
          (this.enabled = !0),
            (this.needsSwap = !0),
            (this.clear = !1),
            (this.renderToScreen = !1);
        };
        Object.assign(Wb.prototype, {
          setSize: function() {},
          render: function() {}
        }),
          (Wb.FullScreenQuad = (function() {
            var e = new Sp(-1, 1, 1, -1, 0, 1),
              t = new Zs(2, 2),
              n = function(e) {
                this._mesh = new ys(t, e);
              };
            return (
              Object.defineProperty(n.prototype, "material", {
                get: function() {
                  return this._mesh.material;
                },
                set: function(e) {
                  this._mesh.material = e;
                }
              }),
              Object.assign(n.prototype, {
                render: function(t) {
                  t.render(this._mesh, e);
                }
              }),
              n
            );
          })());
        var Yb = function(e, t, n, r, i) {
          zb.call(this),
            (this.scene = e),
            (this.camera = t),
            (this.overrideMaterial = n),
            (this.clearColor = r),
            (this.clearAlpha = void 0 !== i ? i : 0),
            (this.clear = !0),
            (this.clearDepth = !1),
            (this.needsSwap = !1);
        };
        Yb.prototype = Object.assign(Object.create(zb.prototype), {
          constructor: Yb,
          render: function(e, t, n) {
            var r,
              i,
              a = e.autoClear;
            (e.autoClear = !1),
              (this.scene.overrideMaterial = this.overrideMaterial),
              this.clearColor &&
                ((r = e.getClearColor().getHex()),
                (i = e.getClearAlpha()),
                e.setClearColor(this.clearColor, this.clearAlpha)),
              this.clearDepth && e.clearDepth(),
              e.setRenderTarget(this.renderToScreen ? null : n),
              this.clear &&
                e.clear(e.autoClearColor, e.autoClearDepth, e.autoClearStencil),
              e.render(this.scene, this.camera),
              this.clearColor && e.setClearColor(r, i),
              (this.scene.overrideMaterial = null),
              (e.autoClear = a);
          }
        });
        var qb = {
            uniforms: {
              tDiffuse: { value: null },
              resolution: { value: new Zi(1 / 1024, 1 / 512) }
            },
            vertexShader: [
              "varying vec2 vUv;",
              "void main() {",
              "\tvUv = uv;",
              "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
              "}"
            ].join("\n"),
            fragmentShader: [
              "precision highp float;",
              "",
              "uniform sampler2D tDiffuse;",
              "",
              "uniform vec2 resolution;",
              "",
              "varying vec2 vUv;",
              "",
              "// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)",
              "",
              "//----------------------------------------------------------------------------------",
              "// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag",
              "// SDK Version: v3.00",
              "// Email:       gameworks@nvidia.com",
              "// Site:        http://developer.nvidia.com/",
              "//",
              "// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.",
              "//",
              "// Redistribution and use in source and binary forms, with or without",
              "// modification, are permitted provided that the following conditions",
              "// are met:",
              "//  * Redistributions of source code must retain the above copyright",
              "//    notice, this list of conditions and the following disclaimer.",
              "//  * Redistributions in binary form must reproduce the above copyright",
              "//    notice, this list of conditions and the following disclaimer in the",
              "//    documentation and/or other materials provided with the distribution.",
              "//  * Neither the name of NVIDIA CORPORATION nor the names of its",
              "//    contributors may be used to endorse or promote products derived",
              "//    from this software without specific prior written permission.",
              "//",
              "// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY",
              "// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE",
              "// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR",
              "// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR",
              "// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,",
              "// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,",
              "// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR",
              "// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY",
              "// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT",
              "// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE",
              "// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",
              "//",
              "//----------------------------------------------------------------------------------",
              "",
              "#define FXAA_PC 1",
              "#define FXAA_GLSL_100 1",
              "#define FXAA_QUALITY_PRESET 12",
              "",
              "#define FXAA_GREEN_AS_LUMA 1",
              "",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_PC_CONSOLE",
              "    //",
              "    // The console algorithm for PC is included",
              "    // for developers targeting really low spec machines.",
              "    // Likely better to just run FXAA_PC, and use a really low preset.",
              "    //",
              "    #define FXAA_PC_CONSOLE 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_GLSL_120",
              "    #define FXAA_GLSL_120 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_GLSL_130",
              "    #define FXAA_GLSL_130 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_HLSL_3",
              "    #define FXAA_HLSL_3 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_HLSL_4",
              "    #define FXAA_HLSL_4 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_HLSL_5",
              "    #define FXAA_HLSL_5 0",
              "#endif",
              "/*==========================================================================*/",
              "#ifndef FXAA_GREEN_AS_LUMA",
              "    //",
              "    // For those using non-linear color,",
              "    // and either not able to get luma in alpha, or not wanting to,",
              "    // this enables FXAA to run using green as a proxy for luma.",
              "    // So with this enabled, no need to pack luma in alpha.",
              "    //",
              "    // This will turn off AA on anything which lacks some amount of green.",
              "    // Pure red and blue or combination of only R and B, will get no AA.",
              "    //",
              "    // Might want to lower the settings for both,",
              "    //    fxaaConsoleEdgeThresholdMin",
              "    //    fxaaQualityEdgeThresholdMin",
              "    // In order to insure AA does not get turned off on colors",
              "    // which contain a minor amount of green.",
              "    //",
              "    // 1 = On.",
              "    // 0 = Off.",
              "    //",
              "    #define FXAA_GREEN_AS_LUMA 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_EARLY_EXIT",
              "    //",
              "    // Controls algorithm's early exit path.",
              "    // On PS3 turning this ON adds 2 cycles to the shader.",
              "    // On 360 turning this OFF adds 10ths of a millisecond to the shader.",
              "    // Turning this off on console will result in a more blurry image.",
              "    // So this defaults to on.",
              "    //",
              "    // 1 = On.",
              "    // 0 = Off.",
              "    //",
              "    #define FXAA_EARLY_EXIT 1",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_DISCARD",
              "    //",
              "    // Only valid for PC OpenGL currently.",
              "    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.",
              "    //",
              "    // 1 = Use discard on pixels which don't need AA.",
              "    //     For APIs which enable concurrent TEX+ROP from same surface.",
              "    // 0 = Return unchanged color on pixels which don't need AA.",
              "    //",
              "    #define FXAA_DISCARD 0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_FAST_PIXEL_OFFSET",
              "    //",
              "    // Used for GLSL 120 only.",
              "    //",
              "    // 1 = GL API supports fast pixel offsets",
              "    // 0 = do not use fast pixel offsets",
              "    //",
              "    #ifdef GL_EXT_gpu_shader4",
              "        #define FXAA_FAST_PIXEL_OFFSET 1",
              "    #endif",
              "    #ifdef GL_NV_gpu_shader5",
              "        #define FXAA_FAST_PIXEL_OFFSET 1",
              "    #endif",
              "    #ifdef GL_ARB_gpu_shader5",
              "        #define FXAA_FAST_PIXEL_OFFSET 1",
              "    #endif",
              "    #ifndef FXAA_FAST_PIXEL_OFFSET",
              "        #define FXAA_FAST_PIXEL_OFFSET 0",
              "    #endif",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#ifndef FXAA_GATHER4_ALPHA",
              "    //",
              "    // 1 = API supports gather4 on alpha channel.",
              "    // 0 = API does not support gather4 on alpha channel.",
              "    //",
              "    #if (FXAA_HLSL_5 == 1)",
              "        #define FXAA_GATHER4_ALPHA 1",
              "    #endif",
              "    #ifdef GL_ARB_gpu_shader5",
              "        #define FXAA_GATHER4_ALPHA 1",
              "    #endif",
              "    #ifdef GL_NV_gpu_shader5",
              "        #define FXAA_GATHER4_ALPHA 1",
              "    #endif",
              "    #ifndef FXAA_GATHER4_ALPHA",
              "        #define FXAA_GATHER4_ALPHA 0",
              "    #endif",
              "#endif",
              "",
              "",
              "/*============================================================================",
              "                        FXAA QUALITY - TUNING KNOBS",
              "------------------------------------------------------------------------------",
              "NOTE the other tuning knobs are now in the shader function inputs!",
              "============================================================================*/",
              "#ifndef FXAA_QUALITY_PRESET",
              "    //",
              "    // Choose the quality preset.",
              "    // This needs to be compiled into the shader as it effects code.",
              "    // Best option to include multiple presets is to",
              "    // in each shader define the preset, then include this file.",
              "    //",
              "    // OPTIONS",
              "    // -----------------------------------------------------------------------",
              "    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)",
              "    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)",
              "    // 39       - no dither, very expensive",
              "    //",
              "    // NOTES",
              "    // -----------------------------------------------------------------------",
              "    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)",
              "    // 13 = about same speed as FXAA 3.9 and better than 12",
              "    // 23 = closest to FXAA 3.9 visually and performance wise",
              "    //  _ = the lowest digit is directly related to performance",
              "    // _  = the highest digit is directly related to style",
              "    //",
              "    #define FXAA_QUALITY_PRESET 12",
              "#endif",
              "",
              "",
              "/*============================================================================",
              "",
              "                           FXAA QUALITY - PRESETS",
              "",
              "============================================================================*/",
              "",
              "/*============================================================================",
              "                     FXAA QUALITY - MEDIUM DITHER PRESETS",
              "============================================================================*/",
              "#if (FXAA_QUALITY_PRESET == 10)",
              "    #define FXAA_QUALITY_PS 3",
              "    #define FXAA_QUALITY_P0 1.5",
              "    #define FXAA_QUALITY_P1 3.0",
              "    #define FXAA_QUALITY_P2 12.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 11)",
              "    #define FXAA_QUALITY_PS 4",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 3.0",
              "    #define FXAA_QUALITY_P3 12.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 12)",
              "    #define FXAA_QUALITY_PS 5",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 4.0",
              "    #define FXAA_QUALITY_P4 12.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 13)",
              "    #define FXAA_QUALITY_PS 6",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 4.0",
              "    #define FXAA_QUALITY_P5 12.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 14)",
              "    #define FXAA_QUALITY_PS 7",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 4.0",
              "    #define FXAA_QUALITY_P6 12.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 15)",
              "    #define FXAA_QUALITY_PS 8",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 4.0",
              "    #define FXAA_QUALITY_P7 12.0",
              "#endif",
              "",
              "/*============================================================================",
              "                     FXAA QUALITY - LOW DITHER PRESETS",
              "============================================================================*/",
              "#if (FXAA_QUALITY_PRESET == 20)",
              "    #define FXAA_QUALITY_PS 3",
              "    #define FXAA_QUALITY_P0 1.5",
              "    #define FXAA_QUALITY_P1 2.0",
              "    #define FXAA_QUALITY_P2 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 21)",
              "    #define FXAA_QUALITY_PS 4",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 22)",
              "    #define FXAA_QUALITY_PS 5",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 23)",
              "    #define FXAA_QUALITY_PS 6",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 24)",
              "    #define FXAA_QUALITY_PS 7",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 3.0",
              "    #define FXAA_QUALITY_P6 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 25)",
              "    #define FXAA_QUALITY_PS 8",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 4.0",
              "    #define FXAA_QUALITY_P7 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 26)",
              "    #define FXAA_QUALITY_PS 9",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 2.0",
              "    #define FXAA_QUALITY_P7 4.0",
              "    #define FXAA_QUALITY_P8 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 27)",
              "    #define FXAA_QUALITY_PS 10",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 2.0",
              "    #define FXAA_QUALITY_P7 2.0",
              "    #define FXAA_QUALITY_P8 4.0",
              "    #define FXAA_QUALITY_P9 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 28)",
              "    #define FXAA_QUALITY_PS 11",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 2.0",
              "    #define FXAA_QUALITY_P7 2.0",
              "    #define FXAA_QUALITY_P8 2.0",
              "    #define FXAA_QUALITY_P9 4.0",
              "    #define FXAA_QUALITY_P10 8.0",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_QUALITY_PRESET == 29)",
              "    #define FXAA_QUALITY_PS 12",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.5",
              "    #define FXAA_QUALITY_P2 2.0",
              "    #define FXAA_QUALITY_P3 2.0",
              "    #define FXAA_QUALITY_P4 2.0",
              "    #define FXAA_QUALITY_P5 2.0",
              "    #define FXAA_QUALITY_P6 2.0",
              "    #define FXAA_QUALITY_P7 2.0",
              "    #define FXAA_QUALITY_P8 2.0",
              "    #define FXAA_QUALITY_P9 2.0",
              "    #define FXAA_QUALITY_P10 4.0",
              "    #define FXAA_QUALITY_P11 8.0",
              "#endif",
              "",
              "/*============================================================================",
              "                     FXAA QUALITY - EXTREME QUALITY",
              "============================================================================*/",
              "#if (FXAA_QUALITY_PRESET == 39)",
              "    #define FXAA_QUALITY_PS 12",
              "    #define FXAA_QUALITY_P0 1.0",
              "    #define FXAA_QUALITY_P1 1.0",
              "    #define FXAA_QUALITY_P2 1.0",
              "    #define FXAA_QUALITY_P3 1.0",
              "    #define FXAA_QUALITY_P4 1.0",
              "    #define FXAA_QUALITY_P5 1.5",
              "    #define FXAA_QUALITY_P6 2.0",
              "    #define FXAA_QUALITY_P7 2.0",
              "    #define FXAA_QUALITY_P8 2.0",
              "    #define FXAA_QUALITY_P9 2.0",
              "    #define FXAA_QUALITY_P10 4.0",
              "    #define FXAA_QUALITY_P11 8.0",
              "#endif",
              "",
              "",
              "",
              "/*============================================================================",
              "",
              "                                API PORTING",
              "",
              "============================================================================*/",
              "#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)",
              "    #define FxaaBool bool",
              "    #define FxaaDiscard discard",
              "    #define FxaaFloat float",
              "    #define FxaaFloat2 vec2",
              "    #define FxaaFloat3 vec3",
              "    #define FxaaFloat4 vec4",
              "    #define FxaaHalf float",
              "    #define FxaaHalf2 vec2",
              "    #define FxaaHalf3 vec3",
              "    #define FxaaHalf4 vec4",
              "    #define FxaaInt2 ivec2",
              "    #define FxaaSat(x) clamp(x, 0.0, 1.0)",
              "    #define FxaaTex sampler2D",
              "#else",
              "    #define FxaaBool bool",
              "    #define FxaaDiscard clip(-1)",
              "    #define FxaaFloat float",
              "    #define FxaaFloat2 float2",
              "    #define FxaaFloat3 float3",
              "    #define FxaaFloat4 float4",
              "    #define FxaaHalf half",
              "    #define FxaaHalf2 half2",
              "    #define FxaaHalf3 half3",
              "    #define FxaaHalf4 half4",
              "    #define FxaaSat(x) saturate(x)",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_GLSL_100 == 1)",
              "  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)",
              "  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_GLSL_120 == 1)",
              "    // Requires,",
              "    //  #version 120",
              "    // And at least,",
              "    //  #extension GL_EXT_gpu_shader4 : enable",
              "    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)",
              "    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)",
              "    #if (FXAA_FAST_PIXEL_OFFSET == 1)",
              "        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)",
              "    #else",
              "        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)",
              "    #endif",
              "    #if (FXAA_GATHER4_ALPHA == 1)",
              "        // use #extension GL_ARB_gpu_shader5 : enable",
              "        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)",
              "        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)",
              "        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)",
              "        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)",
              "    #endif",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_GLSL_130 == 1)",
              '    // Requires "#version 130" or better',
              "    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)",
              "    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)",
              "    #if (FXAA_GATHER4_ALPHA == 1)",
              "        // use #extension GL_ARB_gpu_shader5 : enable",
              "        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)",
              "        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)",
              "        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)",
              "        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)",
              "    #endif",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_HLSL_3 == 1)",
              "    #define FxaaInt2 float2",
              "    #define FxaaTex sampler2D",
              "    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))",
              "    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_HLSL_4 == 1)",
              "    #define FxaaInt2 int2",
              "    struct FxaaTex { SamplerState smpl; Texture2D tex; };",
              "    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)",
              "    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)",
              "#endif",
              "/*--------------------------------------------------------------------------*/",
              "#if (FXAA_HLSL_5 == 1)",
              "    #define FxaaInt2 int2",
              "    struct FxaaTex { SamplerState smpl; Texture2D tex; };",
              "    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)",
              "    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)",
              "    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)",
              "    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)",
              "    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)",
              "    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)",
              "#endif",
              "",
              "",
              "/*============================================================================",
              "                   GREEN AS LUMA OPTION SUPPORT FUNCTION",
              "============================================================================*/",
              "#if (FXAA_GREEN_AS_LUMA == 0)",
              "    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }",
              "#else",
              "    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }",
              "#endif",
              "",
              "",
              "",
              "",
              "/*============================================================================",
              "",
              "                             FXAA3 QUALITY - PC",
              "",
              "============================================================================*/",
              "#if (FXAA_PC == 1)",
              "/*--------------------------------------------------------------------------*/",
              "FxaaFloat4 FxaaPixelShader(",
              "    //",
              "    // Use noperspective interpolation here (turn off perspective interpolation).",
              "    // {xy} = center of pixel",
              "    FxaaFloat2 pos,",
              "    //",
              "    // Used only for FXAA Console, and not used on the 360 version.",
              "    // Use noperspective interpolation here (turn off perspective interpolation).",
              "    // {xy_} = upper left of pixel",
              "    // {_zw} = lower right of pixel",
              "    FxaaFloat4 fxaaConsolePosPos,",
              "    //",
              "    // Input color texture.",
              "    // {rgb_} = color in linear or perceptual color space",
              "    // if (FXAA_GREEN_AS_LUMA == 0)",
              "    //     {__a} = luma in perceptual color space (not linear)",
              "    FxaaTex tex,",
              "    //",
              "    // Only used on the optimized 360 version of FXAA Console.",
              '    // For everything but 360, just use the same input here as for "tex".',
              "    // For 360, same texture, just alias with a 2nd sampler.",
              "    // This sampler needs to have an exponent bias of -1.",
              "    FxaaTex fxaaConsole360TexExpBiasNegOne,",
              "    //",
              "    // Only used on the optimized 360 version of FXAA Console.",
              '    // For everything but 360, just use the same input here as for "tex".',
              "    // For 360, same texture, just alias with a 3nd sampler.",
              "    // This sampler needs to have an exponent bias of -2.",
              "    FxaaTex fxaaConsole360TexExpBiasNegTwo,",
              "    //",
              "    // Only used on FXAA Quality.",
              "    // This must be from a constant/uniform.",
              "    // {x_} = 1.0/screenWidthInPixels",
              "    // {_y} = 1.0/screenHeightInPixels",
              "    FxaaFloat2 fxaaQualityRcpFrame,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // This must be from a constant/uniform.",
              "    // This effects sub-pixel AA quality and inversely sharpness.",
              "    //   Where N ranges between,",
              "    //     N = 0.50 (default)",
              "    //     N = 0.33 (sharper)",
              "    // {x__} = -N/screenWidthInPixels",
              "    // {_y_} = -N/screenHeightInPixels",
              "    // {_z_} =  N/screenWidthInPixels",
              "    // {__w} =  N/screenHeightInPixels",
              "    FxaaFloat4 fxaaConsoleRcpFrameOpt,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // Not used on 360, but used on PS3 and PC.",
              "    // This must be from a constant/uniform.",
              "    // {x__} = -2.0/screenWidthInPixels",
              "    // {_y_} = -2.0/screenHeightInPixels",
              "    // {_z_} =  2.0/screenWidthInPixels",
              "    // {__w} =  2.0/screenHeightInPixels",
              "    FxaaFloat4 fxaaConsoleRcpFrameOpt2,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.",
              "    // This must be from a constant/uniform.",
              "    // {x__} =  8.0/screenWidthInPixels",
              "    // {_y_} =  8.0/screenHeightInPixels",
              "    // {_z_} = -4.0/screenWidthInPixels",
              "    // {__w} = -4.0/screenHeightInPixels",
              "    FxaaFloat4 fxaaConsole360RcpFrameOpt2,",
              "    //",
              "    // Only used on FXAA Quality.",
              "    // This used to be the FXAA_QUALITY_SUBPIX define.",
              "    // It is here now to allow easier tuning.",
              "    // Choose the amount of sub-pixel aliasing removal.",
              "    // This can effect sharpness.",
              "    //   1.00 - upper limit (softer)",
              "    //   0.75 - default amount of filtering",
              "    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)",
              "    //   0.25 - almost off",
              "    //   0.00 - completely off",
              "    FxaaFloat fxaaQualitySubpix,",
              "    //",
              "    // Only used on FXAA Quality.",
              "    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.",
              "    // It is here now to allow easier tuning.",
              "    // The minimum amount of local contrast required to apply algorithm.",
              "    //   0.333 - too little (faster)",
              "    //   0.250 - low quality",
              "    //   0.166 - default",
              "    //   0.125 - high quality",
              "    //   0.063 - overkill (slower)",
              "    FxaaFloat fxaaQualityEdgeThreshold,",
              "    //",
              "    // Only used on FXAA Quality.",
              "    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.",
              "    // It is here now to allow easier tuning.",
              "    // Trims the algorithm from processing darks.",
              "    //   0.0833 - upper limit (default, the start of visible unfiltered edges)",
              "    //   0.0625 - high quality (faster)",
              "    //   0.0312 - visible limit (slower)",
              "    // Special notes when using FXAA_GREEN_AS_LUMA,",
              "    //   Likely want to set this to zero.",
              "    //   As colors that are mostly not-green",
              "    //   will appear very dark in the green channel!",
              "    //   Tune by looking at mostly non-green content,",
              "    //   then start at zero and increase until aliasing is a problem.",
              "    FxaaFloat fxaaQualityEdgeThresholdMin,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.",
              "    // It is here now to allow easier tuning.",
              "    // This does not effect PS3, as this needs to be compiled in.",
              "    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.",
              "    //   Due to the PS3 being ALU bound,",
              "    //   there are only three safe values here: 2 and 4 and 8.",
              "    //   These options use the shaders ability to a free *|/ by 2|4|8.",
              "    // For all other platforms can be a non-power of two.",
              "    //   8.0 is sharper (default!!!)",
              "    //   4.0 is softer",
              "    //   2.0 is really soft (good only for vector graphics inputs)",
              "    FxaaFloat fxaaConsoleEdgeSharpness,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.",
              "    // It is here now to allow easier tuning.",
              "    // This does not effect PS3, as this needs to be compiled in.",
              "    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.",
              "    //   Due to the PS3 being ALU bound,",
              "    //   there are only two safe values here: 1/4 and 1/8.",
              "    //   These options use the shaders ability to a free *|/ by 2|4|8.",
              "    // The console setting has a different mapping than the quality setting.",
              "    // Other platforms can use other values.",
              "    //   0.125 leaves less aliasing, but is softer (default!!!)",
              "    //   0.25 leaves more aliasing, and is sharper",
              "    FxaaFloat fxaaConsoleEdgeThreshold,",
              "    //",
              "    // Only used on FXAA Console.",
              "    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.",
              "    // It is here now to allow easier tuning.",
              "    // Trims the algorithm from processing darks.",
              "    // The console setting has a different mapping than the quality setting.",
              "    // This only applies when FXAA_EARLY_EXIT is 1.",
              "    // This does not apply to PS3,",
              "    // PS3 was simplified to avoid more shader instructions.",
              "    //   0.06 - faster but more aliasing in darks",
              "    //   0.05 - default",
              "    //   0.04 - slower and less aliasing in darks",
              "    // Special notes when using FXAA_GREEN_AS_LUMA,",
              "    //   Likely want to set this to zero.",
              "    //   As colors that are mostly not-green",
              "    //   will appear very dark in the green channel!",
              "    //   Tune by looking at mostly non-green content,",
              "    //   then start at zero and increase until aliasing is a problem.",
              "    FxaaFloat fxaaConsoleEdgeThresholdMin,",
              "    //",
              "    // Extra constants for 360 FXAA Console only.",
              "    // Use zeros or anything else for other platforms.",
              "    // These must be in physical constant registers and NOT immediates.",
              "    // Immediates will result in compiler un-optimizing.",
              "    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)",
              "    FxaaFloat4 fxaaConsole360ConstDir",
              ") {",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat2 posM;",
              "    posM.x = pos.x;",
              "    posM.y = pos.y;",
              "    #if (FXAA_GATHER4_ALPHA == 1)",
              "        #if (FXAA_DISCARD == 0)",
              "            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);",
              "            #if (FXAA_GREEN_AS_LUMA == 0)",
              "                #define lumaM rgbyM.w",
              "            #else",
              "                #define lumaM rgbyM.y",
              "            #endif",
              "        #endif",
              "        #if (FXAA_GREEN_AS_LUMA == 0)",
              "            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);",
              "            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));",
              "        #else",
              "            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);",
              "            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));",
              "        #endif",
              "        #if (FXAA_DISCARD == 1)",
              "            #define lumaM luma4A.w",
              "        #endif",
              "        #define lumaE luma4A.z",
              "        #define lumaS luma4A.x",
              "        #define lumaSE luma4A.y",
              "        #define lumaNW luma4B.w",
              "        #define lumaN luma4B.z",
              "        #define lumaW luma4B.x",
              "    #else",
              "        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);",
              "        #if (FXAA_GREEN_AS_LUMA == 0)",
              "            #define lumaM rgbyM.w",
              "        #else",
              "            #define lumaM rgbyM.y",
              "        #endif",
              "        #if (FXAA_GLSL_100 == 1)",
              "          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));",
              "        #else",
              "          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));",
              "        #endif",
              "    #endif",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat maxSM = max(lumaS, lumaM);",
              "    FxaaFloat minSM = min(lumaS, lumaM);",
              "    FxaaFloat maxESM = max(lumaE, maxSM);",
              "    FxaaFloat minESM = min(lumaE, minSM);",
              "    FxaaFloat maxWN = max(lumaN, lumaW);",
              "    FxaaFloat minWN = min(lumaN, lumaW);",
              "    FxaaFloat rangeMax = max(maxWN, maxESM);",
              "    FxaaFloat rangeMin = min(minWN, minESM);",
              "    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;",
              "    FxaaFloat range = rangeMax - rangeMin;",
              "    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);",
              "    FxaaBool earlyExit = range < rangeMaxClamped;",
              "/*--------------------------------------------------------------------------*/",
              "    if(earlyExit)",
              "        #if (FXAA_DISCARD == 1)",
              "            FxaaDiscard;",
              "        #else",
              "            return rgbyM;",
              "        #endif",
              "/*--------------------------------------------------------------------------*/",
              "    #if (FXAA_GATHER4_ALPHA == 0)",
              "        #if (FXAA_GLSL_100 == 1)",
              "          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));",
              "        #else",
              "          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));",
              "          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));",
              "        #endif",
              "    #else",
              "        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));",
              "        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));",
              "    #endif",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat lumaNS = lumaN + lumaS;",
              "    FxaaFloat lumaWE = lumaW + lumaE;",
              "    FxaaFloat subpixRcpRange = 1.0/range;",
              "    FxaaFloat subpixNSWE = lumaNS + lumaWE;",
              "    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;",
              "    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat lumaNESE = lumaNE + lumaSE;",
              "    FxaaFloat lumaNWNE = lumaNW + lumaNE;",
              "    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;",
              "    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat lumaNWSW = lumaNW + lumaSW;",
              "    FxaaFloat lumaSWSE = lumaSW + lumaSE;",
              "    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);",
              "    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);",
              "    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;",
              "    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;",
              "    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;",
              "    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;",
              "    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;",
              "    FxaaBool horzSpan = edgeHorz >= edgeVert;",
              "    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;",
              "/*--------------------------------------------------------------------------*/",
              "    if(!horzSpan) lumaN = lumaW;",
              "    if(!horzSpan) lumaS = lumaE;",
              "    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;",
              "    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat gradientN = lumaN - lumaM;",
              "    FxaaFloat gradientS = lumaS - lumaM;",
              "    FxaaFloat lumaNN = lumaN + lumaM;",
              "    FxaaFloat lumaSS = lumaS + lumaM;",
              "    FxaaBool pairN = abs(gradientN) >= abs(gradientS);",
              "    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));",
              "    if(pairN) lengthSign = -lengthSign;",
              "    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat2 posB;",
              "    posB.x = posM.x;",
              "    posB.y = posM.y;",
              "    FxaaFloat2 offNP;",
              "    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;",
              "    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;",
              "    if(!horzSpan) posB.x += lengthSign * 0.5;",
              "    if( horzSpan) posB.y += lengthSign * 0.5;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat2 posN;",
              "    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;",
              "    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;",
              "    FxaaFloat2 posP;",
              "    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;",
              "    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;",
              "    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;",
              "    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));",
              "    FxaaFloat subpixE = subpixC * subpixC;",
              "    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));",
              "/*--------------------------------------------------------------------------*/",
              "    if(!pairN) lumaNN = lumaSS;",
              "    FxaaFloat gradientScaled = gradient * 1.0/4.0;",
              "    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;",
              "    FxaaFloat subpixF = subpixD * subpixE;",
              "    FxaaBool lumaMLTZero = lumaMM < 0.0;",
              "/*--------------------------------------------------------------------------*/",
              "    lumaEndN -= lumaNN * 0.5;",
              "    lumaEndP -= lumaNN * 0.5;",
              "    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;",
              "    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;",
              "    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;",
              "    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;",
              "    FxaaBool doneNP = (!doneN) || (!doneP);",
              "    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;",
              "    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;",
              "/*--------------------------------------------------------------------------*/",
              "    if(doneNP) {",
              "        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "        doneN = abs(lumaEndN) >= gradientScaled;",
              "        doneP = abs(lumaEndP) >= gradientScaled;",
              "        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;",
              "        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;",
              "        doneNP = (!doneN) || (!doneP);",
              "        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;",
              "        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;",
              "/*--------------------------------------------------------------------------*/",
              "        #if (FXAA_QUALITY_PS > 3)",
              "        if(doneNP) {",
              "            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "            doneN = abs(lumaEndN) >= gradientScaled;",
              "            doneP = abs(lumaEndP) >= gradientScaled;",
              "            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;",
              "            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;",
              "            doneNP = (!doneN) || (!doneP);",
              "            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;",
              "            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;",
              "/*--------------------------------------------------------------------------*/",
              "            #if (FXAA_QUALITY_PS > 4)",
              "            if(doneNP) {",
              "                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                doneN = abs(lumaEndN) >= gradientScaled;",
              "                doneP = abs(lumaEndP) >= gradientScaled;",
              "                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;",
              "                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;",
              "                doneNP = (!doneN) || (!doneP);",
              "                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;",
              "                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;",
              "/*--------------------------------------------------------------------------*/",
              "                #if (FXAA_QUALITY_PS > 5)",
              "                if(doneNP) {",
              "                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                    doneN = abs(lumaEndN) >= gradientScaled;",
              "                    doneP = abs(lumaEndP) >= gradientScaled;",
              "                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;",
              "                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;",
              "                    doneNP = (!doneN) || (!doneP);",
              "                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;",
              "                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;",
              "/*--------------------------------------------------------------------------*/",
              "                    #if (FXAA_QUALITY_PS > 6)",
              "                    if(doneNP) {",
              "                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                        doneN = abs(lumaEndN) >= gradientScaled;",
              "                        doneP = abs(lumaEndP) >= gradientScaled;",
              "                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;",
              "                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;",
              "                        doneNP = (!doneN) || (!doneP);",
              "                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;",
              "                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;",
              "/*--------------------------------------------------------------------------*/",
              "                        #if (FXAA_QUALITY_PS > 7)",
              "                        if(doneNP) {",
              "                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                            doneN = abs(lumaEndN) >= gradientScaled;",
              "                            doneP = abs(lumaEndP) >= gradientScaled;",
              "                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;",
              "                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;",
              "                            doneNP = (!doneN) || (!doneP);",
              "                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;",
              "                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;",
              "/*--------------------------------------------------------------------------*/",
              "    #if (FXAA_QUALITY_PS > 8)",
              "    if(doneNP) {",
              "        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "        doneN = abs(lumaEndN) >= gradientScaled;",
              "        doneP = abs(lumaEndP) >= gradientScaled;",
              "        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;",
              "        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;",
              "        doneNP = (!doneN) || (!doneP);",
              "        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;",
              "        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;",
              "/*--------------------------------------------------------------------------*/",
              "        #if (FXAA_QUALITY_PS > 9)",
              "        if(doneNP) {",
              "            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "            doneN = abs(lumaEndN) >= gradientScaled;",
              "            doneP = abs(lumaEndP) >= gradientScaled;",
              "            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;",
              "            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;",
              "            doneNP = (!doneN) || (!doneP);",
              "            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;",
              "            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;",
              "/*--------------------------------------------------------------------------*/",
              "            #if (FXAA_QUALITY_PS > 10)",
              "            if(doneNP) {",
              "                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                doneN = abs(lumaEndN) >= gradientScaled;",
              "                doneP = abs(lumaEndP) >= gradientScaled;",
              "                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;",
              "                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;",
              "                doneNP = (!doneN) || (!doneP);",
              "                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;",
              "                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;",
              "/*--------------------------------------------------------------------------*/",
              "                #if (FXAA_QUALITY_PS > 11)",
              "                if(doneNP) {",
              "                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                    doneN = abs(lumaEndN) >= gradientScaled;",
              "                    doneP = abs(lumaEndP) >= gradientScaled;",
              "                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;",
              "                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;",
              "                    doneNP = (!doneN) || (!doneP);",
              "                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;",
              "                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;",
              "/*--------------------------------------------------------------------------*/",
              "                    #if (FXAA_QUALITY_PS > 12)",
              "                    if(doneNP) {",
              "                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
              "                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
              "                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
              "                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
              "                        doneN = abs(lumaEndN) >= gradientScaled;",
              "                        doneP = abs(lumaEndP) >= gradientScaled;",
              "                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;",
              "                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;",
              "                        doneNP = (!doneN) || (!doneP);",
              "                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;",
              "                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;",
              "/*--------------------------------------------------------------------------*/",
              "                    }",
              "                    #endif",
              "/*--------------------------------------------------------------------------*/",
              "                }",
              "                #endif",
              "/*--------------------------------------------------------------------------*/",
              "            }",
              "            #endif",
              "/*--------------------------------------------------------------------------*/",
              "        }",
              "        #endif",
              "/*--------------------------------------------------------------------------*/",
              "    }",
              "    #endif",
              "/*--------------------------------------------------------------------------*/",
              "                        }",
              "                        #endif",
              "/*--------------------------------------------------------------------------*/",
              "                    }",
              "                    #endif",
              "/*--------------------------------------------------------------------------*/",
              "                }",
              "                #endif",
              "/*--------------------------------------------------------------------------*/",
              "            }",
              "            #endif",
              "/*--------------------------------------------------------------------------*/",
              "        }",
              "        #endif",
              "/*--------------------------------------------------------------------------*/",
              "    }",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat dstN = posM.x - posN.x;",
              "    FxaaFloat dstP = posP.x - posM.x;",
              "    if(!horzSpan) dstN = posM.y - posN.y;",
              "    if(!horzSpan) dstP = posP.y - posM.y;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;",
              "    FxaaFloat spanLength = (dstP + dstN);",
              "    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;",
              "    FxaaFloat spanLengthRcp = 1.0/spanLength;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaBool directionN = dstN < dstP;",
              "    FxaaFloat dst = min(dstN, dstP);",
              "    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;",
              "    FxaaFloat subpixG = subpixF * subpixF;",
              "    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;",
              "    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;",
              "/*--------------------------------------------------------------------------*/",
              "    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;",
              "    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);",
              "    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;",
              "    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;",
              "    #if (FXAA_DISCARD == 1)",
              "        return FxaaTexTop(tex, posM);",
              "    #else",
              "        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);",
              "    #endif",
              "}",
              "/*==========================================================================*/",
              "#endif",
              "",
              "void main() {",
              "  gl_FragColor = FxaaPixelShader(",
              "    vUv,",
              "    vec4(0.0),",
              "    tDiffuse,",
              "    tDiffuse,",
              "    tDiffuse,",
              "    resolution,",
              "    vec4(0.0),",
              "    vec4(0.0),",
              "    vec4(0.0),",
              "    0.75,",
              "    0.166,",
              "    0.0833,",
              "    0.0,",
              "    0.0,",
              "    0.0,",
              "    vec4(0.0)",
              "  );",
              "",
              "  // TODO avoid querying texture twice for same texel",
              "  gl_FragColor.a = texture2D(tDiffuse, vUv).a;",
              "}"
            ].join("\n")
          },
          Qb = {
            defines: { SMAA_THRESHOLD: "0.1" },
            uniforms: {
              tDiffuse: { value: null },
              resolution: { value: new Zi(1 / 1024, 1 / 512) }
            },
            vertexShader: [
              "uniform vec2 resolution;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[ 3 ];",
              "void SMAAEdgeDetectionVS( vec2 texcoord ) {",
              "\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );",
              "\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );",
              "\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );",
              "}",
              "void main() {",
              "\tvUv = uv;",
              "\tSMAAEdgeDetectionVS( vUv );",
              "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
              "}"
            ].join("\n"),
            fragmentShader: [
              "uniform sampler2D tDiffuse;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[ 3 ];",
              "vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {",
              "\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );",
              "\tvec4 delta;",
              "\tvec3 C = texture2D( colorTex, texcoord ).rgb;",
              "\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;",
              "\tvec3 t = abs( C - Cleft );",
              "\tdelta.x = max( max( t.r, t.g ), t.b );",
              "\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;",
              "\tt = abs( C - Ctop );",
              "\tdelta.y = max( max( t.r, t.g ), t.b );",
              "\tvec2 edges = step( threshold, delta.xy );",
              "\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )",
              "\t\tdiscard;",
              "\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;",
              "\tt = abs( C - Cright );",
              "\tdelta.z = max( max( t.r, t.g ), t.b );",
              "\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;",
              "\tt = abs( C - Cbottom );",
              "\tdelta.w = max( max( t.r, t.g ), t.b );",
              "\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );",
              "\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;",
              "\tt = abs( C - Cleftleft );",
              "\tdelta.z = max( max( t.r, t.g ), t.b );",
              "\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;",
              "\tt = abs( C - Ctoptop );",
              "\tdelta.w = max( max( t.r, t.g ), t.b );",
              "\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );",
              "\tedges.xy *= step( 0.5 * maxDelta, delta.xy );",
              "\treturn vec4( edges, 0.0, 0.0 );",
              "}",
              "void main() {",
              "\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );",
              "}"
            ].join("\n")
          },
          Zb = {
            defines: {
              SMAA_MAX_SEARCH_STEPS: "8",
              SMAA_AREATEX_MAX_DISTANCE: "16",
              SMAA_AREATEX_PIXEL_SIZE: "( 1.0 / vec2( 160.0, 560.0 ) )",
              SMAA_AREATEX_SUBTEX_SIZE: "( 1.0 / 7.0 )"
            },
            uniforms: {
              tDiffuse: { value: null },
              tArea: { value: null },
              tSearch: { value: null },
              resolution: { value: new Zi(1 / 1024, 1 / 512) }
            },
            vertexShader: [
              "uniform vec2 resolution;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[ 3 ];",
              "varying vec2 vPixcoord;",
              "void SMAABlendingWeightCalculationVS( vec2 texcoord ) {",
              "\tvPixcoord = texcoord / resolution;",
              "\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );",
              "\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );",
              "\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );",
              "}",
              "void main() {",
              "\tvUv = uv;",
              "\tSMAABlendingWeightCalculationVS( vUv );",
              "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
              "}"
            ].join("\n"),
            fragmentShader: [
              "#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )",
              "uniform sampler2D tDiffuse;",
              "uniform sampler2D tArea;",
              "uniform sampler2D tSearch;",
              "uniform vec2 resolution;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[3];",
              "varying vec2 vPixcoord;",
              "#if __VERSION__ == 100",
              "vec2 round( vec2 x ) {",
              "\treturn sign( x ) * floor( abs( x ) + 0.5 );",
              "}",
              "#endif",
              "float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {",
              "\te.r = bias + e.r * scale;",
              "\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;",
              "}",
              "float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {",
              "\tvec2 e = vec2( 0.0, 1.0 );",
              "\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {",
              "\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;",
              "\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;",
              "\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;",
              "\t}",
              "\ttexcoord.x += 0.25 * resolution.x;",
              "\ttexcoord.x += resolution.x;",
              "\ttexcoord.x += 2.0 * resolution.x;",
              "\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);",
              "\treturn texcoord.x;",
              "}",
              "float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {",
              "\tvec2 e = vec2( 0.0, 1.0 );",
              "\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {",
              "\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;",
              "\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;",
              "\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;",
              "\t}",
              "\ttexcoord.x -= 0.25 * resolution.x;",
              "\ttexcoord.x -= resolution.x;",
              "\ttexcoord.x -= 2.0 * resolution.x;",
              "\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );",
              "\treturn texcoord.x;",
              "}",
              "float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {",
              "\tvec2 e = vec2( 1.0, 0.0 );",
              "\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {",
              "\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;",
              "\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution;",
              "\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;",
              "\t}",
              "\ttexcoord.y -= 0.25 * resolution.y;",
              "\ttexcoord.y -= resolution.y;",
              "\ttexcoord.y -= 2.0 * resolution.y;",
              "\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );",
              "\treturn texcoord.y;",
              "}",
              "float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {",
              "\tvec2 e = vec2( 1.0, 0.0 );",
              "\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {",
              "\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;",
              "\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;",
              "\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;",
              "\t}",
              "\ttexcoord.y += 0.25 * resolution.y;",
              "\ttexcoord.y += resolution.y;",
              "\ttexcoord.y += 2.0 * resolution.y;",
              "\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );",
              "\treturn texcoord.y;",
              "}",
              "vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {",
              "\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;",
              "\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );",
              "\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;",
              "\treturn texture2D( areaTex, texcoord, 0.0 ).rg;",
              "}",
              "vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {",
              "\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );",
              "\tvec2 e = texture2D( edgesTex, texcoord ).rg;",
              "\tif ( e.g > 0.0 ) {",
              "\t\tvec2 d;",
              "\t\tvec2 coords;",
              "\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );",
              "\t\tcoords.y = offset[ 1 ].y;",
              "\t\td.x = coords.x;",
              "\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;",
              "\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );",
              "\t\td.y = coords.x;",
              "\t\td = d / resolution.x - pixcoord.x;",
              "\t\tvec2 sqrt_d = sqrt( abs( d ) );",
              "\t\tcoords.y -= 1.0 * resolution.y;",
              "\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;",
              "\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );",
              "\t}",
              "\tif ( e.r > 0.0 ) {",
              "\t\tvec2 d;",
              "\t\tvec2 coords;",
              "\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );",
              "\t\tcoords.x = offset[ 0 ].x;",
              "\t\td.x = coords.y;",
              "\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;",
              "\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );",
              "\t\td.y = coords.y;",
              "\t\td = d / resolution.y - pixcoord.y;",
              "\t\tvec2 sqrt_d = sqrt( abs( d ) );",
              "\t\tcoords.y -= 1.0 * resolution.y;",
              "\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;",
              "\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );",
              "\t}",
              "\treturn weights;",
              "}",
              "void main() {",
              "\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );",
              "}"
            ].join("\n")
          },
          Jb = {
            uniforms: {
              tDiffuse: { value: null },
              tColor: { value: null },
              resolution: { value: new Zi(1 / 1024, 1 / 512) }
            },
            vertexShader: [
              "uniform vec2 resolution;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[ 2 ];",
              "void SMAANeighborhoodBlendingVS( vec2 texcoord ) {",
              "\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );",
              "\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );",
              "}",
              "void main() {",
              "\tvUv = uv;",
              "\tSMAANeighborhoodBlendingVS( vUv );",
              "\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
              "}"
            ].join("\n"),
            fragmentShader: [
              "uniform sampler2D tDiffuse;",
              "uniform sampler2D tColor;",
              "uniform vec2 resolution;",
              "varying vec2 vUv;",
              "varying vec4 vOffset[ 2 ];",
              "vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {",
              "\tvec4 a;",
              "\ta.xz = texture2D( blendTex, texcoord ).xz;",
              "\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;",
              "\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;",
              "\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {",
              "\t\treturn texture2D( colorTex, texcoord, 0.0 );",
              "\t} else {",
              "\t\tvec2 offset;",
              "\t\toffset.x = a.a > a.b ? a.a : -a.b;",
              "\t\toffset.y = a.g > a.r ? -a.g : a.r;",
              "\t\tif ( abs( offset.x ) > abs( offset.y )) {",
              "\t\t\toffset.y = 0.0;",
              "\t\t} else {",
              "\t\t\toffset.x = 0.0;",
              "\t\t}",
              "\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );",
              "\t\ttexcoord += sign( offset ) * resolution;",
              "\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );",
              "\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );",
              "\t\tC.xyz = pow(C.xyz, vec3(2.2));",
              "\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));",
              "\t\tvec4 mixed = mix(C, Cop, s);",
              "\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));",
              "\t\treturn mixed;",
              "\t}",
              "}",
              "void main() {",
              "\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );",
              "}"
            ].join("\n")
          },
          Kb = function(e, t) {
            zb.call(this),
              (this.edgesRT = new la(e, t, {
                depthBuffer: !1,
                stencilBuffer: !1,
                generateMipmaps: !1,
                minFilter: nr,
                format: xr
              })),
              (this.edgesRT.texture.name = "SMAAPass.edges"),
              (this.weightsRT = new la(e, t, {
                depthBuffer: !1,
                stencilBuffer: !1,
                generateMipmaps: !1,
                minFilter: nr,
                format: wr
              })),
              (this.weightsRT.texture.name = "SMAAPass.weights");
            var n = this,
              r = new Image();
            (r.src = this.getAreaTexture()),
              (r.onload = function() {
                n.areaTexture.needsUpdate = !0;
              }),
              (this.areaTexture = new oa()),
              (this.areaTexture.name = "SMAAPass.area"),
              (this.areaTexture.image = r),
              (this.areaTexture.format = xr),
              (this.areaTexture.minFilter = nr),
              (this.areaTexture.generateMipmaps = !1),
              (this.areaTexture.flipY = !1);
            var i = new Image();
            (i.src = this.getSearchTexture()),
              (i.onload = function() {
                n.searchTexture.needsUpdate = !0;
              }),
              (this.searchTexture = new oa()),
              (this.searchTexture.name = "SMAAPass.search"),
              (this.searchTexture.image = i),
              (this.searchTexture.magFilter = Jn),
              (this.searchTexture.minFilter = Jn),
              (this.searchTexture.generateMipmaps = !1),
              (this.searchTexture.flipY = !1),
              (this.uniformsEdges = Is.clone(Qb.uniforms)),
              this.uniformsEdges.resolution.value.set(1 / e, 1 / t),
              (this.materialEdges = new Cs({
                defines: Object.assign({}, Qb.defines),
                uniforms: this.uniformsEdges,
                vertexShader: Qb.vertexShader,
                fragmentShader: Qb.fragmentShader
              })),
              (this.uniformsWeights = Is.clone(Zb.uniforms)),
              this.uniformsWeights.resolution.value.set(1 / e, 1 / t),
              (this.uniformsWeights.tDiffuse.value = this.edgesRT.texture),
              (this.uniformsWeights.tArea.value = this.areaTexture),
              (this.uniformsWeights.tSearch.value = this.searchTexture),
              (this.materialWeights = new Cs({
                defines: Object.assign({}, Zb.defines),
                uniforms: this.uniformsWeights,
                vertexShader: Zb.vertexShader,
                fragmentShader: Zb.fragmentShader
              })),
              (this.uniformsBlend = Is.clone(Jb.uniforms)),
              this.uniformsBlend.resolution.value.set(1 / e, 1 / t),
              (this.uniformsBlend.tDiffuse.value = this.weightsRT.texture),
              (this.materialBlend = new Cs({
                uniforms: this.uniformsBlend,
                vertexShader: Jb.vertexShader,
                fragmentShader: Jb.fragmentShader
              })),
              (this.needsSwap = !1),
              (this.fsQuad = new zb.FullScreenQuad(null));
          };
        Kb.prototype = Object.assign(Object.create(zb.prototype), {
          constructor: Kb,
          render: function(e, t, n) {
            (this.uniformsEdges.tDiffuse.value = n.texture),
              (this.fsQuad.material = this.materialEdges),
              e.setRenderTarget(this.edgesRT),
              this.clear && e.clear(),
              this.fsQuad.render(e),
              (this.fsQuad.material = this.materialWeights),
              e.setRenderTarget(this.weightsRT),
              this.clear && e.clear(),
              this.fsQuad.render(e),
              (this.uniformsBlend.tColor.value = n.texture),
              (this.fsQuad.material = this.materialBlend),
              this.renderToScreen
                ? (e.setRenderTarget(null), this.fsQuad.render(e))
                : (e.setRenderTarget(t),
                  this.clear && e.clear(),
                  this.fsQuad.render(e));
          },
          setSize: function(e, t) {
            this.edgesRT.setSize(e, t),
              this.weightsRT.setSize(e, t),
              this.materialEdges.uniforms.resolution.value.set(1 / e, 1 / t),
              this.materialWeights.uniforms.resolution.value.set(1 / e, 1 / t),
              this.materialBlend.uniforms.resolution.value.set(1 / e, 1 / t);
          },
          getAreaTexture: function() {
            return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII=";
          },
          getSearchTexture: function() {
            return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII=";
          }
        });
        var $b = function(e, t, n, r) {
          zb.call(this),
            (this.scene = e),
            (this.camera = t),
            (this.sampleLevel = 4),
            (this.unbiased = !0),
            (this.clearColor = void 0 !== n ? n : 0),
            (this.clearAlpha = void 0 !== r ? r : 0);
          var i = Bb;
          (this.copyUniforms = Is.clone(i.uniforms)),
            (this.copyMaterial = new Cs({
              uniforms: this.copyUniforms,
              vertexShader: i.vertexShader,
              fragmentShader: i.fragmentShader,
              premultipliedAlpha: !0,
              transparent: !0,
              blending: nn,
              depthTest: !1,
              depthWrite: !1
            })),
            (this.fsQuad = new zb.FullScreenQuad(this.copyMaterial));
        };
        function ex(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        ($b.prototype = Object.assign(Object.create(zb.prototype), {
          constructor: $b,
          dispose: function() {
            this.sampleRenderTarget &&
              (this.sampleRenderTarget.dispose(),
              (this.sampleRenderTarget = null));
          },
          setSize: function(e, t) {
            this.sampleRenderTarget && this.sampleRenderTarget.setSize(e, t);
          },
          render: function(e, t, n) {
            this.sampleRenderTarget ||
              ((this.sampleRenderTarget = new la(n.width, n.height, {
                minFilter: nr,
                magFilter: nr,
                format: wr
              })),
              (this.sampleRenderTarget.texture.name = "SSAARenderPass.sample"));
            var r =
                $b.JitterVectors[Math.max(0, Math.min(this.sampleLevel, 5))],
              i = e.autoClear;
            e.autoClear = !1;
            var a = e.getClearColor().getHex(),
              o = e.getClearAlpha(),
              s = 1 / r.length;
            this.copyUniforms.tDiffuse.value = this.sampleRenderTarget.texture;
            for (var l = n.width, c = n.height, u = 0; u < r.length; u++) {
              var h = r[u];
              this.camera.setViewOffset &&
                this.camera.setViewOffset(
                  l,
                  c,
                  0.0625 * h[0],
                  0.0625 * h[1],
                  l,
                  c
                );
              var d = s;
              this.unbiased && (d += (1 / 32) * ((u + 0.5) / r.length - 0.5)),
                (this.copyUniforms.opacity.value = d),
                e.setClearColor(this.clearColor, this.clearAlpha),
                e.setRenderTarget(this.sampleRenderTarget),
                e.clear(),
                e.render(this.scene, this.camera),
                e.setRenderTarget(this.renderToScreen ? null : t),
                0 === u && (e.setClearColor(0, 0), e.clear()),
                this.fsQuad.render(e);
            }
            this.camera.clearViewOffset && this.camera.clearViewOffset(),
              (e.autoClear = i),
              e.setClearColor(a, o);
          }
        })),
          ($b.JitterVectors = [
            [[0, 0]],
            [
              [4, 4],
              [-4, -4]
            ],
            [
              [-2, -6],
              [6, -2],
              [-6, 2],
              [2, 6]
            ],
            [
              [1, -3],
              [-1, 3],
              [5, 1],
              [-3, -5],
              [-5, 5],
              [-7, -1],
              [3, 7],
              [7, -7]
            ],
            [
              [1, 1],
              [-1, -3],
              [-3, 2],
              [4, -1],
              [-5, -2],
              [2, 5],
              [5, 3],
              [3, -5],
              [-2, 6],
              [0, -7],
              [-4, -6],
              [-6, 4],
              [-8, 0],
              [7, -4],
              [6, 7],
              [-7, -8]
            ],
            [
              [-4, -7],
              [-7, -5],
              [-3, -5],
              [-5, -4],
              [-1, -4],
              [-2, -2],
              [-6, -1],
              [-4, 0],
              [-7, 1],
              [-1, 2],
              [-6, 3],
              [-3, 3],
              [-7, 6],
              [-3, 6],
              [-5, 7],
              [-1, 7],
              [5, -7],
              [1, -6],
              [6, -5],
              [4, -4],
              [2, -3],
              [7, -2],
              [1, -1],
              [4, -1],
              [2, 1],
              [6, 2],
              [0, 4],
              [4, 4],
              [2, 5],
              [7, 5],
              [5, 6],
              [3, 7]
            ]
          ]);
        var tx = (function() {
            function e(t) {
              var n = t.viewer,
                r = t.onRenderStateChanged,
                i = void 0 === r ? null : r;
              !(function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, e),
                (this.viewer = n),
                (this.onRenderStateChanged = i),
                (this.dprCoef = 1),
                (this.renderer = null),
                (this.composer = null),
                (this.clock = new nf()),
                (this.raf = -1),
                (this.onPreUpdate = null),
                (this.onPostUpdate = null),
                (this.pulseEnabled = !0),
                (this.pulseUpdateDelta = 0),
                (this.snapshot = null);
            }
            var t, n, i;
            return (
              (t = e),
              (n = [
                {
                  key: "reset",
                  value: function(e) {
                    var t = this,
                      n = e.usePostProcessing,
                      r = void 0 !== n && n,
                      i = e.frameRateThrottling,
                      a = void 0 === i || i,
                      o = e.throttlingDelay,
                      s = void 0 === o ? 0.1 : o,
                      l = e.throttledFrameRate,
                      c = void 0 === l ? 1 : l,
                      u = e.targetFrameRate,
                      h = void 0 === u ? 30 : u,
                      d = e.autoRenderMode,
                      p = void 0 !== d && d,
                      f = e.renderMode,
                      m = void 0 === f ? "HQ" : f,
                      v = e.physicallyCorrectLights,
                      g = void 0 !== v && v,
                      y = e.gammaOutput,
                      b = void 0 === y || y,
                      x = e.gammaInput,
                      w = void 0 === x || x,
                      _ = e.gammaFactor,
                      M = void 0 === _ ? 2.2 : _,
                      T = e.toneMapping,
                      A = void 0 === T ? "LinearToneMapping" : T,
                      S = e.toneMappingExposure,
                      E = void 0 === S ? 1 : S,
                      R = e.toneMappingWhitePoint,
                      P = void 0 === R ? 1 : R,
                      I = e.aaPostProcessingAA,
                      D = void 0 === I ? "None" : I,
                      O = e.aaSampleLevel,
                      C = void 0 === O ? 1 : O,
                      L = e.aaUnbiased,
                      N = void 0 !== L && L,
                      F = e.aaDprCoef,
                      k = void 0 === F ? 1 : F,
                      U = e.shadowMapEnabled,
                      j = void 0 !== U && U,
                      B = e.shadowMapType,
                      z = void 0 === B ? "BasicShadowMap" : B,
                      V = e.useColorConversion,
                      G = void 0 === V || V,
                      H = e.statsEnabled,
                      X = void 0 !== H && H,
                      W = e.statsPanel,
                      Y = void 0 === W ? 0 : W,
                      q = e.alpha,
                      Q = void 0 === q || q,
                      Z = e.aaBuiltin,
                      J = void 0 === Z || Z,
                      K = e.preserveDrawingBuffer,
                      $ = void 0 !== K && K,
                      ee = e.logarithmicDepthBuffer,
                      te = void 0 === ee || ee,
                      ne = e.useLegacyEnvMaps,
                      re = void 0 !== ne && ne;
                    this.pause(),
                      this.renderer
                        ? (this.aaBuiltin === J &&
                            this.alpha === Q &&
                            this.preserveDrawingBuffer === $ &&
                            this.logarithmicDepthBuffer === te) ||
                          this._notifyNeedsRestart()
                        : ((this.aaBuiltin = J),
                          (this.alpha = Q),
                          (this.preserveDrawingBuffer = $),
                          (this.logarithmicDepthBuffer = te),
                          (this.useLegacyEnvMaps = re),
                          (this.renderer = new Kc({
                            antialias: J,
                            alpha: Q,
                            preserveDrawingBuffer: $,
                            logarithmicDepthBuffer: te
                          })),
                          this.renderer.getContext().getSupportedExtensions(),
                          (this.renderer.debug.checkShaderErrors = !1)),
                      (this.stats = new jb.a()),
                      this.renderer.setClearColor(16777215, 0),
                      (this.composer = new Xb(this.renderer)),
                      (this.composerNeedsReset = !0),
                      (this.pulseUpdateDelta = 0),
                      (this.delta = 0),
                      this.updateConfig({
                        usePostProcessing: r,
                        frameRateThrottling: a,
                        throttlingDelay: s,
                        throttledFrameRate: c,
                        targetFrameRate: h,
                        autoRenderMode: p,
                        renderMode: m,
                        physicallyCorrectLights: g,
                        gammaOutput: b,
                        gammaInput: w,
                        gammaFactor: M,
                        toneMapping: A,
                        toneMappingExposure: E,
                        toneMappingWhitePoint: P,
                        aaPostProcessingAA: D,
                        aaSampleLevel: C,
                        aaUnbiased: N,
                        aaDprCoef: k,
                        shadowMapEnabled: j,
                        shadowMapType: z,
                        useColorConversion: G,
                        statsEnabled: X,
                        statsPanel: Y
                      }),
                      (this.frameRate = this.targetFrameRate),
                      document.removeEventListener("pulseUpdate", function() {
                        t.onPulseUpdated();
                      }),
                      document.addEventListener("pulseUpdate", function() {
                        t.onPulseUpdated();
                      });
                  }
                },
                {
                  key: "resetComposer",
                  value: function() {
                    var e = this.viewer.sceneManager.scene,
                      t = this.viewer.sceneManager.camera;
                    if (this.composerNeedsReset) {
                      if (!e || !t) throw new Error("Invalid scene or camera");
                      (this.composer.passes = []),
                        (this.ssaaPass = new $b(e, t)),
                        (this.ssaaPass.enabled = !1),
                        this.composer.addPass(this.ssaaPass),
                        (this.renderPass = new Yb(e, t)),
                        (this.renderPass.enabled = !0),
                        this.composer.addPass(this.renderPass),
                        (this.fxaaPass = new Vb(qb)),
                        (this.fxaaPass.enabled = !1),
                        this.composer.addPass(this.fxaaPass),
                        (this.smaaPass = new Kb(
                          this.viewer.width * this.devicePixelRatio,
                          this.viewer.height * this.devicePixelRatio
                        )),
                        (this.smaaPass.enabled = !1),
                        this.composer.addPass(this.smaaPass),
                        (this.copyPass = new Vb(Bb)),
                        (this.copyPass.enabled = !0),
                        this.composer.addPass(this.copyPass),
                        (this.composerNeedsReset = !1);
                    }
                  }
                },
                {
                  key: "updateComposer",
                  value: function(e, t) {
                    this.composerNeedsReset && this.resetComposer(),
                      (this.ssaaPass.scene = e),
                      (this.ssaaPass.camera = t),
                      (this.renderPass.scene = e),
                      (this.renderPass.camera = t),
                      (this.ssaaPass.enabled =
                        "SSAA" === this.aaPostProcessingAA),
                      (this.ssaaPass.unbiased = this.aaUnbiased),
                      (this.ssaaPass.sampleLevel = this.aaSampleLevel),
                      (this.renderPass.enabled = !this.ssaaPass.enabled),
                      (this.fxaaPass.enabled =
                        "FXAA" === this.aaPostProcessingAA),
                      (this.smaaPass.enabled =
                        "SMAA" === this.aaPostProcessingAA);
                  }
                },
                {
                  key: "resize",
                  value: function(e, t) {
                    this.renderer.setSize(e, t), this.composer.setSize(e, t);
                  }
                },
                {
                  key: "update",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 &&
                        void 0 !== arguments[0] &&
                        arguments[0];
                    if (t) {
                      var n = this.viewer.sceneManager.scene,
                        r = this.viewer.sceneManager.camera;
                      this.renderCurrentFrame({ scene: n, camera: r });
                    } else this.renderFrame();
                    this.raf = requestAnimationFrame(function() {
                      return e.update(!1);
                    });
                  }
                },
                {
                  key: "renderFrame",
                  value: function() {
                    var e = this.clock.getDelta();
                    this.delta += e;
                    var t,
                      n,
                      r = this.targetFrameRate;
                    (this.pulseUpdateDelta += e),
                      this.pulseUpdateDelta > this.throttlingDelay &&
                        (r = this.throttledFrameRate),
                      this.finalFrame
                        ? ((t = this.targetFrameRate), (this.finalFrame = !1))
                        : (t = this.frameRateThrottling
                            ? r
                            : this.targetFrameRate),
                      (n = this.autoRenderMode
                        ? r === this.targetFrameRate
                          ? "MQ"
                          : "HQ"
                        : this.renderMode),
                      r !== this.frameRate &&
                        (this.onRenderStateChanged &&
                          this.onRenderStateChanged({
                            mode: n,
                            frameRate: t,
                            shouldBeFrameRate: r
                          }),
                        (this.finalFrame = r !== this.targetFrameRate)),
                      (this.frameRate = r);
                    var i = 1 / t,
                      a = !1;
                    for (
                      this.onPreUpdate && this.onPreUpdate(this.delta);
                      this.delta > i;

                    ) {
                      if (!a) {
                        this.stats.begin();
                        var o = this.viewer.sceneManager.scene,
                          s = this.viewer.sceneManager.camera;
                        this.renderCurrentFrame({
                          scene: o,
                          camera: s,
                          update: !1
                        }),
                          this.stats.end(),
                          (a = !0);
                      }
                      this.delta -= i;
                    }
                    this.onPostUpdate && this.onPostUpdate(this.delta);
                  }
                },
                {
                  key: "renderCurrentFrame",
                  value: function(e) {
                    var t = e.scene,
                      n = e.camera,
                      r = e.renderTarget,
                      i = void 0 === r ? null : r,
                      a = e.createPixelBuffer,
                      o = void 0 !== a && a,
                      s = e.update,
                      l = void 0 === s || s;
                    l && this.onPreUpdate && this.onPreUpdate(this.delta);
                    var c = null;
                    return (
                      this.usePostProcessing
                        ? (this.updateComposer(t, n),
                          this.composer &&
                            (i
                              ? (this.composer.reset(i),
                                this.composer.render(this.delta),
                                o &&
                                  ((c = new Uint8Array(
                                    this.composer.renderTarget1.width *
                                      this.composer.renderTarget1.height *
                                      4
                                  )),
                                  this.renderer.readRenderTargetPixels(
                                    this.composer.renderTarget1,
                                    0,
                                    0,
                                    this.composer.renderTarget1.width,
                                    this.composer.renderTarget1.height,
                                    c
                                  )),
                                this.composer.reset())
                              : this.composer.render(this.delta)))
                        : t &&
                          n &&
                          (i
                            ? (this.renderer.setRenderTarget(i),
                              this.renderer.render(t, n),
                              o &&
                                ((c = new Uint8Array(i.width * i.height * 4)),
                                this.renderer.readRenderTargetPixels(
                                  i,
                                  0,
                                  0,
                                  i.width,
                                  i.height,
                                  c
                                )),
                              this.renderer.setRenderTarget(null))
                            : this.renderer.render(t, n)),
                      l && this.onPostUpdate && this.onPostUpdate(this.delta),
                      c
                    );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    var e = this;
                    return Promise.resolve(!0).then(function() {
                      return (
                        e.pause(),
                        document.removeEventListener("pulseUpdate", function() {
                          e.onPulseUpdated();
                        }),
                        e.renderer.renderLists.dispose(),
                        e.renderer.forceContextLoss(),
                        (e.renderer.domElement = null),
                        (e.renderer = null),
                        !0
                      );
                    });
                  }
                },
                {
                  key: "setPulseEnabled",
                  value: function() {
                    var e =
                      !(arguments.length > 0 && void 0 !== arguments[0]) ||
                      arguments[0];
                    this.pulseEnabled = e;
                  }
                },
                {
                  key: "onPulseUpdated",
                  value: function() {
                    this.pulseEnabled && (this.pulseUpdateDelta = 0);
                  }
                },
                {
                  key: "pause",
                  value: function() {
                    -1 !== this.raf && cancelAnimationFrame(this.raf);
                  }
                },
                {
                  key: "resume",
                  value: function() {
                    var e =
                      arguments.length > 0 &&
                      void 0 !== arguments[0] &&
                      arguments[0];
                    this.update(e);
                  }
                },
                {
                  key: "updateConfig",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : {};
                    Object.keys(t).forEach(function(n) {
                      switch (n) {
                        case "aaDprCoef":
                          e.setDprCoef(t[n]);
                          break;
                        case "gammaOutput":
                          e.renderer.gammaOutput = t[n];
                          break;
                        case "gammaInput":
                          e.renderer.gammaInput = t[n];
                          break;
                        case "gammaFactor":
                          e.renderer.gammaFactor = t[n];
                          break;
                        case "physicallyCorrectLights":
                          e.renderer.physicallyCorrectLights = t[n];
                          break;
                        case "toneMapping":
                          e.renderer.toneMapping = r[t[n]];
                          break;
                        case "toneMappingExposure":
                          e.renderer.toneMappingExposure = t[n];
                          break;
                        case "toneMappingWhitePoint":
                          e.renderer.toneMappingWhitePoint = t[n];
                          break;
                        case "shadowMapEnabled":
                          e.renderer.shadowMap.enabled = t[n];
                          break;
                        case "shadowMapType":
                          e.renderer.shadowMap.type = r[t[n]];
                          break;
                        case "usePostProcessing":
                          e.usePostProcessing = t[n];
                          break;
                        case "frameRateThrottling":
                          e.frameRateThrottling = t[n];
                          break;
                        case "targetFrameRate":
                          e.targetFrameRate = t[n];
                          break;
                        case "throttlingDelay":
                          e.throttlingDelay = t[n];
                          break;
                        case "throttledFrameRate":
                          e.throttledFrameRate = t[n];
                          break;
                        case "autoRenderMode":
                          e.autoRenderMode = t[n];
                          break;
                        case "renderMode":
                          e.renderMode = t[n];
                          break;
                        case "aaPostProcessingAA":
                          e.aaPostProcessingAA = t[n];
                          break;
                        case "aaSampleLevel":
                          e.aaSampleLevel = t[n];
                          break;
                        case "aaUnbiased":
                          e.aaUnbiased = t[n];
                          break;
                        case "useColorConversion":
                          e.useColorConversion = t[n];
                          break;
                        case "statsEnabled":
                          e.setStatsEnabled(t[n]);
                          break;
                        case "statsPanel":
                          e.setStatsPanel(t[n]);
                          break;
                        case "alpha":
                          e.alpha !== t[n] && e._notifyNeedsRestart();
                          break;
                        case "aaBuiltin":
                          e.aaBuiltin !== t[n] && e._notifyNeedsRestart();
                          break;
                        case "preserveDrawingBuffer":
                          e.preserveDrawingBuffer !== t[n] &&
                            e._notifyNeedsRestart();
                          break;
                        case "logarithmicDepthBuffer":
                          e.logarithmicDepthBuffer !== t[n] &&
                            e._notifyNeedsRestart();
                        case "useLegacyEnvMaps":
                          e.useLegacyEnvMaps !== t[n] &&
                            e._notifyNeedsRestart();
                      }
                    });
                  }
                },
                {
                  key: "setDprCoef",
                  value: function(e) {
                    (this.dprCoef = e),
                      (this.devicePixelRatio = window.devicePixelRatio
                        ? window.devicePixelRatio * this.dprCoef
                        : 1),
                      this.renderer.setPixelRatio(this.devicePixelRatio),
                      this.usePostProcessing &&
                        this.composer.setPixelRatio(this.devicePixelRatio);
                  }
                },
                {
                  key: "setStatsEnabled",
                  value: function(e) {
                    (this.statsEnabled = e),
                      e
                        ? this.viewer.container.appendChild(this.stats.dom)
                        : this.viewer.container.contains(this.stats.dom) &&
                          this.viewer.container.removeChild(this.stats.dom);
                  }
                },
                {
                  key: "setStatsPanel",
                  value: function(e) {
                    (this.statsPanel = e), this.stats.showPanel(e);
                  }
                },
                {
                  key: "_notifyNeedsRestart",
                  value: function() {
                    this.onRenderStateChanged &&
                      this.onRenderStateChanged({ needsRestart: !0 });
                  }
                },
                {
                  key: "getFrameImageData",
                  value: function(e) {
                    var t = e.width,
                      n = e.height,
                      r = e.format,
                      i = void 0 === r ? "image/png" : r,
                      a = e.imageQuality,
                      o = void 0 === a ? 0.92 : a,
                      s = this.viewer.sceneManager,
                      l = s.scene,
                      c = s.camera,
                      u = new la(t, n),
                      h = c.clone();
                    (h.aspect = t / n), h.updateProjectionMatrix();
                    var d = this.renderCurrentFrame({
                      scene: l,
                      camera: h,
                      renderTarget: u,
                      createPixelBuffer: !0
                    });
                    this.renderCurrentFrame({ scene: l, camera: c });
                    var p = document.createElement("canvas");
                    (p.width = t), (p.height = n);
                    var f = p.getContext("2d"),
                      m = f.createImageData(t, n);
                    m.data.set(d),
                      Array.from({ length: n }, function(e, n) {
                        return m.data.slice(n * t * 4, (n + 1) * t * 4);
                      }).forEach(function(e, r) {
                        return m.data.set(e, (n - r - 1) * t * 4);
                      }),
                      f.putImageData(m, 0, 0),
                      u.dispose();
                    var v = p.toDataURL(i, o);
                    return p.remove(), v;
                  }
                },
                {
                  key: "materialsNeedUpdate",
                  value: function(e) {
                    return (
                      (e.shadowMapEnabled &&
                        e.shadowMapEnabled !==
                          this.renderer.shadowMap.enabled) ||
                      (e.shadowMapType &&
                        r[e.shadowMapType] !== this.renderer.shadowMap.type) ||
                      (e.toneMapping &&
                        r[e.toneMapping] !== this.renderer.toneMapping)
                    );
                  }
                }
              ]) && ex(t.prototype, n),
              i && ex(t, i),
              e
            );
          })(),
          nx = function e(t) {
            var n = t.effectID,
              r = t.viewer;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.viewer = r),
              (this.effectManager = this.viewer.effectManager),
              (this.sceneManager = this.viewer.sceneManager),
              (this.id = n || E()()),
              (this.name = "".concat(this.id, "@HelperEffect"));
          };
        function rx(e) {
          return (rx =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function ix(e, t, n) {
          return (ix = (function() {
            if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
            if (Reflect.construct.sham) return !1;
            if ("function" == typeof Proxy) return !0;
            try {
              return (
                Date.prototype.toString.call(
                  Reflect.construct(Date, [], function() {})
                ),
                !0
              );
            } catch (e) {
              return !1;
            }
          })()
            ? Reflect.construct
            : function(e, t, n) {
                var r = [null];
                r.push.apply(r, t);
                var i = new (Function.bind.apply(e, r))();
                return n && cx(i, n.prototype), i;
              }).apply(null, arguments);
        }
        function ax(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function ox(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function sx(e, t) {
          return !t || ("object" !== rx(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function lx(e) {
          return (lx = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function cx(e, t) {
          return (cx =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var ux = (function(e) {
          function t(e) {
            var n,
              r = e.effectID,
              i = e.viewer,
              a = e.elementIDs,
              o = e.config;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = sx(
                this,
                lx(t).call(this, { effectID: r, viewer: i })
              )).elementID = a[0]),
              (n.elementType = n.sceneManager.getElement(n.elementID).type),
              (n.color = o.color || "#ffffff"),
              (n.overlap = o.overlap || !1),
              (n.animate = o.animate || !1),
              (n.duration = o.duration || 300),
              (n.size = o.size || 1),
              (n.helperObj = null),
              (n.currentOpacity = 0),
              (n.t0 = null),
              n
            );
          }
          var n, i, a;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && cx(e, t);
            })(t, e),
            (n = t),
            (i = [
              {
                key: "init",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return e._setupHelper();
                    })
                    .then(function() {
                      return e._setHelperVisibility(!1), e;
                    });
                }
              },
              {
                key: "dispose",
                value: function() {
                  return this._releaseHelper();
                }
              },
              {
                key: "preUpdate",
                value: function(e) {
                  return (
                    this._updateHelper(e), this._setHelperVisibility(!0), !0
                  );
                }
              },
              {
                key: "postUpdate",
                value: function(e) {
                  return this._setHelperVisibility(!1), !0;
                }
              },
              {
                key: "_setupHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      if (!e.sceneManager.getElement(e.elementID))
                        throw new Error("Invalid element");
                      switch (e.elementType) {
                        case "Node":
                        case "Sprite":
                          return e._setupBoundingBoxHelper();
                        case "Light":
                          return e._setupLightHelper();
                        case "Camera":
                          return e._setupCameraHelper();
                        default:
                          return !0;
                      }
                    })
                    .then(function() {
                      return e._animateOpacity(
                        e.currentOpacity,
                        1,
                        fv.a.Easing.Sinusoidal.In,
                        e.duration
                      );
                    });
                }
              },
              {
                key: "_releaseHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return e._animateOpacity(
                        e.currentOpacity,
                        0,
                        fv.a.Easing.Sinusoidal.Out,
                        e.duration
                      );
                    })
                    .then(function() {
                      switch (e.elementType) {
                        case "Node":
                        case "Sprite":
                          return e._releaseBoundingBoxHelper();
                        case "Light":
                          return e._releaseLightHelper();
                        case "Camera":
                          return e._releaseCameraHelper();
                        default:
                          return !0;
                      }
                    });
                }
              },
              {
                key: "_updateHelper",
                value: function(e) {
                  if (this.sceneManager.getElement(this.elementID))
                    switch (this.elementType) {
                      case "Node":
                      case "Sprite":
                        this._updateBoundingBoxHelper(e);
                        break;
                      case "Light":
                        this._updateLightHelper(e);
                        break;
                      case "Camera":
                        this._updateCameraHelper(e);
                    }
                }
              },
              {
                key: "_setHelperVisibility",
                value: function(e) {
                  this.helperObj.visible = e;
                }
              },
              {
                key: "_setupBoundingBoxHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    var t = e.sceneManager.scene,
                      n = new Za();
                    return (
                      (e.helperObj = new Tm(n, e.color)),
                      (e.helperObj.name = e.name),
                      (e.helperObj.material.transparent = !0),
                      (e.helperObj.material.opacity = e.currentOpacity),
                      e.overlap &&
                        ((e.helperObj.renderOrder = 999999),
                        (e.helperObj.material.transparent = !0),
                        (e.helperObj.material.depthTest = !1)),
                      t.add(e.helperObj),
                      !0
                    );
                  });
                }
              },
              {
                key: "_releaseBoundingBoxHelper",
                value: function(e) {
                  var t = this;
                  return Promise.resolve(!0).then(function() {
                    return (
                      t.sceneManager.scene.remove(t.helperObj),
                      (t.helperObj = null),
                      !0
                    );
                  });
                }
              },
              {
                key: "_updateBoundingBoxHelper",
                value: function(e) {
                  var t = this,
                    n = this.sceneManager.getElement(this.elementID).getRefs();
                  this.helperObj.box.setFromObject(n.obj);
                  var r = function(e) {
                    t.helperObj.box.min[e] === t.helperObj.box.max[e] &&
                      ((t.helperObj.box.min[e] -=
                        0.001 * Math.abs(t.helperObj.box.min[e])),
                      (t.helperObj.box.max[e] +=
                        0.001 * Math.abs(t.helperObj.box.max[e])),
                      (t.helperObj.matrixWorldNeedsUpdate = !0));
                  };
                  r("x"),
                    r("y"),
                    r("z"),
                    (this.helperObj.material.opacity = this.currentOpacity);
                }
              },
              {
                key: "_setupLightHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    var t = e.sceneManager.scene,
                      n = e.sceneManager.getElement(e.elementID),
                      i = n.getRefs().obj;
                    if ("AmbientLight" !== n.lightType) {
                      var a = [i];
                      switch (n.lightType) {
                        case "DirectionalLight":
                        case "PointLight":
                        case "HemisphereLight":
                          a = [].concat(ax(a), [n.helperSize]);
                      }
                      switch (
                        ((e.helperObj = ix(
                          r["".concat(n.lightType, "Helper")],
                          ax(a)
                        )),
                        (e.helperObj.name = e.name),
                        n.lightType)
                      ) {
                        case "DirectionalLight":
                          e.helperObj.lightPlane.material.transparent = !0;
                      }
                      t.add(e.helperObj);
                    }
                    return !0;
                  });
                }
              },
              {
                key: "_releaseLightHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    var t = e.sceneManager.scene;
                    return (
                      e.helperObj &&
                        (t.remove(e.helperObj),
                        e.helperObj.dispose(),
                        (e.helperObj = null)),
                      !0
                    );
                  });
                }
              },
              {
                key: "_updateLightHelper",
                value: function(e) {
                  var t = this.sceneManager.getElement(this.elementID);
                  if (this.helperObj) {
                    switch (t.lightType) {
                      case "DirectionalLight":
                        this.helperObj.lightPlane.material.opacity = this.currentOpacity;
                    }
                    this.helperObj.update();
                  }
                }
              },
              {
                key: "_setupCameraHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    var t = e.sceneManager.scene,
                      n = e.sceneManager.getElement(e.elementID).getRefs().obj;
                    return (
                      (e.helperObj = new xm(n)),
                      (e.helperObj.name = e.name),
                      (e.helperObj.material.transparent = !0),
                      t.add(e.helperObj),
                      !0
                    );
                  });
                }
              },
              {
                key: "_releaseCameraHelper",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    var t = e.sceneManager.scene;
                    return (
                      e.helperObj &&
                        (t.remove(e.helperObj), (e.helperObj = null)),
                      !0
                    );
                  });
                }
              },
              {
                key: "_updateCameraHelper",
                value: function(e) {
                  this.helperObj &&
                    ((this.helperObj.material.opacity = this.currentOpacity),
                    this.helperObj.update());
                }
              },
              {
                key: "_animateOpacity",
                value: function(e, t, n, r) {
                  var i = this;
                  return new Promise(function(a) {
                    document.dispatchEvent(new Event("pulseUpdate")),
                      i.t0 && (i.t0.stop(), (i.t0 = null)),
                      i.animate
                        ? ((i.t0 = new fv.a.Tween({ opacity: e })
                            .to({ opacity: t }, r)
                            .easing(n)
                            .onUpdate(function(e) {
                              (i.currentOpacity = e.opacity),
                                document.dispatchEvent(
                                  new Event("pulseUpdate")
                                );
                            })
                            .onComplete(function() {
                              document.dispatchEvent(new Event("pulseUpdate")),
                                (i.t0 = null),
                                a(!0);
                            })),
                          i.t0.start())
                        : ((i.currentOpacity = t), a(!0));
                  });
                }
              }
            ]) && ox(n.prototype, i),
            a && ox(n, a),
            t
          );
        })(nx);
        function hx(e) {
          return (hx =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function dx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function px(e, t) {
          return !t || ("object" !== hx(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function fx(e) {
          return (fx = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function mx(e, t) {
          return (mx =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var vx = (function(e) {
          function t(e) {
            var n,
              r = e.effectID,
              i = e.viewer,
              a = e.elementIDs,
              o = e.config;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = px(
                this,
                fx(t).call(this, { effectID: r, viewer: i })
              )).elementID = a[0]),
              (n.color = o.color || "#ffffff"),
              (n.dimColor = o.dimColor || n.color),
              (n.overlap = o.overlap || !1),
              (n.animate = o.animate || !1),
              (n.duration = o.duration || 300),
              (n.size = o.size || 1),
              (n.cloneMaterial = null),
              (n.currentColorObj = new Eo("#000000")),
              (n.finalColorObj = new Eo(n.color)),
              (n.dimColorObj = new Eo(n.dimColor)),
              (n.t0 = null),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && mx(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "init",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return e.currentColorObj.set(e._getMaterialColor()), !0;
                    })
                    .then(function() {
                      return e._animateColor(
                        e.currentColorObj,
                        e.finalColorObj,
                        fv.a.Easing.Sinusoidal.In,
                        e.duration / 2
                      );
                    })
                    .then(function() {
                      return e._animateColor(
                        e.finalColorObj,
                        e.dimColorObj,
                        fv.a.Easing.Sinusoidal.Out,
                        e.duration / 2
                      );
                    });
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      var t = e._getMaterialColor();
                      return e.currentColorObj.set(t), t;
                    })
                    .then(function(t) {
                      return e._animateColor(
                        e.currentColorObj,
                        t,
                        fv.a.Easing.Sinusoidal.Out,
                        e.duration
                      );
                    })
                    .then(function() {
                      e._revertMaterial();
                    });
                }
              },
              {
                key: "preUpdate",
                value: function() {
                  return this._setCloneMaterial(), !0;
                }
              },
              {
                key: "postUpdate",
                value: function() {
                  return this._revertMaterial(), !0;
                }
              },
              {
                key: "_animateColor",
                value: function(e, t, n, r) {
                  var i = this;
                  return new Promise(function(a) {
                    document.dispatchEvent(new Event("pulseUpdate")),
                      i.t0 && (i.t0.stop(), (i.t0 = null));
                    var o = new Eo(e),
                      s = new Eo(t);
                    i.animate
                      ? ((i.t0 = new fv.a.Tween({ r: o.r, g: o.g, b: o.b })
                          .to({ r: s.r, g: s.g, b: s.b }, r)
                          .easing(n)
                          .onUpdate(function(e) {
                            i.currentColorObj.setRGB(e.r, e.g, e.b),
                              document.dispatchEvent(new Event("pulseUpdate"));
                          })
                          .onComplete(function() {
                            document.dispatchEvent(new Event("pulseUpdate")),
                              (i.t0 = null),
                              a(!0);
                          })),
                        i.t0.start())
                      : (i.currentColorObj.setRGB(s.r, s.g, s.b),
                        document.dispatchEvent(new Event("pulseUpdate")),
                        a(!0));
                  });
                }
              },
              {
                key: "_getMaterialColor",
                value: function() {
                  var e = this.sceneManager.getElement(this.elementID);
                  if (e.materialID) {
                    var t = this.sceneManager.getElement(e.materialID),
                      n = t.getRefs().obj;
                    return Array.isArray(t)
                      ? t[0].emissive
                        ? t[0].emissive
                        : t[0].color
                      : n.emissive
                      ? n.emissive
                      : n.color;
                  }
                  return this.finalColorObj;
                }
              },
              {
                key: "_setMaterialColor",
                value: function(e, t) {
                  Array.isArray(e)
                    ? e.forEach(function(e) {
                        e.emissive ? e.emissive.set(t) : e.color.set(t);
                      })
                    : e.emissive
                    ? e.emissive.set(t)
                    : e.color.set(t);
                }
              },
              {
                key: "_setCloneMaterial",
                value: function() {
                  var e = this.sceneManager.getElement(this.elementID),
                    t = e.getRefs().obj;
                  if (e.materialID) {
                    var n = this.sceneManager.getElement(e.materialID).getRefs()
                      .obj;
                    (this.cloneMaterial = n.clone()),
                      this._setMaterialColor(
                        this.cloneMaterial,
                        this.currentColorObj
                      ),
                      (t.material = this.cloneMaterial);
                  }
                }
              },
              {
                key: "_revertMaterial",
                value: function() {
                  this.sceneManager.getElement(this.elementID).update(),
                    this.cloneMaterial &&
                      (this.cloneMaterial.dispose(),
                      (this.cloneMaterial = null));
                }
              }
            ]) && dx(n.prototype, r),
            i && dx(n, i),
            t
          );
        })(nx);
        function gx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var yx = (function() {
          function e() {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e);
          }
          var t, n, r;
          return (
            (t = e),
            (r = [
              {
                key: "create",
                value: function(e) {
                  var t = e.effectID,
                    n = e.type,
                    r = e.viewer,
                    i = e.elementIDs,
                    a = e.config;
                  switch (n) {
                    case "HelperEffect":
                      return new ux({
                        effectID: t,
                        viewer: r,
                        elementIDs: i,
                        config: a
                      });
                    case "SimpleHighlightEffect":
                      return new vx({
                        effectID: t,
                        viewer: r,
                        elementIDs: i,
                        config: a
                      });
                    default:
                      return null;
                  }
                }
              }
            ]),
            (n = null) && gx(t.prototype, n),
            r && gx(t, r),
            e
          );
        })();
        function bx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var xx = (function() {
          function e(t) {
            var n = t.viewer;
            t.config,
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, e),
              (this.viewer = n),
              (this.sceneManager = this.viewer.sceneManager),
              (this.effects = {});
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return e.removeAllEffects(!0);
                    })
                    .then(function() {
                      return !0;
                    });
                }
              },
              {
                key: "preUpdate",
                value: function(e) {
                  var t = this;
                  Object.keys(this.effects).forEach(function(n) {
                    t.effects[n].preUpdate(e);
                  });
                }
              },
              {
                key: "postUpdate",
                value: function(e) {
                  var t = this;
                  Object.keys(this.effects).forEach(function(n) {
                    t.effects[n].postUpdate(e);
                  });
                }
              },
              {
                key: "addEffect",
                value: function(e, t, n, r) {
                  var i = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      if (i.effects[e])
                        throw new Error("Effect ".concat(e, " already exists"));
                      var a = yx.create({
                        effectID: e,
                        type: t,
                        viewer: i.viewer,
                        elementIDs: n,
                        config: r
                      });
                      return (i.effects[a.id] = a), a;
                    })
                    .then(function(e) {
                      return e.init();
                    })
                    .then(function(e) {
                      return e.id;
                    });
                }
              },
              {
                key: "removeEffect",
                value: function(e) {
                  var t = this,
                    n =
                      arguments.length > 1 &&
                      void 0 !== arguments[1] &&
                      arguments[1];
                  return Promise.resolve(!0)
                    .then(function() {
                      if (!t.effects[e])
                        throw new Error("Effect ".concat(e, " doesn't exist"));
                      var r = t.effects[e];
                      return n && (r.animate = !1), r.dispose();
                    })
                    .then(function() {
                      return delete t.effects[e], !0;
                    });
                }
              },
              {
                key: "getEffect",
                value: function(e) {
                  return this.effects[e] || null;
                }
              },
              {
                key: "removeAllEffects",
                value: function() {
                  var e = this,
                    t =
                      arguments.length > 0 &&
                      void 0 !== arguments[0] &&
                      arguments[0],
                    n = Object.keys(this.effects).map(function(n) {
                      return e.removeEffect(n, t);
                    });
                  return Promise.all(n);
                }
              }
            ]) && bx(t.prototype, n),
            r && bx(t, r),
            e
          );
        })();
        function wx(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function _x(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Mx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var Tx = (function() {
          function e(t) {
            var n = this,
              r = t.general,
              i = void 0 === r ? {} : r,
              a = t.renderer,
              o = void 0 === a ? {} : a,
              s = t.scene,
              l = void 0 === s ? {} : s,
              c = t.assetManager,
              u = void 0 === c ? null : c,
              h = t.onMouseDown,
              d = void 0 === h ? null : h,
              p = t.onMouseUp,
              f = void 0 === p ? null : p,
              m = t.onMouseMove,
              v = void 0 === m ? null : m,
              g = t.onMouseLeave,
              y = void 0 === g ? null : g,
              b = t.onMouseClick,
              x = void 0 === b ? null : b,
              w = t.onLoadingChanged,
              _ = void 0 === w ? null : w;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.container = document.getElementById(i.containerID)),
              (this.objectPicker = null),
              (this.renderer = new tx({
                viewer: this,
                onRenderStateChanged: o.onRenderStateChanged
              })),
              this.renderer.reset(o);
            var M = this.renderer.renderer.domElement;
            this.container.appendChild(M),
              (this.renderer.onPreUpdate = function(e) {
                n.onWindowResize(),
                  fv.a.update(),
                  n.sceneManager.update(e),
                  n.effectManager && n.effectManager.preUpdate(e);
              }),
              (this.renderer.onPostUpdate = function(e) {
                n.effectManager && n.effectManager.postUpdate(e);
              }),
              (this.assetManager = u),
              u.attach({
                container: this.container,
                renderer: this.renderer.renderer,
                onLoadingChanged: _
              }),
              (this.sceneManager = new Nb(
                (function(e) {
                  for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2
                      ? wx(Object(n), !0).forEach(function(t) {
                          _x(e, t, n[t]);
                        })
                      : Object.getOwnPropertyDescriptors
                      ? Object.defineProperties(
                          e,
                          Object.getOwnPropertyDescriptors(n)
                        )
                      : wx(Object(n)).forEach(function(t) {
                          Object.defineProperty(
                            e,
                            t,
                            Object.getOwnPropertyDescriptor(n, t)
                          );
                        });
                  }
                  return e;
                })({ viewer: this }, l)
              )),
              (this.objectPicker = new kb({
                container: M,
                sceneManager: this.sceneManager,
                onMouseDown: d,
                onMouseUp: f,
                onMouseMove: function(e) {
                  v && v(e);
                },
                onMouseLeave: y,
                onMouseClick: function(e) {
                  x && x(e);
                },
                clickTimeout: i.clickTimeout,
                hoverPeriod: i.hoverPeriod
              })),
              (this.effectManager = new xx({ viewer: this, config: {} }));
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function(e) {
                  var t = this,
                    n = e.bgType,
                    r = e.bgColor;
                  return Promise.resolve(!0)
                    .then(function() {
                      return t.sceneManager.init({ bgType: n, bgColor: r });
                    })
                    .then(function() {
                      return t.onWindowResize(!0), !0;
                    });
                }
              },
              {
                key: "resetRenderer",
                value: function(e) {
                  this.pause(),
                    this.renderer.reset(e),
                    this.container.removeChild(this.container.childNodes[0]),
                    this.container.appendChild(
                      this.renderer.renderer.domElement
                    ),
                    this.onWindowResize(!0),
                    this.resume();
                }
              },
              {
                key: "pause",
                value: function() {
                  this.renderer.pause();
                }
              },
              {
                key: "resume",
                value: function() {
                  var e =
                    arguments.length > 0 &&
                    void 0 !== arguments[0] &&
                    arguments[0];
                  this.renderer.resume(e);
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return (
                        e.renderer.pause(),
                        !e.objectPicker || e.objectPicker.dispose()
                      );
                    })
                    .then(function() {
                      return !e.effectManager || e.effectManager.dispose();
                    })
                    .then(function() {
                      return !e.sceneManager || e.sceneManager.dispose();
                    })
                    .then(function() {
                      return e.assetManager.detach(), !0;
                    })
                    .then(function() {
                      var t = e.renderer.renderer.domElement;
                      return (
                        e.container.removeChild(t),
                        !e.renderer || e.renderer.dispose()
                      );
                    });
                }
              },
              {
                key: "getSnapshot",
                value: function(e) {
                  var t = this,
                    n = e.width,
                    r = void 0 === n ? null : n,
                    i = e.height,
                    a = void 0 === i ? null : i,
                    o = e.format,
                    s = e.imageQuality;
                  return Promise.resolve().then(function() {
                    var e = r || t.width,
                      n = a || t.height;
                    return {
                      data: t.renderer.getFrameImageData({
                        width: e,
                        height: n,
                        format: o,
                        imageQuality: s
                      })
                    };
                  });
                }
              },
              {
                key: "onWindowResize",
                value: function() {
                  var e =
                    arguments.length > 0 &&
                    void 0 !== arguments[0] &&
                    arguments[0];
                  (e ||
                    this.width !== this.container.clientWidth ||
                    this.height !== this.container.clientHeight) &&
                    ((this.width = this.container.clientWidth),
                    (this.height = this.container.clientHeight),
                    this.resize(this.width, this.height),
                    document.dispatchEvent(new Event("pulseUpdate")));
                }
              },
              {
                key: "resize",
                value: function(e, t) {
                  this.renderer.resize(e, t), this.sceneManager.resize(e, t);
                }
              },
              {
                key: "useColorConversion",
                get: function() {
                  return !this.renderer || this.renderer.useColorConversion;
                }
              }
            ]) && Mx(t.prototype, n),
            r && Mx(t, r),
            e
          );
        })();
        function Ax(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function Sx(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Ex(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Rx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var Px = (function() {
          function e() {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e);
          }
          var t, n, i;
          return (
            (t = e),
            (i = [
              {
                key: "getConfigEntry",
                value: function(e, t, n) {
                  var r = null;
                  switch (t) {
                    case "Renderer":
                      r = "renderer";
                      break;
                    case "Environment":
                      r = "environment";
                      break;
                    case "Mesh":
                    case "Object3D":
                    case "Group":
                      r = "meshNode";
                      break;
                    case "Camera":
                    case "PerspectiveCamera":
                    case "OrthographicCamera":
                      r = "camera";
                      break;
                    case "MeshBasicMaterial":
                    case "MeshLambertMaterial":
                    case "MeshPhongMaterial":
                    case "MeshStandardMaterial":
                    case "MeshPhysicalMaterial":
                    case "SpriteMaterial":
                    case "CompoundMaterial":
                    case "MeshToonMaterial":
                    case "ShadowMaterial":
                      r = "material";
                      break;
                    case "PointLight":
                    case "SpotLight":
                    case "DirectionalLight":
                    case "HemisphereLight":
                    case "AmbientLight":
                    case "RectAreaLight":
                      r = "light";
                      break;
                    case "Sprite":
                      r = "annotation";
                      break;
                    case "Basic":
                    case "BasicHDR":
                    case "BasicEXR":
                    case "Equirectangular":
                    case "EquirectangularHDR":
                    case "EquirectangularEXR":
                    case "Cube":
                    case "CubeHDR":
                      r = "texture";
                      break;
                    case "OrbitControls":
                    case "ObjectControls":
                    case "TransformControls":
                      r = "controls";
                      break;
                    default:
                      return null;
                  }
                  var i = e.getTUFInfoForEntity(r),
                    a = (function(e) {
                      for (var t = 1; t < arguments.length; t++) {
                        var n = null != arguments[t] ? arguments[t] : {};
                        t % 2
                          ? Sx(Object(n), !0).forEach(function(t) {
                              Ex(e, t, n[t]);
                            })
                          : Object.getOwnPropertyDescriptors
                          ? Object.defineProperties(
                              e,
                              Object.getOwnPropertyDescriptors(n)
                            )
                          : Sx(Object(n)).forEach(function(t) {
                              Object.defineProperty(
                                e,
                                t,
                                Object.getOwnPropertyDescriptor(n, t)
                              );
                            });
                      }
                      return e;
                    })(
                      {},
                      i.model._rules.commonRules.config,
                      {},
                      i.model._rules.typeRules[t]
                        ? i.model._rules.typeRules[t].config
                        : {}
                    );
                  return a[n] ? a[n] : null;
                }
              },
              {
                key: "set",
                value: function(e, t, n, i) {
                  var a;
                  switch (this.getConfigEntry(t, n).typeRes) {
                    case "enum":
                      e[n] = null !== i ? r[i] : null;
                      break;
                    case "coordinate2":
                    case "coordinate3":
                    case "coordinate4":
                      (a = e[n]).set.apply(a, Ax(i));
                      break;
                    case "color":
                      e[n].set(i);
                      break;
                    case "range":
                    case "boolean":
                    case "integer":
                    case "float":
                      e[n] = i;
                  }
                }
              },
              {
                key: "getValueType",
                value: function(e, t, n) {
                  var r = this.getConfigEntry(e, t, n);
                  return r ? r.typeRes : null;
                }
              }
            ]),
            (n = null) && Rx(t.prototype, n),
            i && Rx(t, i),
            e
          );
        })();
        function Ix(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Dx(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? Ix(Object(n), !0).forEach(function(t) {
                  Ox(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : Ix(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function Ox(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function Cx(e, t) {
          if (null == e) return {};
          var n,
            r,
            i = (function(e, t) {
              if (null == e) return {};
              var n,
                r,
                i = {},
                a = Object.keys(e);
              for (r = 0; r < a.length; r++)
                (n = a[r]), t.indexOf(n) >= 0 || (i[n] = e[n]);
              return i;
            })(e, t);
          if (Object.getOwnPropertySymbols) {
            var a = Object.getOwnPropertySymbols(e);
            for (r = 0; r < a.length; r++)
              (n = a[r]),
                t.indexOf(n) >= 0 ||
                  (Object.prototype.propertyIsEnumerable.call(e, n) &&
                    (i[n] = e[n]));
          }
          return i;
        }
        function Lx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var Nx = (function() {
          function e(t) {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.TUFProvider = t),
              (this.data = {});
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "getEntity",
                value: function(e) {
                  var t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : null,
                    n = this.getDefaultEntity(e, t),
                    r = n.active,
                    i = n.config,
                    a = n.activeConfig,
                    o = Cx(n, ["active", "config", "activeConfig"]);
                  return Dx({}, o, {}, r, { config: Dx({}, i, {}, a) });
                }
              },
              {
                key: "getDefaultEntity",
                value: function(e, t) {
                  if (!e) throw new Error("Entity type is not valid");
                  var n;
                  if (
                    !(n = t
                      ? this.TUFProvider.getEntity(e, t, {
                          returnType: "reference"
                        })
                      : this.TUFProvider.getSingle(e, {
                          returnType: "reference"
                        }))
                  )
                    throw new Error(
                      "Entity data for ID "
                        .concat(t, " of type ")
                        .concat(e, " doesn't exist")
                    );
                  return Dx({}, this._getLocalEntity(e, t), {}, n);
                }
              },
              {
                key: "getRelatedEntity",
                value: function(e, t, n) {
                  var r,
                    i = null;
                  switch (
                    (r = t
                      ? this.TUFProvider.getEntity(e, t, {
                          returnType: "reference"
                        })
                      : this.TUFProvider.getSingle(e, {
                          returnType: "reference"
                        })).nodeTypeID
                  ) {
                    case "1":
                      i = "meshNode";
                      break;
                    case "2":
                      i = "camera";
                      break;
                    case "3":
                      i = "light";
                      break;
                    case "4":
                      i = "annotation";
                  }
                  return r.relEntityID
                    ? this.getEntity(i, r.relEntityID)
                    : null;
                }
              },
              {
                key: "setEntity",
                value: function(e, t, n) {
                  if (!t) throw new Error("Entity ID is not valid");
                  if (!e) throw new Error("Entity type is not valid");
                  var r = {
                    _ref: Dx({}, this._getLocalEntity(e, t)._ref, {}, n._ref)
                  };
                  this.data[e][t] = r;
                }
              },
              {
                key: "mergeEntity",
                value: function(e, t, n) {
                  var r = this.getEntity(e, t);
                  return Dx({}, r, {
                    config: Dx({}, r.config, {}, n.config),
                    activeConfig: Dx({}, r.activeConfig, {}, n.activeConfig)
                  });
                }
              },
              {
                key: "mergeDefaultEntity",
                value: function(e, t, n) {
                  var r = this.getDefaultEntity(e, t);
                  return Dx({}, r, {
                    config: Dx({}, r.config, {}, n.config),
                    activeConfig: Dx({}, r.activeConfig, {}, n.activeConfig)
                  });
                }
              },
              {
                key: "getDiffEntity",
                value: function(e, t, n) {
                  var r = {
                    id: t,
                    entity: e,
                    activeConfig: Dx({}, n.activeConfig)
                  };
                  return delete r._ref, r;
                }
              },
              {
                key: "getAllIds",
                value: function(e) {
                  return this.TUFProvider.getEntityGroup(e, {
                    returnType: "reference"
                  }).allIds;
                }
              },
              {
                key: "_getLocalEntity",
                value: function(e, t) {
                  return (
                    this.data[e] || (this.data[e] = {}),
                    this.data[e][t] ||
                      (this.data[e][t] = { _ref: this.createDefaultRef() }),
                    this.data[e][t]
                  );
                }
              },
              {
                key: "getValueType",
                value: function(e, t) {
                  return Px.getValueType(this.TUFProvider, e, t);
                }
              },
              {
                key: "createDefaultRef",
                value: function() {
                  return { refID: null, fetchPromise: null, fetchCounter: 0 };
                }
              }
            ]) && Lx(t.prototype, n),
            r && Lx(t, r),
            e
          );
        })();
        function Fx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var kx = (function() {
          function e(t) {
            var n = this,
              r = t.sceneManager,
              i = t.type,
              a = t.onUpdate,
              o = t.onComplete;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.sceneManager = r),
              (this.type = i),
              (this.onUpdate = function(e) {
                a && a(e), n._onUpdate(e);
              }),
              (this.onComplete = function(e) {
                o && o(e), n._onComplete(e);
              });
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              { key: "_onUpdate", value: function(e) {} },
              { key: "_onComplete", value: function(e) {} },
              { key: "execute", value: function() {} },
              { key: "dispose", value: function() {} }
            ]) && Fx(t.prototype, n),
            r && Fx(t, r),
            e
          );
        })();
        function Ux(e) {
          return (Ux =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function jx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Bx(e, t) {
          return !t || ("object" !== Ux(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function zx(e) {
          return (zx = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function Vx(e, t) {
          return (Vx =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Gx = (function(e) {
          function t(e) {
            var n,
              r = e.sceneManager,
              i = e.type,
              a = e.elementID,
              o = e.duration,
              s = void 0 === o ? 1e3 : o,
              l = e.easing,
              c = void 0 === l ? "QuadraticInOut" : l,
              u = e.valueExp,
              h = void 0 === u ? "Set" : u,
              d = e.delay,
              p = void 0 === d ? 0 : d,
              f = e.repeat,
              m = void 0 === f ? 0 : f,
              v = e.repeatDelay,
              g = void 0 === v ? 500 : v,
              y = e.yoyo,
              b = void 0 !== y && y,
              x = e.onUpdate,
              w = void 0 === x ? null : x,
              _ = e.onComplete,
              M = void 0 === _ ? null : _,
              T = e.startProperties,
              A = void 0 === T ? [] : T,
              S = e.endProperties,
              E = void 0 === S ? [] : S;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = Bx(
                this,
                zx(t).call(this, {
                  sceneManager: r,
                  type: i,
                  onUpdate: w,
                  onComplete: M
                })
              )).elementID = a),
              (n.duration = s),
              (n.easing = c),
              (n.valueExp = h),
              (n.delay = p),
              (n.repeat = m),
              (n.repeatDelay = g),
              (n.yoyo = b),
              (n._startProperties = A),
              (n._endProperties = E),
              (n.tween = null),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && Vx(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "execute",
                value: function() {
                  var e = this;
                  return new Promise(function(t, n) {
                    (e.tween = e._prepare(
                      e.startProperties,
                      e.endProperties,
                      t
                    )),
                      e.tween.start();
                  });
                }
              },
              {
                key: "_prepare",
                value: function(e, t) {
                  var n = this,
                    r =
                      arguments.length > 2 && void 0 !== arguments[2]
                        ? arguments[2]
                        : null,
                    i = this.prepareState(e),
                    a = this.prepareState(t);
                  return new fv.a.Tween(i)
                    .to(a, this.duration)
                    .easing(this._getTWEENEasing(this.easing))
                    .delay(this.delay)
                    .repeat(this.repeat)
                    .repeatDelay(this.repeatDelay)
                    .yoyo(this.yoyo)
                    .onUpdate(this.onUpdate)
                    .onComplete(function(e) {
                      n.onComplete(e), r(!0);
                    });
                }
              },
              {
                key: "_onUpdate",
                value: function(e) {
                  var t = this.extractState(e);
                  this.sceneManager.setProperties({
                    elementID: this.elementID,
                    properties: t,
                    notify: !1
                  });
                }
              },
              {
                key: "_onComplete",
                value: function(e) {
                  var t = this.extractState(e);
                  this.sceneManager.setProperties({
                    elementID: this.elementID,
                    properties: t
                  });
                }
              },
              {
                key: "prepareState",
                value: function(e) {
                  return e.reduce(function(e, t) {
                    return (
                      Array.isArray(t.value)
                        ? t.value.forEach(function(n, r) {
                            e["_".concat(t.key, "_").concat(r)] = n;
                          })
                        : (e[t.key] = t.value),
                      e
                    );
                  }, {});
                }
              },
              {
                key: "extractState",
                value: function(e) {
                  return this.startProperties.map(function(t) {
                    if (void 0 !== e[t.key]) t.value = e[t.key];
                    else {
                      var n = [];
                      t.value.forEach(function(r, i) {
                        var a = "_".concat(t.key, "_").concat(i);
                        n.push(e[a]);
                      }),
                        (t.value = n);
                    }
                    return t;
                  });
                }
              },
              {
                key: "_getTWEENEasing",
                value: function(e) {
                  switch (e) {
                    case "LinearNone":
                      return fv.a.Easing.Linear.None;
                    case "QuadraticIn":
                      return fv.a.Easing.Quadratic.In;
                    case "QuadraticOut":
                      return fv.a.Easing.Quadratic.Out;
                    case "QuadraticInOut":
                      return fv.a.Easing.Quadratic.InOut;
                    case "CubicIn":
                      return fv.a.Easing.Cubic.In;
                    case "CubicOut":
                      return fv.a.Easing.Cubic.Out;
                    case "CubicInOut":
                      return fv.a.Easing.Cubic.InOut;
                    case "QuarticIn":
                      return fv.a.Easing.Quartic.In;
                    case "QuarticOut":
                      return fv.a.Easing.Quartic.Out;
                    case "QuarticInOut":
                      return fv.a.Easing.Quartic.InOut;
                    case "QuinticIn":
                      return fv.a.Easing.Quintic.In;
                    case "QuinticOut":
                      return fv.a.Easing.Quintic.Out;
                    case "QuinticInOut":
                      return fv.a.Easing.Quintic.InOut;
                    case "SinusoidalIn":
                      return fv.a.Easing.Sinusoidal.In;
                    case "SinusoidalOut":
                      return fv.a.Easing.Sinusoidal.Out;
                    case "SinusoidalInOut":
                      return fv.a.Easing.Sinusoidal.InOut;
                    case "ExponentialIn":
                      return fv.a.Easing.Exponential.In;
                    case "ExponentialOut":
                      return fv.a.Easing.Exponential.Out;
                    case "ExponentialInOut":
                      return fv.a.Easing.Exponential.InOut;
                    case "CircularIn":
                      return fv.a.Easing.Circular.In;
                    case "CircularOut":
                      return fv.a.Easing.Circular.Out;
                    case "CircularInOut":
                      return fv.a.Easing.Circular.InOut;
                    case "ElasticIn":
                      return fv.a.Easing.Elastic.In;
                    case "ElasticOut":
                      return fv.a.Easing.Elastic.Out;
                    case "ElasticInOut":
                      return fv.a.Easing.Elastic.InOut;
                    case "BackIn":
                      return fv.a.Easing.Back.In;
                    case "BackOut":
                      return fv.a.Easing.Back.Out;
                    case "BackInOut":
                      return fv.a.Easing.Back.InOut;
                    case "BounceIn":
                      return fv.a.Easing.Bounce.In;
                    case "BounceOut":
                      return fv.a.Easing.Bounce.Out;
                    case "BounceInOut":
                      return fv.a.Easing.Bounce.InOut;
                    default:
                      return fv.a.Easing.Linear.None;
                  }
                }
              },
              {
                key: "dispose",
                value: function() {
                  this.tween = null;
                }
              },
              {
                key: "startProperties",
                get: function() {
                  return this._startProperties;
                }
              },
              {
                key: "endProperties",
                get: function() {
                  return this._endProperties;
                }
              }
            ]) && jx(n.prototype, r),
            i && jx(n, i),
            t
          );
        })(kx);
        function Hx(e) {
          return (Hx =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Xx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function Wx(e, t) {
          return !t || ("object" !== Hx(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function Yx(e) {
          return (Yx = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function qx(e, t) {
          return (qx =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var Qx = (function(e) {
          function t(e) {
            var n,
              r = e.sceneManager,
              i = e.type;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = Wx(
                this,
                Yx(t).call(this, { sceneManager: r, type: i })
              )).children = []),
              (n.tween = null),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && qx(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "execute",
                value: function() {
                  var e = this;
                  return new Promise(function(t, n) {
                    (e.tween = e._prepare(
                      e.startProperties,
                      e.endProperties,
                      t
                    )),
                      e.tween.start();
                  });
                }
              },
              {
                key: "_prepare",
                value: function(e, t, n) {
                  var r = this,
                    i = null,
                    a = null,
                    o = null;
                  return (
                    this.children.forEach(function(s, l) {
                      (i = t),
                        (t = s.endProperties),
                        (e = 0 === l ? s.startProperties : i),
                        (o = s._prepare(e, t)).onUpdate(s.onUpdate),
                        o.onComplete(function(e) {
                          s.onComplete(e),
                            l === r.children.length - 1 && n && n(!0);
                        }),
                        0 === l ? (a = o) : a.chain(o);
                    }),
                    a
                  );
                }
              },
              { key: "_onUpdate", value: function(e) {} },
              { key: "_onComplete", value: function(e) {} },
              { key: "dispose", value: function() {} },
              {
                key: "startProperties",
                get: function() {
                  return this.children.length > 0
                    ? this.children[0].startProperties
                    : null;
                }
              },
              {
                key: "endProperties",
                get: function() {
                  return this.children.length > 0
                    ? this.children[this.children.length - 1].endProperties
                    : null;
                }
              }
            ]) && Xx(n.prototype, r),
            i && Xx(n, i),
            t
          );
        })(kx);
        function Zx(e) {
          return (Zx =
            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
              ? function(e) {
                  return typeof e;
                }
              : function(e) {
                  return e &&
                    "function" == typeof Symbol &&
                    e.constructor === Symbol &&
                    e !== Symbol.prototype
                    ? "symbol"
                    : typeof e;
                })(e);
        }
        function Jx(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function Kx(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        function $x(e, t) {
          return !t || ("object" !== Zx(t) && "function" != typeof t)
            ? (function(e) {
                if (void 0 === e)
                  throw new ReferenceError(
                    "this hasn't been initialised - super() hasn't been called"
                  );
                return e;
              })(e)
            : t;
        }
        function ew(e) {
          return (ew = Object.setPrototypeOf
            ? Object.getPrototypeOf
            : function(e) {
                return e.__proto__ || Object.getPrototypeOf(e);
              })(e);
        }
        function tw(e, t) {
          return (tw =
            Object.setPrototypeOf ||
            function(e, t) {
              return (e.__proto__ = t), e;
            })(e, t);
        }
        var nw = (function(e) {
          function t(e) {
            var n,
              r = e.sceneManager,
              i = e.type;
            return (
              (function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, t),
              ((n = $x(
                this,
                ew(t).call(this, { sceneManager: r, type: i })
              )).children = []),
              (n.tween = null),
              (n.numCompleted = 0),
              (n.completed = !1),
              n
            );
          }
          var n, r, i;
          return (
            (function(e, t) {
              if ("function" != typeof t && null !== t)
                throw new TypeError(
                  "Super expression must either be null or a function"
                );
              (e.prototype = Object.create(t && t.prototype, {
                constructor: { value: e, writable: !0, configurable: !0 }
              })),
                t && tw(e, t);
            })(t, e),
            (n = t),
            (r = [
              {
                key: "execute",
                value: function() {
                  var e = this;
                  return new Promise(function(t, n) {
                    (e.tween = e._prepare(
                      e.startProperties,
                      e.endProperties,
                      t
                    )),
                      e.tween.start();
                  });
                }
              },
              {
                key: "_prepare",
                value: function(e, t, n) {
                  var r = this;
                  this.numCompleted = 0;
                  var i = [];
                  this.children.forEach(function(a, o) {
                    var s = null;
                    (e = a.startProperties),
                      (t = a.endProperties),
                      (s = a._prepare(e, t)).onUpdate(a.onUpdate),
                      s.onComplete(function(e) {
                        a.onComplete(e),
                          (r.numCompleted += 1),
                          r.numCompleted === r.children.length &&
                            ((r.completed = !0), n && n(!0));
                      }),
                      (i = [].concat(Jx(i), [s]));
                  });
                  var a = new fv.a.Tween({ x: 0 }).to({ x: 0 }, 0);
                  return a.chain.apply(a, Jx(i));
                }
              },
              { key: "_onUpdate", value: function(e) {} },
              { key: "_onComplete", value: function(e) {} },
              { key: "dispose", value: function() {} },
              {
                key: "startProperties",
                get: function() {
                  return this.children.length > 0
                    ? this.children[0].startProperties
                    : null;
                }
              },
              {
                key: "endProperties",
                get: function() {
                  return this.children.length > 0
                    ? this.children[0].endProperties
                    : null;
                }
              }
            ]) && Kx(n.prototype, r),
            i && Kx(n, i),
            t
          );
        })(kx);
        function rw(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function iw(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? rw(Object(n), !0).forEach(function(t) {
                  aw(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : rw(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function aw(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function ow(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var sw = (function() {
          function e() {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e);
          }
          var t, n, r;
          return (
            (t = e),
            (r = [
              {
                key: "createTransition",
                value: function(e) {
                  switch (e.type) {
                    case "BasicTransition":
                      return new Gx(iw({}, e));
                    case "SerialTransition":
                      return new Qx(iw({}, e));
                    case "ConcurrentTransition":
                      return new nw(iw({}, e));
                    default:
                      return null;
                  }
                }
              }
            ]),
            (n = null) && ow(t.prototype, n),
            r && ow(t, r),
            e
          );
        })();
        function lw(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function cw(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function uw(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? cw(Object(n), !0).forEach(function(t) {
                  hw(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : cw(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function hw(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function dw(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var pw = (function() {
            function e() {
              !(function(e, t) {
                if (!(e instanceof t))
                  throw new TypeError("Cannot call a class as a function");
              })(this, e);
            }
            var t, n, r;
            return (
              (t = e),
              (n = [
                {
                  key: "init",
                  value: function(e) {
                    var t = this,
                      n = e.version,
                      r = e.containerID,
                      i = e.rendererID,
                      a = e.cameraID,
                      o = e.environmentID,
                      s = e.cameras,
                      l = void 0 === s ? [] : s,
                      c = e.controls,
                      u = void 0 === c ? [] : c,
                      h = e.models,
                      d = void 0 === h ? [] : h,
                      p = e.materials,
                      f = void 0 === p ? [] : p,
                      m = e.textures,
                      v = void 0 === m ? [] : m,
                      g = e.lights,
                      y = void 0 === g ? [] : g,
                      b = e.meshNodes,
                      x = void 0 === b ? [] : b,
                      w = e.annotations,
                      _ = void 0 === w ? [] : w,
                      M = e.TUFProvider,
                      T = void 0 === M ? null : M,
                      A = e.assetManager,
                      S = void 0 === A ? null : A,
                      E = e.onEntityUpdated,
                      R = void 0 === E ? null : E,
                      P = e.onLoadingChanged,
                      I = void 0 === P ? null : P,
                      D = e.onPointerMove,
                      O = void 0 === D ? null : D,
                      C = e.onPointerClick,
                      L = void 0 === C ? null : C,
                      N = e.clickTimeout,
                      F = void 0 === N ? 250 : N,
                      k = e.hoverPeriod,
                      U = void 0 === k ? 50 : k,
                      j = e.preloadMaterialsForModels,
                      B = void 0 !== j && j;
                    e.testUrl, (this.clock = new nf()), this.clock.start();
                    var z = {},
                      V = [],
                      G = [];
                    return Promise.resolve(!0)
                      .then(function() {
                        (t.version = n),
                          (t.onEntityUpdated = R),
                          (t.onLoadingChanged = I),
                          (t.onPointerMove = O),
                          (t.onPointerClick = L),
                          (t.provider = new Nx(T));
                        var e = t.provider.getEntity("renderer", i),
                          a =
                            "Transparent" ===
                            (z = t.provider.getEntity("environment", o)).config
                              .bgType,
                          s = uw({}, e.config, {
                            alpha: a,
                            onRenderStateChanged: function(e) {
                              t._onRenderStateChanged(e);
                            }
                          }),
                          l = {
                            onElementChanged: function(e) {
                              t._onElementChanged(e);
                            }
                          };
                        return (
                          (t.viewer3d = new Tx({
                            general: {
                              containerID: r,
                              clickTimeout: F,
                              hoverPeriod: U
                            },
                            renderer: s,
                            scene: l,
                            assetManager: S,
                            onMouseMove: function(e) {
                              t._onMouseMove(e);
                            },
                            onMouseClick: function(e) {
                              t._onMouseClick(e);
                            },
                            onLoadingChanged: function(e) {
                              t._onLoadingChanged(e);
                            }
                          })),
                          !0
                        );
                      })
                      .then(function() {
                        return t.viewer3d.init({
                          bgType: z.config.bgType,
                          bgColor: z.config.bgColor
                        });
                      })
                      .then(function() {
                        return (
                          t.viewer3d.onWindowResize(!0),
                          t.viewer3d.resume(!0),
                          t.viewer3d.pause(),
                          !0
                        );
                      })
                      .then(function() {
                        var e = t.getModelsForMeshNodes(x);
                        (G = [].concat(lw(d), lw(e))), (G = lw(new Set(G)));
                        var n = t._getNodesForEntities(x, "meshNode"),
                          r = t._getNodesForEntities(_, "annotation"),
                          i = t.getMeshNodesForModels(G),
                          a = B ? t._getNodesForEntities(i, "meshNode") : [],
                          o = t.getMaterialsForNodes(
                            [].concat(lw(n), lw(r), lw(a))
                          );
                        o = lw(new Set(o));
                        var s = t.getTexturesForMaterials(f),
                          l = t.getTexturesForMaterials(o);
                        (V = [].concat(lw(v), lw(s), lw(l))),
                          z.envMapID && (V = [].concat(lw(V), [z.envMapID])),
                          (V = lw(new Set(V)));
                        var c = [];
                        return (
                          G.forEach(function(e) {
                            c = [].concat(lw(c), [
                              t.registerAssets(e, "model")
                            ]);
                          }),
                          V.forEach(function(e) {
                            c = [].concat(lw(c), [
                              t.registerAssets(e, "texture")
                            ]);
                          }),
                          t.viewer3d.assetManager.loadGroup(c)
                        );
                      })
                      .then(function() {
                        return t.activateCameras(l);
                      })
                      .then(function() {
                        return Promise.all([
                          t.activateCamera(a, !0),
                          t.activateLights(y),
                          t.activateEnvironment(o),
                          t.addTextures(V),
                          t.addModels(G)
                        ]);
                      })
                      .then(function() {
                        return t.activateMeshNodes(x);
                      })
                      .then(function() {
                        return t.activateAnnotations(_);
                      })
                      .then(function() {
                        var e = u.map(function(e) {
                          return t.activateControls(e);
                        });
                        return Promise.all(e);
                      })
                      .then(function() {
                        return (
                          t.viewer3d.onWindowResize(!0),
                          t.viewer3d.resume(!0),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "isEntityAdded",
                  value: function(e, t) {
                    return (
                      0 !== this.provider.getEntity(t, e)._ref.fetchCounter
                    );
                  }
                },
                {
                  key: "registerAssets",
                  value: function(e, t) {
                    var n = this,
                      r = this.provider.getEntity(t, e);
                    if ("model" === t) {
                      var i = this.provider.getEntity("asset", r.assetID);
                      return this.viewer3d.assetManager.register(
                        uw({}, i.config)
                      );
                    }
                    if ("material" === t)
                      this.getTexturesForMaterials([e]).forEach(function(e) {
                        n.registerAssets(e, "texture");
                      });
                    else if ("texture" === t) {
                      if (r.assetIDs) {
                        var a = [];
                        return (
                          r.assetIDs.forEach(function(e) {
                            var t = n.provider.getEntity("asset", e);
                            a = [].concat(lw(a), [uw({}, t.config)]);
                          }),
                          this.viewer3d.assetManager.registerCube(a)
                        );
                      }
                      var o = this.provider.getEntity("asset", r.assetID);
                      return this.viewer3d.assetManager.register(
                        uw({}, o.config)
                      );
                    }
                    return null;
                  }
                },
                {
                  key: "addModel",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("model", e),
                      r = {},
                      i = null;
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var a = Promise.resolve(!0)
                      .then(function() {
                        return (
                          (i = t.registerAssets(e, "model")),
                          t._createModelNodeInfo(n.rootNodeID, r),
                          !0
                        );
                      })
                      .then(function() {
                        return t.viewer3d.sceneManager.addElement({
                          type: "Model",
                          config: { assetID: i, nodeInfo: r }
                        });
                      })
                      .then(function(r) {
                        var i = r.elUuid;
                        (n = t.provider.getEntity("model", e)),
                          t.provider.setEntity("model", e, {
                            _ref: {
                              refID: i,
                              fetchCounter: n._ref.fetchCounter + 1
                            }
                          });
                        var a = t.viewer3d.sceneManager.getElementInfo(i),
                          o = {};
                        return (
                          Object.keys(a.nodes).forEach(function(e) {
                            o[a.nodes[e].userData.id] = e;
                          }),
                          t._createRefsForMeshNodes(n.rootNodeID, o),
                          !0
                        );
                      })
                      .then(function() {
                        return {
                          uuid: (n = t.provider.getEntity("model", e))._ref
                            .refID
                        };
                      })
                      .catch(function(n) {
                        throw (t.provider.setEntity("model", e, {
                          _ref: t.provider.createDefaultRef()
                        }),
                        n);
                      });
                    return (
                      this.provider.setEntity("model", e, {
                        _ref: { fetchPromise: a }
                      }),
                      a
                    );
                  }
                },
                {
                  key: "dispose",
                  value: function() {
                    return this.viewer3d.dispose();
                  }
                },
                {
                  key: "removeModel",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve()
                      .then(function() {
                        t.getMeshNodesForModels([e]);
                        var n = t.provider.getEntity("model", e);
                        t._releaseRefsForMeshNodes(n.rootNodeID);
                        var r = n._ref.refID;
                        return (
                          t.provider.setEntity("model", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          t.viewer3d.sceneManager.removeElement({ elUuid: r })
                        );
                      })
                      .then(function(e) {
                        return { elUuid: e.elUuid };
                      });
                  }
                },
                {
                  key: "removeModels",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = t.map(function(t) {
                        return e.removeModel(t);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "addModels",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [];
                    return (
                      t.forEach(function(t) {
                        e.registerAssets(t, "model");
                      }),
                      t.reduce(function(t, n) {
                        return t.then(function() {
                          return e.addModel(n);
                        });
                      }, Promise.resolve(!0))
                    );
                  }
                },
                {
                  key: "getAddedModels",
                  value: function() {
                    var e = this,
                      t = this.provider.getAllIds("model").filter(function(t) {
                        return (
                          0 !==
                          e.provider.getEntity("model", t)._ref.fetchCounter
                        );
                      });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "activateModels",
                  value: function() {
                    var e =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      t =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1],
                      n = this.getMeshNodesForModels(e);
                    return this.activateMeshNodes(n, t);
                  }
                },
                {
                  key: "getModelsForMeshNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = t.map(function(t) {
                        return e.provider.getEntity("meshNode", t).modelID;
                      });
                    return lw(new Set(n));
                  }
                },
                {
                  key: "getMeshNodesForModels",
                  value: function(e) {
                    var t = this,
                      n = [];
                    return (
                      e.forEach(function(e) {
                        var r = t.provider.getEntity("model", e).rootNodeID;
                        t._traverseNodes(r, function(e) {
                          n = [].concat(lw(n), [e]);
                        });
                      }),
                      lw(new Set(n))
                    );
                  }
                },
                {
                  key: "addMeshNode",
                  value: function(e) {
                    var t = this.provider.getEntity("meshNode", e);
                    return this.addModel(t.modelID);
                  }
                },
                {
                  key: "getAddedMeshNodes",
                  value: function() {
                    var e = this.getAddedModels();
                    return Promise.resolve(this.getMeshNodesForModels(e));
                  }
                },
                {
                  key: "activateMeshNode",
                  value: function(e) {
                    var t = this,
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1];
                    return Promise.resolve(!0)
                      .then(function() {
                        return !n || t._prepareMeshNode(e);
                      })
                      .then(function() {
                        return (
                          (!n && !t.isEntityAdded(e, "meshNode")) ||
                          t.setIfMeshNodeActive(e, n)
                        );
                      })
                      .then(function() {
                        return !0;
                      });
                  }
                },
                {
                  key: "activateMeshNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1];
                    return Promise.resolve(!0)
                      .then(function() {
                        if (n) {
                          var r = t.map(function(t) {
                            return e._prepareMeshNode(t);
                          });
                          return Promise.all(r);
                        }
                        return !0;
                      })
                      .then(function() {
                        var r = t.map(function(t) {
                          return e.activateMeshNode(t, n);
                        });
                        return Promise.all(r);
                      });
                  }
                },
                {
                  key: "addTexture",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("texture", e),
                      r = {};
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var i = Promise.resolve(!0)
                      .then(function() {
                        var i = t.provider.getEntity(
                            "textureType",
                            n.textureTypeID
                          ).nameUQ,
                          a = t._getActiveRenderer(),
                          o = t.provider.getEntity("renderer", a);
                        return (
                          (r = {
                            textureType: i,
                            resolution: n.config.resolution || null,
                            useLegacy: !(
                              !o.config.useLegacyEnvMaps && !n.config.useLegacy
                            ),
                            assetID: t.registerAssets(e, "texture"),
                            userData: t._createUserData(e, "texture")
                          }),
                          !0
                        );
                      })
                      .then(function() {
                        return t.viewer3d.sceneManager.addElement({
                          type: "Texture",
                          config: r
                        });
                      })
                      .then(function(r) {
                        var i = r.elUuid;
                        return (
                          (n = t.provider.getEntity("texture", e)),
                          t.provider.setEntity("texture", e, {
                            _ref: {
                              refID: i,
                              fetchCounter: n._ref.fetchCounter + 1
                            }
                          }),
                          !0
                        );
                      })
                      .then(function() {
                        return t.updateEntityConfig(e, "texture", null, !1);
                      })
                      .then(function() {
                        return {
                          uuid: (n = t.provider.getEntity("texture", e))._ref
                            .refID
                        };
                      })
                      .catch(function(n) {
                        throw (t.provider.setEntity("texture", e, {
                          _ref: { fetchPromise: null }
                        }),
                        n);
                      });
                    return (
                      this.provider.setEntity("texture", e, {
                        _ref: { fetchPromise: i }
                      }),
                      i
                    );
                  }
                },
                {
                  key: "getAddedTextures",
                  value: function() {
                    var e = this,
                      t = this.provider
                        .getAllIds("texture")
                        .filter(function(t) {
                          return (
                            0 !==
                            e.provider.getEntity("texture", t)._ref.fetchCounter
                          );
                        });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "addTextures",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [];
                    t.forEach(function(t) {
                      e.registerAssets(t, "texture");
                    });
                    var n = t.map(function(t) {
                      return e.addTexture(t);
                    });
                    return Promise.all(n);
                  }
                },
                {
                  key: "removeTexture",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        var n = t.provider.getEntity("texture", e)._ref.refID;
                        return (
                          t.provider.setEntity("texture", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          t.viewer3d.sceneManager.removeElement({ elUuid: n })
                        );
                      })
                      .then(function(e) {
                        return { elUuid: e.elUuid };
                      });
                  }
                },
                {
                  key: "getTexturesForMaterial",
                  value: function(e) {
                    var t = this.provider.getEntity("material", e),
                      n = this._getMapTypesForMaterial(e).map(function(e) {
                        return t[e];
                      });
                    return lw(new Set(n));
                  }
                },
                {
                  key: "getTexturesForMaterials",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = [];
                    return (
                      t.forEach(function(t) {
                        var r = e.getTexturesForMaterial(t);
                        n = [].concat(lw(n), lw(r));
                      }),
                      lw(new Set(n))
                    );
                  }
                },
                {
                  key: "removeTextures",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.removeTexture(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "addMaterial",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("material", e),
                      r = {};
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var i = this.provider.getEntity(
                        "materialType",
                        n.materialTypeID
                      ).nameUQ,
                      a = Promise.resolve()
                        .then(function() {
                          if (
                            (t.registerAssets(e, "material"),
                            "CompoundMaterial" !== i)
                          ) {
                            var n = t.getTexturesForMaterial(e);
                            return t.addTextures(n);
                          }
                          return !0;
                        })
                        .then(function() {
                          return t.addMaterials(n.materialIDs);
                        })
                        .then(function() {
                          var a = t._createUserData(e, "material");
                          return (
                            (r = { type: i, userData: a }),
                            "CompoundMaterial" === i &&
                              (r.materialIDs = n.materialIDs.map(function(e) {
                                return t.provider.getEntity(
                                  "material",
                                  e
                                )._ref.refID;
                              })),
                            !0
                          );
                        })
                        .then(function() {
                          return t.viewer3d.sceneManager.addMaterial(r);
                        })
                        .then(function(r) {
                          var i = r.elUuid;
                          return (
                            (n = t.provider.getEntity("material", e)),
                            t.provider.setEntity("material", e, {
                              _ref: {
                                refID: i,
                                fetchCounter: n._ref.fetchCounter + 1
                              }
                            }),
                            !0
                          );
                        })
                        .then(function() {
                          return t.updateEntityConfig(e, "material", null, !1);
                        })
                        .then(function() {
                          return (
                            (n = t.provider.getEntity("material", e)),
                            t._getMapTypesForMaterial(e).forEach(function(e) {
                              var r = t.provider.getEntity("texture", n[e]),
                                i = r._ref.refID;
                              t.viewer3d.sceneManager.setMapForMaterial({
                                materialUuid: n._ref.refID,
                                textureUuid: i,
                                mapType: t._getViewer3DMapType(e),
                                config: r.config
                              });
                            }),
                            { uuid: n._ref.refID }
                          );
                        })
                        .catch(function(n) {
                          throw (t.provider.setEntity("material", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          n);
                        });
                    return (
                      this.provider.setEntity("material", e, {
                        _ref: { fetchPromise: a }
                      }),
                      a
                    );
                  }
                },
                {
                  key: "addMaterials",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [];
                    t.forEach(function(t) {
                      e.registerAssets(t, "material");
                    });
                    var n = t.map(function(t) {
                      return e.addMaterial(t);
                    });
                    return Promise.all(n);
                  }
                },
                {
                  key: "removeMaterial",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        var n = t.provider.getEntity("material", e)._ref.refID;
                        return (
                          t.provider.setEntity("material", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          t.viewer3d.sceneManager.removeElement({ elUuid: n })
                        );
                      })
                      .then(function(e) {
                        return { elUuid: e.elUuid };
                      });
                  }
                },
                {
                  key: "removeMaterials",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.removeMaterial(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "getAddedMaterials",
                  value: function() {
                    var e = this,
                      t = this.provider
                        .getAllIds("material")
                        .filter(function(t) {
                          return (
                            0 !==
                            e.provider.getEntity("material", t)._ref
                              .fetchCounter
                          );
                        });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "setMaterialForNode",
                  value: function(e, t) {
                    var n = this,
                      r = this.provider.getRelatedEntity(
                        "node",
                        e,
                        "relEntity"
                      );
                    if (!r.materialID)
                      throw new Error(
                        "Can't set material to node "
                          .concat(r.id, ", entity ")
                          .concat(r.entity)
                      );
                    if (
                      !this._isEntityActivated(r.id, r.entity) ||
                      this._getCurrentMaterial(e) === r.materialID
                    )
                      return Promise.resolve(!0);
                    var i = function(e) {
                      var t = r._ref.refID;
                      n.viewer3d.sceneManager.setMaterialForObject({
                        objUuid: t,
                        materialUuid: e
                      });
                    };
                    return Promise.resolve(!0)
                      .then(function() {
                        return null === t || n.addMaterial(t);
                      })
                      .then(function() {
                        if (null !== t) {
                          var e = n.provider.getEntity("material", t)._ref
                            .refID;
                          return i(e), !0;
                        }
                        return i(null), !0;
                      });
                  }
                },
                {
                  key: "setMaterialForMeshNode",
                  value: function(e, t) {
                    var n = this;
                    return this._isEntityActivated(e, "meshNode")
                      ? Promise.resolve(!0).then(function() {
                          var r = n.provider.getEntity("meshNode", e),
                            i = n.provider.getEntity(
                              "meshNodeType",
                              r.meshNodeTypeID
                            );
                          if ("Mesh" !== i.nameUQ)
                            throw new Error(
                              "Trying to set material for mesh node "
                                .concat(e, " of type ")
                                .concat(i.nameUQ)
                            );
                          return n.setMaterialForNode(r.nodeID, t);
                        })
                      : Promise.resolve(!0);
                  }
                },
                {
                  key: "setMaterialForAnnotations",
                  value: function(e, t) {
                    var n = this,
                      r = e
                        .filter(function(e) {
                          return n._isEntityActivated(e, "annotation");
                        })
                        .map(function(e) {
                          return n.provider.getEntity("annotation", e).nodeID;
                        });
                    return this.setMaterialForNodes(r, t);
                  }
                },
                {
                  key: "setMaterialForModels",
                  value: function() {
                    var e =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      t = arguments.length > 1 ? arguments[1] : void 0,
                      n = this.getMeshNodesForModels(e);
                    return this.setMaterialForMeshNodes(n, t);
                  }
                },
                {
                  key: "setMaterialForNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = arguments.length > 1 ? arguments[1] : void 0,
                      r = t.map(function(t) {
                        return e.setMaterialForNode(t, [n]);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "setMaterialForMeshNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = arguments.length > 1 ? arguments[1] : void 0,
                      r = t.map(function(t) {
                        return e.setMaterialForMeshNode(t, [n]);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "setMaterialsForMeshNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n =
                        arguments.length > 1 && void 0 !== arguments[1]
                          ? arguments[1]
                          : [],
                      r = t.map(function(t) {
                        return e.setMaterialForMeshNode(t, n);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "getMaterialsForModels",
                  value: function(e) {
                    var t = this,
                      n = [];
                    return (
                      e.forEach(function(e) {
                        var r = t.provider.getEntity("model", e);
                        t._traverseNodes(r.rootNodeID, function(e) {
                          var r = t.provider.getEntity("meshNode", e);
                          r.materialID &&
                            (n = [].concat(lw(n), [r.materialID]));
                        });
                      }),
                      lw(new Set(n))
                    );
                  }
                },
                {
                  key: "getMaterialForMeshNode",
                  value: function(e) {
                    return this.provider.getEntity("meshNode", e).materialID;
                  }
                },
                {
                  key: "getMaterialForNode",
                  value: function(e) {
                    var t = this.provider.getRelatedEntity(
                      "node",
                      e,
                      "relEntity"
                    );
                    return t.materialID ? t.materialID : null;
                  }
                },
                {
                  key: "getMaterialsForNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n = [];
                    return (
                      t.forEach(function(t) {
                        var r = e.getMaterialForNode(t);
                        r && (n = [].concat(lw(n), [r]));
                      }),
                      n
                    );
                  }
                },
                {
                  key: "setChildMaterialsForCompoundMaterial",
                  value: function(e) {
                    var t = this,
                      n =
                        arguments.length > 1 && void 0 !== arguments[1]
                          ? arguments[1]
                          : [];
                    return Promise.resolve(!0)
                      .then(function() {
                        return t.addMaterials(n);
                      })
                      .then(function() {
                        var r = t.provider.getEntity("material", e);
                        if (
                          "CompoundMaterial" !==
                          t.provider.getEntity("materialType", r.materialTypeID)
                            .nameUQ
                        )
                          throw new Error(
                            "Material ".concat(e, " is not compound material")
                          );
                        var i = r._ref.refID,
                          a = n.map(function(e) {
                            return t.provider.getEntity(
                              "material",
                              e
                            )._ref.refID;
                          });
                        return (
                          t.viewer3d.sceneManager.getElement(i).setMaterials(a),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "setMapForModels",
                  value: function(e, t, n) {
                    var r = this.getMeshNodesForModels(e);
                    return this.setMapForMeshNodes(r, t, n);
                  }
                },
                {
                  key: "setMapForMeshNodes",
                  value: function(e, t, n) {
                    var r = this,
                      i = [];
                    return (
                      e.forEach(function(e) {
                        var a = r.getMaterialForMeshNode(e);
                        i = [].concat(lw(i), [r.setMapForMaterial(a, t, n)]);
                      }),
                      Promise.all(i)
                    );
                  }
                },
                {
                  key: "setMapForMaterial",
                  value: function(e, t, n) {
                    var r = this;
                    return this._isEntityActivated(e, "material")
                      ? Promise.resolve(!0)
                          .then(function() {
                            return !t || r.addTexture(t);
                          })
                          .then(function() {
                            var i = r.provider.getEntity("material", e)._ref
                                .refID,
                              a = null;
                            return (
                              t &&
                                (a = r.provider.getEntity("texture", t)._ref
                                  .refID),
                              r.viewer3d.sceneManager.setMapForMaterial({
                                materialUuid: i,
                                textureUuid: a,
                                mapType: r._getViewer3DMapType(n)
                              }),
                              !0
                            );
                          })
                      : Promise.resolve(!0);
                  }
                },
                {
                  key: "updateMapForMaterial",
                  value: function(e, t) {
                    var n = this.provider.getEntity("material", e)[t];
                    return this.setMapForMaterial(e, n, t);
                  }
                },
                {
                  key: "removeMapFromMaterial",
                  value: function(e, t) {
                    return this.setMapForMaterial(e, null, t);
                  }
                },
                {
                  key: "addCamera",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("camera", e),
                      r = this.provider.getEntity("cameraType", n.cameraTypeID);
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var i = this._createUserData(e, "camera"),
                      a = Promise.resolve(!0)
                        .then(function() {
                          return t.viewer3d.sceneManager.addElement({
                            type: "Camera",
                            config: { cameraType: r.nameUQ, userData: i }
                          });
                        })
                        .then(function(r) {
                          var i = r.elUuid;
                          return (
                            (n = t.provider.getEntity("camera", e)),
                            t.provider.setEntity("camera", e, {
                              _ref: {
                                refID: i,
                                fetchCounter: n._ref.fetchCounter + 1
                              }
                            }),
                            !0
                          );
                        })
                        .then(function() {
                          if (n.nodeID) {
                            var e = t.provider.getEntity("node", n.nodeID);
                            return t.setNodeParent(n.nodeID, e.parentID);
                          }
                          return !0;
                        })
                        .then(function() {
                          return t.updateEntityConfig(e, "camera", null, !1);
                        })
                        .then(function() {
                          return {
                            uuid: (n = t.provider.getEntity("camera", e))._ref
                              .refID
                          };
                        })
                        .catch(function(n) {
                          throw (t.provider.setEntity("camera", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          n);
                        });
                    return (
                      this.provider.setEntity("camera", e, {
                        _ref: { fetchPromise: a }
                      }),
                      a
                    );
                  }
                },
                {
                  key: "removeCamera",
                  value: function(e) {
                    var t = this,
                      n = null,
                      r = null;
                    return Promise.resolve(!0)
                      .then(function() {
                        if (
                          ((n = t.provider.getEntity("camera", e)),
                          (r = n._ref.refID),
                          t.viewer3d.sceneManager.currentCameraID === r)
                        )
                          throw new Error(
                            "Can't remove currently used camera ".concat(e)
                          );
                        return !0;
                      })
                      .then(function() {
                        return t.viewer3d.sceneManager.removeElement({
                          elUuid: r
                        });
                      })
                      .then(function(n) {
                        var r = n.elUuid;
                        return (
                          t.provider.setEntity("camera", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          { elUuid: r }
                        );
                      });
                  }
                },
                {
                  key: "addLight",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("light", e),
                      r = this.provider.getEntity("lightType", n.lightTypeID);
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var i = this._createUserData(e, "light"),
                      a = Promise.resolve(!0)
                        .then(function() {
                          return t.viewer3d.sceneManager.addElement({
                            type: "Light",
                            config: { lightType: r.nameUQ, userData: i }
                          });
                        })
                        .then(function(r) {
                          var i = r.elUuid;
                          return (
                            (n = t.provider.getEntity("light", e)),
                            t.provider.setEntity("light", e, {
                              _ref: {
                                refID: i,
                                fetchCounter: n._ref.fetchCounter + 1
                              }
                            }),
                            !0
                          );
                        })
                        .then(function() {
                          if (n.nodeID) {
                            var e = t.provider.getEntity("node", n.nodeID);
                            return t.setNodeParent(n.nodeID, e.parentID);
                          }
                          return !0;
                        })
                        .then(function() {
                          return t.updateEntityConfig(e, "light", null, !1);
                        })
                        .then(function() {
                          var n = t.provider.getEntity("light", e);
                          return (
                            t.viewer3d.sceneManager.setElementActive(
                              n._ref.refID,
                              !1
                            ),
                            { uuid: n._ref.refID }
                          );
                        })
                        .catch(function(n) {
                          throw (t.provider.setEntity("light", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          n);
                        });
                    return (
                      this.provider.setEntity("light", e, {
                        _ref: { fetchPromise: a }
                      }),
                      a
                    );
                  }
                },
                {
                  key: "addLights",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.addLight(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "removeLight",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve()
                      .then(function() {
                        var n = t.provider.getEntity("light", e)._ref.refID;
                        return (
                          t.provider.setEntity("light", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          t.viewer3d.sceneManager.removeElement({ elUuid: n })
                        );
                      })
                      .then(function(e) {
                        return { elUuid: e.elUuid };
                      });
                  }
                },
                {
                  key: "removeLights",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.removeLight(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "getAddedLights",
                  value: function() {
                    var e = this,
                      t = this.provider.getAllIds("light").filter(function(t) {
                        return (
                          0 !==
                          e.provider.getEntity("light", t)._ref.fetchCounter
                        );
                      });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "activateLight",
                  value: function(e) {
                    var t = this,
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1];
                    return Promise.resolve(!0)
                      .then(function() {
                        return !n || t.addLight(e);
                      })
                      .then(function() {
                        return !n || t.updateEntityConfig(e, "light", null, !1);
                      })
                      .then(function() {
                        if (!n && !t.isEntityAdded(e, "light")) return !0;
                        var r = t.provider.getEntity("light", e)._ref.refID;
                        return (
                          t.viewer3d.sceneManager.setElementActive(r, n), !0
                        );
                      });
                  }
                },
                {
                  key: "activateLights",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1],
                      r = t.map(function(t) {
                        return e.activateLight(t, n);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "addAnnotation",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("annotation", e),
                      r = null;
                    if (n._ref.fetchPromise) return n._ref.fetchPromise;
                    var i = Promise.resolve()
                      .then(function() {
                        return t.viewer3d.sceneManager.addElement({
                          type: "Sprite",
                          config: {
                            userData: t._createUserData(e, "annotation")
                          }
                        });
                      })
                      .then(function(i) {
                        var a = i.elUuid;
                        return (
                          (n = t.provider.getEntity("annotation", e)),
                          t.provider.setEntity("annotation", e, {
                            _ref: {
                              refID: a,
                              fetchCounter: n._ref.fetchCounter + 1
                            }
                          }),
                          t.viewer3d.sceneManager.setElementActive(a, !1),
                          (r = t.provider.getEntity("node", n.nodeID)),
                          !0
                        );
                      })
                      .then(function() {
                        return t.setNodeParent(n.nodeID, r.parentID);
                      })
                      .then(function() {
                        return t.setMaterialForNode(n.nodeID, n.materialID);
                      })
                      .then(function() {
                        return t.updateEntityConfig(e, "annotation", null, !1);
                      })
                      .then(function() {
                        return {
                          uuid: (n = t.provider.getEntity("annotation", e))._ref
                            .refID
                        };
                      })
                      .catch(function(n) {
                        throw (t.provider.setEntity("annotation", e, {
                          _ref: t.provider.createDefaultRef()
                        }),
                        n);
                      });
                    return (
                      this.provider.setEntity("annotation", e, {
                        _ref: { fetchPromise: i }
                      }),
                      i
                    );
                  }
                },
                {
                  key: "addAnnotations",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.addAnnotation(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "removeAnnotation",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve()
                      .then(function() {
                        var n = t.provider.getEntity("annotation", e)._ref
                          .refID;
                        return (
                          t.provider.setEntity("annotation", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          t.viewer3d.sceneManager.removeElement({ elUuid: n })
                        );
                      })
                      .then(function(e) {
                        return { elUuid: e.elUuid };
                      });
                  }
                },
                {
                  key: "removeAnnotations",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.removeAnnotation(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "getAddedAnnotations",
                  value: function() {
                    var e = this,
                      t = this.provider
                        .getAllIds("annotation")
                        .filter(function(t) {
                          return (
                            0 !==
                            e.provider.getEntity("annotation", t)._ref
                              .fetchCounter
                          );
                        });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "activateAnnotation",
                  value: function(e) {
                    var t = this,
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1];
                    return Promise.resolve()
                      .then(function() {
                        return !n || t.addAnnotation(e);
                      })
                      .then(function() {
                        if (!n && !t.isEntityAdded(e, "annotation")) return !0;
                        var r = t.provider.getEntity("annotation", e)._ref
                          .refID;
                        return (
                          t.viewer3d.sceneManager.setElementActive(r, n), !0
                        );
                      });
                  }
                },
                {
                  key: "activateAnnotations",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1],
                      r = t.map(function(t) {
                        return e.activateAnnotation(t, n);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "setIfMeshNodeActive",
                  value: function(e, t) {
                    var n = this,
                      r = null,
                      i = null,
                      a = null;
                    return Promise.resolve(!0)
                      .then(function() {
                        return (
                          (r = n.provider.getEntity("meshNode", e)),
                          (i = n.provider.getEntity(
                            "meshNodeType",
                            r.meshNodeTypeID
                          )),
                          (a = r._ref.refID),
                          !0
                        );
                      })
                      .then(function() {
                        return (
                          "Mesh" === i.nameUQ &&
                            n.viewer3d.sceneManager.setElementActive(a, t),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "activateCamera",
                  value: function(e) {
                    var t = this,
                      n =
                        arguments.length > 1 &&
                        void 0 !== arguments[1] &&
                        arguments[1];
                    return Promise.resolve()
                      .then(function() {
                        return t.addCamera(e);
                      })
                      .then(function() {
                        return t.updateEntityConfig(e, "camera", null, !1);
                      })
                      .then(function() {
                        var r = t.provider.getEntity("camera", e);
                        return (
                          n &&
                            t.viewer3d.sceneManager.setCurrentCamera(
                              r._ref.refID
                            ),
                          { elUuid: r._ref.refID }
                        );
                      })
                      .then(function(e) {
                        return e.elUuid, t.viewer3d.onWindowResize(!0), !0;
                      });
                  }
                },
                {
                  key: "deactivateCamera",
                  value: function(e) {
                    return this.removeCamera(e);
                  }
                },
                {
                  key: "activateCameras",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.activateCamera(e, !1);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "deactivateCameras",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.deactivateCamera(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "activateCameraControls",
                  value: function(e) {
                    var t = this;
                    if (this.provider.getEntity("controls", e)._ref.refID)
                      return Promise.resolve(!0);
                    var n = null;
                    return Promise.resolve()
                      .then(function() {
                        return (n = t._getActiveCamera()), !0;
                      })
                      .then(function() {
                        return t.updateEntityConfig(n, "camera", null, !1);
                      })
                      .then(function() {
                        var r = t.provider.getEntity("camera", n)._ref.refID;
                        return t.viewer3d.sceneManager.attachCameraControls({
                          userData: t._createUserData(e, "controls"),
                          cameraID: r
                        });
                      })
                      .then(function(n) {
                        var r = n.elUuid;
                        return (
                          t.provider.setEntity("controls", e, {
                            _ref: { refID: r, fetchCounter: 1 }
                          }),
                          !0
                        );
                      })
                      .then(function() {
                        return t.updateEntityConfig(e, "controls", null, !1);
                      });
                  }
                },
                {
                  key: "deactivateCameraControls",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        var n = t.provider.getEntity("controls", e);
                        return t.viewer3d.sceneManager.detachCameraControls(
                          n._ref.refID
                        );
                      })
                      .then(function() {
                        return (
                          t.provider.setEntity("controls", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "removeCameraControls",
                  value: function(e) {
                    return this.deactivateCameraControls(e);
                  }
                },
                {
                  key: "setCameraControlsTargetCamera",
                  value: function(e, t) {
                    var n = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        var r = n.provider.getEntity("controls", e)._ref.refID,
                          i = n.provider.getEntity("camera", t)._ref.refID;
                        return (
                          n.viewer3d.sceneManager.setCameraControlsTargetCamera(
                            r,
                            i
                          ),
                          !0
                        );
                      })
                      .then(function() {
                        return n.updateEntityConfig(t, "camera");
                      })
                      .then(function() {
                        return n.updateEntityConfig(e, "controls");
                      });
                  }
                },
                {
                  key: "setCameraControlsTargetNode",
                  value: function(e, t) {
                    var n = this;
                    return Promise.resolve(!0).then(function() {
                      var r = n.provider.getEntity("controls", e)._ref.refID,
                        i = null;
                      if (t) {
                        var a = n._getMeshNodeForNode(t);
                        i = n.provider.getEntity("meshNode", a.id)._ref.refID;
                      }
                      return (
                        n.viewer3d.sceneManager.setCameraControlsTargetElement(
                          r,
                          i
                        ),
                        !0
                      );
                    });
                  }
                },
                {
                  key: "addNode",
                  value: function(e) {
                    if (null === e) return Promise.resolve(!0);
                    var t = this.provider.getRelatedEntity(
                      "node",
                      e,
                      "relEntity"
                    );
                    switch (t.entity) {
                      case "meshNode":
                        return this.addMeshNode(t.id);
                      case "annotation":
                        return this.addAnnotation(t.id);
                      case "light":
                        return this.addLight(t.id);
                      case "camera":
                        return this.addCamera(t.id);
                      default:
                        return Promise.resolve(!0);
                    }
                  }
                },
                {
                  key: "addNodes",
                  value: function(e) {
                    var t = this,
                      n = e.map(function(e) {
                        return t.addNode(e);
                      });
                    return Promise.all(n);
                  }
                },
                {
                  key: "getAddedNodes",
                  value: function() {
                    var e = this,
                      t = this.provider.getAllIds("node").filter(function(t) {
                        return (
                          0 !==
                          e.provider.getRelatedEntity("node", t, "relEntity")
                            ._ref.fetchCounter
                        );
                      });
                    return Promise.resolve(t);
                  }
                },
                {
                  key: "activateNode",
                  value: function(e) {
                    var t =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1],
                      n = this.provider.getRelatedEntity(
                        "node",
                        e,
                        "relEntity"
                      );
                    switch (n.entity) {
                      case "meshNode":
                        return this.activateMeshNode(n.id, t);
                      case "annotation":
                        return this.activateAnnotation(n.id, t);
                      case "light":
                        return this.activateLight(n.id, t);
                      case "camera":
                        return this.activateCamera(n.id);
                      default:
                        return Promise.resolve(!0);
                    }
                  }
                },
                {
                  key: "activateNodes",
                  value: function() {
                    var e = this,
                      t =
                        arguments.length > 0 && void 0 !== arguments[0]
                          ? arguments[0]
                          : [],
                      n =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1],
                      r = t.map(function(t) {
                        return e.activateNode(t, n);
                      });
                    return Promise.all(r);
                  }
                },
                {
                  key: "setNodeParent",
                  value: function(e) {
                    var t = this,
                      n =
                        arguments.length > 1 && void 0 !== arguments[1]
                          ? arguments[1]
                          : null;
                    this.getAddedNodes().then(function(t) {
                      if (!t.includes(e))
                        throw new Error("Node ".concat(e, " is not added"));
                    });
                    var r = this.provider.getRelatedEntity(
                      "node",
                      e,
                      "relEntity"
                    );
                    return n
                      ? this.addNode(n)
                          .then(function() {
                            var r = t.isNodeActive(e);
                            return !r || t.activateNode(n, r);
                          })
                          .then(function() {
                            var e = t.provider.getRelatedEntity(
                              "node",
                              n,
                              "relEntity"
                            );
                            t.viewer3d.sceneManager.setParentElement({
                              elementID: r._ref.refID,
                              parentID: e._ref.refID
                            });
                            var i = t.provider.getEntity("node", n);
                            return t.setNodeParent(n, i.parentID);
                          })
                      : (this.viewer3d.sceneManager.setParentElement({
                          elementID: r._ref.refID,
                          parentID: null
                        }),
                        Promise.resolve(!0));
                  }
                },
                {
                  key: "isNodeActive",
                  value: function(e) {
                    var t = this.provider.getRelatedEntity(
                      "node",
                      e,
                      "relEntity"
                    )._ref.refID;
                    return t && this.viewer3d.sceneManager.isElementActive(t);
                  }
                },
                {
                  key: "activateRenderer",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0).then(function() {
                      var n = t.provider.getEntity("renderer", e);
                      return t.viewer3d.resetRenderer(n.config), !0;
                    });
                  }
                },
                {
                  key: "activateEnvironment",
                  value: function(e) {
                    var t = this;
                    if (!e) throw new Error("Invalid environment ID");
                    return Promise.resolve(!0)
                      .then(function() {
                        return t.updateEntityConfig(e, "environment", null, !1);
                      })
                      .then(function(e) {
                        return e;
                      });
                  }
                },
                {
                  key: "setMapForEnvironment",
                  value: function(e, t) {
                    var n = this;
                    return Promise.resolve()
                      .then(function() {
                        return !t || n.addTexture(t);
                      })
                      .then(function() {
                        var r = null;
                        t &&
                          (r = n.provider.getEntity("texture", t)._ref.refID);
                        var i = n.provider.getEntity("environment", e),
                          a = n._getEnvironmentSubConfig(i.config, "bg");
                        return (
                          n.viewer3d.sceneManager.setBackground(
                            uw({}, a, { textureID: r })
                          ),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "updateEntityConfig",
                  value: function(e, t) {
                    var n = this,
                      r =
                        arguments.length > 2 && void 0 !== arguments[2]
                          ? arguments[2]
                          : null,
                      i =
                        !(arguments.length > 3 && void 0 !== arguments[3]) ||
                        arguments[3];
                    return Promise.resolve(!0).then(function() {
                      if (!e) throw new Error("Invalid enitity ID");
                      var a = n.provider.getEntity(t, e),
                        o = null !== r ? r : a.config,
                        s = Object.keys(o)
                          .filter(function(e) {
                            return !e.startsWith("HQ");
                          })
                          .reduce(function(e, t) {
                            return (e[t] = o[t]), e;
                          }, {});
                      if ("environment" === t)
                        return n._updateEnvironmentProperties(e, s, i);
                      if ("renderer" === t)
                        return n._updateRendererProperties(e, s, i);
                      if (a._ref.refID) {
                        var l = a._ref.refID,
                          c = n._getTypeForProperties(e, t);
                        return n._updateProperties(l, c, s, !0, i);
                      }
                      return !0;
                    });
                  }
                },
                {
                  key: "updateEntitiesConfig",
                  value: function(e, t) {
                    var n = this,
                      r =
                        arguments.length > 2 && void 0 !== arguments[2]
                          ? arguments[2]
                          : null,
                      i =
                        !(arguments.length > 3 && void 0 !== arguments[3]) ||
                        arguments[3],
                      a = e.map(function(e) {
                        return n.updateEntityConfig(e, t, r, i);
                      });
                    return Promise.all(a);
                  }
                },
                {
                  key: "activateEffect",
                  value: function(e, t, n, r) {
                    var i = this;
                    return Promise.resolve(!0).then(function() {
                      var a = i._getElementsForNodes(n);
                      return i.viewer3d.effectManager.addEffect(e, t, a, r);
                    });
                  }
                },
                {
                  key: "deactivateEffect",
                  value: function(e) {
                    return this.viewer3d.effectManager.removeEffect(e);
                  }
                },
                {
                  key: "activateTransition",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve().then(function() {
                      return t._createTransition(e).execute();
                    });
                  }
                },
                {
                  key: "_createTransition",
                  value: function(e) {
                    var t = this,
                      n = this.provider.getEntity("transition", e),
                      r = this.provider.getEntity(
                        "transitionType",
                        n.transitionTypeID
                      ).nameUQ,
                      i = n.config;
                    if ("BasicTransition" === r) {
                      var a = n.targetEntityID,
                        o = n.targetEntityType,
                        s = n.targetStateID,
                        l = this.provider.getEntity(o, a),
                        c = this.provider.getEntity("state", s),
                        u = this.provider.getEntity(
                          "stateType",
                          c.stateDataTypeID
                        ).nameUQ;
                      if (!this._checkStateType(o, u))
                        throw new Error(
                          "Entity "
                            .concat(o, " of entity ")
                            .concat(a, " doesn't match state type ")
                            .concat(s)
                        );
                      var h = l._ref.refID,
                        d = Object.keys(c.config).reduce(function(e, t) {
                          return (e[t] = l.config[t]), e;
                        }, {}),
                        p = i.valueExp,
                        f = Object.keys(c.config).reduce(function(e, t) {
                          var n = null;
                          switch (p) {
                            case "Set":
                              n = c.config[t];
                              break;
                            case "Add":
                              Array.isArray(d[t])
                                ? ((n = []),
                                  d[t].forEach(function(e, r) {
                                    n = [].concat(lw(n), [
                                      d[t][r] + c.config[t][r]
                                    ]);
                                  }))
                                : (n = d[t] + c.config[t]);
                              break;
                            case "Multiply":
                              Array.isArray(d[t])
                                ? ((n = []),
                                  d[t].forEach(function(e, r) {
                                    n = [].concat(lw(n), [
                                      d[t][r] * c.config[t][r]
                                    ]);
                                  }))
                                : (n = d[t] * c.config[t]);
                          }
                          return (e[t] = n), e;
                        }, {}),
                        m = this._getTypeForProperties(a, o),
                        v = this._createProperties(h, m, d, !1),
                        g = this._createProperties(h, m, f, !1);
                      return sw.createTransition(
                        uw(
                          {
                            sceneManager: this.viewer3d.sceneManager,
                            type: r,
                            elementID: h
                          },
                          i,
                          { startProperties: v, endProperties: g }
                        )
                      );
                    }
                    var y = sw.createTransition(
                      uw(
                        { sceneManager: this.viewer3d.sceneManager, type: r },
                        i
                      )
                    );
                    return (
                      n.transitionIDs.forEach(function(e) {
                        var n = t._createTransition(e);
                        y.children.push(n);
                      }),
                      y
                    );
                  }
                },
                {
                  key: "getBoundingBox",
                  value: function(e) {
                    var t = this.provider.getRelatedEntity(
                        "node",
                        e,
                        "relEntity"
                      )._ref.refID,
                      n = this.viewer3d.sceneManager.getBoundingBox(t),
                      r = { min: [0, 0, 0], max: [0, 0, 0] };
                    return (
                      n &&
                        (r = {
                          min: [n.min.x, n.min.y, n.min.z],
                          max: [n.max.x, n.max.y, n.max.z]
                        }),
                      Promise.resolve(r)
                    );
                  }
                },
                {
                  key: "getSnapshot",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0).then(function() {
                      return (
                        t.viewer3d.renderer.renderMode,
                        t.viewer3d.getSnapshot(e)
                      );
                    });
                  }
                },
                {
                  key: "getAssetsInfo",
                  value: function() {
                    return this.viewer3d.assetManager.getInfo();
                  }
                },
                {
                  key: "resetAssetsInfo",
                  value: function() {
                    return (
                      this.viewer3d.assetManager.resetInfo(),
                      Promise.resolve(!0)
                    );
                  }
                },
                {
                  key: "activateObjectControls",
                  value: function(e) {
                    var t = this;
                    return this.provider.getEntity("controls", e)._ref.refID
                      ? Promise.resolve(!0)
                      : this.viewer3d.sceneManager
                          .attachObjectControls({
                            userData: this._createUserData(e, "controls")
                          })
                          .then(function(n) {
                            var r = n.element;
                            return (
                              t.provider.setEntity("controls", e, {
                                _ref: { refID: r.uuid, fetchCounter: 1 }
                              }),
                              t.updateEntityConfig(e, "controls", null, !1)
                            );
                          })
                          .then(function() {
                            return !0;
                          });
                  }
                },
                {
                  key: "deactivateObjectControls",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        return t.viewer3d.sceneManager.detachObjectControls();
                      })
                      .then(function() {
                        return (
                          t.provider.setEntity("controls", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "removeObjectControls",
                  value: function(e) {
                    this.deactivateObjectControls(e);
                  }
                },
                {
                  key: "setObjectControlsTargetNode",
                  value: function(e, t) {
                    var n = this;
                    return Promise.resolve().then(function() {
                      var r =
                          null !== t ? n._getElementsForNodes([t])[0] : null,
                        i = n.viewer3d.sceneManager.getElementInfo(
                          n.viewer3d.sceneManager.objectControlsID
                        ).userData;
                      if (e !== i.id)
                        throw new Error(
                          "Object controls ".concat(e, " are not active")
                        );
                      return (
                        n.viewer3d.sceneManager.setObjectControlsTargetElement(
                          r
                        ),
                        !0
                      );
                    });
                  }
                },
                {
                  key: "activateTransformControls",
                  value: function(e) {
                    var t = this;
                    return this.provider.getEntity("controls", e)._ref.refID
                      ? Promise.resolve(!0)
                      : Promise.resolve(!0)
                          .then(function() {
                            return t.viewer3d.sceneManager.attachTransformControls(
                              { userData: t._createUserData(e, "controls") }
                            );
                          })
                          .then(function(n) {
                            var r = n.element;
                            return (
                              t.provider.setEntity("controls", e, {
                                _ref: { refID: r.uuid, fetchCounter: 1 }
                              }),
                              !0
                            );
                          })
                          .then(function() {
                            return t.updateEntityConfig(
                              e,
                              "controls",
                              null,
                              !1
                            );
                          })
                          .then(function() {
                            return !0;
                          });
                  }
                },
                {
                  key: "deactivateTransformControls",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        return t.viewer3d.sceneManager.detachTransformControls();
                      })
                      .then(function() {
                        return (
                          t.provider.setEntity("controls", e, {
                            _ref: t.provider.createDefaultRef()
                          }),
                          !0
                        );
                      });
                  }
                },
                {
                  key: "removeTransformControls",
                  value: function(e) {
                    return this.deactivateTransformControls(e);
                  }
                },
                {
                  key: "activateControls",
                  value: function(e) {
                    var t = this.provider.getEntity("controls", e),
                      n = this.provider.getEntity(
                        "controlsType",
                        t.controlsTypeID
                      );
                    switch (n.nameUQ) {
                      case "OrbitControls":
                        return this.activateCameraControls(e);
                      case "ObjectControls":
                        return this.activateObjectControls(e);
                      case "TransformControls":
                        return this.activateTransformControls(e);
                      default:
                        throw new Error(
                          "Unsupported controls type: ".concat(n.nameUQ)
                        );
                    }
                  }
                },
                {
                  key: "deactivateControls",
                  value: function(e) {
                    var t = this.provider.getEntity("controls", e),
                      n = this.provider.getEntity(
                        "controlsType",
                        t.controlsTypeID
                      );
                    switch (n.nameUQ) {
                      case "OrbitControls":
                        return this.deactivateCameraControls(e);
                      case "ObjectControls":
                        return this.deactivateObjectControls(e);
                      case "TransformControls":
                        return this.deactivateTransformControls(e);
                      default:
                        throw new Error(
                          "Unsupported controls type: ".concat(n.nameUQ)
                        );
                    }
                  }
                },
                {
                  key: "removeControls",
                  value: function(e) {
                    var t = this.provider.getEntity("controls", e),
                      n = this.provider.getEntity(
                        "controlsType",
                        t.controlsTypeID
                      );
                    switch (n.nameUQ) {
                      case "OrbitControls":
                        return this.removeCameraControls(e);
                      case "ObjectControls":
                        return this.removeObjectControls(e);
                      case "TransformControls":
                        return this.removeTransformControls(e);
                      default:
                        throw new Error(
                          "Unsupported controls type: ".concat(n.nameUQ)
                        );
                    }
                  }
                },
                {
                  key: "setControlsTarget",
                  value: function(e, t) {
                    var n =
                        arguments.length > 2 && void 0 !== arguments[2]
                          ? arguments[2]
                          : {},
                      r = this.provider.getEntity("controls", e),
                      i = this.provider.getEntity(
                        "controlsType",
                        r.controlsTypeID
                      );
                    switch (i.nameUQ) {
                      case "OrbitControls":
                        return "node" === n.targetType
                          ? this.setCameraControlsTargetNode(e, t)
                          : this.setCameraControlsTargetCamera(e, t);
                      case "ObjectControls":
                        return this.setObjectControlsTargetNode(e, t);
                      case "TransformControls":
                        if (t) {
                          var a = this._getElementsForNodes([t]);
                          return this.viewer3d.sceneManager.attachObjectToTransform(
                            a[0]
                          );
                        }
                        return this.viewer3d.sceneManager.detachObjectFromTransform();
                      default:
                        throw new Error(
                          "Unsupported controls type: ".concat(i.nameUQ)
                        );
                    }
                  }
                },
                {
                  key: "_updateProperties",
                  value: function(e, t) {
                    var n = this,
                      r =
                        arguments.length > 2 && void 0 !== arguments[2]
                          ? arguments[2]
                          : {},
                      i =
                        !(arguments.length > 3 && void 0 !== arguments[3]) ||
                        arguments[3],
                      a =
                        !(arguments.length > 4 && void 0 !== arguments[4]) ||
                        arguments[4],
                      o = this._createProperties(e, t, r, i),
                      s = this.viewer3d.sceneManager.setProperties({
                        elementID: e,
                        properties: o,
                        notify: a
                      }),
                      l = this._createUpdateProperties(s),
                      c = [];
                    return (
                      Object.keys(l).forEach(function(e) {
                        var t = Object.keys(l[e]).map(function(t) {
                          return n._createUpdatePropertiesModel(l[e][t]);
                        });
                        c = [].concat(lw(c), lw(t));
                      }),
                      Promise.resolve(c)
                    );
                  }
                },
                {
                  key: "_createProperties",
                  value: function(e, t) {
                    var n = this,
                      r =
                        arguments.length > 2 && void 0 !== arguments[2]
                          ? arguments[2]
                          : {},
                      i =
                        !(arguments.length > 3 && void 0 !== arguments[3]) ||
                        arguments[3],
                      a = [];
                    return (
                      Object.keys(r).forEach(function(o) {
                        var s = n.provider.getValueType(t, o);
                        (!s && i) ||
                          (a = [].concat(lw(a), [
                            { elementID: e, key: o, value: r[o], valueType: s }
                          ]));
                      }),
                      a
                    );
                  }
                },
                {
                  key: "_updateEnvironmentProperties",
                  value: function(e) {
                    var t = this,
                      n =
                        arguments.length > 1 && void 0 !== arguments[1]
                          ? arguments[1]
                          : {},
                      r =
                        !(arguments.length > 2 && void 0 !== arguments[2]) ||
                        arguments[2];
                    if (e !== this._getActiveEnvironment())
                      return Promise.resolve(!0);
                    var i = this.provider.getEntity("environment", e),
                      a = uw({}, i.config, {}, n),
                      o = this._getEnvironmentSubConfig(a, "bg"),
                      s = this._getEnvironmentSubConfig(a, "gr"),
                      l = this._getEnvironmentSubConfig(a, "ax"),
                      c =
                        (this._getEnvironmentSubConfig(a, "sl"),
                        this._getEnvironmentSubConfig(a, "op")),
                      u = [
                        this.viewer3d.sceneManager.addElement({
                          type: "Grid",
                          config: s
                        }),
                        this.viewer3d.sceneManager.addElement({
                          type: "Axes",
                          config: l
                        }),
                        Promise.resolve().then(function() {
                          return i.envMapID
                            ? t.setMapForEnvironment(e, i.envMapID, "envMap")
                            : (t.viewer3d.sceneManager.setBackground(uw({}, o)),
                              !0);
                        }),
                        Promise.resolve().then(function() {
                          t.viewer3d.objectPicker &&
                            t.viewer3d.objectPicker.updateConfig(c);
                        })
                      ];
                    return Promise.all(u).then(function() {
                      var i = Object.keys(n).map(function(e) {
                          return { key: e, value: n[e] };
                        }),
                        a = { id: e, type: "environment", properties: i };
                      return (
                        r && t._onEntityChanged(a),
                        [t._createUpdatePropertiesModel(a)]
                      );
                    });
                  }
                },
                {
                  key: "_getEnvironmentSubConfig",
                  value: function(e, t) {
                    var n = {};
                    return (
                      Object.keys(e).forEach(function(r) {
                        var i = r.substr(2);
                        (i = i.charAt(0).toLowerCase() + i.slice(1)),
                          r.startsWith(t) && (n[i] = e[r]);
                      }),
                      n
                    );
                  }
                },
                {
                  key: "_updateRendererProperties",
                  value: function(e) {
                    var t = this,
                      n =
                        arguments.length > 1 && void 0 !== arguments[1]
                          ? arguments[1]
                          : {},
                      r =
                        !(arguments.length > 2 && void 0 !== arguments[2]) ||
                        arguments[2],
                      i = this._getActiveRenderer();
                    if (e !== i) return Promise.resolve(!0);
                    var a = Object.keys(n).reduce(function(e, r) {
                        return (
                          t.provider.getValueType("Renderer", r) &&
                            (e[r] = n[r]),
                          e
                        );
                      }, {}),
                      o = this.viewer3d.renderer.materialsNeedUpdate(a);
                    this.viewer3d.renderer.updateConfig(a),
                      this.viewer3d.sceneManager.updateElements("Material", o);
                    var s = Object.keys(a).map(function(e) {
                        return { key: e, value: n[e] };
                      }),
                      l = { id: e, type: "renderer", properties: s };
                    return (
                      r && this._onEntityChanged(l),
                      Promise.resolve([this._createUpdatePropertiesModel(l)])
                    );
                  }
                },
                {
                  key: "_traverseNodes",
                  value: function(e, t) {
                    var n = this;
                    t(e),
                      this._getNodeForMeshNode(e).children.forEach(function(e) {
                        var r = n._getMeshNodeForNode(e).id;
                        n._traverseNodes(r, t);
                      });
                  }
                },
                {
                  key: "_createRefsForMeshNodes",
                  value: function(e, t) {
                    var n = this,
                      r = this.provider.getEntity("meshNode", e);
                    this.provider.setEntity("meshNode", e, {
                      _ref: {
                        refID: t[e],
                        fetchCounter: r._ref.fetchCounter + 1
                      }
                    }),
                      this.setIfMeshNodeActive(e, !1),
                      this.updateEntityConfig(e, "meshNode", null, !1),
                      this._getNodeForMeshNode(e).children.forEach(function(e) {
                        var r = n._getMeshNodeForNode(e).id;
                        n._createRefsForMeshNodes(r, t);
                      });
                  }
                },
                {
                  key: "_releaseRefsForMeshNodes",
                  value: function(e) {
                    var t = this;
                    this.provider.setEntity("meshNode", e, {
                      _ref: this.provider.createDefaultRef()
                    });
                    var n = this._getNodeForMeshNode(e);
                    n.children.forEach(function(e) {
                      var n = t._getMeshNodeForNode(e).id;
                      t._releaseRefsForMeshNodes(n);
                    }),
                      this.provider.setEntity("node", n.id, {
                        _ref: this.provider.createDefaultRef()
                      });
                  }
                },
                {
                  key: "_createModelNodeInfo",
                  value: function(e, t) {
                    var n = this,
                      r = this.provider.getEntity("meshNode", e);
                    (t[r.nameUQ] = {
                      id: e,
                      type: "meshNode",
                      nodeID: r.nodeID,
                      children: {}
                    }),
                      this._getNodeForMeshNode(e).children.forEach(function(e) {
                        var i = n._getMeshNodeForNode(e).id;
                        n._createModelNodeInfo(i, t[r.nameUQ].children);
                      });
                  }
                },
                {
                  key: "_setupMeshNodeMaterials",
                  value: function(e) {
                    var t = this,
                      n = [];
                    return (
                      this._traverseNodes(e, function(e) {
                        var r = t.provider.getEntity("meshNode", e);
                        r.materialID &&
                          (n = [].concat(lw(n), [
                            t.setMaterialForMeshNode(e, r.materialID)
                          ]));
                      }),
                      Promise.all(n)
                    );
                  }
                },
                {
                  key: "_onMouseClick",
                  value: function(e) {
                    this.onPointerClick &&
                      this.onPointerClick({
                        event: e,
                        data: this._getPointerData(e.intersects)
                      });
                  }
                },
                {
                  key: "_onMouseMove",
                  value: function(e) {
                    this.onPointerMove &&
                      this.onPointerMove({
                        event: e,
                        data: this._getPointerData(e.intersects)
                      });
                  }
                },
                {
                  key: "_getPointerData",
                  value: function(e) {
                    var t = this;
                    return e
                      .filter(function(e) {
                        var n = e.object.userData.nodeID;
                        if (n) {
                          var r = t.getMaterialsForNodes([n]);
                          if (r[0] && t._isEntityActivated(r[0], "material")) {
                            var i = t.provider.getEntity("material", r[0]);
                            return t.viewer3d.sceneManager.testForMaterialTransparency(
                              i._ref.refID,
                              e.uv
                            );
                          }
                          return !0;
                        }
                        return !1;
                      })
                      .map(function(e) {
                        return uw({}, e.object.userData);
                      });
                  }
                },
                {
                  key: "_onLoadingChanged",
                  value: function(e) {
                    this.onLoadingChanged && this.onLoadingChanged(e);
                  }
                },
                {
                  key: "_onElementChanged",
                  value: function(e) {
                    if (this.onEntityUpdated) {
                      var t = this._createUpdatePropertiesEntry(e);
                      this._onEntityChanged(t);
                    }
                  }
                },
                {
                  key: "_onEntityChanged",
                  value: function(e) {
                    if (this.onEntityUpdated) {
                      var t = {};
                      e.properties.forEach(function(e) {
                        t[e.key] = e.value;
                      });
                      var n = this.provider.getDiffEntity(e.type, e.id, {
                        activeConfig: t
                      });
                      this.onEntityUpdated({ model: n });
                    }
                  }
                },
                {
                  key: "_onRenderStateChanged",
                  value: function(e) {
                    if (e.needsRestart) {
                      var t = {
                        id: this._getActiveRenderer(),
                        type: "renderer",
                        properties: [
                          { key: "needsRestart", value: e.needsRestart }
                        ]
                      };
                      this._onEntityChanged(t);
                    }
                    e.mode && this.setRenderMode(e.mode);
                  }
                },
                {
                  key: "setRenderMode",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        t.viewer3d.renderer.setPulseEnabled(!1);
                        var n = t._getActiveRenderer(),
                          r = t._getModeConfig(e, n, "renderer");
                        return t.updateEntityConfig(n, "renderer", r, !0);
                      })
                      .then(function() {
                        return t.viewer3d.renderer.setPulseEnabled(!0), !0;
                      });
                  }
                },
                {
                  key: "_getModeConfig",
                  value: function(e, t, n) {
                    var r = this.provider.getEntity(n, t);
                    return Object.keys(r.config)
                      .filter(function(e) {
                        return e.startsWith("HQ");
                      })
                      .reduce(function(t, n) {
                        return (
                          (t[n.substring(2)] =
                            "HQ" === e
                              ? r.config[n]
                              : r.config[n.substring(2)]),
                          t
                        );
                      }, {});
                  }
                },
                {
                  key: "_getNodeIDs",
                  value: function(e) {
                    var t = this;
                    return e
                      .filter(function(e) {
                        var n = e.object.userData.nodeID;
                        if (n) {
                          var r = t.getMaterialsForNodes([n]);
                          if (r[0] && t._isEntityActivated(r[0], "material")) {
                            var i = t.provider.getEntity("material", r[0]);
                            return t.viewer3d.sceneManager.testForMaterialTransparency(
                              i._ref.refID,
                              e.uv
                            );
                          }
                          return !0;
                        }
                        return !1;
                      })
                      .map(function(e) {
                        return e.object.userData.nodeID;
                      });
                  }
                },
                {
                  key: "_getMeshNodeRefs",
                  value: function(e) {
                    var t = this;
                    return e.map(function(e) {
                      return t.provider.getEntity("meshNode", e)._ref.refID;
                    });
                  }
                },
                {
                  key: "_getMapTypesForMaterial",
                  value: function(e) {
                    var t = this._getAllMapFields(),
                      n = this.provider.getEntity("material", e);
                    return Object.keys(n).filter(function(e) {
                      return t.includes(e) && n[e];
                    });
                  }
                },
                {
                  key: "_getAllMapFields",
                  value: function() {
                    return [
                      "alphaMapID",
                      "aoMapID",
                      "bumpMapID",
                      "displacementMapID",
                      "emissiveMapID",
                      "envMapID",
                      "lightMapID",
                      "diffuseMapID",
                      "metalnessMapID",
                      "normalMapID",
                      "roughnessMapID",
                      "specularMapID",
                      "gradientMapID",
                      "clearcoatNormalMapID"
                    ];
                  }
                },
                {
                  key: "_getViewer3DMapType",
                  value: function(e) {
                    switch (e) {
                      case "alphaMapID":
                        return "alphaMap";
                      case "aoMapID":
                        return "aoMap";
                      case "bumpMapID":
                        return "bumpMap";
                      case "displacementMapID":
                        return "displacementMap";
                      case "emissiveMapID":
                        return "emissiveMap";
                      case "envMapID":
                        return "envMap";
                      case "lightMapID":
                        return "lightMap";
                      case "diffuseMapID":
                        return "map";
                      case "metalnessMapID":
                        return "metalnessMap";
                      case "normalMapID":
                        return "normalMap";
                      case "roughnessMapID":
                        return "roughnessMap";
                      case "specularMapID":
                        return "specularMap";
                      case "gradientMapID":
                        return "gradientMap";
                      case "clearcoatNormalMapID":
                        return "clearcoatNormalMap";
                      default:
                        throw new Error("Unknown map type ".concat(e));
                    }
                    return null;
                  }
                },
                {
                  key: "_addGlobalMaps",
                  value: function(e) {
                    var t = this.provider.getEntity("environment", e);
                    return t.envMapID
                      ? this.addTexture(t.envMapID)
                      : Promise.resolve(!0);
                  }
                },
                {
                  key: "_getActiveCamera",
                  value: function() {
                    return this.provider.getEntity("scene").cameraID;
                  }
                },
                {
                  key: "_getActiveRenderer",
                  value: function() {
                    return this.provider.getEntity("scene").rendererID;
                  }
                },
                {
                  key: "_getActiveEnvironment",
                  value: function() {
                    return this.provider.getEntity("scene").environmentID;
                  }
                },
                {
                  key: "_getActiveControls",
                  value: function(e) {
                    var t = this;
                    return (
                      this.provider
                        .getEntity("scene")
                        .controls.find(function(n) {
                          var r = t.provider.getEntity("controls", n);
                          return (
                            t.provider.getEntity(
                              "controlsType",
                              r.controlsTypeID
                            ).nameUQ === e
                          );
                        }) || null
                    );
                  }
                },
                {
                  key: "_getNodeForMeshNode",
                  value: function(e) {
                    var t = this.provider.getEntity("meshNode", e);
                    return this.provider.getEntity("node", t.nodeID);
                  }
                },
                {
                  key: "_getMeshNodeForNode",
                  value: function(e) {
                    var t = this.provider.getRelatedEntity(
                      "node",
                      e,
                      "relEntity"
                    );
                    if ("meshNode" !== t.entity)
                      throw new Error(
                        "Node "
                          .concat(e, " of type ")
                          .concat(t.entity, " is not meshNode")
                      );
                    return t;
                  }
                },
                {
                  key: "_getElementsForNodes",
                  value: function(e) {
                    var t = this;
                    return e.map(function(e) {
                      return t.provider.getRelatedEntity(
                        "node",
                        e,
                        "relEntity"
                      )._ref.refID;
                    });
                  }
                },
                {
                  key: "_getNodesForElements",
                  value: function(e) {
                    var t = this;
                    return e.map(function(e) {
                      return t.viewer3d.sceneManager.getElementInfo(
                        e
                      ).userData.nodeID;
                    });
                  }
                },
                {
                  key: "_getNodesForEntities",
                  value: function(e, t) {
                    var n = this;
                    return e.map(function(e) {
                      return n.provider.getEntity(t, e).nodeID;
                    });
                  }
                },
                {
                  key: "_checkStateType",
                  value: function() {
                    return !0;
                  }
                },
                {
                  key: "_getTypeForProperties",
                  value: function(e, t) {
                    var n = this.provider.getEntity(t, e),
                      r = t.charAt(0).toUpperCase() + t.slice(1);
                    return (
                      n["".concat(t, "TypeID")] &&
                        (r = this.provider.getEntity(
                          "".concat(t, "Type"),
                          n["".concat(t, "TypeID")]
                        ).nameUQ),
                      r
                    );
                  }
                },
                {
                  key: "_createUserData",
                  value: function(e, t) {
                    return {
                      id: e,
                      type: t,
                      nodeID: this.provider.getEntity(t, e).nodeID || null
                    };
                  }
                },
                {
                  key: "_createUpdatePropertiesEntry",
                  value: function(e) {
                    var t = this.viewer3d.sceneManager.getElementInfo(
                      e.elementID
                    ).userData;
                    return { id: t.id, type: t.type, properties: e.properties };
                  }
                },
                {
                  key: "_createUpdateProperties",
                  value: function(e) {
                    var t = this;
                    return e.reduce(function(e, n) {
                      var r = t.viewer3d.sceneManager.getElementInfo(
                        n.elementID
                      ).userData;
                      return (
                        e[r.type] || (e[r.type] = {}),
                        e[r.type][r.id]
                          ? (e[r.type][r.id].properties = [].concat(
                              lw(e[r.type][r.id].properties),
                              lw(n.properties)
                            ))
                          : (e[r.type][r.id] = {
                              id: r.id,
                              type: r.type,
                              properties: lw(n.properties)
                            }),
                        e
                      );
                    }, {});
                  }
                },
                {
                  key: "_createUpdatePropertiesModel",
                  value: function(e) {
                    if (!e.id || !e.type)
                      throw new Error("Invalid entry data ".concat(e));
                    var t = {};
                    return (
                      e.properties.forEach(function(e) {
                        t[e.key] = e.value;
                      }),
                      {
                        model: this.provider.getDiffEntity(e.type, e.id, {
                          activeConfig: t
                        })
                      }
                    );
                  }
                },
                {
                  key: "_getCurrentMaterial",
                  value: function(e) {
                    var t = this.provider.getRelatedEntity(
                        "node",
                        e,
                        "relEntity"
                      ),
                      n = this.provider.getEntity(t.entity, t.id);
                    if (n._ref.refID) {
                      var r = this.viewer3d.sceneManager.getMaterialForObject(
                        n._ref.refID
                      );
                      if (r) {
                        var i = this.viewer3d.sceneManager.getElementInfo(r);
                        if (i && i.userData.id) return i.userData.id;
                      }
                    }
                    return null;
                  }
                },
                {
                  key: "_prepareMeshNode",
                  value: function(e) {
                    var t = this;
                    return Promise.resolve(!0)
                      .then(function() {
                        return t.addMeshNode(e);
                      })
                      .then(function() {
                        var n = t.provider.getEntity("meshNode", e);
                        if (
                          "Mesh" ===
                          t.provider.getEntity("meshNodeType", n.meshNodeTypeID)
                            .nameUQ
                        )
                          return t.setMaterialForMeshNode(e, n.materialID);
                      });
                  }
                },
                {
                  key: "_isEntityActivated",
                  value: function(e, t) {
                    var n = this.provider.getEntity(t, e);
                    return n && n._ref.refID;
                  }
                }
              ]) && dw(t.prototype, n),
              r && dw(t, r),
              e
            );
          })(),
          fw = (function() {
            function e(e) {
              zd.call(this, e),
                (this.dracoLoader = null),
                (this.ddsLoader = null);
            }
            function t() {
              var e = {};
              return {
                get: function(t) {
                  return e[t];
                },
                add: function(t, n) {
                  e[t] = n;
                },
                remove: function(t) {
                  delete e[t];
                },
                removeAll: function() {
                  e = {};
                }
              };
            }
            e.prototype = Object.assign(Object.create(zd.prototype), {
              constructor: e,
              load: function(e, t, n, r) {
                var i,
                  a = this;
                (i =
                  "" !== this.resourcePath
                    ? this.resourcePath
                    : "" !== this.path
                    ? this.path
                    : Op.extractUrlBase(e)),
                  a.manager.itemStart(e);
                var o = function(t) {
                    r && r(t), a.manager.itemError(e), a.manager.itemEnd(e);
                  },
                  s = new Gd(a.manager);
                s.setPath(this.path),
                  s.setResponseType("arraybuffer"),
                  "use-credentials" === a.crossOrigin &&
                    s.setWithCredentials(!0),
                  s.load(
                    e,
                    function(n) {
                      try {
                        a.parse(
                          n,
                          i,
                          function(n) {
                            t(n), a.manager.itemEnd(e);
                          },
                          o
                        );
                      } catch (e) {
                        o(e);
                      }
                    },
                    n,
                    o
                  );
              },
              setDRACOLoader: function(e) {
                return (this.dracoLoader = e), this;
              },
              setDDSLoader: function(e) {
                return (this.ddsLoader = e), this;
              },
              parse: function(e, t, s, l) {
                var f,
                  m = {};
                if ("string" == typeof e) f = e;
                else if (Op.decodeText(new Uint8Array(e, 0, 4)) === o) {
                  try {
                    m[n.KHR_BINARY_GLTF] = new c(e);
                  } catch (e) {
                    return void (l && l(e));
                  }
                  f = m[n.KHR_BINARY_GLTF].content;
                } else f = Op.decodeText(new Uint8Array(e));
                var v = JSON.parse(f);
                if (void 0 === v.asset || v.asset.version[0] < 2)
                  l &&
                    l(
                      new Error(
                        "THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."
                      )
                    );
                else {
                  if (v.extensionsUsed)
                    for (var g = 0; g < v.extensionsUsed.length; ++g) {
                      var y = v.extensionsUsed[g],
                        b = v.extensionsRequired || [];
                      switch (y) {
                        case n.KHR_LIGHTS_PUNCTUAL:
                          m[y] = new i(v);
                          break;
                        case n.KHR_MATERIALS_UNLIT:
                          m[y] = new a();
                          break;
                        case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:
                          m[y] = new d();
                          break;
                        case n.KHR_DRACO_MESH_COMPRESSION:
                          m[y] = new u(v, this.dracoLoader);
                          break;
                        case n.MSFT_TEXTURE_DDS:
                          m[y] = new r(this.ddsLoader);
                          break;
                        case n.KHR_TEXTURE_TRANSFORM:
                          m[y] = new h();
                          break;
                        case n.KHR_MESH_QUANTIZATION:
                          m[y] = new p();
                          break;
                        default:
                          b.indexOf(y);
                      }
                    }
                  new j(v, m, {
                    path: t || this.resourcePath || "",
                    crossOrigin: this.crossOrigin,
                    manager: this.manager
                  }).parse(s, l);
                }
              }
            });
            var n = {
              KHR_BINARY_GLTF: "KHR_binary_glTF",
              KHR_DRACO_MESH_COMPRESSION: "KHR_draco_mesh_compression",
              KHR_LIGHTS_PUNCTUAL: "KHR_lights_punctual",
              KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:
                "KHR_materials_pbrSpecularGlossiness",
              KHR_MATERIALS_UNLIT: "KHR_materials_unlit",
              KHR_TEXTURE_TRANSFORM: "KHR_texture_transform",
              KHR_MESH_QUANTIZATION: "KHR_mesh_quantization",
              MSFT_TEXTURE_DDS: "MSFT_texture_dds"
            };
            function r(e) {
              if (!e)
                throw new Error(
                  "THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader"
                );
              (this.name = n.MSFT_TEXTURE_DDS), (this.ddsLoader = e);
            }
            function i(e) {
              this.name = n.KHR_LIGHTS_PUNCTUAL;
              var t =
                (e.extensions && e.extensions[n.KHR_LIGHTS_PUNCTUAL]) || {};
              this.lightDefs = t.lights || [];
            }
            function a() {
              this.name = n.KHR_MATERIALS_UNLIT;
            }
            (i.prototype.loadLight = function(e) {
              var t,
                n = this.lightDefs[e],
                r = new Eo(16777215);
              void 0 !== n.color && r.fromArray(n.color);
              var i = void 0 !== n.range ? n.range : 0;
              switch (n.type) {
                case "directional":
                  (t = new Rp(r)).target.position.set(0, 0, -1),
                    t.add(t.target);
                  break;
                case "point":
                  (t = new Ap(r)).distance = i;
                  break;
                case "spot":
                  ((t = new Mp(r)).distance = i),
                    (n.spot = n.spot || {}),
                    (n.spot.innerConeAngle =
                      void 0 !== n.spot.innerConeAngle
                        ? n.spot.innerConeAngle
                        : 0),
                    (n.spot.outerConeAngle =
                      void 0 !== n.spot.outerConeAngle
                        ? n.spot.outerConeAngle
                        : Math.PI / 4),
                    (t.angle = n.spot.outerConeAngle),
                    (t.penumbra =
                      1 - n.spot.innerConeAngle / n.spot.outerConeAngle),
                    t.target.position.set(0, 0, -1),
                    t.add(t.target);
                  break;
                default:
                  throw new Error(
                    'THREE.GLTFLoader: Unexpected light type, "' + n.type + '".'
                  );
              }
              return (
                t.position.set(0, 0, 0),
                (t.decay = 2),
                void 0 !== n.intensity && (t.intensity = n.intensity),
                (t.name = n.name || "light_" + e),
                Promise.resolve(t)
              );
            }),
              (a.prototype.getMaterialType = function() {
                return Lo;
              }),
              (a.prototype.extendParams = function(e, t, n) {
                var r = [];
                (e.color = new Eo(1, 1, 1)), (e.opacity = 1);
                var i = t.pbrMetallicRoughness;
                if (i) {
                  if (Array.isArray(i.baseColorFactor)) {
                    var a = i.baseColorFactor;
                    e.color.fromArray(a), (e.opacity = a[3]);
                  }
                  void 0 !== i.baseColorTexture &&
                    r.push(n.assignTexture(e, "map", i.baseColorTexture));
                }
                return Promise.all(r);
              });
            var o = "glTF",
              s = 12,
              l = { JSON: 1313821514, BIN: 5130562 };
            function c(e) {
              (this.name = n.KHR_BINARY_GLTF),
                (this.content = null),
                (this.body = null);
              var t = new DataView(e, 0, s);
              if (
                ((this.header = {
                  magic: Op.decodeText(new Uint8Array(e.slice(0, 4))),
                  version: t.getUint32(4, !0),
                  length: t.getUint32(8, !0)
                }),
                this.header.magic !== o)
              )
                throw new Error(
                  "THREE.GLTFLoader: Unsupported glTF-Binary header."
                );
              if (this.header.version < 2)
                throw new Error(
                  "THREE.GLTFLoader: Legacy binary file detected."
                );
              for (var r = new DataView(e, s), i = 0; i < r.byteLength; ) {
                var a = r.getUint32(i, !0);
                i += 4;
                var c = r.getUint32(i, !0);
                if (((i += 4), c === l.JSON)) {
                  var u = new Uint8Array(e, s + i, a);
                  this.content = Op.decodeText(u);
                } else if (c === l.BIN) {
                  var h = s + i;
                  this.body = e.slice(h, h + a);
                }
                i += a;
              }
              if (null === this.content)
                throw new Error("THREE.GLTFLoader: JSON content not found.");
            }
            function u(e, t) {
              if (!t)
                throw new Error(
                  "THREE.GLTFLoader: No DRACOLoader instance provided."
                );
              (this.name = n.KHR_DRACO_MESH_COMPRESSION),
                (this.json = e),
                (this.dracoLoader = t);
            }
            function h() {
              this.name = n.KHR_TEXTURE_TRANSFORM;
            }
            function d() {
              return {
                name: n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,
                specularGlossinessParams: [
                  "color",
                  "map",
                  "lightMap",
                  "lightMapIntensity",
                  "aoMap",
                  "aoMapIntensity",
                  "emissive",
                  "emissiveIntensity",
                  "emissiveMap",
                  "bumpMap",
                  "bumpScale",
                  "normalMap",
                  "displacementMap",
                  "displacementScale",
                  "displacementBias",
                  "specularMap",
                  "specular",
                  "glossinessMap",
                  "glossiness",
                  "alphaMap",
                  "envMap",
                  "envMapIntensity",
                  "refractionRatio"
                ],
                getMaterialType: function() {
                  return Cs;
                },
                extendParams: function(e, t, n) {
                  var r = t.extensions[this.name],
                    i = Ws.standard,
                    a = Is.clone(i.uniforms),
                    o = [
                      "#ifdef USE_SPECULARMAP",
                      "\tuniform sampler2D specularMap;",
                      "#endif"
                    ].join("\n"),
                    s = [
                      "#ifdef USE_GLOSSINESSMAP",
                      "\tuniform sampler2D glossinessMap;",
                      "#endif"
                    ].join("\n"),
                    l = [
                      "vec3 specularFactor = specular;",
                      "#ifdef USE_SPECULARMAP",
                      "\tvec4 texelSpecular = texture2D( specularMap, vUv );",
                      "\ttexelSpecular = sRGBToLinear( texelSpecular );",
                      "\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture",
                      "\tspecularFactor *= texelSpecular.rgb;",
                      "#endif"
                    ].join("\n"),
                    c = [
                      "float glossinessFactor = glossiness;",
                      "#ifdef USE_GLOSSINESSMAP",
                      "\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );",
                      "\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture",
                      "\tglossinessFactor *= texelGlossiness.a;",
                      "#endif"
                    ].join("\n"),
                    u = [
                      "PhysicalMaterial material;",
                      "material.diffuseColor = diffuseColor.rgb;",
                      "material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );",
                      "material.specularColor = specularFactor.rgb;"
                    ].join("\n"),
                    h = i.fragmentShader
                      .replace(
                        "uniform float roughness;",
                        "uniform vec3 specular;"
                      )
                      .replace(
                        "uniform float metalness;",
                        "uniform float glossiness;"
                      )
                      .replace("#include <roughnessmap_pars_fragment>", o)
                      .replace("#include <metalnessmap_pars_fragment>", s)
                      .replace("#include <roughnessmap_fragment>", l)
                      .replace("#include <metalnessmap_fragment>", c)
                      .replace("#include <lights_physical_fragment>", u);
                  delete a.roughness,
                    delete a.metalness,
                    delete a.roughnessMap,
                    delete a.metalnessMap,
                    (a.specular = { value: new Eo().setHex(1118481) }),
                    (a.glossiness = { value: 0.5 }),
                    (a.specularMap = { value: null }),
                    (a.glossinessMap = { value: null }),
                    (e.vertexShader = i.vertexShader),
                    (e.fragmentShader = h),
                    (e.uniforms = a),
                    (e.defines = { STANDARD: "" }),
                    (e.color = new Eo(1, 1, 1)),
                    (e.opacity = 1);
                  var d = [];
                  if (Array.isArray(r.diffuseFactor)) {
                    var p = r.diffuseFactor;
                    e.color.fromArray(p), (e.opacity = p[3]);
                  }
                  if (
                    (void 0 !== r.diffuseTexture &&
                      d.push(n.assignTexture(e, "map", r.diffuseTexture)),
                    (e.emissive = new Eo(0, 0, 0)),
                    (e.glossiness =
                      void 0 !== r.glossinessFactor ? r.glossinessFactor : 1),
                    (e.specular = new Eo(1, 1, 1)),
                    Array.isArray(r.specularFactor) &&
                      e.specular.fromArray(r.specularFactor),
                    void 0 !== r.specularGlossinessTexture)
                  ) {
                    var f = r.specularGlossinessTexture;
                    d.push(n.assignTexture(e, "glossinessMap", f)),
                      d.push(n.assignTexture(e, "specularMap", f));
                  }
                  return Promise.all(d);
                },
                createMaterial: function(e) {
                  var t = new Cs({
                    defines: e.defines,
                    vertexShader: e.vertexShader,
                    fragmentShader: e.fragmentShader,
                    uniforms: e.uniforms,
                    fog: !0,
                    lights: !0,
                    opacity: e.opacity,
                    transparent: e.transparent
                  });
                  return (
                    (t.isGLTFSpecularGlossinessMaterial = !0),
                    (t.color = e.color),
                    (t.map = void 0 === e.map ? null : e.map),
                    (t.lightMap = null),
                    (t.lightMapIntensity = 1),
                    (t.aoMap = void 0 === e.aoMap ? null : e.aoMap),
                    (t.aoMapIntensity = 1),
                    (t.emissive = e.emissive),
                    (t.emissiveIntensity = 1),
                    (t.emissiveMap =
                      void 0 === e.emissiveMap ? null : e.emissiveMap),
                    (t.bumpMap = void 0 === e.bumpMap ? null : e.bumpMap),
                    (t.bumpScale = 1),
                    (t.normalMap = void 0 === e.normalMap ? null : e.normalMap),
                    e.normalScale && (t.normalScale = e.normalScale),
                    (t.displacementMap = null),
                    (t.displacementScale = 1),
                    (t.displacementBias = 0),
                    (t.specularMap =
                      void 0 === e.specularMap ? null : e.specularMap),
                    (t.specular = e.specular),
                    (t.glossinessMap =
                      void 0 === e.glossinessMap ? null : e.glossinessMap),
                    (t.glossiness = e.glossiness),
                    (t.alphaMap = null),
                    (t.envMap = void 0 === e.envMap ? null : e.envMap),
                    (t.envMapIntensity = 1),
                    (t.refractionRatio = 0.98),
                    (t.extensions.derivatives = !0),
                    t
                  );
                },
                cloneMaterial: function(e) {
                  var t = e.clone();
                  t.isGLTFSpecularGlossinessMaterial = !0;
                  for (
                    var n = this.specularGlossinessParams, r = 0, i = n.length;
                    r < i;
                    r++
                  ) {
                    var a = e[n[r]];
                    t[n[r]] = a && a.isColor ? a.clone() : a;
                  }
                  return t;
                },
                refreshUniforms: function(e, t, n, r, i) {
                  if (!0 === i.isGLTFSpecularGlossinessMaterial) {
                    var a,
                      o = i.uniforms,
                      s = i.defines;
                    (o.opacity.value = i.opacity),
                      o.diffuse.value.copy(i.color),
                      o.emissive.value
                        .copy(i.emissive)
                        .multiplyScalar(i.emissiveIntensity),
                      (o.map.value = i.map),
                      (o.specularMap.value = i.specularMap),
                      (o.alphaMap.value = i.alphaMap),
                      (o.lightMap.value = i.lightMap),
                      (o.lightMapIntensity.value = i.lightMapIntensity),
                      (o.aoMap.value = i.aoMap),
                      (o.aoMapIntensity.value = i.aoMapIntensity),
                      i.map
                        ? (a = i.map)
                        : i.specularMap
                        ? (a = i.specularMap)
                        : i.displacementMap
                        ? (a = i.displacementMap)
                        : i.normalMap
                        ? (a = i.normalMap)
                        : i.bumpMap
                        ? (a = i.bumpMap)
                        : i.glossinessMap
                        ? (a = i.glossinessMap)
                        : i.alphaMap
                        ? (a = i.alphaMap)
                        : i.emissiveMap && (a = i.emissiveMap),
                      void 0 !== a &&
                        (a.isWebGLRenderTarget && (a = a.texture),
                        !0 === a.matrixAutoUpdate && a.updateMatrix(),
                        o.uvTransform.value.copy(a.matrix)),
                      i.envMap &&
                        ((o.envMap.value = i.envMap),
                        (o.envMapIntensity.value = i.envMapIntensity),
                        (o.flipEnvMap.value = i.envMap.isCubeTexture ? -1 : 1),
                        (o.reflectivity.value = i.reflectivity),
                        (o.refractionRatio.value = i.refractionRatio),
                        (o.maxMipLevel.value = e.properties.get(
                          i.envMap
                        ).__maxMipLevel)),
                      o.specular.value.copy(i.specular),
                      (o.glossiness.value = i.glossiness),
                      (o.glossinessMap.value = i.glossinessMap),
                      (o.emissiveMap.value = i.emissiveMap),
                      (o.bumpMap.value = i.bumpMap),
                      (o.normalMap.value = i.normalMap),
                      (o.displacementMap.value = i.displacementMap),
                      (o.displacementScale.value = i.displacementScale),
                      (o.displacementBias.value = i.displacementBias),
                      null !== o.glossinessMap.value &&
                        void 0 === s.USE_GLOSSINESSMAP &&
                        ((s.USE_GLOSSINESSMAP = ""), (s.USE_ROUGHNESSMAP = "")),
                      null === o.glossinessMap.value &&
                        void 0 !== s.USE_GLOSSINESSMAP &&
                        (delete s.USE_GLOSSINESSMAP, delete s.USE_ROUGHNESSMAP);
                  }
                }
              };
            }
            function p() {
              this.name = n.KHR_MESH_QUANTIZATION;
            }
            function f(e, t, n, r) {
              Td.call(this, e, t, n, r);
            }
            (u.prototype.decodePrimitive = function(e, t) {
              var n = this.json,
                r = this.dracoLoader,
                i = e.extensions[this.name].bufferView,
                a = e.extensions[this.name].attributes,
                o = {},
                s = {},
                l = {};
              for (var c in a) {
                var u = E[c] || c.toLowerCase();
                o[u] = a[c];
              }
              for (c in e.attributes)
                if (((u = E[c] || c.toLowerCase()), void 0 !== a[c])) {
                  var h = n.accessors[e.attributes[c]],
                    d = M[h.componentType];
                  (l[u] = d), (s[u] = !0 === h.normalized);
                }
              return t.getDependency("bufferView", i).then(function(e) {
                return new Promise(function(t) {
                  r.decodeDracoFile(
                    e,
                    function(e) {
                      for (var n in e.attributes) {
                        var r = e.attributes[n],
                          i = s[n];
                        void 0 !== i && (r.normalized = i);
                      }
                      t(e);
                    },
                    o,
                    l
                  );
                });
              });
            }),
              (h.prototype.extendTexture = function(e, t) {
                return (
                  (e = e.clone()),
                  void 0 !== t.offset && e.offset.fromArray(t.offset),
                  void 0 !== t.rotation && (e.rotation = t.rotation),
                  void 0 !== t.scale && e.repeat.fromArray(t.scale),
                  t.texCoord,
                  (e.needsUpdate = !0),
                  e
                );
              }),
              (f.prototype = Object.create(Td.prototype)),
              (f.prototype.constructor = f),
              (f.prototype.copySampleValue_ = function(e) {
                for (
                  var t = this.resultBuffer,
                    n = this.sampleValues,
                    r = this.valueSize,
                    i = e * r * 3 + r,
                    a = 0;
                  a !== r;
                  a++
                )
                  t[a] = n[i + a];
                return t;
              }),
              (f.prototype.beforeStart_ = f.prototype.copySampleValue_),
              (f.prototype.afterEnd_ = f.prototype.copySampleValue_),
              (f.prototype.interpolate_ = function(e, t, n, r) {
                for (
                  var i = this.resultBuffer,
                    a = this.sampleValues,
                    o = this.valueSize,
                    s = 2 * o,
                    l = 3 * o,
                    c = r - t,
                    u = (n - t) / c,
                    h = u * u,
                    d = h * u,
                    p = e * l,
                    f = p - l,
                    m = -2 * d + 3 * h,
                    v = d - h,
                    g = 1 - m,
                    y = v - h + u,
                    b = 0;
                  b !== o;
                  b++
                ) {
                  var x = a[f + b + o],
                    w = a[f + b + s] * c,
                    _ = a[p + b + o],
                    M = a[p + b] * c;
                  i[b] = g * x + y * w + m * _ + v * M;
                }
                return i;
              });
            var m,
              v = 0,
              g = 1,
              y = 2,
              b = 3,
              x = 4,
              w = 5,
              _ = 6,
              M = {
                5120: Int8Array,
                5121: Uint8Array,
                5122: Int16Array,
                5123: Uint16Array,
                5125: Uint32Array,
                5126: Float32Array
              },
              T = {
                9728: Jn,
                9729: nr,
                9984: Kn,
                9985: rr,
                9986: er,
                9987: ar
              },
              A = { 33071: Qn, 33648: Zn, 10497: qn },
              S = {
                SCALAR: 1,
                VEC2: 2,
                VEC3: 3,
                VEC4: 4,
                MAT2: 4,
                MAT3: 9,
                MAT4: 16
              },
              E = {
                POSITION: "position",
                NORMAL: "normal",
                TANGENT: "tangent",
                TEXCOORD_0: "uv",
                TEXCOORD_1: "uv2",
                COLOR_0: "color",
                WEIGHTS_0: "skinWeight",
                JOINTS_0: "skinIndex"
              },
              R = {
                scale: "scale",
                translation: "position",
                rotation: "quaternion",
                weights: "morphTargetInfluences"
              },
              P = { CUBICSPLINE: void 0, LINEAR: ti, STEP: ei },
              I = "OPAQUE",
              D = "MASK",
              O = "BLEND",
              C = { "image/png": wr, "image/jpeg": xr };
            function L(e, t) {
              return "string" != typeof e || "" === e
                ? ""
                : (/^https?:\/\//i.test(t) &&
                    /^\//.test(e) &&
                    (t = t.replace(/(^https?:\/\/[^\/]+).*/i, "$1")),
                  /^(https?:)?\/\//i.test(e)
                    ? e
                    : /^data:.*,.*$/i.test(e)
                    ? e
                    : /^blob:.*$/i.test(e)
                    ? e
                    : t + e);
            }
            function N(e, t, n) {
              for (var r in n.extensions)
                void 0 === e[r] &&
                  ((t.userData.gltfExtensions =
                    t.userData.gltfExtensions || {}),
                  (t.userData.gltfExtensions[r] = n.extensions[r]));
            }
            function F(e, t) {
              void 0 !== t.extras &&
                "object" == typeof t.extras &&
                Object.assign(e.userData, t.extras);
            }
            function k(e, t) {
              if ((e.updateMorphTargets(), void 0 !== t.weights))
                for (var n = 0, r = t.weights.length; n < r; n++)
                  e.morphTargetInfluences[n] = t.weights[n];
              if (t.extras && Array.isArray(t.extras.targetNames)) {
                var i = t.extras.targetNames;
                if (e.morphTargetInfluences.length === i.length)
                  for (
                    e.morphTargetDictionary = {}, n = 0, r = i.length;
                    n < r;
                    n++
                  )
                    e.morphTargetDictionary[i[n]] = n;
              }
            }
            function U(e) {
              for (
                var t = "", n = Object.keys(e).sort(), r = 0, i = n.length;
                r < i;
                r++
              )
                t += n[r] + ":" + e[n[r]] + ";";
              return t;
            }
            function j(e, n, r) {
              (this.json = e || {}),
                (this.extensions = n || {}),
                (this.options = r || {}),
                (this.cache = new t()),
                (this.primitiveCache = {}),
                (this.textureLoader = new Qd(this.options.manager)),
                this.textureLoader.setCrossOrigin(this.options.crossOrigin),
                (this.fileLoader = new Gd(this.options.manager)),
                this.fileLoader.setResponseType("arraybuffer"),
                "use-credentials" === this.options.crossOrigin &&
                  this.fileLoader.setWithCredentials(!0);
            }
            function B(e, t, n) {
              var r = t.attributes,
                i = [];
              function a(t, r) {
                return n.getDependency("accessor", t).then(function(t) {
                  e.setAttribute(r, t);
                });
              }
              for (var o in r) {
                var s = E[o] || o.toLowerCase();
                s in e.attributes || i.push(a(r[o], s));
              }
              if (void 0 !== t.indices && !e.index) {
                var l = n
                  .getDependency("accessor", t.indices)
                  .then(function(t) {
                    e.setIndex(t);
                  });
                i.push(l);
              }
              return (
                F(e, t),
                (function(e, t, n) {
                  var r = t.attributes,
                    i = new Za();
                  if (void 0 !== r.POSITION) {
                    var a = (h = n.json.accessors[r.POSITION]).min,
                      o = h.max;
                    i.set(new ea(a[0], a[1], a[2]), new ea(o[0], o[1], o[2]));
                    var s = t.targets;
                    if (void 0 !== s)
                      for (var l = new ea(), c = 0, u = s.length; c < u; c++) {
                        var h,
                          d = s[c];
                        if (void 0 !== d.POSITION)
                          (a = (h = n.json.accessors[d.POSITION]).min),
                            (o = h.max),
                            l.setX(Math.max(Math.abs(a[0]), Math.abs(o[0]))),
                            l.setY(Math.max(Math.abs(a[1]), Math.abs(o[1]))),
                            l.setZ(Math.max(Math.abs(a[2]), Math.abs(o[2]))),
                            i.expandByVector(l);
                      }
                    e.boundingBox = i;
                    var p = new $a();
                    i.getCenter(p.center),
                      (p.radius = i.min.distanceTo(i.max) / 2),
                      (e.boundingSphere = p);
                  }
                })(e, t, n),
                Promise.all(i).then(function() {
                  return void 0 !== t.targets
                    ? (function(e, t, n) {
                        for (
                          var r = !1, i = !1, a = 0, o = t.length;
                          a < o &&
                          (void 0 !== (c = t[a]).POSITION && (r = !0),
                          void 0 !== c.NORMAL && (i = !0),
                          !r || !i);
                          a++
                        );
                        if (!r && !i) return Promise.resolve(e);
                        var s = [],
                          l = [];
                        for (a = 0, o = t.length; a < o; a++) {
                          var c = t[a];
                          if (r) {
                            var u =
                              void 0 !== c.POSITION
                                ? n.getDependency("accessor", c.POSITION)
                                : e.attributes.position;
                            s.push(u);
                          }
                          i &&
                            ((u =
                              void 0 !== c.NORMAL
                                ? n.getDependency("accessor", c.NORMAL)
                                : e.attributes.normal),
                            l.push(u));
                        }
                        return Promise.all([
                          Promise.all(s),
                          Promise.all(l)
                        ]).then(function(t) {
                          var n = t[0],
                            a = t[1];
                          return (
                            r && (e.morphAttributes.position = n),
                            i && (e.morphAttributes.normal = a),
                            (e.morphTargetsRelative = !0),
                            e
                          );
                        });
                      })(e, t.targets, n)
                    : e;
                })
              );
            }
            return (
              (j.prototype.parse = function(e, t) {
                var n = this,
                  r = this.json,
                  i = this.extensions;
                this.cache.removeAll(),
                  this.markDefs(),
                  Promise.all([
                    this.getDependencies("scene"),
                    this.getDependencies("animation"),
                    this.getDependencies("camera")
                  ])
                    .then(function(t) {
                      var a = {
                        scene: t[0][r.scene || 0],
                        scenes: t[0],
                        animations: t[1],
                        cameras: t[2],
                        asset: r.asset,
                        parser: n,
                        userData: {}
                      };
                      N(i, a, r), F(a, r), e(a);
                    })
                    .catch(t);
              }),
              (j.prototype.markDefs = function() {
                for (
                  var e = this.json.nodes || [],
                    t = this.json.skins || [],
                    n = this.json.meshes || [],
                    r = {},
                    i = {},
                    a = 0,
                    o = t.length;
                  a < o;
                  a++
                )
                  for (var s = t[a].joints, l = 0, c = s.length; l < c; l++)
                    e[s[l]].isBone = !0;
                for (var u = 0, h = e.length; u < h; u++) {
                  var d = e[u];
                  void 0 !== d.mesh &&
                    (void 0 === r[d.mesh] && (r[d.mesh] = i[d.mesh] = 0),
                    r[d.mesh]++,
                    void 0 !== d.skin && (n[d.mesh].isSkinnedMesh = !0));
                }
                (this.json.meshReferences = r), (this.json.meshUses = i);
              }),
              (j.prototype.getDependency = function(e, t) {
                var r = e + ":" + t,
                  i = this.cache.get(r);
                if (!i) {
                  switch (e) {
                    case "scene":
                      i = this.loadScene(t);
                      break;
                    case "node":
                      i = this.loadNode(t);
                      break;
                    case "mesh":
                      i = this.loadMesh(t);
                      break;
                    case "accessor":
                      i = this.loadAccessor(t);
                      break;
                    case "bufferView":
                      i = this.loadBufferView(t);
                      break;
                    case "buffer":
                      i = this.loadBuffer(t);
                      break;
                    case "material":
                      i = this.loadMaterial(t);
                      break;
                    case "texture":
                      i = this.loadTexture(t);
                      break;
                    case "skin":
                      i = this.loadSkin(t);
                      break;
                    case "animation":
                      i = this.loadAnimation(t);
                      break;
                    case "camera":
                      i = this.loadCamera(t);
                      break;
                    case "light":
                      i = this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);
                      break;
                    default:
                      throw new Error("Unknown type: " + e);
                  }
                  this.cache.add(r, i);
                }
                return i;
              }),
              (j.prototype.getDependencies = function(e) {
                var t = this.cache.get(e);
                if (!t) {
                  var n = this,
                    r = this.json[e + ("mesh" === e ? "es" : "s")] || [];
                  (t = Promise.all(
                    r.map(function(t, r) {
                      return n.getDependency(e, r);
                    })
                  )),
                    this.cache.add(e, t);
                }
                return t;
              }),
              (j.prototype.loadBuffer = function(e) {
                var t = this.json.buffers[e],
                  r = this.fileLoader;
                if (t.type && "arraybuffer" !== t.type)
                  throw new Error(
                    "THREE.GLTFLoader: " +
                      t.type +
                      " buffer type is not supported."
                  );
                if (void 0 === t.uri && 0 === e)
                  return Promise.resolve(
                    this.extensions[n.KHR_BINARY_GLTF].body
                  );
                var i = this.options;
                return new Promise(function(e, n) {
                  r.load(L(t.uri, i.path), e, void 0, function() {
                    n(
                      new Error(
                        'THREE.GLTFLoader: Failed to load buffer "' +
                          t.uri +
                          '".'
                      )
                    );
                  });
                });
              }),
              (j.prototype.loadBufferView = function(e) {
                var t = this.json.bufferViews[e];
                return this.getDependency("buffer", t.buffer).then(function(e) {
                  var n = t.byteLength || 0,
                    r = t.byteOffset || 0;
                  return e.slice(r, r + n);
                });
              }),
              (j.prototype.loadAccessor = function(e) {
                var t = this,
                  n = this.json,
                  r = this.json.accessors[e];
                if (void 0 === r.bufferView && void 0 === r.sparse)
                  return Promise.resolve(null);
                var i = [];
                return (
                  void 0 !== r.bufferView
                    ? i.push(this.getDependency("bufferView", r.bufferView))
                    : i.push(null),
                  void 0 !== r.sparse &&
                    (i.push(
                      this.getDependency(
                        "bufferView",
                        r.sparse.indices.bufferView
                      )
                    ),
                    i.push(
                      this.getDependency(
                        "bufferView",
                        r.sparse.values.bufferView
                      )
                    )),
                  Promise.all(i).then(function(e) {
                    var i,
                      a = e[0],
                      o = S[r.type],
                      s = M[r.componentType],
                      l = s.BYTES_PER_ELEMENT,
                      c = l * o,
                      u = r.byteOffset || 0,
                      h =
                        void 0 !== r.bufferView
                          ? n.bufferViews[r.bufferView].byteStride
                          : void 0,
                      d = !0 === r.normalized;
                    if (h && h !== c) {
                      var p = Math.floor(u / h),
                        f =
                          "InterleavedBuffer:" +
                          r.bufferView +
                          ":" +
                          r.componentType +
                          ":" +
                          p +
                          ":" +
                          r.count,
                        m = t.cache.get(f);
                      m ||
                        ((m = new tu(
                          new s(a, p * h, (r.count * h) / l),
                          h / l
                        )),
                        t.cache.add(f, m)),
                        (i = new nu(m, o, (u % h) / l, d));
                    } else i = new No(null === a ? new s(r.count * o) : new s(a, u, r.count * o), o, d);
                    if (void 0 !== r.sparse) {
                      var v = S.SCALAR,
                        g = M[r.sparse.indices.componentType],
                        y = r.sparse.indices.byteOffset || 0,
                        b = r.sparse.values.byteOffset || 0,
                        x = new g(e[1], y, r.sparse.count * v),
                        w = new s(e[2], b, r.sparse.count * o);
                      null !== a &&
                        (i = new No(i.array.slice(), i.itemSize, i.normalized));
                      for (var _ = 0, T = x.length; _ < T; _++) {
                        var A = x[_];
                        if (
                          (i.setX(A, w[_ * o]),
                          o >= 2 && i.setY(A, w[_ * o + 1]),
                          o >= 3 && i.setZ(A, w[_ * o + 2]),
                          o >= 4 && i.setW(A, w[_ * o + 3]),
                          o >= 5)
                        )
                          throw new Error(
                            "THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute."
                          );
                      }
                    }
                    return i;
                  })
                );
              }),
              (j.prototype.loadTexture = function(e) {
                var t,
                  r = this,
                  i = this.json,
                  a = this.options,
                  o = this.textureLoader,
                  s = window.URL || window.webkitURL,
                  l = i.textures[e],
                  c = l.extensions || {},
                  u = (t = c[n.MSFT_TEXTURE_DDS]
                    ? i.images[c[n.MSFT_TEXTURE_DDS].source]
                    : i.images[l.source]).uri,
                  h = !1;
                return (
                  void 0 !== t.bufferView &&
                    (u = r
                      .getDependency("bufferView", t.bufferView)
                      .then(function(e) {
                        h = !0;
                        var n = new Blob([e], { type: t.mimeType });
                        return (u = s.createObjectURL(n));
                      })),
                  Promise.resolve(u)
                    .then(function(e) {
                      var t = a.manager.getHandler(e);
                      return (
                        t ||
                          (t = c[n.MSFT_TEXTURE_DDS]
                            ? r.extensions[n.MSFT_TEXTURE_DDS].ddsLoader
                            : o),
                        new Promise(function(n, r) {
                          t.load(L(e, a.path), n, void 0, r);
                        })
                      );
                    })
                    .then(function(e) {
                      !0 === h && s.revokeObjectURL(u),
                        (e.flipY = !1),
                        void 0 !== l.name && (e.name = l.name),
                        t.mimeType in C && (e.format = C[t.mimeType]);
                      var n = (i.samplers || {})[l.sampler] || {};
                      return (
                        (e.magFilter = T[n.magFilter] || nr),
                        (e.minFilter = T[n.minFilter] || ar),
                        (e.wrapS = A[n.wrapS] || qn),
                        (e.wrapT = A[n.wrapT] || qn),
                        e
                      );
                    })
                );
              }),
              (j.prototype.assignTexture = function(e, t, r) {
                var i = this;
                return this.getDependency("texture", r.index).then(function(a) {
                  if (!a.isCompressedTexture)
                    switch (t) {
                      case "aoMap":
                      case "emissiveMap":
                      case "metalnessMap":
                      case "normalMap":
                      case "roughnessMap":
                        a.format = xr;
                    }
                  if (i.extensions[n.KHR_TEXTURE_TRANSFORM]) {
                    var o =
                      void 0 !== r.extensions
                        ? r.extensions[n.KHR_TEXTURE_TRANSFORM]
                        : void 0;
                    o &&
                      (a = i.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(
                        a,
                        o
                      ));
                  }
                  e[t] = a;
                });
              }),
              (j.prototype.assignFinalMaterial = function(e) {
                var t = e.geometry,
                  r = e.material,
                  i = this.extensions,
                  a = void 0 !== t.attributes.tangent,
                  o = void 0 !== t.attributes.color,
                  s = void 0 === t.attributes.normal,
                  l = !0 === e.isSkinnedMesh,
                  c = Object.keys(t.morphAttributes).length > 0,
                  u = c && void 0 !== t.morphAttributes.normal;
                if (e.isPoints) {
                  var h = "PointsMaterial:" + r.uuid,
                    d = this.cache.get(h);
                  d ||
                    ((d = new Vu()),
                    Co.prototype.copy.call(d, r),
                    d.color.copy(r.color),
                    (d.map = r.map),
                    (d.sizeAttenuation = !1),
                    this.cache.add(h, d)),
                    (r = d);
                } else if (e.isLine) {
                  h = "LineBasicMaterial:" + r.uuid;
                  var p = this.cache.get(h);
                  p ||
                    ((p = new Du()),
                    Co.prototype.copy.call(p, r),
                    p.color.copy(r.color),
                    this.cache.add(h, p)),
                    (r = p);
                }
                if (a || o || s || l || c) {
                  (h = "ClonedMaterial:" + r.uuid + ":"),
                    r.isGLTFSpecularGlossinessMaterial &&
                      (h += "specular-glossiness:"),
                    l && (h += "skinning:"),
                    a && (h += "vertex-tangents:"),
                    o && (h += "vertex-colors:"),
                    s && (h += "flat-shading:"),
                    c && (h += "morph-targets:"),
                    u && (h += "morph-normals:");
                  var f = this.cache.get(h);
                  f ||
                    ((f = r.isGLTFSpecularGlossinessMaterial
                      ? i[
                          n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS
                        ].cloneMaterial(r)
                      : r.clone()),
                    l && (f.skinning = !0),
                    a && (f.vertexTangents = !0),
                    o && (f.vertexColors = $t),
                    s && (f.flatShading = !0),
                    c && (f.morphTargets = !0),
                    u && (f.morphNormals = !0),
                    this.cache.add(h, f)),
                    (r = f);
                }
                r.aoMap &&
                  void 0 === t.attributes.uv2 &&
                  void 0 !== t.attributes.uv &&
                  t.setAttribute("uv2", new No(t.attributes.uv.array, 2)),
                  r.isGLTFSpecularGlossinessMaterial &&
                    (e.onBeforeRender =
                      i[
                        n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS
                      ].refreshUniforms),
                  (e.material = r);
              }),
              (j.prototype.loadMaterial = function(e) {
                var t,
                  r = this.json,
                  i = this.extensions,
                  a = r.materials[e],
                  o = {},
                  s = a.extensions || {},
                  l = [];
                if (s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {
                  var c = i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];
                  (t = c.getMaterialType()), l.push(c.extendParams(o, a, this));
                } else if (s[n.KHR_MATERIALS_UNLIT]) {
                  var u = i[n.KHR_MATERIALS_UNLIT];
                  (t = u.getMaterialType()), l.push(u.extendParams(o, a, this));
                } else {
                  t = fd;
                  var h = a.pbrMetallicRoughness || {};
                  if (
                    ((o.color = new Eo(1, 1, 1)),
                    (o.opacity = 1),
                    Array.isArray(h.baseColorFactor))
                  ) {
                    var d = h.baseColorFactor;
                    o.color.fromArray(d), (o.opacity = d[3]);
                  }
                  void 0 !== h.baseColorTexture &&
                    l.push(this.assignTexture(o, "map", h.baseColorTexture)),
                    (o.metalness =
                      void 0 !== h.metallicFactor ? h.metallicFactor : 1),
                    (o.roughness =
                      void 0 !== h.roughnessFactor ? h.roughnessFactor : 1),
                    void 0 !== h.metallicRoughnessTexture &&
                      (l.push(
                        this.assignTexture(
                          o,
                          "metalnessMap",
                          h.metallicRoughnessTexture
                        )
                      ),
                      l.push(
                        this.assignTexture(
                          o,
                          "roughnessMap",
                          h.metallicRoughnessTexture
                        )
                      ));
                }
                !0 === a.doubleSided && (o.side = qt);
                var p = a.alphaMode || I;
                return (
                  p === O
                    ? (o.transparent = !0)
                    : ((o.transparent = !1),
                      p === D &&
                        (o.alphaTest =
                          void 0 !== a.alphaCutoff ? a.alphaCutoff : 0.5)),
                  void 0 !== a.normalTexture &&
                    t !== Lo &&
                    (l.push(
                      this.assignTexture(o, "normalMap", a.normalTexture)
                    ),
                    (o.normalScale = new Zi(1, 1)),
                    void 0 !== a.normalTexture.scale &&
                      o.normalScale.set(
                        a.normalTexture.scale,
                        a.normalTexture.scale
                      )),
                  void 0 !== a.occlusionTexture &&
                    t !== Lo &&
                    (l.push(this.assignTexture(o, "aoMap", a.occlusionTexture)),
                    void 0 !== a.occlusionTexture.strength &&
                      (o.aoMapIntensity = a.occlusionTexture.strength)),
                  void 0 !== a.emissiveFactor &&
                    t !== Lo &&
                    (o.emissive = new Eo().fromArray(a.emissiveFactor)),
                  void 0 !== a.emissiveTexture &&
                    t !== Lo &&
                    l.push(
                      this.assignTexture(o, "emissiveMap", a.emissiveTexture)
                    ),
                  Promise.all(l).then(function() {
                    var e;
                    return (
                      (e =
                        t === Cs
                          ? i[
                              n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS
                            ].createMaterial(o)
                          : new t(o)),
                      void 0 !== a.name && (e.name = a.name),
                      e.map && (e.map.encoding = ui),
                      e.emissiveMap && (e.emissiveMap.encoding = ui),
                      e.specularMap && (e.specularMap.encoding = ui),
                      F(e, a),
                      a.extensions && N(i, e, a),
                      e
                    );
                  })
                );
              }),
              (j.prototype.loadGeometries = function(e) {
                var t = this,
                  r = this.extensions,
                  i = this.primitiveCache;
                function a(e) {
                  return r[n.KHR_DRACO_MESH_COMPRESSION]
                    .decodePrimitive(e, t)
                    .then(function(n) {
                      return B(n, e, t);
                    });
                }
                for (var o, s, l = [], c = 0, u = e.length; c < u; c++) {
                  var h,
                    d = e[c],
                    p =
                      ((s = void 0),
                      (s =
                        (o = d).extensions &&
                        o.extensions[n.KHR_DRACO_MESH_COMPRESSION])
                        ? "draco:" +
                          s.bufferView +
                          ":" +
                          s.indices +
                          ":" +
                          U(s.attributes)
                        : o.indices + ":" + U(o.attributes) + ":" + o.mode),
                    f = i[p];
                  f
                    ? l.push(f.promise)
                    : ((h =
                        d.extensions &&
                        d.extensions[n.KHR_DRACO_MESH_COMPRESSION]
                          ? a(d)
                          : B(new es(), d, t)),
                      (i[p] = { primitive: d, promise: h }),
                      l.push(h));
                }
                return Promise.all(l);
              }),
              (j.prototype.loadMesh = function(e) {
                for (
                  var t = this,
                    n = this.json.meshes[e],
                    r = n.primitives,
                    i = [],
                    a = 0,
                    o = r.length;
                  a < o;
                  a++
                ) {
                  var s =
                    void 0 === r[a].material
                      ? (m =
                          m ||
                          new fd({
                            color: 16777215,
                            emissive: 0,
                            metalness: 1,
                            roughness: 1,
                            transparent: !1,
                            depthTest: !0,
                            side: Wt
                          }))
                      : this.getDependency("material", r[a].material);
                  i.push(s);
                }
                return Promise.all(i).then(function(i) {
                  return t.loadGeometries(r).then(function(a) {
                    for (var o = [], s = 0, l = a.length; s < l; s++) {
                      var c,
                        u = a[s],
                        h = r[s],
                        d = i[s];
                      if (
                        h.mode === x ||
                        h.mode === w ||
                        h.mode === _ ||
                        void 0 === h.mode
                      )
                        !0 !==
                          (c =
                            !0 === n.isSkinnedMesh
                              ? new wu(u, d)
                              : new ys(u, d)).isSkinnedMesh ||
                          c.geometry.attributes.skinWeight.normalized ||
                          c.normalizeSkinWeights(),
                          h.mode === w
                            ? (c.drawMode = si)
                            : h.mode === _ && (c.drawMode = li);
                      else if (h.mode === g) c = new Bu(u, d);
                      else if (h.mode === b) c = new ku(u, d);
                      else if (h.mode === y) c = new zu(u, d);
                      else {
                        if (h.mode !== v)
                          throw new Error(
                            "THREE.GLTFLoader: Primitive mode unsupported: " +
                              h.mode
                          );
                        c = new Yu(u, d);
                      }
                      Object.keys(c.geometry.morphAttributes).length > 0 &&
                        k(c, n),
                        (c.name = n.name || "mesh_" + e),
                        a.length > 1 && (c.name += "_" + s),
                        F(c, n),
                        t.assignFinalMaterial(c),
                        o.push(c);
                    }
                    if (1 === o.length) return o[0];
                    var p = new Hc();
                    for (s = 0, l = o.length; s < l; s++) p.add(o[s]);
                    return p;
                  });
                });
              }),
              (j.prototype.loadCamera = function(e) {
                var t,
                  n = this.json.cameras[e],
                  r = n[n.type];
                if (r)
                  return (
                    "perspective" === n.type
                      ? (t = new Ns(
                          Qi.radToDeg(r.yfov),
                          r.aspectRatio || 1,
                          r.znear || 1,
                          r.zfar || 2e6
                        ))
                      : "orthographic" === n.type &&
                        (t = new Sp(
                          r.xmag / -2,
                          r.xmag / 2,
                          r.ymag / 2,
                          r.ymag / -2,
                          r.znear,
                          r.zfar
                        )),
                    void 0 !== n.name && (t.name = n.name),
                    F(t, n),
                    Promise.resolve(t)
                  );
              }),
              (j.prototype.loadSkin = function(e) {
                var t = this.json.skins[e],
                  n = { joints: t.joints };
                return void 0 === t.inverseBindMatrices
                  ? Promise.resolve(n)
                  : this.getDependency("accessor", t.inverseBindMatrices).then(
                      function(e) {
                        return (n.inverseBindMatrices = e), n;
                      }
                    );
              }),
              (j.prototype.loadAnimation = function(e) {
                for (
                  var t = this.json.animations[e],
                    n = [],
                    r = [],
                    i = [],
                    a = [],
                    o = [],
                    s = 0,
                    l = t.channels.length;
                  s < l;
                  s++
                ) {
                  var c = t.channels[s],
                    u = t.samplers[c.sampler],
                    h = c.target,
                    d = void 0 !== h.node ? h.node : h.id,
                    p =
                      void 0 !== t.parameters ? t.parameters[u.input] : u.input,
                    m =
                      void 0 !== t.parameters
                        ? t.parameters[u.output]
                        : u.output;
                  n.push(this.getDependency("node", d)),
                    r.push(this.getDependency("accessor", p)),
                    i.push(this.getDependency("accessor", m)),
                    a.push(u),
                    o.push(h);
                }
                return Promise.all([
                  Promise.all(n),
                  Promise.all(r),
                  Promise.all(i),
                  Promise.all(a),
                  Promise.all(o)
                ]).then(function(n) {
                  for (
                    var r = n[0],
                      i = n[1],
                      a = n[2],
                      o = n[3],
                      s = n[4],
                      l = [],
                      c = 0,
                      u = r.length;
                    c < u;
                    c++
                  ) {
                    var h = r[c],
                      d = i[c],
                      p = a[c],
                      m = o[c],
                      v = s[c];
                    if (void 0 !== h) {
                      var g;
                      switch (
                        (h.updateMatrix(), (h.matrixAutoUpdate = !0), R[v.path])
                      ) {
                        case R.weights:
                          g = Dd;
                          break;
                        case R.rotation:
                          g = Cd;
                          break;
                        case R.position:
                        case R.scale:
                        default:
                          g = Nd;
                      }
                      var y = h.name ? h.name : h.uuid,
                        b =
                          void 0 !== m.interpolation ? P[m.interpolation] : ti,
                        x = [];
                      R[v.path] === R.weights
                        ? h.traverse(function(e) {
                            !0 === e.isMesh &&
                              e.morphTargetInfluences &&
                              x.push(e.name ? e.name : e.uuid);
                          })
                        : x.push(y);
                      var w = p.array;
                      if (p.normalized) {
                        var _;
                        if (w.constructor === Int8Array) _ = 1 / 127;
                        else if (w.constructor === Uint8Array) _ = 1 / 255;
                        else if (w.constructor == Int16Array) _ = 1 / 32767;
                        else {
                          if (w.constructor !== Uint16Array)
                            throw new Error(
                              "THREE.GLTFLoader: Unsupported output accessor component type."
                            );
                          _ = 1 / 65535;
                        }
                        for (
                          var M = new Float32Array(w.length),
                            T = 0,
                            A = w.length;
                          T < A;
                          T++
                        )
                          M[T] = w[T] * _;
                        w = M;
                      }
                      for (T = 0, A = x.length; T < A; T++) {
                        var S = new g(x[T] + "." + R[v.path], d.array, w, b);
                        "CUBICSPLINE" === m.interpolation &&
                          ((S.createInterpolant = function(e) {
                            return new f(
                              this.times,
                              this.values,
                              this.getValueSize() / 3,
                              e
                            );
                          }),
                          (S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = !0)),
                          l.push(S);
                      }
                    }
                  }
                  return new Fd(
                    void 0 !== t.name ? t.name : "animation_" + e,
                    void 0,
                    l
                  );
                });
              }),
              (j.prototype.loadNode = function(e) {
                var t,
                  r = this.json,
                  i = this.extensions,
                  a = this,
                  o = r.meshReferences,
                  s = r.meshUses,
                  l = r.nodes[e];
                return ((t = []),
                void 0 !== l.mesh &&
                  t.push(
                    a.getDependency("mesh", l.mesh).then(function(e) {
                      var t;
                      if (o[l.mesh] > 1) {
                        var n = s[l.mesh]++;
                        ((t = e.clone()).name += "_instance_" + n),
                          (t.onBeforeRender = e.onBeforeRender);
                        for (var r = 0, i = t.children.length; r < i; r++)
                          (t.children[r].name += "_instance_" + n),
                            (t.children[r].onBeforeRender =
                              e.children[r].onBeforeRender);
                      } else t = e;
                      return (
                        void 0 !== l.weights &&
                          t.traverse(function(e) {
                            if (e.isMesh)
                              for (var t = 0, n = l.weights.length; t < n; t++)
                                e.morphTargetInfluences[t] = l.weights[t];
                          }),
                        t
                      );
                    })
                  ),
                void 0 !== l.camera &&
                  t.push(a.getDependency("camera", l.camera)),
                l.extensions &&
                  l.extensions[n.KHR_LIGHTS_PUNCTUAL] &&
                  void 0 !== l.extensions[n.KHR_LIGHTS_PUNCTUAL].light &&
                  t.push(
                    a.getDependency(
                      "light",
                      l.extensions[n.KHR_LIGHTS_PUNCTUAL].light
                    )
                  ),
                Promise.all(t)).then(function(e) {
                  var t;
                  if (
                    (t =
                      !0 === l.isBone
                        ? new Au()
                        : e.length > 1
                        ? new Hc()
                        : 1 === e.length
                        ? e[0]
                        : new Na()) !== e[0]
                  )
                    for (var n = 0, r = e.length; n < r; n++) t.add(e[n]);
                  if (
                    (void 0 !== l.name &&
                      ((t.userData.name = l.name),
                      (t.name = Sf.sanitizeNodeName(l.name))),
                    F(t, l),
                    l.extensions && N(i, t, l),
                    void 0 !== l.matrix)
                  ) {
                    var a = new ga();
                    a.fromArray(l.matrix), t.applyMatrix(a);
                  } else void 0 !== l.translation && t.position.fromArray(l.translation), void 0 !== l.rotation && t.quaternion.fromArray(l.rotation), void 0 !== l.scale && t.scale.fromArray(l.scale);
                  return t;
                });
              }),
              (j.prototype.loadScene = (function() {
                function e(t, n, r, i) {
                  var a = r.nodes[t];
                  return i
                    .getDependency("node", t)
                    .then(function(e) {
                      return void 0 === a.skin
                        ? e
                        : i
                            .getDependency("skin", a.skin)
                            .then(function(e) {
                              for (
                                var n = [], r = 0, a = (t = e).joints.length;
                                r < a;
                                r++
                              )
                                n.push(i.getDependency("node", t.joints[r]));
                              return Promise.all(n);
                            })
                            .then(function(n) {
                              return (
                                e.traverse(function(e) {
                                  if (e.isMesh) {
                                    for (
                                      var r = [], i = [], a = 0, o = n.length;
                                      a < o;
                                      a++
                                    ) {
                                      var s = n[a];
                                      if (s) {
                                        r.push(s);
                                        var l = new ga();
                                        void 0 !== t.inverseBindMatrices &&
                                          l.fromArray(
                                            t.inverseBindMatrices.array,
                                            16 * a
                                          ),
                                          i.push(l);
                                      }
                                    }
                                    e.bind(new Tu(r, i), e.matrixWorld);
                                  }
                                }),
                                e
                              );
                            });
                      var t;
                    })
                    .then(function(t) {
                      n.add(t);
                      var o = [];
                      if (a.children)
                        for (
                          var s = a.children, l = 0, c = s.length;
                          l < c;
                          l++
                        ) {
                          var u = s[l];
                          o.push(e(u, t, r, i));
                        }
                      return Promise.all(o);
                    });
                }
                return function(t) {
                  var n = this.json,
                    r = this.extensions,
                    i = this.json.scenes[t],
                    a = new Fa();
                  void 0 !== i.name && (a.name = i.name),
                    F(a, i),
                    i.extensions && N(r, a, i);
                  for (
                    var o = i.nodes || [], s = [], l = 0, c = o.length;
                    l < c;
                    l++
                  )
                    s.push(e(o[l], a, n, this));
                  return Promise.all(s).then(function() {
                    return a;
                  });
                };
              })()),
              e
            );
          })(),
          mw = function(e) {
            zd.call(this, e),
              (this.decoderPath = ""),
              (this.decoderConfig = {}),
              (this.decoderBinary = null),
              (this.decoderPending = null),
              (this.workerLimit = 4),
              (this.workerPool = []),
              (this.workerNextTaskID = 1),
              (this.workerSourceURL = ""),
              (this.defaultAttributeIDs = {
                position: "POSITION",
                normal: "NORMAL",
                color: "COLOR",
                uv: "TEX_COORD"
              }),
              (this.defaultAttributeTypes = {
                position: "Float32Array",
                normal: "Float32Array",
                color: "Float32Array",
                uv: "Float32Array"
              });
          };
        (mw.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: mw,
          setDecoderPath: function(e) {
            return (this.decoderPath = e), this;
          },
          setDecoderConfig: function(e) {
            return (this.decoderConfig = e), this;
          },
          setWorkerLimit: function(e) {
            return (this.workerLimit = e), this;
          },
          setVerbosity: function() {},
          setDrawMode: function() {},
          setSkipDequantization: function() {},
          load: function(e, t, n, r) {
            var i = new Gd(this.manager);
            i.setPath(this.path),
              i.setResponseType("arraybuffer"),
              "use-credentials" === this.crossOrigin &&
                i.setWithCredentials(!0),
              i.load(
                e,
                e => {
                  var n = {
                    attributeIDs: this.defaultAttributeIDs,
                    attributeTypes: this.defaultAttributeTypes,
                    useUniqueIDs: !1
                  };
                  this.decodeGeometry(e, n)
                    .then(t)
                    .catch(r);
                },
                n,
                r
              );
          },
          decodeDracoFile: function(e, t, n, r) {
            var i = {
              attributeIDs: n || this.defaultAttributeIDs,
              attributeTypes: r || this.defaultAttributeTypes,
              useUniqueIDs: !!n
            };
            this.decodeGeometry(e, i).then(t);
          },
          decodeGeometry: function(e, t) {
            var n,
              r = this.workerNextTaskID++,
              i = e.byteLength;
            for (var a in t.attributeTypes) {
              var o = t.attributeTypes[a];
              void 0 !== o.BYTES_PER_ELEMENT && (t.attributeTypes[a] = o.name);
            }
            var s = this._getWorker(r, i)
              .then(
                i => (
                  (n = i),
                  new Promise((i, a) => {
                    (n._callbacks[r] = { resolve: i, reject: a }),
                      n.postMessage(
                        { type: "decode", id: r, taskConfig: t, buffer: e },
                        [e]
                      );
                  })
                )
              )
              .then(e => this._createGeometry(e.geometry));
            return (
              s.finally(() => {
                n && r && this._releaseTask(n, r);
              }),
              s
            );
          },
          _createGeometry: function(e) {
            var t = new es();
            e.index && t.setIndex(new No(e.index.array, 1));
            for (var n = 0; n < e.attributes.length; n++) {
              var r = e.attributes[n],
                i = r.name,
                a = r.array,
                o = r.itemSize;
              t.setAttribute(i, new No(a, o));
            }
            return t;
          },
          _loadLibrary: function(e, t) {
            var n = new Gd(this.manager);
            return (
              n.setPath(this.decoderPath),
              n.setResponseType(t),
              new Promise((t, r) => {
                n.load(e, t, void 0, r);
              })
            );
          },
          preload: function() {
            return this._initDecoder(), this;
          },
          _initDecoder: function() {
            if (this.decoderPending) return this.decoderPending;
            var e =
                "object" != typeof WebAssembly ||
                "js" === this.decoderConfig.type,
              t = [];
            return (
              e
                ? t.push(this._loadLibrary("draco_decoder.js", "text"))
                : (t.push(this._loadLibrary("draco_wasm_wrapper.js", "text")),
                  t.push(
                    this._loadLibrary("draco_decoder.wasm", "arraybuffer")
                  )),
              (this.decoderPending = Promise.all(t).then(t => {
                var n = t[0];
                e || (this.decoderConfig.wasmBinary = t[1]);
                var r = mw.DRACOWorker.toString(),
                  i = [
                    "/* draco decoder */",
                    n,
                    "",
                    "/* worker */",
                    r.substring(r.indexOf("{") + 1, r.lastIndexOf("}"))
                  ].join("\n");
                this.workerSourceURL = URL.createObjectURL(new Blob([i]));
              })),
              this.decoderPending
            );
          },
          _getWorker: function(e, t) {
            return this._initDecoder().then(() => {
              var n;
              return (
                this.workerPool.length < this.workerLimit
                  ? (((n = new Worker(this.workerSourceURL))._callbacks = {}),
                    (n._taskCosts = {}),
                    (n._taskLoad = 0),
                    n.postMessage({
                      type: "init",
                      decoderConfig: this.decoderConfig
                    }),
                    (n.onmessage = function(e) {
                      var t = e.data;
                      switch (t.type) {
                        case "decode":
                          n._callbacks[t.id].resolve(t);
                          break;
                        case "error":
                          n._callbacks[t.id].reject(t);
                      }
                    }),
                    this.workerPool.push(n))
                  : this.workerPool.sort(function(e, t) {
                      return e._taskLoad > t._taskLoad ? -1 : 1;
                    }),
                ((n = this.workerPool[this.workerPool.length - 1])._taskCosts[
                  e
                ] = t),
                (n._taskLoad += t),
                n
              );
            });
          },
          _releaseTask: function(e, t) {
            (e._taskLoad -= e._taskCosts[t]),
              delete e._callbacks[t],
              delete e._taskCosts[t];
          },
          debug: function() {},
          dispose: function() {
            for (var e = 0; e < this.workerPool.length; ++e)
              this.workerPool[e].terminate();
            return (this.workerPool.length = 0), this;
          }
        })),
          (mw.DRACOWorker = function() {
            var e, t;
            function n(e, t, n, r, i, a) {
              var o,
                s,
                l = a.num_components(),
                c = n.num_points() * l;
              switch (i) {
                case Float32Array:
                  (o = new e.DracoFloat32Array()),
                    t.GetAttributeFloatForAllPoints(n, a, o),
                    (s = new Float32Array(c));
                  break;
                case Int8Array:
                  (o = new e.DracoInt8Array()),
                    t.GetAttributeInt8ForAllPoints(n, a, o),
                    (s = new Int8Array(c));
                  break;
                case Int16Array:
                  (o = new e.DracoInt16Array()),
                    t.GetAttributeInt16ForAllPoints(n, a, o),
                    (s = new Int16Array(c));
                  break;
                case Int32Array:
                  (o = new e.DracoInt32Array()),
                    t.GetAttributeInt32ForAllPoints(n, a, o),
                    (s = new Int32Array(c));
                  break;
                case Uint8Array:
                  (o = new e.DracoUInt8Array()),
                    t.GetAttributeUInt8ForAllPoints(n, a, o),
                    (s = new Uint8Array(c));
                  break;
                case Uint16Array:
                  (o = new e.DracoUInt16Array()),
                    t.GetAttributeUInt16ForAllPoints(n, a, o),
                    (s = new Uint16Array(c));
                  break;
                case Uint32Array:
                  (o = new e.DracoUInt32Array()),
                    t.GetAttributeUInt32ForAllPoints(n, a, o),
                    (s = new Uint32Array(c));
                  break;
                default:
                  throw new Error(
                    "THREE.DRACOLoader: Unexpected attribute type."
                  );
              }
              for (var u = 0; u < c; u++) s[u] = o.GetValue(u);
              return e.destroy(o), { name: r, array: s, itemSize: l };
            }
            onmessage = function(r) {
              var i = r.data;
              switch (i.type) {
                case "init":
                  (e = i.decoderConfig),
                    (t = new Promise(function(t) {
                      (e.onModuleLoaded = function(e) {
                        t({ draco: e });
                      }),
                        DracoDecoderModule(e);
                    }));
                  break;
                case "decode":
                  var a = i.buffer,
                    o = i.taskConfig;
                  t.then(e => {
                    var t = e.draco,
                      r = new t.Decoder(),
                      s = new t.DecoderBuffer();
                    s.Init(new Int8Array(a), a.byteLength);
                    try {
                      var l = (function(e, t, r, i) {
                          var a,
                            o,
                            s = i.attributeIDs,
                            l = i.attributeTypes,
                            c = t.GetEncodedGeometryType(r);
                          if (c === e.TRIANGULAR_MESH)
                            (a = new e.Mesh()),
                              (o = t.DecodeBufferToMesh(r, a));
                          else {
                            if (c !== e.POINT_CLOUD)
                              throw new Error(
                                "THREE.DRACOLoader: Unexpected geometry type."
                              );
                            (a = new e.PointCloud()),
                              (o = t.DecodeBufferToPointCloud(r, a));
                          }
                          if (!o.ok() || 0 === a.ptr)
                            throw new Error(
                              "THREE.DRACOLoader: Decoding failed: " +
                                o.error_msg()
                            );
                          var u = { index: null, attributes: [] };
                          for (var h in s) {
                            var d,
                              p,
                              f = self[l[h]];
                            if (i.useUniqueIDs)
                              (p = s[h]), (d = t.GetAttributeByUniqueId(a, p));
                            else {
                              if (-1 === (p = t.GetAttributeId(a, e[s[h]])))
                                continue;
                              d = t.GetAttribute(a, p);
                            }
                            u.attributes.push(n(e, t, a, h, f, d));
                          }
                          if (c === e.TRIANGULAR_MESH) {
                            for (
                              var m = a.num_faces(),
                                v = new Uint32Array(3 * m),
                                g = new e.DracoInt32Array(),
                                y = 0;
                              y < m;
                              ++y
                            ) {
                              t.GetFaceFromMesh(a, y, g);
                              for (var b = 0; b < 3; ++b)
                                v[3 * y + b] = g.GetValue(b);
                            }
                            (u.index = { array: v, itemSize: 1 }), e.destroy(g);
                          }
                          return e.destroy(a), u;
                        })(t, r, s, o),
                        c = l.attributes.map(e => e.array.buffer);
                      l.index && c.push(l.index.array.buffer),
                        self.postMessage(
                          { type: "decode", id: i.id, geometry: l },
                          c
                        );
                    } catch (e) {
                      self.postMessage({
                        type: "error",
                        id: i.id,
                        error: e.message
                      });
                    } finally {
                      t.destroy(s), t.destroy(r);
                    }
                  });
              }
            };
          }),
          (mw.setDecoderPath = function() {}),
          (mw.setDecoderConfig = function() {}),
          (mw.releaseDecoderModule = function() {}),
          (mw.getDecoderModule = function() {});
        var vw = function(e) {
          zd.call(this, e),
            (this.transcoderPath = ""),
            (this.transcoderBinary = null),
            (this.transcoderPending = null),
            (this.workerLimit = 4),
            (this.workerPool = []),
            (this.workerNextTaskID = 1),
            (this.workerSourceURL = ""),
            (this.workerConfig = {
              format: null,
              astcSupported: !1,
              etcSupported: !1,
              dxtSupported: !1,
              pvrtcSupported: !1
            });
        };
        (vw.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: vw,
          setTranscoderPath: function(e) {
            return (this.transcoderPath = e), this;
          },
          setWorkerLimit: function(e) {
            return (this.workerLimit = e), this;
          },
          detectSupport: function(e) {
            var t = this.workerConfig;
            if (
              ((t.astcSupported = !!e.extensions.get(
                "WEBGL_compressed_texture_astc"
              )),
              (t.etcSupported = !!e.extensions.get(
                "WEBGL_compressed_texture_etc1"
              )),
              (t.dxtSupported = !!e.extensions.get(
                "WEBGL_compressed_texture_s3tc"
              )),
              (t.pvrtcSupported =
                !!e.extensions.get("WEBGL_compressed_texture_pvrtc") ||
                !!e.extensions.get("WEBKIT_WEBGL_compressed_texture_pvrtc")),
              t.astcSupported)
            )
              t.format = vw.BASIS_FORMAT.cTFASTC_4x4;
            else if (t.dxtSupported) t.format = vw.BASIS_FORMAT.cTFBC3;
            else if (t.pvrtcSupported)
              t.format = vw.BASIS_FORMAT.cTFPVRTC1_4_RGBA;
            else {
              if (!t.etcSupported)
                throw new Error(
                  "THREE.BasisTextureLoader: No suitable compressed texture format found."
                );
              t.format = vw.BASIS_FORMAT.cTFETC1;
            }
            return this;
          },
          load: function(e, t, n, r) {
            var i = new Gd(this.manager);
            i.setResponseType("arraybuffer"),
              i.load(
                e,
                e => {
                  this._createTexture(e)
                    .then(t)
                    .catch(r);
                },
                n,
                r
              );
          },
          _createTexture: function(e) {
            var t,
              n,
              r = this._getWorker()
                .then(
                  r => (
                    (t = r),
                    (n = this.workerNextTaskID++),
                    new Promise((r, i) => {
                      (t._callbacks[n] = { resolve: r, reject: i }),
                        (t._taskCosts[n] = e.byteLength),
                        (t._taskLoad += t._taskCosts[n]),
                        t.postMessage({ type: "transcode", id: n, buffer: e }, [
                          e
                        ]);
                    })
                  )
                )
                .then(e => {
                  var t,
                    n = this.workerConfig,
                    { width: r, height: i, mipmaps: a, format: o } = e;
                  switch (o) {
                    case vw.BASIS_FORMAT.cTFASTC_4x4:
                      t = new Zu(a, r, i, kr);
                      break;
                    case vw.BASIS_FORMAT.cTFBC1:
                    case vw.BASIS_FORMAT.cTFBC3:
                      t = new Zu(a, r, i, vw.DXT_FORMAT_MAP[n.format], sr);
                      break;
                    case vw.BASIS_FORMAT.cTFETC1:
                      t = new Zu(a, r, i, Fr);
                      break;
                    case vw.BASIS_FORMAT.cTFPVRTC1_4_RGB:
                      t = new Zu(a, r, i, Or);
                      break;
                    case vw.BASIS_FORMAT.cTFPVRTC1_4_RGBA:
                      t = new Zu(a, r, i, Lr);
                      break;
                    default:
                      throw new Error(
                        "THREE.BasisTextureLoader: No supported format available."
                      );
                  }
                  return (
                    (t.minFilter = 1 === a.length ? nr : ar),
                    (t.magFilter = nr),
                    (t.generateMipmaps = !1),
                    (t.needsUpdate = !0),
                    t
                  );
                });
            return (
              r.finally(() => {
                t &&
                  n &&
                  ((t._taskLoad -= t._taskCosts[n]),
                  delete t._callbacks[n],
                  delete t._taskCosts[n]);
              }),
              r
            );
          },
          _initTranscoder: function() {
            if (!this.transcoderBinary) {
              var e = new Gd(this.manager);
              e.setPath(this.transcoderPath);
              var t = new Promise((t, n) => {
                  e.load("basis_transcoder.js", t, void 0, n);
                }),
                n = new Gd(this.manager);
              n.setPath(this.transcoderPath), n.setResponseType("arraybuffer");
              var r = new Promise((e, t) => {
                n.load("basis_transcoder.wasm", e, void 0, t);
              });
              this.transcoderPending = Promise.all([t, r]).then(([e, t]) => {
                var n = vw.BasisWorker.toString(),
                  r = [
                    "/* basis_transcoder.js */",
                    e,
                    "/* worker */",
                    n.substring(n.indexOf("{") + 1, n.lastIndexOf("}"))
                  ].join("\n");
                (this.workerSourceURL = URL.createObjectURL(new Blob([r]))),
                  (this.transcoderBinary = t);
              });
            }
            return this.transcoderPending;
          },
          _getWorker: function() {
            return this._initTranscoder().then(() => {
              if (this.workerPool.length < this.workerLimit) {
                var e = new Worker(this.workerSourceURL);
                (e._callbacks = {}),
                  (e._taskCosts = {}),
                  (e._taskLoad = 0),
                  e.postMessage({
                    type: "init",
                    config: this.workerConfig,
                    transcoderBinary: this.transcoderBinary
                  }),
                  (e.onmessage = function(t) {
                    var n = t.data;
                    switch (n.type) {
                      case "transcode":
                        e._callbacks[n.id].resolve(n);
                        break;
                      case "error":
                        e._callbacks[n.id].reject(n);
                    }
                  }),
                  this.workerPool.push(e);
              } else
                this.workerPool.sort(function(e, t) {
                  return e._taskLoad > t._taskLoad ? -1 : 1;
                });
              return this.workerPool[this.workerPool.length - 1];
            });
          },
          dispose: function() {
            for (var e = 0; e < this.workerPool.length; e++)
              this.workerPool[e].terminate();
            return (this.workerPool.length = 0), this;
          }
        })),
          (vw.BASIS_FORMAT = {
            cTFETC1: 0,
            cTFETC2: 1,
            cTFBC1: 2,
            cTFBC3: 3,
            cTFBC4: 4,
            cTFBC5: 5,
            cTFBC7_M6_OPAQUE_ONLY: 6,
            cTFBC7_M5: 7,
            cTFPVRTC1_4_RGB: 8,
            cTFPVRTC1_4_RGBA: 9,
            cTFASTC_4x4: 10,
            cTFATC_RGB: 11,
            cTFATC_RGBA_INTERPOLATED_ALPHA: 12,
            cTFRGBA32: 13,
            cTFRGB565: 14,
            cTFBGR565: 15,
            cTFRGBA4444: 16
          }),
          (vw.DXT_FORMAT = {
            COMPRESSED_RGB_S3TC_DXT1_EXT: 33776,
            COMPRESSED_RGBA_S3TC_DXT1_EXT: 33777,
            COMPRESSED_RGBA_S3TC_DXT3_EXT: 33778,
            COMPRESSED_RGBA_S3TC_DXT5_EXT: 33779
          }),
          ((vw.DXT_FORMAT_MAP = {})[vw.BASIS_FORMAT.cTFBC1] =
            vw.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT),
          (vw.DXT_FORMAT_MAP[vw.BASIS_FORMAT.cTFBC3] =
            vw.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT),
          (vw.BasisWorker = function() {
            var e, t, n;
            onmessage = function(r) {
              var i,
                a,
                o = r.data;
              switch (o.type) {
                case "init":
                  (e = o.config),
                    (i = o.transcoderBinary),
                    (t = new Promise(e => {
                      (a = { wasmBinary: i, onRuntimeInitialized: e }),
                        BASIS(a);
                    }).then(() => {
                      var { BasisFile: e, initializeBasis: t } = a;
                      (n = e), t();
                    }));
                  break;
                case "transcode":
                  t.then(() => {
                    try {
                      for (
                        var {
                            width: t,
                            height: r,
                            hasAlpha: i,
                            mipmaps: a,
                            format: s
                          } = (function(t) {
                            var r = new n(new Uint8Array(t)),
                              i = r.getImageWidth(0, 0),
                              a = r.getImageHeight(0, 0),
                              o = r.getNumLevels(0),
                              s = r.getHasAlpha();
                            function l() {
                              r.close(), r.delete();
                            }
                            if (!s)
                              switch (e.format) {
                                case 9:
                                  e.format = 8;
                              }
                            if (!i || !a || !o)
                              throw (l(),
                              new Error(
                                "THREE.BasisTextureLoader:  Invalid .basis file"
                              ));
                            if (!r.startTranscoding())
                              throw (l(),
                              new Error(
                                "THREE.BasisTextureLoader: .startTranscoding failed"
                              ));
                            for (var c = [], u = 0; u < o; u++) {
                              var h = r.getImageWidth(0, u),
                                d = r.getImageHeight(0, u),
                                p = new Uint8Array(
                                  r.getImageTranscodedSizeInBytes(
                                    0,
                                    u,
                                    e.format
                                  )
                                );
                              if (!r.transcodeImage(p, 0, u, e.format, 0, s))
                                throw (l(),
                                new Error(
                                  "THREE.BasisTextureLoader: .transcodeImage failed."
                                ));
                              c.push({ data: p, width: h, height: d });
                            }
                            return (
                              l(),
                              {
                                width: i,
                                height: a,
                                hasAlpha: s,
                                mipmaps: c,
                                format: e.format
                              }
                            );
                          })(o.buffer),
                          l = [],
                          c = 0;
                        c < a.length;
                        ++c
                      )
                        l.push(a[c].data.buffer);
                      self.postMessage(
                        {
                          type: "transcode",
                          id: o.id,
                          width: t,
                          height: r,
                          hasAlpha: i,
                          mipmaps: a,
                          format: s
                        },
                        l
                      );
                    } catch (e) {
                      self.postMessage({
                        type: "error",
                        id: o.id,
                        error: e.message
                      });
                    }
                  });
              }
            };
          });
        var gw = function(e) {
          Wd.call(this, e), (this.type = sr);
        };
        gw.prototype = Object.assign(Object.create(Wd.prototype), {
          constructor: gw,
          parse: function(e) {
            var t = function(e, t) {
                switch (e) {
                  case 1:
                  case 2:
                  case 3:
                    break;
                  default:
                  case 4:
                }
                return -1;
              },
              n = function(e, t, n) {
                t = t || 1024;
                for (
                  var r = e.pos,
                    i = -1,
                    a = 0,
                    o = "",
                    s = String.fromCharCode.apply(
                      null,
                      new Uint16Array(e.subarray(r, r + 128))
                    );
                  0 > (i = s.indexOf("\n")) && a < t && r < e.byteLength;

                )
                  (o += s),
                    (a += s.length),
                    (r += 128),
                    (s += String.fromCharCode.apply(
                      null,
                      new Uint16Array(e.subarray(r, r + 128))
                    ));
                return (
                  -1 < i &&
                  (!1 !== n && (e.pos += a + i + 1), o + s.slice(0, i))
                );
              },
              r = (function() {
                var e = new Float32Array(1),
                  t = new Int32Array(e.buffer);
                function n(n) {
                  e[0] = n;
                  var r = t[0],
                    i = (r >> 16) & 32768,
                    a = (r >> 12) & 2047,
                    o = (r >> 23) & 255;
                  return o < 103
                    ? i
                    : o > 142
                    ? ((i |= 31744), (i |= (255 == o ? 0 : 1) && 8388607 & r))
                    : o < 113
                    ? (i |= ((a |= 2048) >> (114 - o)) + ((a >> (113 - o)) & 1))
                    : ((i |= ((o - 112) << 10) | (a >> 1)), (i += 1 & a));
                }
                return function(e, t, r, i) {
                  var a = e[t + 3],
                    o = Math.pow(2, a - 128) / 255;
                  (r[i + 0] = n(e[t + 0] * o)),
                    (r[i + 1] = n(e[t + 1] * o)),
                    (r[i + 2] = n(e[t + 2] * o));
                };
              })(),
              i = new Uint8Array(e);
            i.pos = 0;
            var a,
              o,
              s,
              l,
              c,
              u,
              h = (function(e) {
                var r,
                  i,
                  a = /^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,
                  o = /^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,
                  s = /^\s*FORMAT=(\S+)\s*$/,
                  l = /^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,
                  c = {
                    valid: 0,
                    string: "",
                    comments: "",
                    programtype: "RGBE",
                    format: "",
                    gamma: 1,
                    exposure: 1,
                    width: 0,
                    height: 0
                  };
                if (e.pos >= e.byteLength || !(r = n(e))) return t(1);
                if (!(i = r.match(/^#\?(\S+)$/))) return t(3);
                for (
                  c.valid |= 1, c.programtype = i[1], c.string += r + "\n";
                  !1 !== (r = n(e));

                )
                  if (((c.string += r + "\n"), "#" !== r.charAt(0))) {
                    if (
                      ((i = r.match(a)) && (c.gamma = parseFloat(i[1], 10)),
                      (i = r.match(o)) && (c.exposure = parseFloat(i[1], 10)),
                      (i = r.match(s)) && ((c.valid |= 2), (c.format = i[1])),
                      (i = r.match(l)) &&
                        ((c.valid |= 4),
                        (c.height = parseInt(i[1], 10)),
                        (c.width = parseInt(i[2], 10))),
                      2 & c.valid && 4 & c.valid)
                    )
                      break;
                  } else c.comments += r + "\n";
                return 2 & c.valid && 4 & c.valid ? c : t(3);
              })(i);
            if (-1 !== h) {
              var d = h.width,
                p = h.height,
                f = (function(e, n, r) {
                  var i,
                    a,
                    o,
                    s,
                    l,
                    c,
                    u,
                    h,
                    d,
                    p,
                    f,
                    m,
                    v,
                    g = n,
                    y = r;
                  if (
                    g < 8 ||
                    g > 32767 ||
                    2 !== e[0] ||
                    2 !== e[1] ||
                    128 & e[2]
                  )
                    return new Uint8Array(e);
                  if (g !== ((e[2] << 8) | e[3])) return t(3);
                  if (!(i = new Uint8Array(4 * n * r)) || !i.length)
                    return t(4);
                  for (
                    a = 0,
                      o = 0,
                      h = 4 * g,
                      v = new Uint8Array(4),
                      c = new Uint8Array(h);
                    y > 0 && o < e.byteLength;

                  ) {
                    if (o + 4 > e.byteLength) return t(1);
                    if (
                      ((v[0] = e[o++]),
                      (v[1] = e[o++]),
                      (v[2] = e[o++]),
                      (v[3] = e[o++]),
                      2 != v[0] || 2 != v[1] || ((v[2] << 8) | v[3]) != g)
                    )
                      return t(3);
                    for (u = 0; u < h && o < e.byteLength; ) {
                      if (
                        ((m = (s = e[o++]) > 128) && (s -= 128),
                        0 === s || u + s > h)
                      )
                        return t(3);
                      if (m) for (l = e[o++], d = 0; d < s; d++) c[u++] = l;
                      else c.set(e.subarray(o, o + s), u), (u += s), (o += s);
                    }
                    for (p = g, d = 0; d < p; d++)
                      (f = 0),
                        (i[a] = c[d + f]),
                        (f += g),
                        (i[a + 1] = c[d + f]),
                        (f += g),
                        (i[a + 2] = c[d + f]),
                        (f += g),
                        (i[a + 3] = c[d + f]),
                        (a += 4);
                    y--;
                  }
                  return i;
                })(i.subarray(i.pos), d, p);
              if (-1 !== f) {
                switch (this.type) {
                  case sr:
                    var m = f,
                      v = Tr,
                      g = sr;
                    break;
                  case pr:
                    for (
                      var y = (f.length / 4) * 3,
                        b = new Float32Array(y),
                        x = 0;
                      x < y;
                      x++
                    )
                      (s = b),
                        (l = 3 * x),
                        (c = void 0),
                        (u = void 0),
                        (c = (a = f)[3 + (o = 4 * x)]),
                        (u = Math.pow(2, c - 128) / 255),
                        (s[l + 0] = a[o + 0] * u),
                        (s[l + 1] = a[o + 1] * u),
                        (s[l + 2] = a[o + 2] * u);
                    (m = b), (v = xr), (g = pr);
                    break;
                  case fr:
                    y = (f.length / 4) * 3;
                    var w = new Uint16Array(y);
                    for (x = 0; x < y; x++) r(f, 4 * x, w, 3 * x);
                    (m = w), (v = xr), (g = fr);
                }
                return {
                  width: d,
                  height: p,
                  data: m,
                  header: h.string,
                  gamma: h.gamma,
                  exposure: h.exposure,
                  format: v,
                  type: g
                };
              }
            }
            return null;
          },
          setDataType: function(e) {
            return (this.type = e), this;
          },
          load: function(e, t, n, r) {
            return Wd.prototype.load.call(
              this,
              e,
              function(e, n) {
                switch (e.type) {
                  case sr:
                    (e.encoding = di),
                      (e.minFilter = Jn),
                      (e.magFilter = Jn),
                      (e.generateMipmaps = !1),
                      (e.flipY = !0);
                    break;
                  case pr:
                  case fr:
                    (e.encoding = ci),
                      (e.minFilter = nr),
                      (e.magFilter = nr),
                      (e.generateMipmaps = !1),
                      (e.flipY = !0);
                }
                t && t(e, n);
              },
              n,
              r
            );
          }
        });
        var yw = {},
          bw = void 0,
          xw = yw;
        function ww(e, t) {
          var n,
            r = e.split("."),
            i = xw;
          !(r[0] in i) && i.execScript && i.execScript("var " + r[0]);
          for (; r.length && (n = r.shift()); )
            r.length || t === bw ? (i = i[n] ? i[n] : (i[n] = {})) : (i[n] = t);
        }
        var _w =
          "undefined" != typeof Uint8Array &&
          "undefined" != typeof Uint16Array &&
          "undefined" != typeof Uint32Array &&
          "undefined" != typeof DataView;
        function Mw(e) {
          var t,
            n,
            r,
            i,
            a,
            o,
            s,
            l,
            c,
            u,
            h = e.length,
            d = 0,
            p = Number.POSITIVE_INFINITY;
          for (l = 0; l < h; ++l)
            e[l] > d && (d = e[l]), e[l] < p && (p = e[l]);
          for (
            t = 1 << d,
              n = new (_w ? Uint32Array : Array)(t),
              r = 1,
              i = 0,
              a = 2;
            r <= d;

          ) {
            for (l = 0; l < h; ++l)
              if (e[l] === r) {
                for (o = 0, s = i, c = 0; c < r; ++c)
                  (o = (o << 1) | (1 & s)), (s >>= 1);
                for (u = (r << 16) | l, c = o; c < t; c += a) n[c] = u;
                ++i;
              }
            ++r, (i <<= 1), (a <<= 1);
          }
          return [n, d, p];
        }
        function Tw(e, t) {
          switch (
            ((this.g = []),
            (this.h = 32768),
            (this.d = this.f = this.a = this.l = 0),
            (this.input = _w ? new Uint8Array(e) : e),
            (this.m = !1),
            (this.i = Sw),
            (this.r = !1),
            (!t && (t = {})) ||
              (t.index && (this.a = t.index),
              t.bufferSize && (this.h = t.bufferSize),
              t.bufferType && (this.i = t.bufferType),
              t.resize && (this.r = t.resize)),
            this.i)
          ) {
            case Aw:
              (this.b = 32768),
                (this.c = new (_w ? Uint8Array : Array)(32768 + this.h + 258));
              break;
            case Sw:
              (this.b = 0),
                (this.c = new (_w ? Uint8Array : Array)(this.h)),
                (this.e = this.z),
                (this.n = this.v),
                (this.j = this.w);
              break;
            default:
              throw Error("invalid inflate mode");
          }
        }
        var Aw = 0,
          Sw = 1,
          Ew = { t: Aw, s: Sw };
        Tw.prototype.k = function() {
          for (; !this.m; ) {
            var e = Ww(this, 3);
            switch ((1 & e && (this.m = !0), (e >>>= 1))) {
              case 0:
                var t = this.input,
                  n = this.a,
                  r = this.c,
                  i = this.b,
                  a = t.length,
                  o = bw,
                  s = r.length,
                  l = bw;
                if (((this.d = this.f = 0), n + 1 >= a))
                  throw Error("invalid uncompressed block header: LEN");
                if (((o = t[n++] | (t[n++] << 8)), n + 1 >= a))
                  throw Error("invalid uncompressed block header: NLEN");
                if (o === ~(t[n++] | (t[n++] << 8)))
                  throw Error(
                    "invalid uncompressed block header: length verify"
                  );
                if (n + o > t.length) throw Error("input buffer is broken");
                switch (this.i) {
                  case Aw:
                    for (; i + o > r.length; ) {
                      if (((o -= l = s - i), _w))
                        r.set(t.subarray(n, n + l), i), (i += l), (n += l);
                      else for (; l--; ) r[i++] = t[n++];
                      (this.b = i), (r = this.e()), (i = this.b);
                    }
                    break;
                  case Sw:
                    for (; i + o > r.length; ) r = this.e({ p: 2 });
                    break;
                  default:
                    throw Error("invalid inflate mode");
                }
                if (_w) r.set(t.subarray(n, n + o), i), (i += o), (n += o);
                else for (; o--; ) r[i++] = t[n++];
                (this.a = n), (this.b = i), (this.c = r);
                break;
              case 1:
                this.j(Gw, Xw);
                break;
              case 2:
                var c,
                  u,
                  h,
                  d,
                  p = Ww(this, 5) + 257,
                  f = Ww(this, 5) + 1,
                  m = Ww(this, 4) + 4,
                  v = new (_w ? Uint8Array : Array)(Dw.length),
                  g = bw,
                  y = bw,
                  b = bw,
                  x = bw,
                  w = bw;
                for (w = 0; w < m; ++w) v[Dw[w]] = Ww(this, 3);
                if (!_w) for (w = m, m = v.length; w < m; ++w) v[Dw[w]] = 0;
                for (
                  c = Mw(v),
                    g = new (_w ? Uint8Array : Array)(p + f),
                    w = 0,
                    d = p + f;
                  w < d;

                )
                  switch (((y = Yw(this, c)), y)) {
                    case 16:
                      for (x = 3 + Ww(this, 2); x--; ) g[w++] = b;
                      break;
                    case 17:
                      for (x = 3 + Ww(this, 3); x--; ) g[w++] = 0;
                      b = 0;
                      break;
                    case 18:
                      for (x = 11 + Ww(this, 7); x--; ) g[w++] = 0;
                      b = 0;
                      break;
                    default:
                      b = g[w++] = y;
                  }
                (u = Mw(_w ? g.subarray(0, p) : g.slice(0, p))),
                  (h = Mw(_w ? g.subarray(p) : g.slice(p))),
                  this.j(u, h);
                break;
              default:
                throw Error("unknown BTYPE: " + e);
            }
          }
          return this.n();
        };
        var Rw,
          Pw,
          Iw = [
            16,
            17,
            18,
            0,
            8,
            7,
            9,
            6,
            10,
            5,
            11,
            4,
            12,
            3,
            13,
            2,
            14,
            1,
            15
          ],
          Dw = _w ? new Uint16Array(Iw) : Iw,
          Ow = [
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            13,
            15,
            17,
            19,
            23,
            27,
            31,
            35,
            43,
            51,
            59,
            67,
            83,
            99,
            115,
            131,
            163,
            195,
            227,
            258,
            258,
            258
          ],
          Cw = _w ? new Uint16Array(Ow) : Ow,
          Lw = [
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            1,
            1,
            1,
            1,
            2,
            2,
            2,
            2,
            3,
            3,
            3,
            3,
            4,
            4,
            4,
            4,
            5,
            5,
            5,
            5,
            0,
            0,
            0
          ],
          Nw = _w ? new Uint8Array(Lw) : Lw,
          Fw = [
            1,
            2,
            3,
            4,
            5,
            7,
            9,
            13,
            17,
            25,
            33,
            49,
            65,
            97,
            129,
            193,
            257,
            385,
            513,
            769,
            1025,
            1537,
            2049,
            3073,
            4097,
            6145,
            8193,
            12289,
            16385,
            24577
          ],
          kw = _w ? new Uint16Array(Fw) : Fw,
          Uw = [
            0,
            0,
            0,
            0,
            1,
            1,
            2,
            2,
            3,
            3,
            4,
            4,
            5,
            5,
            6,
            6,
            7,
            7,
            8,
            8,
            9,
            9,
            10,
            10,
            11,
            11,
            12,
            12,
            13,
            13
          ],
          jw = _w ? new Uint8Array(Uw) : Uw,
          Bw = new (_w ? Uint8Array : Array)(288);
        for (Rw = 0, Pw = Bw.length; Rw < Pw; ++Rw)
          Bw[Rw] = 143 >= Rw ? 8 : 255 >= Rw ? 9 : 279 >= Rw ? 7 : 8;
        var zw,
          Vw,
          Gw = Mw(Bw),
          Hw = new (_w ? Uint8Array : Array)(30);
        for (zw = 0, Vw = Hw.length; zw < Vw; ++zw) Hw[zw] = 5;
        var Xw = Mw(Hw);
        function Ww(e, t) {
          for (
            var n, r = e.f, i = e.d, a = e.input, o = e.a, s = a.length;
            i < t;

          ) {
            if (o >= s) throw Error("input buffer is broken");
            (r |= a[o++] << i), (i += 8);
          }
          return (
            (n = r & ((1 << t) - 1)),
            (e.f = r >>> t),
            (e.d = i - t),
            (e.a = o),
            n
          );
        }
        function Yw(e, t) {
          for (
            var n,
              r,
              i = e.f,
              a = e.d,
              o = e.input,
              s = e.a,
              l = o.length,
              c = t[0],
              u = t[1];
            a < u && !(s >= l);

          )
            (i |= o[s++] << a), (a += 8);
          if ((r = (n = c[i & ((1 << u) - 1)]) >>> 16) > a)
            throw Error("invalid code length: " + r);
          return (e.f = i >> r), (e.d = a - r), (e.a = s), 65535 & n;
        }
        function qw(e, t) {
          var n, r;
          switch (
            ((this.input = e),
            (this.a = 0),
            (!t && (t = {})) ||
              (t.index && (this.a = t.index), t.verify && (this.A = t.verify)),
            (n = e[this.a++]),
            (r = e[this.a++]),
            15 & n)
          ) {
            case Qw:
              this.method = Qw;
              break;
            default:
              throw Error("unsupported compression method");
          }
          if (0 != ((n << 8) + r) % 31)
            throw Error("invalid fcheck flag:" + (((n << 8) + r) % 31));
          if (32 & r) throw Error("fdict flag is not supported");
          this.q = new Tw(e, {
            index: this.a,
            bufferSize: t.bufferSize,
            bufferType: t.bufferType,
            resize: t.resize
          });
        }
        (Tw.prototype.j = function(e, t) {
          var n = this.c,
            r = this.b;
          this.o = e;
          for (var i, a, o, s, l = n.length - 258; 256 !== (i = Yw(this, e)); )
            if (256 > i)
              r >= l && ((this.b = r), (n = this.e()), (r = this.b)),
                (n[r++] = i);
            else
              for (
                s = Cw[(a = i - 257)],
                  0 < Nw[a] && (s += Ww(this, Nw[a])),
                  i = Yw(this, t),
                  o = kw[i],
                  0 < jw[i] && (o += Ww(this, jw[i])),
                  r >= l && ((this.b = r), (n = this.e()), (r = this.b));
                s--;

              )
                n[r] = n[r++ - o];
          for (; 8 <= this.d; ) (this.d -= 8), this.a--;
          this.b = r;
        }),
          (Tw.prototype.w = function(e, t) {
            var n = this.c,
              r = this.b;
            this.o = e;
            for (var i, a, o, s, l = n.length; 256 !== (i = Yw(this, e)); )
              if (256 > i) r >= l && (l = (n = this.e()).length), (n[r++] = i);
              else
                for (
                  s = Cw[(a = i - 257)],
                    0 < Nw[a] && (s += Ww(this, Nw[a])),
                    i = Yw(this, t),
                    o = kw[i],
                    0 < jw[i] && (o += Ww(this, jw[i])),
                    r + s > l && (l = (n = this.e()).length);
                  s--;

                )
                  n[r] = n[r++ - o];
            for (; 8 <= this.d; ) (this.d -= 8), this.a--;
            this.b = r;
          }),
          (Tw.prototype.e = function() {
            var e,
              t,
              n = new (_w ? Uint8Array : Array)(this.b - 32768),
              r = this.b - 32768,
              i = this.c;
            if (_w) n.set(i.subarray(32768, n.length));
            else for (e = 0, t = n.length; e < t; ++e) n[e] = i[e + 32768];
            if ((this.g.push(n), (this.l += n.length), _w))
              i.set(i.subarray(r, r + 32768));
            else for (e = 0; 32768 > e; ++e) i[e] = i[r + e];
            return (this.b = 32768), i;
          }),
          (Tw.prototype.z = function(e) {
            var t,
              n,
              r,
              i = (this.input.length / this.a + 1) | 0,
              a = this.input,
              o = this.c;
            return (
              e &&
                ("number" == typeof e.p && (i = e.p),
                "number" == typeof e.u && (i += e.u)),
              (n =
                2 > i
                  ? (r = (((a.length - this.a) / this.o[2] / 2) * 258) | 0) <
                    o.length
                    ? o.length + r
                    : o.length << 1
                  : o.length * i),
              _w ? (t = new Uint8Array(n)).set(o) : (t = o),
              (this.c = t)
            );
          }),
          (Tw.prototype.n = function() {
            var e,
              t,
              n,
              r,
              i,
              a = 0,
              o = this.c,
              s = this.g,
              l = new (_w ? Uint8Array : Array)(this.l + (this.b - 32768));
            if (0 === s.length)
              return _w
                ? this.c.subarray(32768, this.b)
                : this.c.slice(32768, this.b);
            for (t = 0, n = s.length; t < n; ++t)
              for (r = 0, i = (e = s[t]).length; r < i; ++r) l[a++] = e[r];
            for (t = 32768, n = this.b; t < n; ++t) l[a++] = o[t];
            return (this.g = []), (this.buffer = l);
          }),
          (Tw.prototype.v = function() {
            var e,
              t = this.b;
            return (
              _w
                ? this.r
                  ? (e = new Uint8Array(t)).set(this.c.subarray(0, t))
                  : (e = this.c.subarray(0, t))
                : (this.c.length > t && (this.c.length = t), (e = this.c)),
              (this.buffer = e)
            );
          }),
          (qw.prototype.k = function() {
            var e,
              t,
              n = this.input;
            if (((e = this.q.k()), (this.a = this.q.a), this.A)) {
              t =
                ((n[this.a++] << 24) |
                  (n[this.a++] << 16) |
                  (n[this.a++] << 8) |
                  n[this.a++]) >>>
                0;
              var r = e;
              if ("string" == typeof r) {
                var i,
                  a,
                  o = r.split("");
                for (i = 0, a = o.length; i < a; i++)
                  o[i] = (255 & o[i].charCodeAt(0)) >>> 0;
                r = o;
              }
              for (var s, l = 1, c = 0, u = r.length, h = 0; 0 < u; ) {
                u -= s = 1024 < u ? 1024 : u;
                do {
                  c += l += r[h++];
                } while (--s);
                (l %= 65521), (c %= 65521);
              }
              if (t !== ((c << 16) | l) >>> 0)
                throw Error("invalid adler-32 checksum");
            }
            return e;
          });
        var Qw = 8;
        ww("Zlib.Inflate", qw),
          ww("Zlib.Inflate.prototype.decompress", qw.prototype.k);
        var Zw,
          Jw,
          Kw,
          $w,
          e_ = { ADAPTIVE: Ew.s, BLOCK: Ew.t };
        if (Object.keys) Zw = Object.keys(e_);
        else for (Jw in ((Zw = []), (Kw = 0), e_)) Zw[Kw++] = Jw;
        for (Kw = 0, $w = Zw.length; Kw < $w; ++Kw)
          ww("Zlib.Inflate.BufferType." + (Jw = Zw[Kw]), e_[Jw]);
        var t_ = yw.Zlib,
          n_ = function(e) {
            Wd.call(this, e), (this.type = pr);
          };
        n_.prototype = Object.assign(Object.create(Wd.prototype), {
          constructor: n_,
          parse: function(e) {
            const t = 65536,
              n = t >> 3,
              r = 14,
              i = 65537,
              a = 1 << r,
              o = a - 1,
              s = 59,
              l = 63,
              c = 2 + l - s,
              u = 2,
              h = 8,
              d = 4,
              p = 4,
              f = 2,
              m = 1,
              v = { l: 0, c: 0, lc: 0 };
            function g(e, t, n, r, i) {
              for (; n < e; ) (t = (t << 8) | k(r, i)), (n += 8);
              (n -= e),
                (v.l = (t >> n) & ((1 << e) - 1)),
                (v.c = t),
                (v.lc = n);
            }
            const y = new Array(59);
            function b(e, t, n, r, a, o, u) {
              for (var h = n, d = 0, p = 0; a <= o; a++) {
                if (h.value - n.value > r) return !1;
                g(6, d, p, e, h);
                var f = v.l;
                if (((d = v.c), (p = v.lc), (u[a] = f), f == l)) {
                  if (h.value - n.value > r)
                    throw "Something wrong with hufUnpackEncTable";
                  g(8, d, p, e, h);
                  var m = v.l + c;
                  if (((d = v.c), (p = v.lc), a + m > o + 1))
                    throw "Something wrong with hufUnpackEncTable";
                  for (; m--; ) u[a++] = 0;
                  a--;
                } else if (f >= s) {
                  if (a + (m = f - s + 2) > o + 1)
                    throw "Something wrong with hufUnpackEncTable";
                  for (; m--; ) u[a++] = 0;
                  a--;
                }
              }
              !(function(e) {
                for (var t = 0; t <= 58; ++t) y[t] = 0;
                for (t = 0; t < i; ++t) y[e[t]] += 1;
                var n = 0;
                for (t = 58; t > 0; --t) {
                  var r = (n + y[t]) >> 1;
                  (y[t] = n), (n = r);
                }
                for (t = 0; t < i; ++t) {
                  var a = e[t];
                  a > 0 && (e[t] = a | (y[a]++ << 6));
                }
              })(u);
            }
            function x(e) {
              return 63 & e;
            }
            function w(e) {
              return e >> 6;
            }
            const _ = { c: 0, lc: 0 };
            function M(e, t, n, r) {
              (e = (e << 8) | k(n, r)), (t += 8), (_.c = e), (_.lc = t);
            }
            const T = { c: 0, lc: 0 };
            function A(e, t, n, r, i, a, o, s, l, c) {
              if (e == t) {
                r < 8 && (M(n, r, i, o), (n = _.c), (r = _.lc));
                var u = n >> (r -= 8);
                if (((u = new Uint8Array([u])[0]), l.value + u > c)) return !1;
                for (var h = s[l.value - 1]; u-- > 0; ) s[l.value++] = h;
              } else {
                if (!(l.value < c)) return !1;
                s[l.value++] = e;
              }
              (T.c = n), (T.lc = r);
            }
            function S(e) {
              var t = (function(e) {
                return 65535 & e;
              })(e);
              return t > 32767 ? t - 65536 : t;
            }
            const E = { a: 0, b: 0 };
            function R(e, t) {
              var n = S(e),
                r = S(t),
                i = n + (1 & r) + (r >> 1),
                a = i,
                o = i - r;
              (E.a = a), (E.b = o);
            }
            function P(e, t, n, r, i, a) {
              for (var o, s = n > i ? i : n, l = 1; l <= s; ) l <<= 1;
              for (o = l >>= 1, l >>= 1; l >= 1; ) {
                for (
                  var c,
                    u,
                    h,
                    d,
                    p = 0,
                    f = p + a * (i - o),
                    m = a * l,
                    v = a * o,
                    g = r * l,
                    y = r * o;
                  p <= f;
                  p += v
                ) {
                  for (var b = p, x = p + r * (n - o); b <= x; b += y) {
                    var w = b + g,
                      _ = (M = b + m) + g;
                    R(t[b + e], t[M + e]),
                      (c = E.a),
                      (h = E.b),
                      R(t[w + e], t[_ + e]),
                      (u = E.a),
                      (d = E.b),
                      R(c, u),
                      (t[b + e] = E.a),
                      (t[w + e] = E.b),
                      R(h, d),
                      (t[M + e] = E.a),
                      (t[_ + e] = E.b);
                  }
                  if (n & l) {
                    var M = b + m;
                    R(t[b + e], t[M + e]),
                      (c = E.a),
                      (t[M + e] = E.b),
                      (t[b + e] = c);
                  }
                }
                if (i & l)
                  for (b = p, x = p + r * (n - o); b <= x; b += y)
                    (w = b + g),
                      R(t[b + e], t[w + e]),
                      (c = E.a),
                      (t[w + e] = E.b),
                      (t[b + e] = c);
                (o = l), (l >>= 1);
              }
              return p;
            }
            function I(e, t, n, s, l, c, u) {
              var h = n.value,
                d = F(t, n),
                p = F(t, n);
              n.value += 4;
              var f = F(t, n);
              if (((n.value += 4), d < 0 || d >= i || p < 0 || p >= i))
                throw "Something wrong with HUF_ENCSIZE";
              var m = new Array(i),
                v = new Array(a);
              if (
                ((function(e) {
                  for (var t = 0; t < a; t++)
                    (e[t] = {}),
                      (e[t].len = 0),
                      (e[t].lit = 0),
                      (e[t].p = null);
                })(v),
                b(e, 0, n, s - (n.value - h), d, p, m),
                f > 8 * (s - (n.value - h)))
              )
                throw "Something wrong with hufUncompress";
              !(function(e, t, n, i) {
                for (; t <= n; t++) {
                  var a = w(e[t]),
                    o = x(e[t]);
                  if (a >> o) throw "Invalid table entry";
                  if (o > r) {
                    if ((u = i[a >> (o - r)]).len) throw "Invalid table entry";
                    if ((u.lit++, u.p)) {
                      var s = u.p;
                      u.p = new Array(u.lit);
                      for (var l = 0; l < u.lit - 1; ++l) u.p[l] = s[l];
                    } else u.p = new Array(1);
                    u.p[u.lit - 1] = t;
                  } else if (o) {
                    var c = 0;
                    for (l = 1 << (r - o); l > 0; l--) {
                      var u;
                      if ((u = i[(a << (r - o)) + c]).len || u.p)
                        throw "Invalid table entry";
                      (u.len = o), (u.lit = t), c++;
                    }
                  }
                }
              })(m, d, p, v),
                (function(e, t, n, i, a, s, l, c, u, h) {
                  for (
                    var d = 0,
                      p = 0,
                      f = c,
                      m = Math.trunc(a.value + (s + 7) / 8);
                    a.value < m;

                  )
                    for (M(d, p, n, a), d = _.c, p = _.lc; p >= r; )
                      if ((b = t[(d >> (p - r)) & o]).len)
                        (p -= b.len),
                          A(b.lit, l, d, p, n, 0, a, u, h, f),
                          (d = T.c),
                          (p = T.lc);
                      else {
                        if (!b.p) throw "hufDecode issues";
                        var v;
                        for (v = 0; v < b.lit; v++) {
                          for (var g = x(e[b.p[v]]); p < g && a.value < m; )
                            M(d, p, n, a), (d = _.c), (p = _.lc);
                          if (
                            p >= g &&
                            w(e[b.p[v]]) == ((d >> (p - g)) & ((1 << g) - 1))
                          ) {
                            (p -= g),
                              A(b.p[v], l, d, p, n, 0, a, u, h, f),
                              (d = T.c),
                              (p = T.lc);
                            break;
                          }
                        }
                        if (v == b.lit) throw "hufDecode issues";
                      }
                  var y = (8 - s) & 7;
                  for (d >>= y, p -= y; p > 0; ) {
                    var b;
                    if (!(b = t[(d << (r - p)) & o]).len)
                      throw "hufDecode issues";
                    (p -= b.len),
                      A(b.lit, l, d, p, n, 0, a, u, h, f),
                      (d = T.c),
                      (p = T.lc);
                  }
                })(m, v, e, 0, n, f, p, u, l, c);
            }
            function D(e) {
              for (var t = 1; t < e.length; t++) {
                var n = e[t - 1] + e[t] - 128;
                e[t] = n;
              }
            }
            function O(e, t) {
              for (
                var n = 0,
                  r = Math.floor((e.length + 1) / 2),
                  i = 0,
                  a = e.length - 1;
                !(i > a || ((t[i++] = e[n++]), i > a));

              )
                t[i++] = e[r++];
            }
            function C(e) {
              var t = e.array.slice(e.offset.value, e.offset.value + e.size),
                n = new t_.Inflate(t, { resize: !0, verify: !0 }),
                r = new Uint8Array(n.decompress().buffer),
                i = new Uint8Array(r.length);
              return D(r), O(r, i), new DataView(i.buffer);
            }
            function L(e, t) {
              for (var n = new Uint8Array(e), r = 0; 0 != n[t.value + r]; )
                r += 1;
              var i = new TextDecoder().decode(n.slice(t.value, t.value + r));
              return (t.value = t.value + r + 1), i;
            }
            function N(e, t) {
              var n = e.getUint32(0, !0);
              return (t.value = t.value + h), n;
            }
            function F(e, t) {
              var n = e.getUint32(t.value, !0);
              return (t.value = t.value + p), n;
            }
            function k(e, t) {
              var n = e[t.value];
              return (t.value = t.value + m), n;
            }
            function U(e, t) {
              var n = e.getUint8(t.value);
              return (t.value = t.value + m), n;
            }
            function j(e, t) {
              var n = e.getFloat32(t.value, !0);
              return (t.value += d), n;
            }
            function B(e, t) {
              var n = e.getUint16(t.value, !0);
              return (t.value += f), n;
            }
            function z(e, t, n, r, i) {
              if ("string" === r || "iccProfile" === r)
                return (function(e, t, n) {
                  var r = new TextDecoder().decode(
                    new Uint8Array(e).slice(t.value, t.value + n)
                  );
                  return (t.value = t.value + n), r;
                })(t, n, i);
              if ("chlist" === r)
                return (function(e, t, n, r) {
                  for (var i = n.value, a = []; n.value < i + r - 1; ) {
                    var o = L(t, n),
                      s = F(e, n),
                      l = U(e, n);
                    n.value += 3;
                    var c = F(e, n),
                      u = F(e, n);
                    a.push({
                      name: o,
                      pixelType: s,
                      pLinear: l,
                      xSampling: c,
                      ySampling: u
                    });
                  }
                  return (n.value += 1), a;
                })(e, t, n, i);
              if ("chromaticities" === r)
                return (function(e, t) {
                  return {
                    redX: j(e, t),
                    redY: j(e, t),
                    greenX: j(e, t),
                    greenY: j(e, t),
                    blueX: j(e, t),
                    blueY: j(e, t),
                    whiteX: j(e, t),
                    whiteY: j(e, t)
                  };
                })(e, n);
              if ("compression" === r)
                return (function(e, t) {
                  return [
                    "NO_COMPRESSION",
                    "RLE_COMPRESSION",
                    "ZIPS_COMPRESSION",
                    "ZIP_COMPRESSION",
                    "PIZ_COMPRESSION",
                    "PXR24_COMPRESSION",
                    "B44_COMPRESSION",
                    "B44A_COMPRESSION",
                    "DWAA_COMPRESSION",
                    "DWAB_COMPRESSION"
                  ][U(e, t)];
                })(e, n);
              if ("box2i" === r)
                return (function(e, t) {
                  return {
                    xMin: F(e, t),
                    yMin: F(e, t),
                    xMax: F(e, t),
                    yMax: F(e, t)
                  };
                })(e, n);
              if ("lineOrder" === r)
                return (function(e, t) {
                  return ["INCREASING_Y"][U(e, t)];
                })(e, n);
              if ("float" === r) return j(e, n);
              if ("v2f" === r)
                return (function(e, t) {
                  return [j(e, t), j(e, t)];
                })(e, n);
              if ("int" === r) return F(e, n);
              throw "Cannot parse value for unsupported type: " + r;
            }
            var V = new DataView(e),
              G = new Uint8Array(e),
              H = {};
            V.getUint32(0, !0), V.getUint8(4, !0), V.getUint8(5, !0);
            for (var X = { value: 8 }, W = !0; W; ) {
              var Y = L(e, X);
              if (0 == Y) W = !1;
              else {
                var q = z(V, e, X, L(e, X), F(V, X));
                H[Y] = q;
              }
            }
            var Q,
              Z,
              J,
              K,
              $ = H.dataWindow.yMax + 1;
            switch (H.compression) {
              case "NO_COMPRESSION":
                (Z = 1),
                  (Q = function(e) {
                    return new DataView(e.array.buffer, e.offset.value, e.size);
                  });
                break;
              case "RLE_COMPRESSION":
                (Z = 1),
                  (Q = function(e) {
                    var t = e.viewer.buffer.slice(
                        e.offset.value,
                        e.offset.value + e.size
                      ),
                      n = new Uint8Array(
                        (function(e) {
                          for (
                            var t = e.byteLength,
                              n = new Array(),
                              r = 0,
                              i = new DataView(e);
                            t > 0;

                          ) {
                            var a = i.getInt8(r++);
                            if (a < 0) {
                              t -= 1 + (s = -a);
                              for (var o = 0; o < s; o++)
                                n.push(i.getUint8(r++));
                            } else {
                              var s = a;
                              t -= 2;
                              var l = i.getUint8(r++);
                              for (o = 0; o < s + 1; o++) n.push(l);
                            }
                          }
                          return n;
                        })(t)
                      ),
                      r = new Uint8Array(n.length);
                    return D(n), O(n, r), new DataView(r.buffer);
                  });
                break;
              case "ZIPS_COMPRESSION":
                (Z = 1), (Q = C);
                break;
              case "ZIP_COMPRESSION":
                (Z = 16), (Q = C);
                break;
              case "PIZ_COMPRESSION":
                (Z = 32),
                  (Q = function(e) {
                    var r = e.viewer,
                      i = { value: e.offset.value },
                      a = e.width * Z * (H.channels.length * u),
                      o = new Uint16Array(a),
                      s = new Uint8Array(n),
                      l = B(r, i),
                      c = B(r, i);
                    if (c >= n)
                      throw "Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";
                    if (l <= c)
                      for (var h = 0; h < c - l + 1; h++) s[h + l] = U(r, i);
                    var d = new Uint16Array(t);
                    !(function(e, n) {
                      for (var r = 0, i = 0; i < t; ++i)
                        (0 == i || e[i >> 3] & (1 << (7 & i))) && (n[r++] = i);
                      for (; r < t; ) n[r++] = 0;
                    })(s, d);
                    var p = F(r, i);
                    I(e.array, r, i, p, o, { value: 0 }, a);
                    var f = new Array(e.channels),
                      m = 0;
                    for (h = 0; h < e.channels; h++)
                      (f[h] = {}),
                        (f[h].start = m),
                        (f[h].end = f[h].start),
                        (f[h].nx = e.width),
                        (f[h].ny = e.lines),
                        (f[h].size = 1),
                        (m += f[h].nx * f[h].ny * f[h].size);
                    var v = 0;
                    for (h = 0; h < e.channels; h++)
                      for (var g = 0; g < f[h].size; ++g)
                        v += P(
                          g + v,
                          o,
                          f[h].nx,
                          f[h].size,
                          f[h].ny,
                          f[h].nx * f[h].size
                        );
                    !(function(e, t, n) {
                      for (var r = 0; r < n; ++r) t[r] = e[t[r]];
                    })(d, o, m);
                    for (
                      var y = new Uint8Array(o.buffer.byteLength),
                        b = 0,
                        x = 2 * e.width,
                        w = 0;
                      w < e.lines;
                      w++
                    )
                      for (var _ = 0; _ < e.channels; _++) {
                        var M = f[_],
                          T = new Uint8Array(o.buffer, 2 * M.end + w * x, x);
                        y.set(T, b), (b += x);
                      }
                    return new DataView(y.buffer);
                  });
                break;
              default:
                throw "EXRLoader.parse: " + H.compression + " is unsupported";
            }
            var ee = H.channels[0].pixelType;
            if (1 === ee)
              switch (this.type) {
                case pr:
                  (K = function(e, t) {
                    return (
                      (n = B(e, t)),
                      (i = 1023 & n),
                      (n >> 15 ? -1 : 1) *
                        ((r = (31744 & n) >> 10)
                          ? 31 === r
                            ? i
                              ? NaN
                              : 1 / 0
                            : Math.pow(2, r - 15) * (1 + i / 1024)
                          : (i / 1024) * 6103515625e-14)
                    );
                    var n, r, i;
                  }),
                    (J = f);
                  break;
                case fr:
                  (K = B), (J = f);
              }
            else {
              if (2 !== ee)
                throw "EXRLoader.parse: unsupported pixelType " +
                  ee +
                  " for " +
                  H.compression +
                  ".";
              switch (this.type) {
                case pr:
                  (K = j), (J = d);
                  break;
                case fr:
                  throw "EXRLoader.parse: unsupported HalfFloatType texture for FloatType image file.";
              }
            }
            for (var te = $ / Z, ne = 0; ne < te; ne++) N(V, X);
            var re = H.dataWindow.xMax - H.dataWindow.xMin + 1,
              ie = H.dataWindow.yMax - H.dataWindow.yMin + 1,
              ae = re * ie * 4;
            switch (this.type) {
              case pr:
                var oe = new Float32Array(ae);
                H.channels.length < 4 && oe.fill(1, 0, ae);
                break;
              case fr:
                (oe = new Uint16Array(ae)),
                  H.channels.length < 4 && oe.fill(15360, 0, ae);
            }
            var se = { R: 0, G: 1, B: 2, A: 3 },
              le = {
                array: G,
                viewer: V,
                offset: X,
                channels: H.channels.length,
                width: re,
                lines: Z,
                size: 0
              };
            if (
              "NO_COMPRESSION" === H.compression ||
              "ZIP_COMPRESSION" === H.compression ||
              "ZIPS_COMPRESSION" === H.compression ||
              "RLE_COMPRESSION" === H.compression ||
              "PIZ_COMPRESSION" === H.compression
            )
              for (var ce, ue = { value: 0 }, he = 0; he < ie / Z; he++) {
                F(V, X),
                  (ae = F(V, X)),
                  (le.offset = X),
                  (le.size = ae),
                  (ce = Q(le)),
                  (X.value += ae);
                for (var de = 0; de < Z; de++) {
                  var pe = de + he * Z;
                  if (pe >= ie) break;
                  for (var fe = 0; fe < H.channels.length; fe++)
                    for (
                      var me = se[H.channels[fe].name], ve = 0;
                      ve < re;
                      ve++
                    ) {
                      var ge = de * (H.channels.length * re) + fe * re + ve;
                      ue.value = ge * J;
                      var ye = K(ce, ue);
                      oe[4 * re * (ie - 1 - pe) + 4 * ve + me] = ye;
                    }
                }
              }
            return {
              header: H,
              width: re,
              height: ie,
              data: oe,
              format: wr,
              type: this.type
            };
          },
          setDataType: function(e) {
            return (this.type = e), this;
          },
          load: function(e, t, n, r) {
            return Wd.prototype.load.call(
              this,
              e,
              function(e, n) {
                switch (e.type) {
                  case pr:
                  case fr:
                    (e.encoding = ci),
                      (e.minFilter = nr),
                      (e.magFilter = nr),
                      (e.generateMipmaps = !1),
                      (e.flipY = !1);
                }
                t && t(e, n);
              },
              n,
              r
            );
          }
        });
        var r_ = function(e) {
          zd.call(this, e), (this.hdrLoader = new gw()), (this.type = sr);
        };
        function i_(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        r_.prototype = Object.assign(Object.create(zd.prototype), {
          constructor: r_,
          load: function(e, t, n, r) {
            Array.isArray(e) ||
              (this.setDataType(e),
              (e = t),
              (t = n),
              (n = r),
              (r = arguments[4]));
            var i = new ll();
            switch (((i.type = this.type), i.type)) {
              case sr:
                (i.encoding = di),
                  (i.format = wr),
                  (i.minFilter = Jn),
                  (i.magFilter = Jn),
                  (i.generateMipmaps = !1);
                break;
              case pr:
              case fr:
                (i.encoding = ci),
                  (i.format = xr),
                  (i.minFilter = nr),
                  (i.magFilter = nr),
                  (i.generateMipmaps = !1);
            }
            var a = this,
              o = 0;
            function s(t, n, r, s) {
              new Gd(a.manager)
                .setPath(a.path)
                .setResponseType("arraybuffer")
                .load(
                  e[t],
                  function(e) {
                    o++;
                    var r = a.hdrLoader.parse(e);
                    if (r) {
                      if (void 0 !== r.data) {
                        var s = new Bs(r.data, r.width, r.height);
                        (s.type = i.type),
                          (s.encoding = i.encoding),
                          (s.format = i.format),
                          (s.minFilter = i.minFilter),
                          (s.magFilter = i.magFilter),
                          (s.generateMipmaps = i.generateMipmaps),
                          (i.images[t] = s);
                      }
                      6 === o && ((i.needsUpdate = !0), n && n(i));
                    }
                  },
                  r,
                  s
                );
            }
            for (var l = 0; l < e.length; l++) s(l, t, n, r);
            return i;
          },
          setDataType: function(e) {
            return (this.type = e), this.hdrLoader.setDataType(e), this;
          }
        });
        var a_ = (function() {
          function e(t) {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.renderer = t),
              (this.loaders = {});
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function() {
                  var e = this.createGLTFLoader();
                  (this.loaders.tuf = e), (this.loaders.gltf = e);
                  var t = this.createTextureLoader();
                  (this.loaders.jpg = t),
                    (this.loaders.jpeg = t),
                    (this.loaders.png = t),
                    (this.loaders.gif = t),
                    (this.loaders.tif = t),
                    (this.loaders.hdr = this.createHDRTextureLoader()),
                    (this.loaders.exr = this.createEXRTextureLoader()),
                    (this.loaders.basis = this.createBasisTextureLoader());
                  var n = this.createCubeTextureLoader();
                  (this.loaders.jpgcube = n),
                    (this.loaders.jpegcube = n),
                    (this.loaders.pngcube = n),
                    (this.loaders.gifcube = n),
                    (this.loaders.tifcube = n),
                    (this.loaders.hdrcube = this.createHDRCubeTextureLoader());
                }
              },
              {
                key: "dispose",
                value: function() {
                  (this.renderer = null), (this.loaders = {});
                }
              },
              {
                key: "getLoader",
                value: function(e) {
                  return this.loaders[e] ? this.loaders[e] : null;
                }
              },
              {
                key: "createGLTFLoader",
                value: function() {
                  var e = new fw(),
                    t = new mw();
                  return (
                    t.setDecoderPath(
                      "https://cdn.unlimited3d.com/viewer/comp/r109/"
                    ),
                    e.setDRACOLoader(t),
                    e
                  );
                }
              },
              {
                key: "createTextureLoader",
                value: function() {
                  return new Qd();
                }
              },
              {
                key: "createHDRTextureLoader",
                value: function() {
                  var e = new gw();
                  return e.setDataType(sr), e;
                }
              },
              {
                key: "createEXRTextureLoader",
                value: function() {
                  var e = new n_();
                  return e.setDataType(pr), e;
                }
              },
              {
                key: "createBasisTextureLoader",
                value: function() {
                  var e = new vw();
                  if (
                    (e.setTranscoderPath(
                      "https://cdn.unlimited3d.com/viewer/bss/"
                    ),
                    !this.renderer)
                  )
                    throw new Error("Renderer is not initialized!");
                  return e.detectSupport(this.renderer), e;
                }
              },
              {
                key: "createCubeTextureLoader",
                value: function() {
                  return new qd();
                }
              },
              {
                key: "createHDRCubeTextureLoader",
                value: function() {
                  var e = new r_();
                  return e.setDataType(sr), e;
                }
              },
              {
                key: "getType",
                value: function(e) {
                  return "gltf" === e || "tuf" === e ? "model" : "texture";
                }
              }
            ]) && i_(t.prototype, n),
            r && i_(t, r),
            e
          );
        })();
        function o_(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function s_(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? o_(Object(n), !0).forEach(function(t) {
                  l_(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : o_(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function l_(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function c_(e) {
          return (
            (function(e) {
              if (Array.isArray(e)) {
                for (var t = 0, n = new Array(e.length); t < e.length; t++)
                  n[t] = e[t];
                return n;
              }
            })(e) ||
            (function(e) {
              if (
                Symbol.iterator in Object(e) ||
                "[object Arguments]" === Object.prototype.toString.call(e)
              )
                return Array.from(e);
            })(e) ||
            (function() {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance"
              );
            })()
          );
        }
        function u_(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var h_ = (function() {
          function e(t) {
            var n = t.container,
              r = void 0 === n ? null : n,
              i = t.renderer,
              a = void 0 === i ? null : i,
              o = t.onLoadingChanged,
              s = void 0 === o ? null : o;
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.container = r),
              (this.renderer = a),
              (this.onLoadingChanged = s),
              (this.loaders = null),
              (this.pending = {}),
              (this.assets = {}),
              (this.overrides = {});
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "attach",
                value: function(e) {
                  var t = e.container,
                    n = e.renderer,
                    r = e.onLoadingChanged;
                  return (
                    (this.container = t),
                    (this.renderer = n),
                    (this.onLoadingChanged = r),
                    (this.loaders = new a_(this.renderer)),
                    this.loaders.init(),
                    !0
                  );
                }
              },
              {
                key: "detach",
                value: function() {
                  return (
                    (this.container = null),
                    (this.renderer = null),
                    (this.onLoadingChanged = null),
                    this.loaders.dispose(),
                    (this.loaders = null),
                    !0
                  );
                }
              },
              { key: "dispose", value: function() {} },
              {
                key: "register",
                value: function(e) {
                  var t = e.src;
                  return (
                    this.pending[t] ||
                      (this.pending[t] = {
                        promise: null,
                        config: e,
                        status: "REGISTERED",
                        loaded: 0
                      }),
                    t
                  );
                }
              },
              {
                key: "registerCube",
                value: function(e) {
                  var t = [],
                    n = [],
                    r = 0,
                    i = [];
                  return (
                    e.forEach(function(e) {
                      (t = [].concat(c_(t), [e.src])),
                        (n = [].concat(c_(n), [e.thumb_src])),
                        (r += e.size),
                        (i = [].concat(c_(i), [e.refAssetID]));
                    }),
                    this.register({
                      src: t,
                      thumb_src: n,
                      size: r,
                      refAssetID: i,
                      extension: "".concat(e[0].extension, "cube")
                    })
                  );
                }
              },
              {
                key: "unregister",
                value: function(e) {
                  this.pending[e] && delete this.pending[e];
                }
              },
              {
                key: "isRegistered",
                value: function(e) {
                  return !!this.pending[e];
                }
              },
              {
                key: "load",
                value: function(e) {
                  var t = this;
                  if (!this.pending[e])
                    throw new Error("Asset ".concat(e, " is not registered"));
                  if (this.pending[e].promise) return this.pending[e].promise;
                  var n,
                    r,
                    i = this._getExtension(e),
                    a = this.loaders.getLoader(i);
                  if (!a)
                    throw new Error(
                      "Can't load ".concat(e, " with extension ").concat(i)
                    );
                  return (
                    (this.pending[e].promise =
                      ((n = this.pending[e].config.src),
                      (r = function(n) {
                        if (
                          ((t.pending[e].loaded = n.loaded), t.onLoadingChanged)
                        ) {
                          var r = s_({}, t.getInfo(e), {
                            info: t.getTotalInfo()
                          });
                          t.onLoadingChanged(r);
                        }
                      }),
                      new Promise(function(i, o) {
                        if (
                          ((t.pending[n].status = "LOADING"),
                          t.onLoadingChanged)
                        ) {
                          var s = s_({}, t.getInfo(e), {
                            info: t.getTotalInfo()
                          });
                          t.onLoadingChanged(s);
                        }
                        !(function(n, r, i, o) {
                          a.load(
                            n,
                            function(n) {
                              if (
                                ((t.pending[e].status = "LOADED"),
                                (t.pending[e].loaded =
                                  t.pending[e].config.size),
                                t.onLoadingChanged)
                              ) {
                                var i = s_({}, t.getInfo(e), {
                                  info: t.getTotalInfo()
                                });
                                t.onLoadingChanged(i);
                              }
                              r({ obj: n });
                            },
                            i,
                            function() {
                              o("couldn't load ".concat(n));
                            }
                          );
                        })(n, i, r, o);
                      }))),
                    this.pending[e].promise
                  );
                }
              },
              {
                key: "loadGroup",
                value: function(e) {
                  var t = this,
                    n = e.map(function(e) {
                      return t.load(e);
                    });
                  return Promise.all(n);
                }
              },
              {
                key: "loadAll",
                value: function() {
                  var e = this,
                    t = Object.keys(this.pending).filter(function(t) {
                      return (
                        "LOADED" !== e.pending[t].status &&
                        "DONE" !== e.pending[t].status
                      );
                    });
                  return this.loadGroup(t);
                }
              },
              {
                key: "getInfo",
                value: function(e) {
                  return {
                    id: this.pending[e].config.refAssetID,
                    url: this.pending[e].config.src,
                    type: this.loaders.getType(
                      this.pending[e].config.extension
                    ),
                    status: this.pending[e].status,
                    loaded: this.pending[e].loaded,
                    size: this.pending[e].config.size
                  };
                }
              },
              {
                key: "getTotalInfo",
                value: function() {
                  var e = this,
                    t = {
                      assets: {},
                      summary: {
                        loadedAssets: 0,
                        loadedSize: 0,
                        totalAssets: 0,
                        totalSize: 0,
                        progress: 0
                      }
                    };
                  return (
                    Object.keys(this.pending).forEach(function(n) {
                      var r = e.getInfo(n);
                      "DONE" !== r.status &&
                        (t.assets[r.type] || (t.assets[r.type] = {}),
                        (t.assets[r.type][n] = r),
                        (t.summary.totalAssets += 1),
                        (t.summary.totalSize += r.size),
                        (t.summary.loadedSize += r.loaded),
                        "LOADED" === r.status && (t.summary.loadedAssets += 1),
                        (t.summary.progress =
                          0 !== t.summary.totalSize
                            ? (t.summary.loadedSize / t.summary.totalSize) * 100
                            : 0));
                    }),
                    t
                  );
                }
              },
              {
                key: "resetInfo",
                value: function() {
                  var e = this;
                  Object.keys(this.pending).forEach(function(t) {
                    "LOADED" === e.pending[t].status &&
                      (e.pending[t].status = "DONE");
                  });
                }
              },
              {
                key: "_getExtension",
                value: function(e) {
                  return this.pending[e]
                    ? this.pending[e].config.extension
                    : null;
                }
              }
            ]) && u_(t.prototype, n),
            r && u_(t, r),
            e
          );
        })();
        function d_(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function p_(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function f_(e, t) {
          for (var n = 0; n < t.length; n++) {
            var r = t[n];
            (r.enumerable = r.enumerable || !1),
              (r.configurable = !0),
              "value" in r && (r.writable = !0),
              Object.defineProperty(e, r.key, r);
          }
        }
        var m_ = (function() {
          function e() {
            !(function(e, t) {
              if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function");
            })(this, e),
              (this.assetManager = new h_({})),
              (this.app = null);
          }
          var t, n, r;
          return (
            (t = e),
            (n = [
              {
                key: "init",
                value: function(e) {
                  var t = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return !t.app || t.app.dispose();
                    })
                    .then(function() {
                      return (
                        (t.app = new pw()),
                        t.app.init(
                          (function(e) {
                            for (var t = 1; t < arguments.length; t++) {
                              var n = null != arguments[t] ? arguments[t] : {};
                              t % 2
                                ? d_(Object(n), !0).forEach(function(t) {
                                    p_(e, t, n[t]);
                                  })
                                : Object.getOwnPropertyDescriptors
                                ? Object.defineProperties(
                                    e,
                                    Object.getOwnPropertyDescriptors(n)
                                  )
                                : d_(Object(n)).forEach(function(t) {
                                    Object.defineProperty(
                                      e,
                                      t,
                                      Object.getOwnPropertyDescriptor(n, t)
                                    );
                                  });
                            }
                            return e;
                          })({}, e, {
                            assetManager: e.assetManager || t.assetManager
                          })
                        )
                      );
                    });
                }
              },
              {
                key: "dispose",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0)
                    .then(function() {
                      return !e.app || e.app.dispose();
                    })
                    .then(function() {
                      return (e.app = null), !0;
                    });
                }
              },
              {
                key: "addModels",
                value: function(e) {
                  return this.app.addModels(e);
                }
              },
              {
                key: "removeModels",
                value: function(e) {
                  return this.app.removeModels(e);
                }
              },
              {
                key: "getAddedModels",
                value: function() {
                  return this.app.getAddedModels();
                }
              },
              {
                key: "activateModels",
                value: function(e) {
                  return this.app.activateModels(e, !0);
                }
              },
              {
                key: "deactivateModels",
                value: function(e) {
                  return this.app.activateModels(e, !1);
                }
              },
              {
                key: "activateMeshNodes",
                value: function(e) {
                  return this.app.activateMeshNodes(e, !0);
                }
              },
              {
                key: "deactivateMeshNodes",
                value: function(e) {
                  return this.app.activateMeshNodes(e, !1);
                }
              },
              {
                key: "addMaterials",
                value: function(e) {
                  return this.app.addMaterials(e);
                }
              },
              {
                key: "removeMaterials",
                value: function(e) {
                  return this.app.removeMaterials(e);
                }
              },
              {
                key: "getAddedMaterials",
                value: function() {
                  return this.app.getAddedMaterials();
                }
              },
              {
                key: "setMaterialForModels",
                value: function(e, t) {
                  return this.app.setMaterialForModels(e, t);
                }
              },
              {
                key: "setMaterialForMeshNodes",
                value: function(e, t) {
                  return this.app.setMaterialForMeshNodes(e, t);
                }
              },
              {
                key: "setMaterialForAnnotations",
                value: function(e, t) {
                  return this.app.setMaterialForAnnotations(e, t);
                }
              },
              {
                key: "setChildMaterialsForCompoundMaterial",
                value: function(e) {
                  var t =
                    arguments.length > 1 && void 0 !== arguments[1]
                      ? arguments[1]
                      : [];
                  return this.app.setChildMaterialsForCompoundMaterial(e, t);
                }
              },
              {
                key: "setMapForModels",
                value: function(e, t, n) {
                  return this.app.setMapForModels(e, t, n);
                }
              },
              {
                key: "setMapForMeshNodes",
                value: function(e, t, n) {
                  return this.app.setMapForMeshNodes(e, t, n);
                }
              },
              {
                key: "setMapForMaterial",
                value: function(e, t, n) {
                  return this.app.setMapForMaterial(e, t, n);
                }
              },
              {
                key: "removeMapFromMaterial",
                value: function(e, t) {
                  return this.app.removeMapFromMaterial(e, t);
                }
              },
              {
                key: "addTextures",
                value: function(e) {
                  return this.app.addTextures(e);
                }
              },
              {
                key: "removeTextures",
                value: function(e) {
                  return this.app.removeTextures(e);
                }
              },
              {
                key: "getAddedTextures",
                value: function() {
                  return this.app.getAddedTextures();
                }
              },
              {
                key: "addLights",
                value: function(e) {
                  return this.app.addLights(e);
                }
              },
              {
                key: "removeLights",
                value: function(e) {
                  return this.app.removeLights(e);
                }
              },
              {
                key: "getAddedLights",
                value: function() {
                  return this.app.getAddedLights();
                }
              },
              {
                key: "activateLights",
                value: function(e) {
                  return this.app.activateLights(e, !0);
                }
              },
              {
                key: "deactivateLights",
                value: function(e) {
                  return this.app.activateLights(e, !1);
                }
              },
              {
                key: "addAnnotations",
                value: function(e) {
                  return this.app.addAnnotations(e);
                }
              },
              {
                key: "removeAnnotations",
                value: function(e) {
                  return this.app.removeAnnotations(e);
                }
              },
              {
                key: "getAddedAnnotations",
                value: function() {
                  return this.app.getAddedAnnotations();
                }
              },
              {
                key: "activateAnnotations",
                value: function(e) {
                  return this.app.activateAnnotations(e, !0);
                }
              },
              {
                key: "deactivateAnnotations",
                value: function(e) {
                  return this.app.activateAnnotations(e, !1);
                }
              },
              {
                key: "activateCamera",
                value: function(e) {
                  var t =
                    !(arguments.length > 1 && void 0 !== arguments[1]) ||
                    arguments[1];
                  return this.app.activateCamera(e, t);
                }
              },
              {
                key: "deactivateCamera",
                value: function(e) {
                  return this.app.deactivateCamera(e);
                }
              },
              {
                key: "activateCameras",
                value: function(e) {
                  return this.app.activateCameras(e);
                }
              },
              {
                key: "deactivateCameras",
                value: function(e) {
                  return this.app.deactivateCameras(e);
                }
              },
              {
                key: "activateCameraControls",
                value: function(e) {
                  return this.app.activateCameraControls(e);
                }
              },
              {
                key: "deactivateCameraControls",
                value: function(e) {
                  return this.app.deactivateCameraControls(e);
                }
              },
              {
                key: "setCameraControlsTargetCamera",
                value: function(e, t) {
                  return this.app.setCameraControlsTargetCamera(e, t);
                }
              },
              {
                key: "activateControls",
                value: function(e) {
                  return this.app.activateControls(e);
                }
              },
              {
                key: "deactivateControls",
                value: function(e) {
                  return this.app.deactivateControls(e);
                }
              },
              {
                key: "removeControls",
                value: function(e) {
                  return this.app.removeControls(e);
                }
              },
              {
                key: "setControlsTarget",
                value: function(e, t) {
                  var n =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : {};
                  return this.app.setControlsTarget(e, t, n);
                }
              },
              {
                key: "activateNodes",
                value: function() {
                  var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : [];
                  return this.app.activateNodes(e, !0);
                }
              },
              {
                key: "deactivateNodes",
                value: function() {
                  var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : [];
                  return this.app.activateNodes(e, !1);
                }
              },
              {
                key: "setNodeParent",
                value: function(e, t) {
                  return this.app.setNodeParent(e, t);
                }
              },
              {
                key: "activateRenderer",
                value: function(e) {
                  return this.app.activateRenderer(e);
                }
              },
              {
                key: "setActiveRenderer",
                value: function(e) {
                  return this.app.activateRenderer(e);
                }
              },
              {
                key: "activateEnvironment",
                value: function(e) {
                  return this.app.activateEnvironment(e);
                }
              },
              {
                key: "setMapForEnvironment",
                value: function(e, t, n) {
                  return this.app.setMapForEnvironment(e, t, n);
                }
              },
              {
                key: "updateEntityConfig",
                value: function(e, t) {
                  var n =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : null;
                  return this.app.updateEntityConfig(e, t, n, !1);
                }
              },
              {
                key: "updateEntitiesConfig",
                value: function(e, t) {
                  var n =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : null;
                  return this.app.updateEntitiesConfig(e, t, n, !1);
                }
              },
              {
                key: "activateEffect",
                value: function(e, t, n, r) {
                  return this.app.activateEffect(e, t, n, r);
                }
              },
              {
                key: "deactivateEffect",
                value: function(e) {
                  return this.app.deactivateEffect(e);
                }
              },
              {
                key: "activateTransition",
                value: function(e) {
                  return this.app.activateTransition(e);
                }
              },
              {
                key: "getBoundingBox",
                value: function(e) {
                  return this.app.getBoundingBox(e);
                }
              },
              {
                key: "getSnapshot",
                value: function(e) {
                  return this.app.getSnapshot(e);
                }
              },
              {
                key: "getAssetsInfo",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    return e.assetManager.getTotalInfo();
                  });
                }
              },
              {
                key: "resetAssetsInfo",
                value: function() {
                  var e = this;
                  return Promise.resolve(!0).then(function() {
                    return e.assetManager.resetInfo();
                  });
                }
              },
              {
                key: "getMeshNodesForModels",
                value: function(e) {
                  return this.app.getMeshNodesForModels(e);
                }
              }
            ]) && f_(t.prototype, n),
            r && f_(t, r),
            e
          );
        })();
        function v_(e, t) {
          if (!e || !t) return !1;
          if (e.length !== t.length) return !1;
          for (var n = 0; n < e.length; n += 1)
            if (e[n] instanceof Array && t[n] instanceof Array) {
              if (!e[n].compare(t[n])) return !1;
            } else if (e[n] !== t[n]) return !1;
          return !0;
        }
        var g_ = class {
            constructor() {
              (this.viewer3D = new m_()), (this.initialized = !1);
            }
            init(e) {
              return Promise.resolve(!0)
                .then(() => this.viewer3D.init(e))
                .then(() => ((this.initialized = !0), !0));
            }
            dispose() {
              return Promise.resolve(!0)
                .then(() => this.viewer3D.dispose())
                .then(() => ((this.initialized = !1), !0));
            }
            updateEntity(e, t) {
              var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : [];
              return this.initialized
                ? Promise.resolve(!0)
                    .then(() => {
                      var r = this._getConfigDiff(e, t, n);
                      return (
                        0 === Object.keys(r).length || this._updateConfig(e, r)
                      );
                    })
                    .then(() => this._updateRelations(e, t))
                    .catch(e => {
                      throw e;
                    })
                : Promise.resolve(!0);
            }
            activateMeshNodes(e) {
              return this.viewer3D.activateMeshNodes(e);
            }
            deactivateMeshNodes(e) {
              return this.viewer3D.deactivateMeshNodes(e);
            }
            addModels(e) {
              return this.viewer3D.addModels(e);
            }
            removeModels(e) {
              return this.viewer3D.removeModels(e);
            }
            activateModels(e) {
              return this.viewer3D.activateModels(e);
            }
            setMaterialForMeshNodes(e, t) {
              return this.viewer3D.setMaterialForMeshNodes(e, t);
            }
            activateLights(e) {
              return this.viewer3D.activateLights(e);
            }
            deactivateLights(e) {
              return this.viewer3D.deactivateLights(e);
            }
            removeLights(e) {
              return this.viewer3D.removeLights(e);
            }
            activateAnnotations(e) {
              return this.viewer3D.activateAnnotations(e);
            }
            deactivateAnnotations(e) {
              return this.viewer3D.deactivateAnnotations(e);
            }
            removeAnnotations(e) {
              return this.viewer3D.removeAnnotations(e);
            }
            activateControls(e) {
              return this.viewer3D.activateControls(e);
            }
            deactivateControls(e) {
              return this.viewer3D.deactivateControls(e);
            }
            setControlsTarget(e, t) {
              var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : {};
              return this.viewer3D.setControlsTarget(e, t, n);
            }
            getBoundingBox(e) {
              return this.viewer3D.getBoundingBox(e);
            }
            getAddedModels() {
              return this.viewer3D.getAddedModels();
            }
            addMaterials(e) {
              return this.viewer3D.addMaterials(e);
            }
            removeMaterials(e) {
              return this.viewer3D.removeMaterials(e);
            }
            getAddedTextures() {
              return this.viewer3D.getAddedTextures();
            }
            removeTextures(e) {
              return this.viewer3D.removeTextures(e);
            }
            setChildMaterialsForCompoundMaterial(e, t) {
              return this.viewer3D.setChildMaterialsForCompoundMaterial(e, t);
            }
            activateEffect(e, t, n, r) {
              return this.viewer3D.activateEffect(e, t, n, r);
            }
            deactivateEffect(e) {
              return this.viewer3D.deactivateEffect(e);
            }
            deactivateEffects(e) {
              var t = e.map(e => this.deactivateEffect(e));
              return Promise.all(t);
            }
            activateTransition(e, t, n, r) {
              return this.viewer3D.activateTransition(e, t, n, r);
            }
            getSnapshot(e, t) {
              return this.viewer3D.getSnapshot({ width: e, height: t });
            }
            setMapForEnvironment(e, t, n) {
              return this.viewer3D.setMapForEnvironment(e, t, n);
            }
            activateCamera(e) {
              var t =
                !(arguments.length > 1 && void 0 !== arguments[1]) ||
                arguments[1];
              return this.viewer3D.activateCamera(e, t);
            }
            deactivateCamera(e) {
              return this.viewer3D.deactivateCamera(e);
            }
            activateCameras(e) {
              return this.viewer3D.activateCameras(e);
            }
            deactivateCameras(e) {
              return this.viewer3D.deactivateCameras(e);
            }
            removeControls(e) {
              return this.viewer3D.removeControls(e);
            }
            _updateRelations(e, t) {
              return new Promise((n, r) => {
                var i = e.constructor.getRelations(e.getTypeName()),
                  a = [];
                Object.keys(i).forEach(n => {
                  i[n].referenceType === G &&
                    i[n].active &&
                    (i[n].fieldType === z &&
                      e.active[i[n].field] !== t.active[i[n].field] &&
                      (a = [
                        ...a,
                        this._updateRelationsByEntitySwicher(e, i[n].field)
                      ]),
                    i[n].fieldType === V &&
                      (v_(e.active[i[n].field], t.active[i[n].field]) ||
                        (a = [
                          ...a,
                          this._updateRelationsArrayByEntitySwicher(
                            e,
                            t,
                            i[n].field
                          )
                        ])));
                }),
                  Promise.all(a)
                    .then(() => {
                      n();
                    })
                    .catch(e => {
                      r(e);
                    });
              });
            }
            _updateRelationsByEntitySwicher(e, t) {
              return new Promise((n, r) => {
                var v = e.constructor.getEntityName();
                switch (v) {
                  case u:
                    Ot.isMapField(t) &&
                      (null === e.active[t]
                        ? this.viewer3D
                            .removeMapFromMaterial(e.id, t)
                            .then(() => {
                              n();
                            })
                            .catch(e => {
                              r(w.default.setStandard(e, 400));
                            })
                        : this.viewer3D
                            .setMapForMaterial(e.id, e.active[t], t)
                            .then(() => {
                              n();
                            })
                            .catch(e => {
                              r(w.default.setStandard(e, 400));
                            }));
                    break;
                  case h:
                    switch (t) {
                      case "materialID":
                        this.viewer3D
                          .setMaterialForMeshNodes([e.id], e.active[t])
                          .then(() => {
                            n();
                          })
                          .catch(e => {
                            r(w.default.setStandard(e, 400));
                          });
                    }
                    break;
                  case y:
                    switch (t) {
                      case "materialID":
                        this.viewer3D
                          .setMaterialForAnnotations([e.id], e.active[t])
                          .then(() => {
                            n();
                          })
                          .catch(e => {
                            r(w.default.setStandard(e, 400));
                          });
                    }
                    break;
                  case f:
                    switch (t) {
                      case "cameraID":
                        this.viewer3D
                          .activateCamera(e.active[t])
                          .then(() => {
                            n();
                          })
                          .catch(e => {
                            r(w.default.setStandard(e, 400));
                          });
                        break;
                      case "rendererID":
                        this.viewer3D
                          .activateRenderer(e.active[t])
                          .then(() => {
                            n();
                          })
                          .catch(e => {
                            r(w.default.setStandard(e, 400));
                          });
                        break;
                      case "environmentID":
                        this.viewer3D
                          .activateEnvironment(e.active[t])
                          .then(() => {
                            n();
                          })
                          .catch(e => {
                            r(w.default.setStandard(e, 400));
                          });
                    }
                    break;
                  case d:
                  case i:
                  case a:
                  case o:
                  case s:
                  case l:
                  case c:
                  case p:
                  case m:
                  case x:
                    n();
                    break;
                  default:
                    r(
                      w.default.setStandard(
                        "Do not support entity: ".concat(v),
                        400
                      )
                    );
                }
              });
            }
            _updateRelationsArrayByEntitySwicher(e, t, n) {
              var r = t.active[n],
                i = e.active[n],
                a = i.filter(e => !r.includes(e)),
                o = r.filter(e => !i.includes(e));
              return Promise.resolve(!0).then(() => {
                switch (e.constructor.getEntityName()) {
                  case f:
                    switch (n) {
                      case "cameras":
                        return Promise.all([
                          this.deactivateCameras(o),
                          this.activateCameras(a)
                        ]);
                      case "meshNodes":
                        return Promise.all([
                          this.deactivateMeshNodes(o),
                          this.activateMeshNodes(a)
                        ]);
                      case "lights":
                        return Promise.all([
                          this.deactivateLights(o),
                          this.activateLights(a)
                        ]);
                      case "annotations":
                        return Promise.all([
                          this.deactivateAnnotations(o),
                          this.activateAnnotations(a)
                        ]);
                      case "controls":
                        var t = o.map(e => this.deactivateControls(e)),
                          r = a.map(e => this.activateControls(e));
                        return Promise.all([...t, ...r]);
                    }
                }
                return Promise.resolve(!0);
              });
            }
            _updateConfig(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : null;
              return new Promise((n, r) => {
                var _ = e.constructor.getEntityName();
                switch (_) {
                  case h:
                  case c:
                  case u:
                  case m:
                  case a:
                  case s:
                  case p:
                  case y:
                  case x:
                    this.viewer3D
                      .updateEntityConfig(e.id, _, t)
                      .then(() => {
                        n(!0);
                      })
                      .catch(e => {
                        r(w.default.setStandard(e, 400));
                      });
                    break;
                  case d:
                  case i:
                  case o:
                  case l:
                  case f:
                  case g:
                  case b:
                  case v:
                    n(!0);
                    break;
                  default:
                    r(
                      w.default.setStandard(
                        "Do not support entity: ".concat(_),
                        400
                      )
                    );
                }
              });
            }
            _getConfigDiff(e, t, n) {
              var r = n.reduce(
                (t, n) => (
                  ("N" !== n.kind && "E" !== n.kind) ||
                    ("config" === n.path[0] &&
                      (t[n.path[1]] = e.config[n.path[1]])),
                  t
                ),
                {}
              );
              return (r = n.reduce(
                (t, n) => (
                  ("N" !== n.kind && "E" !== n.kind) ||
                    ("activeConfig" === n.path[0] &&
                      (t[n.path[1]] = e.activeConfig[n.path[1]])),
                  t
                ),
                r
              ));
            }
            getAssetsInfo() {
              return this.viewer3D.getAssetsInfo();
            }
            resetAssetsInfo() {
              return this.viewer3D.resetAssetsInfo();
            }
          },
          y_ = n(4),
          b_ = n.n(y_),
          x_ = "typeRes",
          w_ = "requiredRes",
          __ = "entityRefRes",
          M_ = "uniqueRes",
          T_ = "generateUniqueRes",
          A_ = "defaultRes",
          S_ = "minRangeRes",
          E_ = "maxRangeRes",
          R_ = "createDefinedID",
          P_ = "enumValuesRes",
          I_ = "fixedValueRes",
          D_ = "activeRes";
        function O_(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function C_(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        class L_ {
          constructor(e) {
            var t =
              arguments.length > 1 && void 0 !== arguments[1]
                ? arguments[1]
                : "model";
            (this.model = e),
              (this.entity = this.model.getEntityName()),
              (this.modelTypeName = null),
              (this.update = !1),
              (this.rules = null),
              (this.relations = null),
              (this.queue = { byId: {}, allIds: [] }),
              (this.queueProcess = !1),
              (this.queueProcessUniqueIndex = {}),
              (this.externalProviderTufActive = !1),
              (this.externalProviderTuf = null),
              (this.currentEntity = null),
              (this.returnFormat = t);
          }
          static removeDataForEntityInRedux(e) {
            var t = Object.assign({}, e);
            return (
              void 0 !== t.rel && delete t.rel,
              void 0 !== t.relActive && delete t.relActive,
              void 0 !== t.relations && delete t.relations,
              t
            );
          }
          static removeDataForEntityGroupInRedux(e) {
            for (
              var t = { allIds: [], byId: {} }, n = 0;
              n < e.allIds.length;
              n++
            ) {
              var r = e.allIds[n];
              (t.allIds[n] = r),
                (t.byId[r] = this.removeDataForEntityInRedux(e.byId[r]));
            }
            return t;
          }
          setExternalProviderTUF(e) {
            (this.externalProviderTufActive = !0),
              (this.externalProviderTuf = e);
          }
          parseGroupQueueRelations(e) {
            if (!this.queueProcess) return null;
            (this.modelTypeName = this._findTypeName(e)),
              (this.rules = this.model.getRules(this.modelTypeName)),
              (this.relations = this.model.getRelations(this.modelTypeName));
            var t = this._parseRelations(e),
              n = Object.assign({}, this.queue.byId[e.id], t);
            if (
              ((this.queue.byId[e.id] = Object.assign({}, n)),
              this._checkUniqueIndex(n),
              "model" === this.returnFormat)
            ) {
              var r = new this.model();
              return r.setFromData(n), r;
            }
            return n;
          }
          parseGroupQueue(e) {
            (this.update = !1),
              (this.queueProcess = !0),
              (this.modelTypeName = this._findTypeName(e)),
              (this.rules = this.model.getRules(this.modelTypeName)),
              (this.relations = this.model.getRelations(this.modelTypeName));
            var t = this._parseData(e);
            return (this.queue.byId[t.id] = t), this.queue.allIds.push(t.id), t;
          }
          parse(e) {
            var t =
              arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            (this.update = t),
              (this.modelTypeName = this._findTypeName(e)),
              (this.rules = this.model.getRules(this.modelTypeName)),
              (this.relations = this.model.getRelations(this.modelTypeName)),
              this.update && this.model.getEntityType() === W
                ? ((void 0 !== e.id &&
                    this._referenceExists(e.id, this.entity)) ||
                    w.default.standard(
                      "Entity: "
                        .concat(this.entity, ". Does not exists with id = ")
                        .concat(e.id),
                      302
                    ),
                  (this.currentEntity = this._getCurrentEntity(
                    this.entity,
                    e.id
                  )))
                : (this.currentEntity = this._getCurrentEntity(this.entity));
            var n = this._parseData(e),
              r = this._parseRelations(e),
              i = Object.assign({}, n, r);
            if ((this._checkUniqueIndex(i), "model" === this.returnFormat)) {
              var a = new this.model();
              return a.setFromData(i), a;
            }
            return i;
          }
          _getCurrentEntity(e) {
            var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : null,
              n = null;
            return null === t
              ? (this.queueProcess &&
                  this.entity === e &&
                  void 0 === this.queue.byId &&
                  (n = this.queue),
                this.externalProviderTufActive &&
                  this.externalProviderTuf[e] &&
                  void 0 === this.externalProviderTuf[e].byId &&
                  (n = this.externalProviderTuf[e]),
                null === n &&
                  (n = Ot.getSingle(e, { returnType: "reference" })),
                n)
              : (this.queueProcess &&
                  this.entity === e &&
                  void 0 !== this.queue.byId[t] &&
                  (n = this.queue.byId[t]),
                this.externalProviderTufActive &&
                  this.externalProviderTuf[e] &&
                  void 0 !== this.externalProviderTuf[e].byId[t] &&
                  (n = this.externalProviderTuf[e].byId[t]),
                null === n &&
                  (n = Ot.getEntity(e, t, { returnType: "reference" })),
                n);
          }
          _parseData(e) {
            var t = this._processObject(this.rules, e);
            return (
              (t.config = this._processObject(
                this.rules.config,
                e.config,
                "config"
              )),
              (e.activeConfig = (function(e) {
                for (var t = 1; t < arguments.length; t++) {
                  var n = null != arguments[t] ? arguments[t] : {};
                  t % 2
                    ? O_(Object(n), !0).forEach(function(t) {
                        C_(e, t, n[t]);
                      })
                    : Object.getOwnPropertyDescriptors
                    ? Object.defineProperties(
                        e,
                        Object.getOwnPropertyDescriptors(n)
                      )
                    : O_(Object(n)).forEach(function(t) {
                        Object.defineProperty(
                          e,
                          t,
                          Object.getOwnPropertyDescriptor(n, t)
                        );
                      });
                }
                return e;
              })({}, e.config, {}, e.activeConfig)),
              (t.activeConfig = this._processObject(
                this.rules.config,
                e.activeConfig,
                "activeConfig",
                !0
              )),
              "object" == typeof e.config &&
                Object.keys(e.config).forEach(n => {
                  Array.isArray(e.config[n])
                    ? (t.config[n] = [...e.config[n]])
                    : (t.config[n] = e.config[n]);
                }),
              t
            );
          }
          _parseRelations(e) {
            return Object.keys(this.relations).reduce(
              (t, n) =>
                this.update && this.relations[n].notChangeable
                  ? ((t[this.relations[n].field] = this.currentEntity[
                      this.relations[n].field
                    ]),
                    this.relations[n].active &&
                      (t.active[
                        this.relations[n].field
                      ] = this.currentEntity.active[this.relations[n].field]),
                    t)
                  : (this.relations[n].referenceType === G &&
                      ((t[
                        this.relations[n].field
                      ] = this._getValidatedRelationValue(
                        e,
                        n,
                        this.relations[n].defaultValue,
                        n
                      )),
                      this.relations[n].active &&
                        (t.active[
                          this.relations[n].field
                        ] = this._getValidatedRelationValue(
                          e.active,
                          n,
                          t[this.relations[n].field],
                          "active.".concat(n)
                        ))),
                    t),
              { active: {} }
            );
          }
          _getValidatedRelationValue(e, t, n, r) {
            var i = this._getValue(this.relations[t].field, e, n);
            if (
              (void 0 === i &&
                w.default.standard(
                  "Entity: "
                    .concat(this.entity, ". Relation ")
                    .concat(r, " is required."),
                  302
                ),
              this.relations[t].fieldType === V)
            ) {
              if (
                (Array.isArray(i) ||
                  w.default.standard(
                    "Entity: "
                      .concat(this.entity, ". Relation ")
                      .concat(r, " have to be array."),
                    302
                  ),
                this._referenceArray(i, this.relations[t].referenceEntity)
                  .length === i.length)
              )
                return i;
              w.default.standard(
                "Entity: "
                  .concat(this.entity, ". Relation array ")
                  .concat(
                    r,
                    " do not have right refereces. One or more references to non existing reference."
                  ),
                302
              );
            }
            if (this.relations[t].fieldType === z) {
              if (this._referenceExists(i, this.relations[t].referenceEntity))
                return i;
              if (
                void 0 !== this.relations[t].defaultValue &&
                null === this.relations[t].defaultValue &&
                this.relations[t].defaultValue === i
              )
                return null;
            }
            return (
              w.default.standard(
                "Entity: "
                  .concat(this.entity, ". Bad Relation ")
                  .concat(r, " on field: ")
                  .concat(
                    this.relations[t].field,
                    " . This reference does not exists."
                  ),
                302
              ),
              null
            );
          }
          _checkUniqueIndex(e) {
            for (
              var t = this.model.getUniqueGroups(),
                n = Ot.getEntityGroup(this.entity, { returnType: "reference" }),
                r = !0,
                i = 0;
              i < t.length;
              i++
            ) {
              var a = t[i];
              if (this.update) {
                for (var o = !0, s = 0; s < a.length; s++)
                  if (b_.a.get(n.byId[e.id], a[s]) !== b_.a.get(e, a[s])) {
                    o = !1;
                    break;
                  }
                if (o) continue;
              }
              for (var l = 0; l < n.allIds.length; l++) {
                var c = n.allIds[l];
                r = !1;
                for (var u = 0; u < a.length; u++)
                  if (b_.a.get(n.byId[c], a[u]) !== b_.a.get(e, a[u])) {
                    r = !0;
                    break;
                  }
                if (!r) break;
              }
              if (this.queueProcess && r) {
                for (var h = "", d = null, p = 0; p < a.length; p++)
                  (h += "".concat(a[p], ":")),
                    (d += "".concat(b_.a.get(e, a[p]), ":"));
                this.queueProcessUniqueIndex[h]
                  ? this.queueProcessUniqueIndex[h][d]
                    ? (r = !1)
                    : (this.queueProcessUniqueIndex[h][d] = !0)
                  : (this.queueProcessUniqueIndex = { [h]: { [d]: !0 } });
              }
              if (this.externalProviderTufActive && r)
                for (
                  var f = 0;
                  f < this.externalProviderTuf[this.entity].allIds.length;
                  f++
                ) {
                  var m = this.externalProviderTuf[this.entity].allIds[f];
                  if (m !== e.id) {
                    r = !1;
                    for (var v = 0; v < a.length; v++)
                      if (
                        b_.a.get(
                          this.externalProviderTuf[this.entity].byId[m],
                          a[v]
                        ) !== b_.a.get(e, a[v])
                      ) {
                        r = !0;
                        break;
                      }
                    if (!r) break;
                  }
                }
              r ||
                w.default.standard(
                  "Entity: "
                    .concat(this.entity, ". Fields '")
                    .concat(
                      t[i].toString(),
                      "' have to be unique with groupFields. "
                    ),
                  304
                );
            }
          }
          _referenceArray(e, t) {
            for (var n = [], r = 0; r < e.length; r++)
              this._referenceExists(e[r], t) && n.push(e[r]);
            return n;
          }
          _referenceExists(e, t) {
            return (
              null !== Ot.getEntity(t, e, { returnType: "reference" }) ||
              !(
                !this.queueProcess ||
                this.entity !== t ||
                void 0 === this.queue.byId[e]
              ) ||
              !(
                !this.externalProviderTufActive ||
                !this.externalProviderTuf[t] ||
                void 0 === this.externalProviderTuf[t].byId[e]
              )
            );
          }
          _processObject(e, t) {
            var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : "",
              r =
                arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
              i = L_.allDescribers();
            return Object.keys(e).reduce((a, o) => {
              if (!i.includes(o)) {
                var s = this._getValidatedDataValue(
                  e,
                  o,
                  t,
                  "".concat(n, ".").concat(o),
                  r
                );
                void 0 !== s && (a[o] = s);
              }
              return a;
            }, {});
          }
          _getValidatedDataValue(e, t, n, r, i) {
            if (!i || e[t].activeRes) {
              var a;
              void 0 !== e[t].defaultRes && (a = e[t].defaultRes);
              var o = this._getValue(t, n, a);
              if (
                (void 0 === o &&
                  e[t].typeRes !== he &&
                  e[t].typeRes !== de &&
                  e[t].requiredRes &&
                  w.default.standard(
                    "Entity: "
                      .concat(this.entity, ". Field ")
                      .concat(t, " is required. Path: '")
                      .concat(r, "'"),
                    302
                  ),
                null !== o || o !== a)
              )
                switch (e[t].typeRes) {
                  case he:
                    this.update
                      ? void 0 !== n.id && null != n.id
                        ? (o = n.id)
                        : w.default.standard(
                            "Entity: "
                              .concat(this.entity, ". TypeRes: '")
                              .concat(e[t].typeRes, "' is not set! Path: '")
                              .concat(r, "'")
                          )
                      : e[t].createDefinedID && void 0 !== n.id && null != n.id
                      ? ((o = n.id), (e[t].uniqueRes = !0))
                      : (o = E()());
                    break;
                  case de:
                    o = this.entity;
                    break;
                  case Te:
                  case Me:
                  case fe:
                  case me:
                  case ve:
                  case ge:
                  case Ee:
                  case Ae:
                    this._validateInput(o, e[t].typeRes) ||
                      w.default.standard(
                        "Entity: "
                          .concat(this.entity, ". Field ")
                          .concat(t, " have to be: ")
                          .concat(e[t].typeRes, ". Path: '")
                          .concat(r, "'"),
                        308
                      );
                    break;
                  case pe:
                    o = e[t].fixedValueRes;
                    break;
                  case Se:
                    this._validateRangeInput(
                      o,
                      e[t].minRangeRes,
                      e[t].maxRangeRes,
                      r
                    );
                    break;
                  case we:
                    this._validateEnumInput(o, e[t].enumValuesRes) ||
                      w.default.standard(
                        "Entity: "
                          .concat(this.entity, ". Field ")
                          .concat(t, " have to be one of these values: '")
                          .concat(e[t].enumValuesRes.toString(), "'. Path: '")
                          .concat(r, "'"),
                        308
                      );
                    break;
                  case ye:
                  case _e:
                    o = {};
                    break;
                  case xe:
                    o = this._loopArray(e[t], o, r);
                    break;
                  case be:
                    o = JSON.parse(JSON.stringify(o));
                    break;
                  default:
                    w.default.standard(
                      "Entity: "
                        .concat(this.entity, ". TypeRes: '")
                        .concat(e[t].typeRes, "' is not defined! Path: '")
                        .concat(r, "'")
                    );
                }
              if (e[t].uniqueRes)
                if (null !== o && e[t].generateUniqueRes) {
                  for (var s = 1, l = o; !this._isUnique(l, r, n); )
                    (l = "".concat(o, "-").concat(s)), s++;
                  o = l;
                } else
                  (null !== o && this._isUnique(o, r, n)) ||
                    w.default.standard(
                      "Entity: "
                        .concat(this.entity, ". Field ")
                        .concat(t, " have to be unique. Path: '")
                        .concat(r, "'"),
                      304
                    );
              return o;
            }
          }
          _getValue(e, t, n) {
            try {
              var r = t[e];
              if (null != r) return r;
            } catch (e) {}
            return n;
          }
          _loopArray(e, t, n) {
            return Array.isArray(t) ? [...t] : [];
          }
          _validateInput(e, t) {
            try {
              switch (t) {
                case Te:
                case Me:
                  if (typeof e === t) return !0;
                  break;
                case fe:
                  if (
                    Array.isArray(e) &&
                    2 === e.length &&
                    "number" == typeof e[0] &&
                    "number" == typeof e[1]
                  )
                    return !0;
                  break;
                case me:
                  if (
                    Array.isArray(e) &&
                    3 === e.length &&
                    "number" == typeof e[0] &&
                    "number" == typeof e[1] &&
                    "number" == typeof e[2]
                  )
                    return !0;
                  break;
                case ve:
                  if (
                    Array.isArray(e) &&
                    4 === e.length &&
                    "number" == typeof e[0] &&
                    "number" == typeof e[1] &&
                    "number" == typeof e[2] &&
                    "number" == typeof e[3]
                  )
                    return !0;
                  break;
                case ge:
                  if ("string" == typeof e && 7 === e.length && "#" === e[0])
                    return !0;
                  break;
                case ye:
                  if ("object" == typeof e && null !== e) return !0;
                  break;
                case xe:
                  if (Array.isArray(e)) return !0;
                  break;
                case _e:
                  return this.validateInput(e, ye);
                case Ee:
                  if (Number(e) === e && (e % 1 == 0 || 0 === e)) return !0;
                  break;
                case Ae:
                  if (Number(e) === e || "Infinity" === e || "-Infinity" === e)
                    return !0;
              }
            } catch (e) {}
            return !1;
          }
          _validateRangeInput(e, t, n, r) {
            return (
              (void 0 !== t &&
                void 0 !== n &&
                Number(t) === t &&
                Number(n) === n) ||
                w.default.standard(
                  "Entity: "
                    .concat(
                      this.entity,
                      ". TypeRes: range, Min and Max undefined! Path: '"
                    )
                    .concat(r, "'")
                ),
              Number(e) !== e &&
                w.default.standard(
                  "Entity: "
                    .concat(
                      this.entity,
                      ". TypeRes: range, value have to be float! Path: '"
                    )
                    .concat(r, "'")
                ),
              (e < t || e > n) &&
                w.default.standard(
                  "Entity: "
                    .concat(
                      this.entity,
                      ". TypeRes: range, value has to be between '"
                    )
                    .concat(t, "' and '")
                    .concat(n, "'! Path: '")
                    .concat(r, "'")
                ),
              !0
            );
          }
          _validateEnumInput(e, t) {
            return -1 !== t.indexOf(e);
          }
          _isUnique(e, t, n) {
            for (
              var r = Ot.getEntityGroup(this.entity, {
                returnType: "reference"
              });
              "." === t.charAt(0);

            )
              t = t.substr(1);
            var i = !0;
            if (this.update && b_.a.get(r.byId[n.id], t) === e) return !0;
            for (var a = 0; a < r.allIds.length; a++) {
              var o = r.allIds[a];
              if (b_.a.get(r.byId[o], t) === e) {
                i = !1;
                break;
              }
            }
            if (
              (this.queueProcess &&
                i &&
                (this.queueProcessUniqueIndex[t]
                  ? this.queueProcessUniqueIndex[t][e]
                    ? (i = !1)
                    : (this.queueProcessUniqueIndex[t][e] = !0)
                  : (this.queueProcessUniqueIndex = { [t]: { [e]: !0 } })),
              this.externalProviderTufActive && i)
            )
              for (
                var s = 0;
                s < this.externalProviderTuf[this.entity].allIds.length;
                s++
              ) {
                var l = this.externalProviderTuf[this.entity].allIds[s];
                if (
                  n.id !== l &&
                  b_.a.get(this.externalProviderTuf[this.entity].byId[l], t) ===
                    e
                ) {
                  i = !1;
                  break;
                }
              }
            return i;
          }
          _findTypeName(e) {
            if (null === this.model._typeRelation) return null;
            var t = this.model._relations.commonRelations[
              this.model._typeRelation
            ];
            (void 0 !== t &&
              void 0 !== t.referenceEntity &&
              "undefined" !== t.referenceOn &&
              void 0 !== t.field) ||
              w.default.standard(
                "Entity: "
                  .concat(this.entity, ". Type Relation ")
                  .concat(
                    this.model._typeRelation,
                    " is required in model description!."
                  ),
                302
              ),
              (void 0 !== e[t.field] && null !== e[t.field]) ||
                (null === this.model._defaultType
                  ? w.default.standard(
                      "Entity: "
                        .concat(this.entity, ". Relation field ")
                        .concat(t.field, " is required."),
                      302
                    )
                  : ((e[t.field] = Ot.getEntityByNameUQ(
                      t.referenceEntity,
                      this.model._defaultType,
                      { returnType: "reference" }
                    ).id),
                    null === e[t.field] &&
                      w.default.standard(
                        "Entity: "
                          .concat(this.entity, ". Relation field ")
                          .concat(t.field, " is required."),
                        302
                      )));
            var n = Ot.getEntity(t.referenceEntity, e[t.field], {
              returnType: "reference"
            });
            return (
              null === n &&
                (this.externalProviderTufActive &&
                this.externalProviderTuf[t.referenceEntity] &&
                void 0 !==
                  this.externalProviderTuf[t.referenceEntity].byId[e[t.field]]
                  ? (n = this.externalProviderTuf[t.referenceEntity].byId[
                      e[t.field]
                    ])
                  : w.default.standard(
                      "Entity: "
                        .concat(this.entity, ". Relation on ")
                        .concat(t.referenceEntity, " do not exists. Field  ")
                        .concat(t.field, "."),
                      302
                    )),
              n.nameUQ
            );
          }
          static allRelationsDescribers() {
            return [
              "field",
              "fieldType",
              "referenceEntity",
              "referenceOn",
              "relationReferenceName",
              "referenceEntityTypes",
              "referenceType",
              "defaultValue",
              "active",
              "notChangeable"
            ];
          }
          static allDescribers() {
            return [x_, w_, __, M_, T_, A_, S_, E_, R_, P_, I_, D_];
          }
          static allTypesRes() {
            return [
              he,
              de,
              pe,
              me,
              ve,
              fe,
              ge,
              ye,
              be,
              xe,
              we,
              _e,
              Me,
              Te,
              Ae,
              Se,
              Ee
            ];
          }
        }
        var N_ = L_,
          F_ = e => t => {
            t({ type: "TUF_LOAD", payload: { tuf: e } });
          },
          k_ = e => t => {
            t({
              type: "TUF_ENTITY_ADD",
              payload: { entity: N_.removeDataForEntityInRedux(e) }
            });
          },
          U_ = e => t => {
            t({ type: "TUF_ENTITY_DELETE", payload: { entity: e } });
          },
          j_ = e => t => {
            t({
              type: "TUF_ENTITY_ADD_GROUP",
              payload: { entityGroup: N_.removeDataForEntityGroupInRedux(e) }
            });
          },
          B_ = e => t => {
            t({
              type: "TUF_ENTITY_UPDATE_GROUP",
              payload: { entityGroup: N_.removeDataForEntityGroupInRedux(e) }
            });
          },
          z_ = e => t => {
            t({
              type: "TUF_ENTITY_UPDATE",
              payload: { entity: N_.removeDataForEntityInRedux(e) }
            });
          },
          V_ = e => t => {
            t({
              type: "TUF_SINGLE_UPDATE",
              payload: { single: N_.removeDataForEntityInRedux(e) }
            });
          };
        class G_ {
          constructor() {}
          static all() {
            return Ot.getEntityGroup(this.entityClass._entity);
          }
          static get(e) {
            return this.getById(e);
          }
          static getById(e) {
            return this.entityClass._entityType === W
              ? Ot.getEntity(this.entityClass._entity, e)
              : Ot.getSingle(this.entityClass._entity);
          }
          static getGroup() {
            return this.entityClass._entityType === W
              ? Ot.getEntityGroup(this.entityClass._entity)
              : Ot.getSingle(this.entityClass._entity);
          }
          static create(e) {
            return this.entityClass.getEntityType() === Y
              ? this.update(e)
              : new Promise((t, n) => {
                  try {
                    var r = new N_(this.entityClass).parse(e);
                    k_(r)(C.dispatch), t(B()({}, r));
                  } catch (e) {
                    n(e);
                  }
                });
          }
          static createEntityGroup(e) {
            return new Promise((t, n) => {
              try {
                for (
                  var r = { byId: {}, allIds: [], idsMap: {} },
                    i = new N_(this.entityClass),
                    a = 0;
                  a < e.length;
                  a++
                ) {
                  var o = e[a].id;
                  (e[a] = Object.assign({}, e[a], i.parseGroupQueue(e[a]))),
                    void 0 !== o && (r.idsMap[o] = e[a].id);
                }
                for (var s = 0; s < e.length; s++) {
                  var l = i.parseGroupQueueRelations(e[s]);
                  (r.byId[l.id] = l), r.allIds.push(l.id);
                }
                j_(r)(C.dispatch), t(r);
              } catch (e) {
                n(e);
              }
            });
          }
          static update(e) {
            return new Promise((t, n) => {
              try {
                var r = new N_(this.entityClass).parse(e, !0);
                this.entityClass.getEntityType() === Y
                  ? V_(r)(C.dispatch)
                  : z_(r)(C.dispatch),
                  t(r);
              } catch (e) {
                n(e);
              }
            });
          }
          static updateEntityGroup(e) {
            return new Promise((t, n) => {
              try {
                for (var r = { byId: {}, allIds: [] }, i = 0; i < e.length; i++)
                  (r.byId[e[i].id] = e[i]), r.allIds.push(e[i].id);
                B_(r)(C.dispatch), t(r);
              } catch (e) {
                n(e);
              }
            });
          }
          static delete(e) {
            return new Promise((t, n) => {
              this.entityClass._entityType === W && U_(e)(C.dispatch), t();
            });
          }
        }
        G_.entityClass = null;
        var H_ = G_;
        class X_ extends H_ {
          constructor() {
            super();
          }
        }
        X_.entityClass = at;
        var W_ = X_;
        class Y_ extends H_ {
          constructor() {
            super();
          }
        }
        Y_.entityClass = st;
        var q_ = Y_;
        function Q_(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function Z_(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        var J_ = class {
          constructor(e, t) {
            (this.tufViewer3D = e), (this.entityRepoClass = t);
          }
          create() {
            var e =
              arguments.length > 0 && void 0 !== arguments[0]
                ? arguments[0]
                : {};
            return (
              arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
              this.entityRepoClass.create(e)
            );
          }
          update() {
            var e =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : {},
              t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
            return Promise.resolve(null)
              .then(() => {
                var t = this.entityRepoClass.get(e.id),
                  n =
                    e instanceof ue
                      ? e
                      : this.entityRepoClass.get(e.id).assignFromData(e),
                  r = t.getDiff(n);
                return 0 === r.length
                  ? { updatedEntity: t, oldEntity: t, diffResult: r }
                  : (this._updateLockedProperties(n),
                    this.entityRepoClass
                      .update(n)
                      .then(e => ({
                        updatedEntity: e,
                        oldEntity: t,
                        diffResult: r
                      })));
              })
              .then(e => {
                var n = e.updatedEntity,
                  r = e.oldEntity,
                  i = e.diffResult;
                return this.tufViewer3D && t.viewer3dUpdate
                  ? this.tufViewer3D.updateEntity(n, r, i).then(() => n)
                  : n;
              });
          }
          delete(e) {
            var t =
              arguments.length > 1 && void 0 !== arguments[1]
                ? arguments[1]
                : { viewer3dUpdate: !0 };
            return this.entityRepoClass.delete(e, t);
          }
          clone(e) {
            return Promise.resolve()
              .then(() => {
                var t = this.entityRepoClass.get(e);
                return this.create(
                  (function(e) {
                    for (var t = 1; t < arguments.length; t++) {
                      var n = null != arguments[t] ? arguments[t] : {};
                      t % 2
                        ? Q_(Object(n), !0).forEach(function(t) {
                            Z_(e, t, n[t]);
                          })
                        : Object.getOwnPropertyDescriptors
                        ? Object.defineProperties(
                            e,
                            Object.getOwnPropertyDescriptors(n)
                          )
                        : Q_(Object(n)).forEach(function(t) {
                            Object.defineProperty(
                              e,
                              t,
                              Object.getOwnPropertyDescriptor(n, t)
                            );
                          });
                    }
                    return e;
                  })({}, t)
                );
              })
              .catch(e => {
                throw e;
              });
          }
          getEntityType(e) {
            var t = this.entityRepoClass.get(e);
            return t.rel["".concat(t.entity, "Type")]().nameUQ;
          }
          _updateLockedProperties(e) {
            ["position", "quaternion", "scale", "target", "direction"].forEach(
              t => {
                var n = "lock"
                  .concat(t.charAt(0).toUpperCase())
                  .concat(t.substr(1));
                e.activeConfig[t] &&
                  e.config[n] &&
                  (e.config[t] = e.activeConfig[t]);
              }
            );
          }
        };
        class K_ extends H_ {
          constructor() {
            super();
          }
        }
        K_.entityClass = ct;
        var $_ = K_;
        class eM extends H_ {
          constructor() {
            super();
          }
          static update(e) {
            return super.update(e);
          }
          static groupCreateObject(e) {
            return Promise.resolve().then(() => {
              var t = [];
              return (
                e.allIds.forEach(n => {
                  t.push(e.byId[n]);
                }),
                this.createEntityGroup(t)
              );
            });
          }
        }
        eM.entityClass = Pe;
        var tM = eM,
          nM = class extends J_ {
            constructor(e) {
              super(e, tM);
            }
            update(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
              return super.update(e, t);
            }
          };
        class rM extends H_ {
          constructor() {
            super();
          }
        }
        rM.entityClass = Ne;
        var iM = rM;
        class aM extends H_ {
          constructor() {
            super();
          }
          static groupCreateObject(e, t) {
            return new Promise((n, r) => {
              try {
                for (
                  var i = new N_(pt),
                    a = aM._loopGroupObjectCreation(t, e, null, i),
                    o = { byId: {}, allIds: [] },
                    s = {},
                    l = 0;
                  l < e.allIds.length;
                  l++
                ) {
                  var c = e.allIds[l],
                    u = i.parseGroupQueueRelations(e.byId[c]);
                  (o.byId[u.id] = u), o.allIds.push(u.id), (s[c] = u.id);
                }
                j_(o)(C.dispatch),
                  n({ newGroupNode: o, newRootNodeID: a, references: s });
              } catch (e) {
                r(e);
              }
            });
          }
          static _loopGroupObjectCreation(e, t, n, r) {
            for (
              var i = r.parseGroupQueue(t.byId[e]), a = [], o = 0;
              o < t.byId[e].children.length;
              o++
            ) {
              var s = t.byId[e].children[o];
              a.push(this._loopGroupObjectCreation(s, t, i.id, r));
            }
            return (
              (t.byId[e].parentID = n),
              (t.byId[e].children = a),
              (t.byId[e].id = i.id),
              i.id
            );
          }
        }
        aM.entityClass = pt;
        var oM = aM;
        class sM extends H_ {
          static getDefaultMaterial() {
            var e = {
              nameUQ:
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : "Default",
              materialTypeID:
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : oe,
              config: {
                color:
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : "#7b7b7b"
              }
            };
            return super.create(e);
          }
          static groupCreateObject(e) {
            return Promise.resolve().then(() => {
              var t = [];
              return (
                e.allIds.forEach(n => {
                  t.push(e.byId[n]);
                }),
                this.createEntityGroup(t)
              );
            });
          }
        }
        sM.entityClass = Xe;
        var lM = sM;
        class cM extends H_ {
          static groupCreateObject(e, t) {
            return new Promise((n, r) => {
              try {
                for (
                  var i = {
                      nameUQ: "rel-meshnode",
                      nodeTypeID: Q,
                      parentID: null,
                      children: []
                    },
                    a = [],
                    o = 0;
                  o < e.allIds.length;
                  o++
                )
                  a[o] = i;
                oM.createEntityGroup(a)
                  .then(i => {
                    lM.getDefaultMaterial()
                      .then(a => {
                        for (
                          var o = {}, s = [], l = 0;
                          l < e.allIds.length;
                          l++
                        ) {
                          var c = e.allIds[l];
                          (e.byId[c].nodeID = i.allIds[l]),
                            (s[l] = this.addDefaultMaterial(e.byId[c], a.id)),
                            (o[c] = l);
                        }
                        this.createEntityGroup(s)
                          .then(a => {
                            for (var l = [], c = 0; c < e.allIds.length; c++) {
                              var u = e.allIds[c],
                                h = e.byId[u].parentID,
                                d = e.byId[u].children,
                                p = i.byId[i.allIds[c]];
                              if (null !== h) {
                                var f = a.allIds[o[h]];
                                p.parentID = a.byId[f].nodeID;
                              }
                              for (var m = 0; m < d.length; m++) {
                                var v = a.allIds[o[d[m]]];
                                p.children.push(a.byId[v].nodeID);
                              }
                              (p.relEntityID = s[o[u]].id), (l[c] = p);
                            }
                            oM.updateEntityGroup(l)
                              .then(e => {
                                n({
                                  newGroupMeshNode: a,
                                  newRootNodeID: a.allIds[o[t]]
                                });
                              })
                              .catch(e => {
                                r(e);
                              });
                          })
                          .catch(e => {
                            r(e);
                          });
                      })
                      .catch(e => {
                        r(e);
                      });
                  })
                  .catch(e => {
                    r(e);
                  });
              } catch (e) {
                r(e);
              }
            });
          }
          static create(e) {
            return lM.getDefaultMaterial().then(t => {
              var n = this.addDefaultMaterial(e, t.id);
              return super.create(n);
            });
          }
          static changeModel(e, t) {
            return Promise.resolve().then(() => {
              var n = this.getGroup(),
                r = [];
              return (
                n.allIds.forEach(i => {
                  var a = n.byId[i];
                  a.modelID === e.id && ((a.modelID = t.id), r.push(a));
                }),
                this.updateEntityGroup(r)
              );
            });
          }
          static renameOldMeshNodes(e) {
            return Promise.resolve().then(() => {
              var t = e.rel.meshNodes(),
                n = t.allIds.map(e => {
                  var n = t.byId[e];
                  return Object.assign({}, n, {
                    nameUQ: "".concat(n.nameUQ, ";-old-").concat(n.id)
                  });
                });
              return super.updateEntityGroup(n);
            });
          }
          static addDefaultMaterial(e, t) {
            return (
              e.materialID || e.meshNodeTypeID !== q || (e.materialID = t), e
            );
          }
        }
        cM.entityClass = ke;
        var uM = cM;
        class hM extends H_ {
          constructor() {
            super();
          }
        }
        hM.entityClass = Je;
        var dM = hM,
          pM = class extends J_ {
            constructor(e) {
              super(e, oM);
            }
          },
          fM = class extends J_ {
            constructor(e) {
              super(e, dM);
            }
            create(e) {
              var t = null,
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  var t = {
                    nameUQ: "".concat(e.nameUQ, " - node"),
                    nodeTypeID: Z,
                    parentID: null,
                    children: []
                  };
                  return new pM(this.tufViewer3D).create(t);
                })
                .then(
                  t => (
                    (n = Ot.getEntity("node", t.id)),
                    (e.nodeID = n.id),
                    super.create(e)
                  )
                )
                .then(e => ((t = Ot.getEntity("camera", e.id)), !0))
                .then(
                  () => (
                    (n.relEntityID = t.id), new pM(this.tufViewer3D).update(n)
                  )
                )
                .then(() =>
                  (r = new _M(this.tufViewer3D)).addSelectableActive([t.nodeID])
                )
                .then(() => r.addCamerasActive([t.id]))
                .then(() => r.addCamerasDefault([t.id]))
                .then(() => this.updateLayout(t.id))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _setInitialCameraPosition(e) {
              return Promise.resolve(!0)
                .then(() => new _M(this.tufViewer3D).getSceneInfo())
                .then(t => {
                  if (e.cameraTypeID === $) return null;
                  var n = (e.config.fov * Math.PI) / 180,
                    r = (t.size[0], t.size[1] / 2 / Math.tan(n / 2)),
                    i = t.box.min[2];
                  (r += t.size[2] / 2), (r *= 3);
                  var a = i < 0 ? -i + r : r - i,
                    o = Math.PI / 4,
                    s = Math.PI / 4,
                    l = t.center;
                  return (
                    (e.config.position = [
                      l[0] + r * Math.sin(o) * Math.cos(s),
                      l[1] + r * Math.sin(o) * Math.sin(s),
                      l[2] + r * Math.cos(o)
                    ]),
                    (e.activeConfig.position = [...e.config.position]),
                    (e.config.far = 100 * a),
                    (e.config.direction = l),
                    (e.activeConfig.direction = l),
                    super.update(e)
                  );
                });
            }
            setInitialCameraPosition() {
              return Promise.resolve()
                .then(() => {
                  for (
                    var e = [], t = this.entityRepoClass.all(), n = 0;
                    n < t.allIds.length;
                    n += 1
                  ) {
                    var r = t.byId[t.allIds[n]];
                    e.push(this.updateLayout(r.id));
                  }
                  return Promise.all(e);
                })
                .catch(e => {
                  throw e;
                });
            }
            delete(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 },
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  if (
                    ((n = this.entityRepoClass.get(e.id)),
                    (r = new _M(this.tufViewer3D)).getEntityActive("camera") ===
                      e.id)
                  )
                    throw w.default.setStandard(
                      "Can't delete camera, it's active"
                    );
                  if (r.getEntityDefault("camera") === e.id)
                    throw w.default.setStandard(
                      "Can't delete camera, it's set as default"
                    );
                  return r.getSelectedNodes();
                })
                .then(e => {
                  if (e.some(e => e.nodeID === n.nodeID)) {
                    var t = e
                      .filter(e => e.nodeID !== n.nodeID)
                      .map(e => e.nodeID);
                    return r.setSelectedNodes(t);
                  }
                  return null;
                })
                .then(() => r.removeSelectableActive([n.nodeID], !0))
                .then(() => r.removeCamerasActive([n.id]))
                .then(() => r.removeCamerasDefault([n.id]))
                .then(() => super.delete(e, t))
                .then(() => {
                  var e = n.rel.node();
                  return !e || new pM(this.tufViewer3D).delete(e);
                })
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            updateLayout(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = this.entityRepoClass.get(e);
                  return this._setInitialCameraPosition(t);
                })
                .catch(e => {
                  throw e;
                });
            }
          };
        class mM extends H_ {
          constructor() {
            super();
          }
        }
        mM.entityClass = Pt;
        var vM = mM,
          gM = class extends J_ {
            constructor(e) {
              super(e, vM);
            }
            create(e) {
              return Promise.resolve()
                .then(() => {
                  var t = {};
                  return (
                    (t.nameUQ = e.nameUQ),
                    (t.controlsTypeID = e.controlsTypeID),
                    super.create(e)
                  );
                })
                .then(e =>
                  e.controlsTypeID === ie ? this.updateLayout(e.id) : e
                )
                .catch(e => {
                  throw e;
                });
            }
            _setInitialPosition(e) {
              return Promise.resolve()
                .then(() => new _M(this.tufViewer3D).getSceneInfo())
                .then(t => {
                  var n = q_.get(),
                    r = dM.getById(n.active.cameraID);
                  (e.config.target = t.center),
                    (e.activeConfig.target = t.center),
                    (e.config.maxDistance = r ? r.config.far / 2 : 1e3),
                    (e.activeConfig.polarAngle = null),
                    (e.activeConfig.azimuthalAngle = null),
                    (e.activeConfig.radius = null);
                  var i = t.ratio[2] / (5 / 3);
                  return (e.editorData.zoomSize = i), super.update(e);
                })
                .catch(e => {
                  throw e;
                });
            }
            setInitialCameraControlPosition() {
              return Promise.resolve()
                .then(() => {
                  for (
                    var e = [], t = this.entityRepoClass.all(), n = 0;
                    n < t.allIds.length;
                    n += 1
                  ) {
                    var r = t.byId[t.allIds[n]];
                    r.controlsTypeID === ie &&
                      e.push(this._setInitialPosition(r));
                  }
                  return Promise.all(e);
                })
                .catch(e => {
                  throw e;
                });
            }
            delete(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
              return Promise.resolve(!0)
                .then(() => {
                  var t = this.entityRepoClass.get(e.id);
                  if (t.isSceneActive())
                    throw w.default.setStandard(
                      "Can't delete controls, it's active"
                    );
                  if (t.isSceneDefault())
                    throw w.default.setStandard(
                      "Can't delete controls, it's set as default"
                    );
                  return !0;
                })
                .then(() => this.tufViewer3D.removeControls(e.id))
                .then(() => super.delete(e, t))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            update() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : {},
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 };
              return Promise.resolve(!0)
                .then(() => this.preUpdate(e))
                .then(() => super.update(e, t));
            }
            preUpdate(e) {
              return Promise.resolve(!0).then(() => {
                var t = this.entityRepoClass.get(e.id),
                  n = q_.get(),
                  r = new _M(this.tufViewer3D),
                  i = this._getControlsByType(n.active.controls);
                if (
                  i[ae] &&
                  i[ae][0].id === e.id &&
                  t.controlsTypeID === ae &&
                  e.activeConfig.state !== t.activeConfig.state
                )
                  if ("dragging" === e.activeConfig.state) {
                    if (i[ie]) {
                      var a = i[ie][0];
                      return (
                        (n = q_.get()).editorData.inactiveControls ||
                          (n.editorData.inactiveControls = []),
                        (n.editorData.inactiveControls = [
                          ...n.editorData.inactiveControls,
                          a.id
                        ]),
                        r.update(n).then(() => r.removeControlsActive([a.id]))
                      );
                    }
                  } else if (
                    n.editorData.inactiveControls &&
                    n.editorData.inactiveControls.length > 0
                  ) {
                    var o = this.entityRepoClass.get(
                        n.editorData.inactiveControls[0]
                      ),
                      s = o.config.transitionEnabled;
                    return (
                      (o.config.transitionEnabled = !1),
                      super
                        .update(o)
                        .then(e =>
                          r
                            .addControlsActive(n.editorData.inactiveControls)
                            .then(
                              () => (
                                ((n = q_.get()).editorData.inactiveControls = []),
                                r.update(n)
                              )
                            )
                            .then(() => e)
                        )
                        .then(
                          e => (
                            (e.config.transitionEnabled = s),
                            (e.activeConfig.enabled = !0),
                            super.update(e)
                          )
                        )
                    );
                  }
                return !0;
              });
            }
            reset(e) {
              return Promise.resolve(!0).then(() => {
                var t = [];
                return (
                  e.forEach(e => {
                    var n = this.entityRepoClass.get(e);
                    n.controlsTypeID === ie &&
                      ((n.activeConfig.polarAngle = null),
                      (n.activeConfig.azimuthalAngle = null),
                      (n.activeConfig.radius = null),
                      (n.activeConfig.target = null),
                      (t = [...t, this.update(n)]));
                  }),
                  Promise.all(t)
                );
              });
            }
            handleSelection() {
              return Promise.resolve(!0).then(() => {
                var e = q_.get(),
                  t = e.editorData.selection.focusedNode,
                  n = this._getControlsByType(e.active.controls);
                return (
                  !n[ae] ||
                  this.setControlsTarget(n[ae][0].id, t, { target: "node" })
                );
              });
            }
            setControlsTarget(e, t, n) {
              return Promise.resolve(!0)
                .then(() => {
                  var r = this.entityRepoClass.get(e);
                  return (
                    "node" === n.targetType && (r.targetID = t), this.update(r)
                  );
                })
                .then(() => this.tufViewer3D.setControlsTarget(e, t, n));
            }
            updateLayout(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = this.entityRepoClass.get(e);
                  return this._setInitialPosition(t);
                })
                .catch(e => {
                  throw e;
                });
            }
            _getControlsByType(e) {
              return e.reduce((e, t) => {
                var n = this.entityRepoClass.get(t),
                  r = n.controlsTypeID;
                return e[r] || (e[r] = []), (e[r] = [...e[r], n]), e;
              }, {});
            }
            filterControls(e, t) {
              return e.filter(
                e => this.entityRepoClass.get(e).controlsTypeID === t
              );
            }
          };
        function yM(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function bM(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? yM(Object(n), !0).forEach(function(t) {
                  xM(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : yM(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function xM(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        var wM = class {
            constructor(e) {
              this.sceneService = e;
            }
            initSelectionData() {
              return Promise.resolve(!0).then(() => {
                var e = q_.get();
                return (
                  (e.editorData.selection = {
                    selectedNodes: {},
                    hoveredNodes: {},
                    focusedNode: null
                  }),
                  this.sceneService.update(e)
                );
              });
            }
            setSelectedNodes(e) {
              var t = q_.get(),
                n = e.filter(e => t.active.selectable.includes(e)),
                r = $_.get(t.active.environmentID);
              if (!r.config.slEnabled) return Promise.resolve(!0);
              var i = 0 !== n.length ? n[n.length - 1] : null,
                a = {},
                o = {},
                s = {};
              return Promise.resolve(!0)
                .then(() => {
                  var e = t.editorData.selection || {};
                  (e.selectedNodes = e.selectedNodes || {}),
                    (e.hoveredNodes = e.hoveredNodes || {}),
                    (e.focusedNode = i);
                  var l = Object.keys(e.selectedNodes);
                  return (
                    !!v_(n, l) ||
                    ((a = bM({}, e.selectedNodes)),
                    (o = bM({}, e.hoveredNodes)),
                    (e.selectedNodes = n.reduce(
                      (e, t) => (
                        (r.config.slMultiple || t === i) && (e[t] = [E()()]), e
                      ),
                      {}
                    )),
                    (e.hoveredNodes = {}),
                    (s = bM({}, e.selectedNodes)),
                    (t.editorData.selection = e),
                    this.sceneService.update(t))
                  );
                })
                .then(() => {
                  var e = [];
                  return (
                    !r.config.slSelectionVisible ||
                    ((e = [
                      ...e,
                      Object.keys(a).map(e =>
                        this.sceneService.tufViewer3D.deactivateEffects(a[e])
                      ),
                      Object.keys(s).map(e => {
                        var t;
                        return (
                          (t =
                            r.config.slDimNotFocused && e !== i
                              ? r.config.slDimSelectionColor
                              : r.config.slSelectionColor),
                          this.sceneService.tufViewer3D.activateEffect(
                            s[e],
                            this._getEffectType(r.config.slType),
                            [e],
                            {
                              color: t,
                              dimColor: r.config.slDimSelectionColor,
                              animate:
                                r.config.slAnimationEnabled &&
                                r.config.slAnimateSelection,
                              overlap: r.config.slOverlap,
                              duration: r.config.slAnimationInterval
                            }
                          )
                        );
                      })
                    ]),
                    r.config.slHoverVisible &&
                      (e = [
                        ...e,
                        Object.keys(o).map(e =>
                          this.sceneService.tufViewer3D.deactivateEffects(o[e])
                        )
                      ]),
                    Promise.all(e))
                  );
                });
            }
            addSelectedNodes(e) {
              return Promise.resolve(!0).then(() => {
                var t = q_.get(),
                  n = t.editorData.selection
                    ? t.editorData.selection
                    : { selectedNodes: {} },
                  r = [...Object.keys(n.selectedNodes), ...e];
                return this.setSelectedNodes(r);
              });
            }
            removeSelectedNodes(e) {
              return Promise.resolve(!0).then(() => {
                var t = q_.get(),
                  n = t.editorData.selection
                    ? t.editorData.selection
                    : { selectedNodes: {} },
                  r = Object.keys(n.selectedNodes).filter(t => !e.includes(t));
                return this.setSelectedNodes(r);
              });
            }
            reselectNodes() {
              var e = [];
              return Promise.resolve(!0)
                .then(() => {
                  var t = q_.get(),
                    n = t.editorData.selection
                      ? t.editorData.selection
                      : { selectedNodes: {} };
                  return (
                    (e = Object.keys(n.selectedNodes)),
                    this.setSelectedNodes([])
                  );
                })
                .then(() => this.setSelectedNodes(e));
            }
            setHoveredNodes(e) {
              var t = q_.get(),
                n = e.filter(e => t.active.selectable.includes(e)),
                r = $_.get(t.active.environmentID);
              if (!r.config.slEnabled) return Promise.resolve(!0);
              var i = {},
                a = {};
              return Promise.resolve(!0)
                .then(() => {
                  var e = t.editorData.selection
                      ? t.editorData.selection
                      : { hoveredNodes: {} },
                    r = e.selectedNodes ? e.selectedNodes : {},
                    o = Object.keys(e.hoveredNodes);
                  return (
                    !!v_(n, o) ||
                    ((i = bM({}, e.hoveredNodes)),
                    (e.hoveredNodes = n.reduce(
                      (e, t) => (
                        Object.keys(r).includes(t) || (e[t] = [E()()]), e
                      ),
                      {}
                    )),
                    (a = bM({}, e.hoveredNodes)),
                    (t.editorData.selection = e),
                    this.sceneService.update(t))
                  );
                })
                .then(() => {
                  if (r.config.slHoverVisible) {
                    var e = [
                      Object.keys(i).map(e =>
                        this.sceneService.tufViewer3D.deactivateEffects(i[e])
                      ),
                      Object.keys(a).map(e => {
                        var t = r.config.slHoverColor;
                        return this.sceneService.tufViewer3D.activateEffect(
                          a[e],
                          this._getEffectType(r.config.slType),
                          [e],
                          {
                            color: t,
                            animate:
                              r.config.slAnimationEnabled &&
                              r.config.slAnimateHover,
                            overlap: r.config.slOverlap,
                            duration: r.config.slAnimationInterval
                          }
                        );
                      })
                    ];
                    return Promise.all(e);
                  }
                  return !0;
                });
            }
            getSelectedNodes() {
              var e = q_.get(),
                t = e.editorData.selection
                  ? e.editorData.selection
                  : { selectedNodes: {} };
              return Object.keys(t.selectedNodes);
            }
            getHoveredNodes() {
              var e = q_.get(),
                t = e.editorData.selection
                  ? e.editorData.selection
                  : { hoveredNodes: {} };
              return Object.keys(t.hoveredNodes);
            }
            _getEffectType(e) {
              switch (e) {
                case "BoundaryBox":
                  return "HelperEffect";
                case "SimpleHighlight":
                  return "SimpleHighlightEffect";
                default:
                  return null;
              }
            }
          },
          _M = class extends J_ {
            constructor(e) {
              super(e, q_);
            }
            addEntities(e, t) {
              var n =
                  !(arguments.length > 2 && void 0 !== arguments[2]) ||
                  arguments[2],
                r =
                  arguments.length > 3 &&
                  void 0 !== arguments[3] &&
                  arguments[3],
                i =
                  arguments.length > 4 &&
                  void 0 !== arguments[4] &&
                  arguments[4],
                a = null;
              return Promise.resolve(!0)
                .then(() => this._getEntityArrays(e, t, n))
                .then(t => {
                  var r = [...t.oldValues, ...t.addedValues];
                  return this.setEntities(e, r, n, !1, i);
                })
                .then(e => ((a = e), !0))
                .then(() =>
                  r
                    ? this._getEntityArrays(e, t, !n).then(t => {
                        var r = [...t.oldValues, ...t.addedValues];
                        return this.setEntities(e, r, !n, !1, i);
                      })
                    : a
                )
                .catch(e => {
                  throw e;
                });
            }
            removeEntities(e, t) {
              var n =
                  !(arguments.length > 2 && void 0 !== arguments[2]) ||
                  arguments[2],
                r =
                  arguments.length > 3 &&
                  void 0 !== arguments[3] &&
                  arguments[3],
                i =
                  arguments.length > 4 &&
                  void 0 !== arguments[4] &&
                  arguments[4],
                a = null,
                o = [];
              return Promise.resolve(!0)
                .then(() => this._getEntityArrays(e, t, n))
                .then(e => {
                  var t = e.removedValues;
                  return (o = [...t]), !0;
                })
                .then(() => {
                  if (n) {
                    var r = this._getNodeIDsForEntities(e, t);
                    return this.removeSelectedNodes(r);
                  }
                  return !0;
                })
                .then(() => this.setEntities(e, o, n, !1, i))
                .then(e => ((a = e), !0))
                .then(() =>
                  r
                    ? this._getEntityArrays(e, t, !n).then(t => {
                        var r = [...t.removedValues];
                        return this.setEntities(e, r, !n, !1, i);
                      })
                    : a
                )
                .catch(e => {
                  throw e;
                });
            }
            _getNodeIDsForEntities(e, t) {
              var n = null;
              switch (e) {
                case "meshNodes":
                case "lights":
                case "annotations":
                case "cameras":
                  n = e.substr(0, e.length - 1);
                  break;
                case "controls":
                  n = "controls";
              }
              return n ? t.map(e => Ot.getEntity(n, e).nodeID) : [];
            }
            setEntities(e, t) {
              var n =
                  !(arguments.length > 2 && void 0 !== arguments[2]) ||
                  arguments[2],
                r =
                  arguments.length > 3 &&
                  void 0 !== arguments[3] &&
                  arguments[3],
                i =
                  (arguments.length > 4 &&
                    void 0 !== arguments[4] &&
                    arguments[4],
                  null);
              return Promise.resolve(!0)
                .then(() => this._getEntityArrays(e, t, n))
                .then(() => {
                  var r = this.entityRepoClass.get();
                  return n ? (r.active[e] = t) : (r[e] = t), this.update(r);
                })
                .then(e => ((i = e), !0))
                .then(() => (r ? this.setEntities(e, t, !n) : i))
                .catch(e => {
                  throw e;
                });
            }
            sync(e) {
              return Promise.resolve(!0)
                .then(() => this._syncEntity("renderer", e))
                .then(() => this._syncEntity("environment", e))
                .then(() => this._syncEntity("camera", e))
                .then(() => this._syncEntities("meshNodes", e))
                .then(() => this._syncEntities("lights", e))
                .then(() => this._syncEntities("annotations", e))
                .then(() => this._syncEntities("controls", e))
                .then(() => this.entityRepoClass.get())
                .catch(e => {
                  throw e;
                });
            }
            getEntityActive(e) {
              return this.entityRepoClass.get().active["".concat(e, "ID")];
            }
            getEntityDefault(e) {
              return this.entityRepoClass.get()["".concat(e, "ID")];
            }
            setCurrentCameraActive(e) {
              var t = null;
              return Promise.resolve(!0)
                .then(() => {
                  var e = new gM(this.tufViewer3D),
                    n = this.entityRepoClass.get();
                  return (t = e.filterControls(n.active.controls, ie)), !0;
                })
                .then(() => this.removeControlsActive(t))
                .then(() => {
                  var t = this.entityRepoClass.get();
                  return (t.active.cameraID = e), this.update(t);
                })
                .then(() => this.addControlsActive(t));
            }
            addCamerasActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("cameras", e, !0, t);
            }
            addCamerasDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("cameras", e, !1, t);
            }
            removeCamerasActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("cameras", e, !0, t);
            }
            removeCamerasDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("cameras", e, !1, t);
            }
            addMeshNodesActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("meshNodes", e, !0, t);
            }
            addMeshNodesDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("meshNodes", e, !1, t);
            }
            removeMeshNodesActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("meshNodes", e, !0, t);
            }
            removeMeshNodesDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("meshNodes", e, !1, t);
            }
            addSelectableActive(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2];
              return this.addEntities("selectable", e, !0, t, n);
            }
            addSelectableDefault(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2];
              return this.addEntities("selectable", e, !1, t, n);
            }
            removeSelectableActive(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2];
              return this.removeEntities("selectable", e, !0, t, n);
            }
            removeSelectableDefault(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2];
              return this.removeEntities("selectable", e, !1, t, n);
            }
            addLightsActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("lights", e, !0, t);
            }
            addLightsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("lights", e, !1, t);
            }
            removeLightsActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("lights", e, !0, t);
            }
            removeLightsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("lights", e, !1, t);
            }
            addAnnotationsActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("annotations", e, !0, t);
            }
            addAnnotationsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("annotations", e, !1, t);
            }
            removeAnnotationsActive(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("annotations", e, !0, t);
            }
            removeAnnotationsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("annotations", e, !1, t);
            }
            addControlsActive(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n = new gM(this.tufViewer3D);
              return Promise.resolve(!0)
                .then(() => n.reset(e))
                .then(() => this.addEntities("controls", e, !0, t))
                .then(() => n.handleSelection());
            }
            addControlsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.addEntities("controls", e, !1, t);
            }
            removeControlsActive(e) {
              var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n = new gM(this.tufViewer3D);
              return this.removeEntities("controls", e, !0, t).then(t =>
                n.reset(e).then(() => t)
              );
            }
            removeControlsDefault(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
              return this.removeEntities("controls", e, !1, t);
            }
            _getEntityArrays(e, t) {
              var n =
                !(arguments.length > 2 && void 0 !== arguments[2]) ||
                arguments[2];
              return Promise.resolve(!0).then(() => {
                var r = this.entityRepoClass.get(),
                  i = n ? r.active[e] : r[e],
                  a = i.filter(e => !t.includes(e)),
                  o = t.filter(e => !i.includes(e));
                return { oldValues: i, addedValues: o, removedValues: a };
              });
            }
            _syncEntities(e, t) {
              return Promise.resolve(!0)
                .then(() => {
                  var n = this.entityRepoClass.get(),
                    r = null;
                  return (
                    (r = t ? n.active[e] : n[e]), this.setEntities(e, r, !t, !1)
                  );
                })
                .catch(e => {
                  throw e;
                });
            }
            _syncEntity(e, t) {
              return Promise.resolve(!0).then(() => {
                var n = this.entityRepoClass.get(),
                  r = null;
                return (
                  t
                    ? ((r = this.getEntityActive(e)),
                      (n["".concat(e, "ID")] = r))
                    : ((r = this.getEntityDefault(e)),
                      (n.active["".concat(e, "ID")] = r)),
                  this.update(n)
                );
              });
            }
            update() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : {},
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 };
              return Promise.resolve(!0).then(() => {
                if (!e.active.cameras.includes(e.active.cameraID))
                  throw w.default.setStandard(
                    "Current camera is not in active cameras list"
                  );
                return super.update(e, t);
              });
            }
            getSceneInfo() {
              return Promise.resolve(!0)
                .then(() => this.getBoundingBox())
                .then(e => {
                  if (e) {
                    var t = [
                      e.max[0] - e.min[0],
                      e.max[1] - e.min[1],
                      e.max[2] - e.min[2]
                    ];
                    return {
                      box: e,
                      center: [
                        (e.max[0] + e.min[0]) / 2,
                        (e.max[1] + e.min[1]) / 2,
                        (e.max[2] + e.min[2]) / 2
                      ],
                      size: t,
                      ratio: [...t]
                    };
                  }
                  return this.getDefaultSceneInfo();
                });
            }
            getDefaultSceneInfo() {
              return {
                box: { min: [-0.5, -0.5, -0.5], max: [0.5, 0.5, 0.5] },
                center: [0, 0, 0],
                size: [1, 1, 1],
                ratio: [1, 1, 1]
              };
            }
            getBoundingBox() {
              return new Promise((e, t) => {
                var n = {
                    max: [-1 / 0, -1 / 0, -1 / 0],
                    min: [1 / 0, 1 / 0, 1 / 0]
                  },
                  r = [],
                  i = iM.all();
                if (0 === i.allIds.length) e(null);
                else {
                  for (var a = 0; a < i.allIds.length; a += 1) {
                    var o = i.byId[i.allIds[a]].rootNodeID,
                      s = uM.getById(o);
                    r.push(this.tufViewer3D.getBoundingBox(s.nodeID));
                  }
                  Promise.all(r)
                    .then(t => {
                      for (var r = 0; r < t.length; r += 1) {
                        for (var i = t[r], a = 0; a < i.max.length; a += 1)
                          i.max[a] > n.max[a] && (n.max[a] = i.max[a]);
                        for (var o = 0; o < i.min.length; o += 1)
                          i.min[o] < n.min[o] && (n.min[o] = i.min[o]);
                      }
                      e(n);
                    })
                    .catch(e => {
                      t(e);
                    });
                }
              });
            }
            updateLayout(e) {
              var t = e.active,
                n = void 0 === t || t,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  r = this.entityRepoClass.get();
                  var e = [];
                  e = n ? [r.active.environmentID] : [...$_.all().allIds];
                  var t = new OM(this.tufViewer3D),
                    i = e.map(e => t.updateLayout(e));
                  return Promise.all(i);
                })
                .then(() => {
                  var e = [];
                  e = n ? [r.active.cameraID] : [...dM.all().allIds];
                  var t = new fM(this.tufViewer3D),
                    i = [...e.map(e => t.updateLayout(e))];
                  return Promise.all(i);
                })
                .then(() => {
                  var e = [];
                  if (n)
                    e = r.active.controls.filter(
                      e => vM.get(e).controlsTypeID === ie
                    );
                  else {
                    var t = vM.all();
                    e = t.allIds.filter(e => t.byId[e].controlsTypeID === ie);
                  }
                  var i = new gM(this.tufViewer3D),
                    a = [...e.map(e => i.updateLayout(e))];
                  return Promise.all(a);
                });
            }
            prepareScene() {
              return Promise.resolve(!0)
                .then(() => new wM(this).initSelectionData())
                .then(() => {
                  var e = this.entityRepoClass.get();
                  return new gM(this.tufViewer3D).reset(e.active.controls);
                });
            }
            setSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() => new wM(this).setSelectedNodes(e))
                .then(() => new gM(this.tufViewer3D).handleSelection());
            }
            addSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() => new wM(this).addSelectedNodes(e))
                .then(() => new gM(this.tufViewer3D).handleSelection());
            }
            removeSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() => new wM(this).removeSelectedNodes(e))
                .then(() => new gM(this.tufViewer3D).handleSelection());
            }
            reselectNodes() {
              return new wM(this).reselectNodes();
            }
            setHoveredNodes(e) {
              return new wM(this).setHoveredNodes(e);
            }
            getSelectedNodes() {
              return new wM(this).getSelectedNodes();
            }
            getHoveredNodes() {
              return new wM(this).getHoveredNodes();
            }
          },
          MM = class extends J_ {
            constructor(e) {
              super(e, uM);
            }
            syncMeshNodesForModel(e, t) {
              var n = {},
                r = {},
                i = { byId: {}, allIds: [] },
                a = { byId: {}, allIds: [] };
              return Promise.resolve()
                .then(() => {
                  t.allIds.forEach(e => {
                    r[t.byId[e].nameUQ] = e;
                  });
                  var o = uM.getGroup(),
                    s = [];
                  return (
                    o.allIds.forEach(l => {
                      var c = o.byId[l];
                      if (c.modelID === e.id) {
                        var u = r[c.nameUQ];
                        if (!u)
                          return (
                            s.push(this.delete(c)),
                            (i.byId[l] = c),
                            i.allIds.push(l),
                            (a.byId[c.nodeID] = !0),
                            void a.allIds.push(c.nodeID)
                          );
                        if (t.byId[u].meshNodeTypeID !== c.meshNodeTypeID)
                          return (
                            s.push(this.delete(c)),
                            (i.byId[l] = c),
                            i.allIds.push(l),
                            (a.byId[c.nodeID] = !0),
                            void a.allIds.push(c.nodeID)
                          );
                        n[c.nameUQ] = l;
                      }
                    }),
                    Promise.all(s)
                  );
                })
                .then(() => lM.getDefaultMaterial())
                .then(e => {
                  var r = {
                      nameUQ: "rel-meshnode",
                      nodeTypeID: Q,
                      parentID: null,
                      children: []
                    },
                    i = [],
                    a = [];
                  return (
                    t.allIds.forEach(o => {
                      var s = t.byId[o];
                      n[s.nameUQ] ||
                        (i.push(Object.assign({}, r)),
                        a.push(uM.addDefaultMaterial(s, e.id)));
                    }),
                    oM.createEntityGroup(i).then(
                      e => (
                        a.forEach((t, n) => {
                          t.nodeID = e.allIds[n];
                        }),
                        uM.createEntityGroup(a)
                      )
                    )
                  );
                })
                .then(o => {
                  o.allIds.forEach(e => {
                    n[o.byId[e].nameUQ] = e;
                  });
                  var s = uM.getGroup(),
                    l = [];
                  return (
                    s.allIds.forEach(i => {
                      var a = s.byId[i];
                      if (a.modelID === e.id) {
                        var o = r[a.nameUQ];
                        if (o) {
                          var c = a.rel.node();
                          c.relEntityID = i;
                          var u = t.byId[o];
                          null === u.parentID
                            ? (c.parentID = null)
                            : (c.parentID =
                                s.byId[n[t.byId[u.parentID].nameUQ]].nodeID),
                            (c.children = u.children.map(
                              e => s.byId[n[t.byId[e].nameUQ]].nodeID
                            )),
                            l.push(c);
                        }
                      }
                    }),
                    oM
                      .updateEntityGroup(l)
                      .then(() => ({
                        newMeshNodes: o,
                        deletedMeshNodes: i,
                        deletedNodes: a
                      }))
                  );
                });
            }
            delete(e) {
              var t = null,
                n = null;
              return Promise.resolve()
                .then(
                  () => (
                    (t = new _M(this.tufViewer3D)),
                    (n = this.entityRepoClass.get(e.id)),
                    !0
                  )
                )
                .then(() => t.removeSelectableActive([n.nodeID], !0))
                .then(() => t.removeMeshNodesActive([n.id]))
                .then(() => t.removeMeshNodesDefault([n.id]))
                .then(() => {
                  var t = e.rel.node();
                  return super.delete(n).then(() => t);
                })
                .then(e => oM.delete(e));
            }
            deleteGroup(e) {
              var t = null,
                n = null,
                r = null,
                i = null;
              return Promise.resolve(!0)
                .then(
                  () => (
                    (t = new _M(this.tufViewer3D)),
                    (n = e.map(e => e.id)),
                    (i = e.map(e => e.rel.node())),
                    (r = i.map(e => e.id)),
                    !0
                  )
                )
                .then(() => t.removeSelectableActive(r, !0))
                .then(() => t.removeMeshNodesActive(n))
                .then(() => t.removeMeshNodesDefault(n))
                .then(() => {
                  var t = e.map(e => super.delete(e));
                  return Promise.all(t);
                })
                .then(() => {
                  var e = i.map(e => oM.delete(e));
                  return Promise.all(e);
                });
            }
            isInUse(e) {
              return !1;
            }
          };
        class TM extends H_ {
          constructor() {
            super();
          }
          static groupCreateObject(e) {
            return Promise.resolve().then(() => {
              var t = [];
              return (
                e.allIds.forEach(n => {
                  t.push(e.byId[n]);
                }),
                this.createEntityGroup(t)
              );
            });
          }
        }
        TM.entityClass = De;
        var AM = TM;
        function SM(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function EM(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? SM(Object(n), !0).forEach(function(t) {
                  RM(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : SM(Object(n)).forEach(function(t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function RM(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        var PM = class extends J_ {
            constructor(e) {
              super(e, AM);
            }
            create(e) {
              return Promise.resolve(!0).then(() =>
                void 0 === e.textureTypeID ||
                ("7" !== e.textureTypeID && "8" !== e.textureTypeID)
                  ? this._createTexture(e)
                  : this._createCubeTexture(e)
              );
            }
            delete(e) {
              return Promise.resolve(!0)
                .then(() => {
                  if (this.isTextureInUse(e.id))
                    throw w.default.setStandard(
                      "Can't delete texture, it's in use"
                    );
                  return !0;
                })
                .then(() => {
                  var t = new nM(this.tufViewer3D),
                    n = tM.get(e.assetID);
                  if (!n) return !0;
                  var r = n.rel.textures();
                  return !!(r && r.allIds.length > 1) || t.delete(n);
                })
                .then(() => this.tufViewer3D.removeTextures([e.id]))
                .then(() => super.delete(e))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            changeType(e, t) {
              return Promise.resolve()
                .then(() => {
                  var n = EM({}, this.entityRepoClass.get(e), {
                    textureTypeID: t
                  });
                  return super.create(n);
                })
                .catch(e => {
                  throw e;
                });
            }
            cloneTexture(e) {
              return Promise.resolve()
                .then(() => {
                  var t = this.entityRepoClass.get(e);
                  return super.create(EM({}, t));
                })
                .catch(e => {
                  throw e;
                });
            }
            isTextureInUse(e) {
              var t = this.entityRepoClass.get(e),
                n = this._getMapRelationNames(),
                r = !1;
              n.forEach(e => {
                var n = t.rel[e];
                n && n().allIds.length > 0 && (r = !0);
                var i = t.relActive[e];
                i && i().allIds.length > 0 && (r = !0);
              });
              var i = t.rel.envMapsEnv;
              i && i().allIds.length > 0 && (r = !0);
              var a = t.relActive.envMapsEnv;
              return a && a().allIds.length > 0 && (r = !0), r;
            }
            _createTexture(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = new nM(this.tufViewer3D),
                    n = {
                      name: e.name,
                      config: {
                        refAssetID: e.id,
                        src: e.src,
                        thumb_src: e.thumb_src,
                        size: e.size,
                        extension: e.extension
                      }
                    };
                  return t.create(n);
                })
                .then(t => {
                  var n = { assetID: t.id };
                  return (
                    void 0 !== e.textureTypeID &&
                      (n.textureTypeID = e.textureTypeID),
                    void 0 !== e.config && (n.config = e.config),
                    super.create(n)
                  );
                });
            }
            _createCubeTexture(e) {
              return super.create(e);
            }
            _getMapRelationNames() {
              return [
                "alphaMaps",
                "aoMaps",
                "bumpMaps",
                "displacementMaps",
                "emissiveMaps",
                "envMaps",
                "lightMaps",
                "diffuseMaps",
                "metalnessMaps",
                "normalMaps",
                "roughnessMaps",
                "specularMaps",
                "gradientMaps",
                "clearcoatNormalMaps"
              ];
            }
          },
          IM = class extends J_ {
            constructor(e) {
              super(e, lM);
            }
            create(e) {
              return Promise.resolve()
                .then(() =>
                  this.isNewMaterialCompound(e.materialTypeID)
                    ? this.entityRepoClass.getDefaultMaterial("DefaultCompound")
                    : null
                )
                .then(t => (t && (e.materialIDs = [t.id]), super.create(e)))
                .then(e => this.tufViewer3D.addMaterials([e.id]).then(() => e))
                .catch(e => {
                  throw e;
                });
            }
            addChildrenToCompoundMaterial(e, t) {
              return Promise.resolve()
                .then(() => {
                  var n = this.entityRepoClass.getById(e);
                  if (!n || !this.isCompoundMaterial(e))
                    throw w.default.setStandard(
                      "Can't find material with id: ".concat(e)
                    );
                  var r = [...n.materialIDs];
                  return (
                    r.push(...t),
                    r.forEach(e => {
                      if (!this.entityRepoClass.getById(e))
                        throw w.default.setStandard(
                          "Child material doesn't exist"
                        );
                    }),
                    (n.materialIDs = r),
                    (n.active.materialIDs = r),
                    super.update(n)
                  );
                })
                .then(t => {
                  this.tufViewer3D
                    .setChildMaterialsForCompoundMaterial(e, t.materialIDs)
                    .then(() => t)
                    .catch(e => {
                      throw e;
                    });
                })
                .catch(e => {
                  throw e;
                });
            }
            removeChildrenFromCompoundMaterial(e, t) {
              return Promise.resolve()
                .then(() => {
                  var n = this.entityRepoClass.getById(e);
                  if (!n || !this.isCompoundMaterial(e))
                    throw w.default.setStandard(
                      "Can't find material with id: ".concat(e)
                    );
                  var r = n.materialIDs.filter(e => !t.includes(e));
                  return (
                    (n.materialIDs = r),
                    (n.active.materialIDs = r),
                    super.update(n)
                  );
                })
                .then(t => {
                  this.tufViewer3D
                    .setChildMaterialsForCompoundMaterial(e, t.materialIDs)
                    .then(() => t)
                    .catch(e => {
                      throw e;
                    });
                })
                .catch(e => {
                  throw e;
                });
            }
            delete(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = this.entityRepoClass.get(e.id),
                    n =
                      this.isMaterialPartOfCompound(t) ||
                      this.isMaterialUsedByAnnotations(t) ||
                      this.isMaterialUsedByMeshNodes(t);
                  if (n)
                    throw w.default.setStandard(
                      "Can't delete material, it's in use by ".concat(n)
                    );
                  return t;
                })
                .then(e => this._removeTextures(e))
                .then(() => this.tufViewer3D.removeMaterials([e.id]))
                .then(() => super.delete(e))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _removeTextures(e) {
              return Promise.resolve()
                .then(() => {
                  var t = this._getMapRelationNames(),
                    n = new Set();
                  return (
                    t.forEach(t => {
                      e.rel[t] &&
                        null !== e.rel[t]() &&
                        (n.add(e["".concat(t, "ID")]),
                        (e["".concat(t, "ID")] = null)),
                        e.relActive[t] &&
                          null !== e.relActive[t]() &&
                          (n.add(e.active["".concat(t, "ID")]),
                          (e.active["".concat(t, "ID")] = null));
                    }),
                    this.update(e).then(() => n)
                  );
                })
                .then(e => {
                  var t = new PM(this.tufViewer3D),
                    n = [];
                  return (
                    [...e].forEach(e => {
                      var r = AM.get(e);
                      n.push(t.delete(r));
                    }),
                    Promise.all(n)
                  );
                });
            }
            isMaterialPartOfCompound(e) {
              if (!e.rel.compoundMaterial) return null;
              var t = e.rel.compoundMaterial();
              return t ? "compound material: " + t.nameUQ : null;
            }
            isMaterialUsedByAnnotations(e) {
              var t = e.rel.annotations(),
                n = e.relActive.annotations();
              if (0 === t.allIds.length && 0 === n.allIds.length) return null;
              for (var r = new Set(), i = 0; i < t.allIds.length; i += 1)
                r.add(t.byId[t.allIds[i]].nameUQ);
              for (var a = 0; a < n.allIds.length; a += 1)
                r.add(n.byId[n.allIds[a]].nameUQ);
              return [...r].reduce((e, t) => e + " " + t, "annotations:");
            }
            isMaterialUsedByMeshNodes(e) {
              var t = e.rel.meshNodes(),
                n = e.relActive.meshNodes();
              if (0 === t.allIds.length && 0 === n.allIds.length) return null;
              for (var r = new Set(), i = 0; i < t.allIds.length; i += 1)
                r.add(t.byId[t.allIds[i]].titleUQ);
              for (var a = 0; a < n.allIds.length; a += 1)
                r.add(n.byId[n.allIds[a]].titleUQ);
              return [...r].reduce((e, t) => e + " " + t, "meshNodes:");
            }
            isCompoundMaterial(e) {
              return (
                "CompoundMaterial" ===
                this.entityRepoClass.get(e).rel.materialType().nameUQ
              );
            }
            isNewMaterialCompound(e) {
              return (
                "CompoundMaterial" === Ot.getEntity("materialType", e).nameUQ
              );
            }
            _getMapRelationNames() {
              return [
                "alphaMap",
                "aoMap",
                "bumpMap",
                "displacementMap",
                "emissiveMap",
                "envMap",
                "lightMap",
                "diffuseMap",
                "metalnessMap",
                "normalMap",
                "roughnessMap",
                "specularMap",
                "gradientMap",
                "clearcoatNormalMap"
              ];
            }
            static getMapNames() {
              return [
                "alphaMapID",
                "aoMapID",
                "bumpMapID",
                "displacementMapID",
                "emissiveMapID",
                "envMapID",
                "lightMapID",
                "diffuseMapID",
                "metalnessMapID",
                "normalMapID",
                "roughnessMapID",
                "specularMapID",
                "gradientMapID",
                "clearcoatNormalMapID"
              ];
            }
          },
          DM = class extends J_ {
            constructor(e) {
              super(e, iM);
            }
            updateModelWithNew(e, t) {
              var n = null,
                r = null,
                i = null,
                a = [],
                o = [],
                s = [],
                l = [],
                c = null,
                u = null,
                h = null,
                d = null,
                p = null;
              return Promise.resolve()
                .then(() => {
                  var e = q_.get();
                  return (
                    (n = new _M(this.tufViewer3D)),
                    (a = [...e.active.meshNodes]),
                    (o = [...e.meshNodes]),
                    (s = [...e.active.selectable]),
                    (l = [...e.selectable]),
                    n
                      .removeMeshNodesActive(a)
                      .then(() => n.removeMeshNodesDefault(o))
                      .then(() => n.removeSelectableActive(s))
                      .then(() => n.removeSelectableDefault(l))
                  );
                })
                .then(() => this.tufViewer3D.removeModels([e.id]))
                .then(() => {
                  var e = W_.get();
                  return T.parseModel(t.id, e.version, e.converterVersion);
                })
                .then(
                  e => (
                    (c = e),
                    (i = new nM(this.tufViewer3D)),
                    (c.asset.config.refAssetID = c.asset.id),
                    i.create(c.asset)
                  )
                )
                .then(t => {
                  (d = t), (r = e.rel.asset());
                  var n = Object.assign({}, e, {
                    nameUQ: "".concat(e.nameUQ, "-old-").concat(e.id)
                  });
                  return super.update(n);
                })
                .then(t => ((u = t), (e.assetID = d.id), iM.create(e)))
                .then(e => ((h = e), uM.changeModel(u, h)))
                .then(
                  () => (
                    c.meshNodeGroup.allIds.forEach(e => {
                      c.meshNodeGroup.byId[e].modelID = h.id;
                    }),
                    new MM(this.tufViewer3D).syncMeshNodesForModel(
                      h,
                      c.meshNodeGroup
                    )
                  )
                )
                .then(t => ((p = t), this.delete(e)))
                .then(() => {
                  var e = [...p.newMeshNodes.allIds];
                  return (
                    a.forEach(t => {
                      p.deletedMeshNodes.byId[t] || e.push(t);
                    }),
                    n.addMeshNodesActive(e)
                  );
                })
                .then(() => {
                  var e = [...p.newMeshNodes.allIds];
                  return (
                    o.forEach(t => {
                      p.deletedMeshNodes.byId[t] || e.push(t);
                    }),
                    n.addMeshNodesDefault(e)
                  );
                })
                .then(() => {
                  var e = p.newMeshNodes.allIds.map(
                    e => p.newMeshNodes.byId[e].nodeID
                  );
                  return (
                    s.forEach(t => {
                      p.deletedNodes.byId[t] || e.push(t);
                    }),
                    n.addSelectableActive(e)
                  );
                })
                .then(() => {
                  var e = [];
                  return (
                    l.forEach(t => {
                      p.deletedNodes.byId[t] || e.push(t);
                    }),
                    n.addSelectableDefault(e)
                  );
                })
                .then(() => n.prepareScene())
                .then(() =>
                  r.id === h.assetID ? h : i.delete(r).then(() => h)
                );
            }
            _parseAndCreateMeshNodes(e) {
              var t = null,
                n = null,
                r = null;
              return Promise.resolve()
                .then(() => {
                  var t = W_.get();
                  return (
                    void 0 !== e.name && (n = e.name),
                    T.parseModel(e.id, t.version, t.converterVersion)
                  );
                })
                .then(e => {
                  t = e;
                  var n = new nM(this.tufViewer3D);
                  return (
                    (t.asset.config.refAssetID = t.asset.id), n.create(t.asset)
                  );
                })
                .then(e => {
                  null === n && (n = e.name);
                  var t = { assetID: e.id, nameUQ: n };
                  return iM.create(t);
                })
                .then(
                  e => (
                    (r = e),
                    void 0 === t.assetGroup
                      ? null
                      : tM.groupCreateObject(t.assetGroup)
                  )
                )
                .then(e =>
                  void 0 === t.textureGroup
                    ? null
                    : (t.textureGroup.allIds.forEach(n => {
                        var r = t.textureGroup.byId[n];
                        void 0 !== e.idsMap[r.assetID] &&
                          (r.assetID = e.idsMap[r.assetID]);
                      }),
                      AM.groupCreateObject(t.textureGroup))
                )
                .then(e => {
                  if (void 0 === t.materialGroup) return null;
                  var n = IM.getMapNames();
                  return (
                    t.materialGroup.allIds.forEach(r => {
                      var i = t.materialGroup.byId[r];
                      n.forEach(t => {
                        i[t] && e.idsMap[i[t]] && (i[t] = e.idsMap[i[t]]),
                          i.active[t] &&
                            e.idsMap[i.active[t]] &&
                            (i.active[t] = e.idsMap[i.active[t]]);
                      });
                    }),
                    lM.groupCreateObject(t.materialGroup)
                  );
                })
                .then(e => {
                  for (var n = 0; n < t.meshNodeGroup.allIds.length; n += 1) {
                    var i = t.meshNodeGroup.allIds[n],
                      a = t.meshNodeGroup.byId[i];
                    (a.modelID = r.id),
                      a.materialID &&
                        e.idsMap[a.materialID] &&
                        (a.materialID = e.idsMap[a.materialID]),
                      a.active &&
                        a.active.materialID &&
                        e.idsMap[a.active.materialID] &&
                        (a.active.materialID = e.idsMap[a.active.materialID]);
                  }
                  return uM.groupCreateObject(
                    t.meshNodeGroup,
                    t.model.rootNodeID
                  );
                })
                .then(
                  e => (
                    (r.rootNodeID = e.newRootNodeID),
                    this.update(r).then(t => ({ modelU: t, resultMeshNode: e }))
                  )
                );
            }
            create(e) {
              var t = null,
                n = null,
                r = null;
              return this._parseAndCreateMeshNodes(e)
                .then(e => {
                  var i = e.modelU,
                    a = e.resultMeshNode;
                  return (
                    (t = i),
                    (r = a.newGroupMeshNode),
                    (n = new _M(this.tufViewer3D)).addMeshNodesDefault(r.allIds)
                  );
                })
                .then(() => n.addMeshNodesActive(r.allIds))
                .then(() => {
                  var e = r.allIds.map(e => r.byId[e].nodeID);
                  n.addSelectableActive(e);
                })
                .then(() =>
                  1 === iM.all().allIds.length
                    ? new gM(this.tufViewer3D)
                        .setInitialCameraControlPosition()
                        .then(() =>
                          new fM(this.tufViewer3D).setInitialCameraPosition()
                        )
                    : null
                )
                .then(() => new OM(this.tufViewer3D).setGridAndAxes())
                .then(() => t);
            }
            delete(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 },
                n = null;
              return Promise.resolve(!0)
                .then(() => {
                  if (this.isModelInUse(e.id))
                    throw w.default.setStandard(
                      "Can't delete model, it's in use"
                    );
                  return (n = this.entityRepoClass.get(e.id)), !0;
                })
                .then(() => this.tufViewer3D.removeModels([n.id]))
                .then(() => {
                  var e = n.rel.meshNodes(),
                    t = new MM(this.tufViewer3D),
                    r = Object.keys(e.byId).map(t => e.byId[t]);
                  return t.deleteGroup(r);
                })
                .then(() => {
                  var e = new nM(this.tufViewer3D),
                    t = tM.get(n.assetID);
                  return !t || e.delete(t);
                })
                .then(() => super.delete(e, t))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            getBoundingBox() {
              return new Promise((e, t) => {
                for (
                  var n = {
                      max: [-1 / 0, -1 / 0, -1 / 0],
                      min: [1 / 0, 1 / 0, 1 / 0]
                    },
                    r = [],
                    i = iM.all(),
                    a = 0;
                  a < i.allIds.length;
                  a += 1
                ) {
                  var o = i.byId[i.allIds[a]].rootNodeID,
                    s = uM.getById(o);
                  r.push(this.tufViewer3D.getBoundingBox(s.nodeID));
                }
                Promise.all(r)
                  .then(t => {
                    for (var r = 0; r < t.length; r += 1) {
                      for (var i = t[r], a = 0; a < i.max.length; a += 1)
                        i.max[a] > n.max[a] && (n.max[a] = i.max[a]);
                      for (var o = 0; o < i.min.length; o += 1)
                        i.min[o] < n.min[o] && (n.min[o] = i.min[o]);
                    }
                    e(n);
                  })
                  .catch(e => {
                    t(e);
                  });
              });
            }
            isModelInUse(e) {
              var t = this.entityRepoClass.get(e).rel.meshNodes(),
                n = new MM(this.tufViewer3D),
                r = !1;
              return (
                t.allIds.forEach(e => {
                  n.isInUse(e) && (r = !0);
                }),
                r
              );
            }
          },
          OM = class extends J_ {
            constructor(e) {
              super(e, $_);
            }
            delete(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
              return Promise.resolve(!0)
                .then(() => {
                  var t = new _M(this.tufViewer3D);
                  if (t.getEntityActive("environment") === e.id)
                    throw w.default.setStandard(
                      "Can't delete environment, it's active"
                    );
                  if (t.getEntityDefault("environment") === e.id)
                    throw w.default.setStandard(
                      "Can't delete environment, it's set as default"
                    );
                  return !0;
                })
                .then(() => super.delete(e, t))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _setGridAndAxes(e) {
              return Promise.resolve(!0)
                .then(() => new _M(this.tufViewer3D).getSceneInfo())
                .then(t => {
                  var n = Math.max(...t.size),
                    r = Math.ceil(Math.log(n) / Math.LN10 + 1e-9);
                  return (
                    (r = Math.pow(10, r)),
                    (e.config.grSize = 2 * r),
                    (e.config.grDivisions = 20),
                    (e.config.axSize = r / 4),
                    super.update(e)
                  );
                });
            }
            setGridAndAxes() {
              return Promise.resolve()
                .then(() => new DM(this.tufViewer3D).getBoundingBox())
                .then(e => {
                  for (
                    var t = [], n = this.entityRepoClass.all(), r = 0;
                    r < n.allIds.length;
                    r++
                  ) {
                    var i = n.byId[n.allIds[r]];
                    t.push(this._setGridAndAxes(i, e));
                  }
                  return Promise.all(t);
                })
                .catch(e => {
                  throw e;
                });
            }
            updateLayout(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = this.entityRepoClass.get(e);
                  return this._setGridAndAxes(t);
                })
                .catch(e => {
                  throw e;
                });
            }
          };
        class CM extends H_ {
          constructor() {
            super();
          }
        }
        CM.entityClass = tt;
        var LM = CM,
          NM = class extends J_ {
            constructor(e) {
              super(e, LM);
            }
            create(e) {
              var t = new _M(this.tufViewer3D),
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  if (e.lightTypeID === re)
                    throw w.default.setStandard(
                      "Creating Ambient light is not allowed"
                    );
                  var t = {
                    nameUQ: "".concat(e.nameUQ, " - node"),
                    nodeTypeID: J,
                    parentID: null,
                    children: []
                  };
                  return new pM(this.tufViewer3D).create(t);
                })
                .then(
                  t => (
                    (r = Ot.getEntity("node", t.id)),
                    (e.nodeID = r.id),
                    super.create(e)
                  )
                )
                .then(e => ((n = Ot.getEntity("light", e.id)), !0))
                .then(() => this._setInitialLightPosition(n))
                .then(
                  () => (
                    (r.relEntityID = n.id), new pM(this.tufViewer3D).update(r)
                  )
                )
                .then(() => t.addLightsDefault([n.id]))
                .then(() => t.addLightsActive([n.id]))
                .then(() => t.addSelectableActive([n.nodeID]))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            delete(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 },
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  if ((n = this.entityRepoClass.get(e.id)).lightTypeID === re)
                    throw w.default.setStandard("Can't delete ambient light");
                  return (r = new _M(this.tufViewer3D)), !0;
                })
                .then(() => r.removeSelectableActive([n.nodeID], !0))
                .then(() => r.removeLightsActive([n.id]))
                .then(() => r.removeLightsDefault([n.id]))
                .then(() => this.tufViewer3D.removeLights([n.id]))
                .then(() => super.delete(e, t))
                .then(() => {
                  if (n.nodeID) {
                    var e = n.rel.node();
                    if (e) return new pM(this.tufViewer3D).delete(e);
                  }
                  return !0;
                })
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _setInitialLightPosition(e) {
              return Promise.resolve(!0)
                .then(() => new _M(this.tufViewer3D).getSceneInfo())
                .then(t => {
                  var n = !1;
                  return (
                    e.lightTypeID !== re &&
                      ((e.activeConfig.position = [
                        0,
                        t.box.max[1] + t.size[1],
                        0
                      ]),
                      (n = !0)),
                    (e.lightTypeID !== ee &&
                      e.lightTypeID !== te &&
                      e.lightTypeID !== ne) ||
                      ((e.activeConfig.helperSize =
                        Math.max(t.size[0], t.size[2]) / 8),
                      (n = !0)),
                    !n || super.update(e)
                  );
                });
            }
          };
        class FM extends H_ {
          constructor() {
            super();
          }
        }
        FM.entityClass = Qe;
        var kM = FM,
          UM = class extends J_ {
            constructor(e) {
              super(e, kM);
            }
            delete(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
              return Promise.resolve(!0)
                .then(() => {
                  var t = new _M(this.tufViewer3D);
                  if (t.getEntityActive("renderer") === e.id)
                    throw w.default.setStandard(
                      "Can't delete renderer, it's active"
                    );
                  if (t.getEntityDefault("renderer") === e.id)
                    throw w.default.setStandard(
                      "Can't delete renderer, it's set as default"
                    );
                  return !0;
                })
                .then(() => super.delete(e, t))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
          };
        class jM extends H_ {}
        jM.entityClass = gt;
        var BM = jM,
          zM = class extends J_ {
            constructor(e) {
              super(e, BM);
            }
            create(e) {
              var t = new _M(this.tufViewer3D),
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(() => {
                  var t = {
                    nameUQ: "".concat(e.nameUQ, " - node"),
                    nodeTypeID: K,
                    parentID: null,
                    children: []
                  };
                  return new pM(this.tufViewer3D).create(t);
                })
                .then(e => ((r = Ot.getEntity("node", e.id)), !0))
                .then(() => lM.getDefaultMaterial("Annotation-Mat", se))
                .then(
                  t => (
                    (e.materialID = t.id), (e.nodeID = r.id), super.create(e)
                  )
                )
                .then(e => ((n = this.entityRepoClass.get(e.id)), !0))
                .then(
                  () => (
                    (r.relEntityID = n.id), new pM(this.tufViewer3D).update(r)
                  )
                )
                .then(() => t.addAnnotationsDefault([n.id]))
                .then(() => t.addAnnotationsActive([n.id]))
                .then(() => t.addSelectableActive([n.nodeID], !0))
                .then(() => this._updatePosition(n))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            delete(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : { viewer3dUpdate: !0 },
                n = null,
                r = null;
              return Promise.resolve(!0)
                .then(
                  () => (
                    (n = new _M(this.tufViewer3D)),
                    (r = this.entityRepoClass.get(e.id)),
                    !0
                  )
                )
                .then(() => n.removeSelectableActive([r.nodeID], !0))
                .then(() => n.removeAnnotationsActive([r.id]))
                .then(() => n.removeAnnotationsDefault([r.id]))
                .then(() => this.tufViewer3D.removeAnnotations([r.id]))
                .then(() => super.delete(r, t))
                .then(() => {
                  var e = r.rel.node();
                  return !e || new pM(this.tufViewer3D).delete(e);
                })
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _updatePosition(e) {
              return new DM(this.tufViewer3D)
                .getBoundingBox()
                .then(t =>
                  this._getBoundingBox(e).then(e => ({
                    modelsBox: t,
                    annotationBox: e
                  }))
                )
                .then(t => {
                  for (
                    var n = t.modelsBox,
                      r = t.annotationBox,
                      i = [
                        n.max[0] - n.min[0],
                        n.max[1] - n.min[1],
                        n.max[2] - n.min[2]
                      ],
                      a = Math.min(...i),
                      o = [
                        r.max[0] - r.min[0],
                        r.max[1] - r.min[1],
                        r.max[2] - r.min[2]
                      ],
                      s = [a / o[0] / 3, a / o[1] / 3, a / o[2] / 3],
                      l = 0;
                    l < 2;
                    l += 1
                  )
                    (e.config.scale[l] = s[l]),
                      (e.activeConfig.scale[l] = s[l]);
                  for (var c = 0; c < 3; c += 1) {
                    var u = n.max[c] - (o[c] * s[c]) / 2;
                    (e.config.position[c] = Number.isNaN(u) ? n.max[c] : u),
                      (e.activeConfig.position[c] = Number.isNaN(u)
                        ? n.max[c]
                        : u);
                  }
                  return super.update(e);
                })
                .catch(e => {
                  throw e;
                });
            }
            _getBoundingBox(e) {
              return this.tufViewer3D.getBoundingBox(e.nodeID);
            }
          };
        class VM extends H_ {
          constructor() {
            super();
          }
        }
        VM.entityClass = wt;
        var GM = VM;
        class HM extends H_ {
          constructor() {
            super();
          }
        }
        HM.entityClass = At;
        var XM = HM,
          WM = class extends J_ {
            constructor(e) {
              super(e, XM);
            }
            delete(e) {
              return Promise.resolve(!0)
                .then(() => {
                  if (this.isStateInUse(e.id))
                    throw w.default.setStandard(
                      "Can't delete state, it's in use"
                    );
                  return !0;
                })
                .then(() => super.delete(e))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            isStateInUse(e) {
              var t = this.entityRepoClass.get(e),
                n = t.rel.transitions().allIds,
                r = t.relActive.transitions().allIds;
              return n.length > 0 || r.length > 0;
            }
          },
          YM = class extends J_ {
            constructor(e) {
              super(e, GM);
            }
            create(e) {
              return Promise.resolve(!0)
                .then(() => {
                  if (null === Ot.getEntity(e.entityType, e.entityID))
                    throw w.default.setStandard(
                      "Unknown transition entity type ".concat(e.entityType)
                    );
                  var t = {
                    nameUQ: e.nameUQ,
                    transitionTypeID: e.transitionTypeID,
                    targetStateID: e.targetStateID,
                    targetEntityID: e.entityID,
                    targetEntityType: e.entityType,
                    config: e.config
                  };
                  return super.create(t);
                })
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
            _entityActive(e) {
              if ("meshNode" === e.targetEntityType) return !0;
              var t = Ot.getEntity(e.targetEntityType, e.targetEntityID);
              return !!t && t.isSceneActive();
            }
            activate(e) {
              return Promise.resolve(!0).then(() => {
                var t = GM.getById(e);
                if (null === t)
                  throw w.default.setStandard("Transition not found");
                if (!this._entityActive(t))
                  throw w.default.setStandard("Target entity is not active");
                return this.tufViewer3D.activateTransition(
                  t.id,
                  t.targetEntityID,
                  t.targetEntityType,
                  t.targetStateID
                );
              });
            }
            delete(e) {
              return Promise.resolve(!0)
                .then(() => {
                  var t = e.rel.state();
                  return super.delete(e).then(() => t);
                })
                .then(e => (e ? new WM(this.tufViewer3D).delete(e) : null))
                .catch(e => {
                  throw w.default.setFatal(e, 306);
                });
            }
          },
          qM = class extends J_ {
            constructor(e) {
              super(e, W_);
            }
          };
        class QM extends H_ {
          constructor() {
            super();
          }
        }
        QM.entityClass = ht;
        var ZM = QM,
          JM = class extends J_ {
            constructor(e) {
              super(e, ZM);
            }
          },
          KM = class {
            static createService(e, t) {
              var n = null;
              switch (e) {
                case y:
                  n = new zM(t);
                  break;
                case i:
                  n = new nM(t);
                  break;
                case a:
                  n = new fM(t);
                  break;
                case x:
                  n = new gM(t);
                  break;
                case o:
                  n = new JM(t);
                  break;
                case s:
                  n = new OM(t);
                  break;
                case l:
                  n = new qM(t);
                  break;
                case c:
                  n = new NM(t);
                  break;
                case u:
                  n = new IM(t);
                  break;
                case h:
                  n = new MM(t);
                  break;
                case d:
                  n = new DM(t);
                  break;
                case p:
                  n = new UM(t);
                  break;
                case f:
                  n = new _M(t);
                  break;
                case b:
                  n = new WM(t);
                  break;
                case m:
                  n = new PM(t);
                  break;
                case g:
                  n = new YM(t);
              }
              return n;
            }
          },
          $M = "EDITOR",
          eT = "PRESENTATIONAL",
          tT = class {
            constructor() {
              (this.store = C),
                (this.tufViewer3D = new g_()),
                (this.onLoadingChanged = () => {}),
                (this.onPointerMove = () => {}),
                (this.onPointerClick = () => {});
            }
            init(e) {
              return Promise.resolve(!0)
                .then(
                  () => (
                    (this.mode = e.mode || $M),
                    (this.token = e.token || "none"),
                    (this.containerID = e.containerID),
                    (this.solution3DID = e.solution3DID),
                    (this.solution3DType = e.solution3DType
                      ? e.solution3DType
                      : "basic"),
                    (this.apiURL = e.apiURL
                      ? e.apiURL
                      : "http://platformv2.threedium.co.uk"),
                    (this.onLoadingChanged = e.onLoadingChanged || (() => {})),
                    (this.onPointerMove = e.onPointerMove || (() => {})),
                    (this.onPointerClick = e.onPointerClick || (() => {})),
                    T.create(this.token, this.apiURL, this.solution3DID),
                    !0
                  )
                )
                .catch(e => {
                  throw w.default.setStandard(e, 300);
                });
            }
            dispose() {
              return Promise.resolve(!0)
                .then(() => this.tufViewer3D.dispose())
                .catch(e => {
                  throw w.default.setStandard(e, 300);
                });
            }
            setup() {
              return Promise.resolve()
                .then(() => this.dispose())
                .then(() =>
                  KM.createService(f, this.tufViewer3D).prepareScene()
                )
                .then(() => this._setupViewer())
                .catch(e => {
                  throw w.default.setStandard(e, 300);
                });
            }
            updateEntity(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : { viewer3dUpdate: !0 };
              return Promise.resolve()
                .then(() => {
                  var n = KM.createService(e.entity, this.tufViewer3D);
                  if (null === n)
                    throw w.default.setFatal("Not supported entity", 306);
                  return n.update(e, { viewer3dUpdate: t.viewer3dUpdate });
                })
                .catch(e => {
                  throw w.default.setStandard(e, 300);
                });
            }
            _setupViewer() {
              return Promise.resolve(!0)
                .then(() => {
                  var e = W_.get(),
                    t = q_.get(),
                    n = [],
                    r = [];
                  this.mode === eT &&
                    t.editorData &&
                    t.editorData.active &&
                    ((n = t.editorData.active.models || []),
                    (r = t.editorData.active.textures || []));
                  var i = {
                    version: e.version,
                    containerID: this.containerID,
                    rendererID: t.active.rendererID,
                    cameraID: t.active.cameraID,
                    environmentID: t.active.environmentID,
                    cameras: t.active.cameras,
                    controls: t.active.controls,
                    lights: t.active.lights,
                    meshNodes: t.active.meshNodes,
                    annotations: t.active.annotations,
                    models: n,
                    textures: r,
                    TUFProvider: Ot,
                    onLoadingChanged: this._onLoadingChanged,
                    onPointerMove: this._onPointerMove,
                    onPointerClick: this._onPointerClick,
                    onEntityUpdated: this._onEntityUpdated
                  };
                  return this.tufViewer3D.init(i);
                })
                .catch(e => {
                  throw w.default.setStandard(e, 300);
                });
            }
            _onLoadingChanged(e) {
              this.onLoadingChanged(this._getLoadingData(e));
            }
            _onPointerMove(e) {
              var t = e.data.map(e => e.nodeID),
                n = 0 !== t.length ? [t[0]] : [];
              this.setHoveredNodes(n),
                this.onPointerMove(this._getPointerData(e.data));
            }
            _onPointerClick(e) {
              var t = e.data.map(e => e.nodeID),
                n = 0 !== t.length ? [t[0]] : [];
              0 === e.event.button
                ? e.event.shiftKey
                  ? this.addSelectedNodes(n)
                  : this.setSelectedNodes(n)
                : 2 === e.event.button && this.removeSelectedNodes(n),
                this.onPointerClick(this._getPointerData(e.data));
            }
            _onEntityUpdated() {
              throw w.default.standard("Abstract method call");
            }
            _getLoadingData(e) {
              return e;
            }
            _getPointerData(e) {
              return e;
            }
            setSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() =>
                  KM.createService(f, this.tufViewer3D).setSelectedNodes(e)
                )
                .catch(e => w.default.setStandard(e, 400));
            }
            addSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() =>
                  KM.createService(f, this.tufViewer3D).addSelectedNodes(e)
                )
                .catch(e => w.default.setStandard(e, 400));
            }
            removeSelectedNodes(e) {
              return Promise.resolve(!0)
                .then(() =>
                  KM.createService(f, this.tufViewer3D).removeSelectedNodes(e)
                )
                .catch(e => w.default.setStandard(e, 400));
            }
            setHoveredNodes(e) {
              return Promise.resolve(!0)
                .then(() =>
                  KM.createService(f, this.tufViewer3D).setHoveredNodes(e)
                )
                .catch(e => w.default.setStandard(e, 400));
            }
            getAssetsInfo() {
              return this.tufViewer3D.getAssetsInfo();
            }
            resetAssetsInfo() {
              return this.tufViewer3D.resetAssetsInfo();
            }
            takeSnapshot(e, t) {
              return this.tufViewer3D.getSnapshot(e, t);
            }
            reload() {
              return this.setup();
            }
            getViewer3D() {
              return this.tufViewer3D.viewer3D;
            }
          },
          nT = {
            version: "1.0.1",
            load(e, t) {
              return new Promise((n, r) => {
                T.getSolution3DById(e, t)
                  .then(e => {
                    this.setupTUF(e), n(!0);
                  })
                  .catch(e => {
                    r(e);
                  });
              });
            },
            setupTUF(e) {
              e.tuf && e.tuf.info && e.tuf.info.version === this.version
                ? ((e.tuf.info.solutionID = e.id.toString()),
                  (e.tuf.info.solutionType = e.type),
                  Object.keys(e.tuf).map(t => {
                    var n = Ot.getTUFInfoForEntity(t);
                    if (null === n) return null;
                    var r = n.model,
                      i = new N_(r, "json");
                    if (
                      (i.setExternalProviderTUF(e.tuf), r.getEntityType() === Y)
                    )
                      return (e.tuf[t] = i.parse(e.tuf[t], !0)), null;
                    for (var a = 0; a < e.tuf[t].allIds.length; a++) {
                      var o = e.tuf[t].allIds[a];
                      e.tuf[t].byId[o] = i.parse(e.tuf[t].byId[o], !0);
                    }
                  }),
                  F_(e.tuf)(C.dispatch))
                : w.default.fatal("Bad solution 3D!", 301);
            },
            loadPresentational(e, t, n, r) {
              return new Promise((i, a) => {
                T.getDistibutionInfo(e, t, n, r)
                  .then(e => {
                    T.getDistibutionTUF(e.assetURL, e.tufFile)
                      .then(t => {
                        this.setupPresentationalTUF(t, e.assetURL), i();
                      })
                      .catch(e => {
                        a(e);
                      });
                  })
                  .catch(e => {
                    a(e);
                  });
              });
            },
            setupPresentationalTUF(e, t) {
              if (e && e.info && e.info.version === this.version) {
                for (var n = 0; n < e.asset.allIds.length; n++) {
                  var r = e.asset.allIds[n];
                  (e.asset.byId[r].config.src = ""
                    .concat(t, "/")
                    .concat(e.asset.byId[r].config.src)),
                    (e.asset.byId[r].config.thumb_src = ""
                      .concat(t, "/")
                      .concat(e.asset.byId[r].config.thumb_src));
                }
                F_(e)(C.dispatch);
              } else w.default.fatal("Bad solution 3D!", 301);
            }
          },
          rT = new (class {
            create(e, t) {
              this.axiosInstance = M.a.create({
                timeout: 3e4,
                validateStatus: e => e >= 200 && e <= 299,
                baseURL: t,
                headers: { common: { Authorization: "Bearer ".concat(e) } }
              });
            }
            registerView(e) {
              return Promise.resolve(!0)
                .then(() => this.axiosInstance.get("api/aly/view/".concat(e)))
                .then(e => {
                  if (e.data.errors.length > 0) throw e.data.errors;
                  return e.data.res;
                });
            }
            registerInteraction(e, t) {
              var n = e;
              return (
                "object" == typeof e && (n = JSON.stringify(e)),
                Promise.resolve(!0)
                  .then(() =>
                    this.axiosInstance.post("api/aly/int/".concat(t), {
                      data: n
                    })
                  )
                  .then(e => {
                    if (e.data.errors.length > 0) throw e.data.errors;
                    return e.data.res;
                  })
              );
            }
          })(),
          iT = {
            viewID: null,
            registerView(e) {
              return rT
                .registerView(e)
                .then(
                  e => (
                    e.view && "" !== e.view && (this.viewID = e.view),
                    this.viewID
                  )
                )
                .catch(() => {});
            },
            registerInteraction(e) {
              return Promise.resolve()
                .then(() => {
                  if (null === this.viewID)
                    throw w.default.setStandard("not set view");
                  return rT.registerInteraction(e, this.viewID);
                })
                .catch(() => {});
            }
          },
          aT = {
            getID(e, t, n) {
              var r = C.getState();
              try {
                return void 0 === r.TUF.showData.index[e][t][n]
                  ? null
                  : r.TUF.showData.index[e][t][n];
              } catch (e) {
                return null;
              }
            }
          };
        class oT extends H_ {
          constructor() {
            super();
          }
          static create() {}
          static update() {}
          static delete() {}
        }
        oT.entityClass = je;
        var sT = oT;
        function lT(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var r = Object.getOwnPropertySymbols(e);
            t &&
              (r = r.filter(function(t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, r);
          }
          return n;
        }
        function cT(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0
                })
              : (e[t] = n),
            e
          );
        }
        function uT(e) {
          for (
            var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1;
            r < t;
            r++
          )
            n[r - 1] = arguments[r];
          var i = { action: e, data: [...n] };
          iT.registerInteraction(i);
        }
        function hT(e) {
          return /^#[0-9A-F]{6}$/i.test(e);
        }
        function dT(e) {
          if (
            !Array.isArray(e) ||
            3 !== e.length ||
            !e.every(e => !Number.isNaN(Number(e)))
          )
            throw w.default.setStandard(
              "Position must be array of numbers with 3 elements"
            );
        }
        function pT(e, t) {
          if (
            !Array.isArray(e) ||
            !e.every(e => "string" == typeof e || e instanceof String)
          )
            throw w.default.setStandard(
              "".concat(t, " must be array of strings")
            );
        }
        function fT(e, t) {
          if (!e) throw w.default.setStandard("".concat(t, " can't be empty"));
        }
        function mT(e, t) {
          if (Number(e) !== e)
            throw w.default.setStandard("".concat(t, " must be number"));
        }
        function vT(e, t) {
          return "Infinity" === e || "-Infinity" === e || mT(e, t);
        }
        t.default = class extends tT {
          constructor() {
            super(),
              (this._onLoadingChanged = this._onLoadingChanged.bind(this)),
              (this._onPointerClick = this._onPointerClick.bind(this)),
              (this._onPointerMove = this._onPointerMove.bind(this)),
              (this._onEntityUpdated = this._onEntityUpdated.bind(this));
          }
          init(e, t) {
            var n = null;
            return Promise.resolve(!0)
              .then(() =>
                super.init(
                  (function(e) {
                    for (var t = 1; t < arguments.length; t++) {
                      var n = null != arguments[t] ? arguments[t] : {};
                      t % 2
                        ? lT(Object(n), !0).forEach(function(t) {
                            cT(e, t, n[t]);
                          })
                        : Object.getOwnPropertyDescriptors
                        ? Object.defineProperties(
                            e,
                            Object.getOwnPropertyDescriptors(n)
                          )
                        : lT(Object(n)).forEach(function(t) {
                            Object.defineProperty(
                              e,
                              t,
                              Object.getOwnPropertyDescriptor(n, t)
                            );
                          });
                    }
                    return e;
                  })({}, e, {
                    apiURL: "".concat("https://dist.unlimited3d.com"),
                    mode: eT
                  })
                )
              )
              .then(
                () => (
                  rT.create(
                    this.token,
                    "".concat("https://analytics.unlimited3d.com/")
                  ),
                  (this.distID = e.distID),
                  (this.solution3DName = e.solution3DName),
                  (this.projectName = e.projectName),
                  (this.configuration = t),
                  (this.draggingStart = null),
                  (n = new Date()),
                  iT.registerView(this.distID),
                  !0
                )
              )
              .then(() => this.loadTUF())
              .then(() => this.setup())
              .then(() => {
                var e = { action: "loaded", data: [{ time: new Date() - n }] };
                return iT.registerInteraction(e), !0;
              })
              .catch(e => {
                throw w.default.setStandard(e, 300);
              });
          }
          loadTUF() {
            return Promise.resolve(!0)
              .then(() =>
                nT.loadPresentational(
                  this.solution3DID,
                  this.solution3DName,
                  this.projectName,
                  this.distID
                )
              )
              .then(() => this._loadConfiguration());
          }
          _findEntities(e, t) {
            return Promise.resolve().then(() => this._findEntitiesSync(e, t));
          }
          _findEntitiesSync(e, t) {
            var n = [];
            return (
              t.forEach(t => {
                var r =
                  "meshNode" !== e
                    ? aT.getID(e, "nameUQ", t)
                    : this._getMeshNodeID(t);
                null !== r && n.push(r);
              }),
              n
            );
          }
          _prepareSelectable(e) {
            return Promise.resolve().then(() =>
              e
                .map(e => {
                  var t = "meshNode",
                    n = this._getMeshNodeID(e);
                  return null === n &&
                    ((t = "annotation"),
                    null === (n = aT.getID(t, "nameUQ", e)))
                    ? null
                    : Ot.getEntity(t, n).nodeID;
                })
                .filter(e => null !== e)
            );
          }
          _loadSingle(e, t) {
            var n =
              arguments.length > 2 && void 0 !== arguments[2]
                ? arguments[2]
                : t;
            if (void 0 !== this.configuration[n]) {
              var r = this._findEntitiesSync(t, [this.configuration[n]]);
              if (0 === r.length)
                throw w.default.setStandard("Unknown ".concat(n));
              return (e.active["".concat(t, "ID")] = r[0]), !0;
            }
          }
          _loadGroup(e, t, n) {
            var r =
              arguments.length > 3 && void 0 !== arguments[3]
                ? arguments[3]
                : n;
            if (void 0 !== this.configuration[n]) {
              if (void 0 === this.configuration[n].override) {
                var i = this._findEntitiesSync(
                    t,
                    this.configuration[n].show || []
                  ),
                  a = this._findEntitiesSync(
                    t,
                    this.configuration[n].hide || []
                  ),
                  o = [...new Set([...e.active[r], ...i])];
                return (
                  (o = o.filter(e => !a.includes(e))), (e.active[r] = o), !0
                );
              }
              var s = this._findEntitiesSync(t, this.configuration[n].override);
              e.active[r] = s;
            }
          }
          _getGroupsChildren(e) {
            var t = [];
            return (
              e.forEach(e => {
                var n = [];
                this._getGroupChildren(e, n), t.push(...new Set(n));
              }),
              t
            );
          }
          _loadMeshNodes(e) {
            if (void 0 === this.configuration.parts) return !1;
            if (void 0 !== this.configuration.parts.override) {
              var t = this._findEntitiesSync(
                  "meshNode",
                  this.configuration.parts.override
                ),
                n = this._getGroupsChildren(t);
              return (e.active.meshNodes = n), !0;
            }
            var r = this._findEntitiesSync(
                "meshNode",
                this.configuration.parts.show || []
              ),
              i = this._getGroupsChildren(r),
              a = this._findEntitiesSync(
                "meshNode",
                this.configuration.parts.hide || []
              ),
              o = this._getGroupsChildren(a),
              s = [...new Set([...e.active.meshNodes, ...i])];
            return (
              (s = s.filter(e => !o.includes(e))), (e.active.meshNodes = s), !0
            );
          }
          _loadMaterials(e, t) {
            return Promise.resolve().then(() => {
              if (
                void 0 === this.configuration[t] ||
                void 0 === this.configuration[t].materials
              )
                return null;
              var n = [];
              return (
                Object.keys(this.configuration[t].materials).forEach(r => {
                  n.push(
                    this._changeMaterial(
                      this.configuration[t].materials[r],
                      r,
                      e,
                      { viewer3dUpdate: !1 }
                    )
                  );
                }),
                Promise.all(n)
              );
            });
          }
          _loadConfiguration() {
            var e = null;
            return Promise.resolve()
              .then(
                () => (
                  (e = q_.get()),
                  this._loadSingle(e, "camera"),
                  this._loadSingle(e, "environment", "viewport"),
                  this._loadSingle(e, "renderer", "renderer"),
                  this._loadGroup(e, "light", "lights"),
                  this._loadGroup(e, "annotation", "annotations"),
                  this._loadMeshNodes(e, "parts", "meshNodes"),
                  this.updateEntity(e, { viewer3dUpdate: !1 })
                )
              )
              .then(() => this._loadMaterials("annotation", "annotations"))
              .then(() => this._loadMaterials("meshNode", "parts"))
              .then(() => this._loadMaterialOptions("material", "materials"))
              .then(() => this._loadSwitchMaterials());
          }
          _getLoadingData(e) {
            return e.info.summary;
          }
          _getPointerData(e) {
            return this._parseSelectedAndHovered(e);
          }
          _onEntityUpdated(e) {
            if (
              (this.updateEntity(e.model, { viewer3dUpdate: !1 }),
              "controls" === e.model.entity)
            ) {
              var t = e.model,
                n = vM.getById(t.id);
              if (n && "2" === n.controlsTypeID && t.activeConfig.state)
                if ("dragging" === t.activeConfig.state)
                  this.draggingStart = new Date();
                else if ("idle" === t.activeConfig.state) {
                  var r = {
                    action: "cameraInteraction",
                    data: [{ duration: new Date() - this.draggingStart }]
                  };
                  iT.registerInteraction(r);
                }
            }
          }
          _parseEntity(e) {
            return { type: e.entity, shortName: e.nameUQ, name: e.nameUQ };
          }
          _getID(e, t) {
            var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : "nameUQ",
              r = aT.getID(e, n, t);
            if (null === r)
              throw w.default.setStandard(
                "No ".concat(e, " named: ").concat(t)
              );
            return r;
          }
          _parseSelectedAndHovered(e) {
            return e.map(e => {
              var t = Ot.getEntity(e.type, e.id, { returnType: "reference" });
              if ("meshNode" === t.entity) {
                var n = Ot.getEntity("model", t.modelID, {
                  returnType: "reference"
                }).nameUQ;
                return {
                  type: "part",
                  shortName: t.titleUQ,
                  name: "".concat(n, ":").concat(t.titleUQ)
                };
              }
              return this._parseEntity(t);
            });
          }
          _getNodeID(e) {
            var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : "meshNode",
              n = this._getMeshNodeID(e);
            return null === n ? null : Ot.getEntity(t, n).nodeID;
          }
          _getEntityFromNode(e) {
            return Ot.getEntity("node", e).rel.relEntity();
          }
          _getMeshNodeID(e) {
            var t = e.split(":"),
              n = [],
              r = t[0];
            if (1 === t.length) n = Ot.getEntityGroup("model").allIds;
            else {
              var i = aT.getID("model", "nameUQ", t[0]);
              if (null === i) return null;
              (n[0] = i), (r = t[1]);
            }
            for (var a = null, o = 0; o < n.length; o++)
              if (
                null !==
                (a = aT.getID(
                  "meshNode",
                  "modelID:titleUQ",
                  "".concat(n[o], ":").concat(r)
                ))
              )
                return a;
            return null;
          }
          getMaterial(e) {
            fT(e, "Part");
            var t = this._getMeshNodeID(e);
            if (null === t) throw w.default.setStandard("Bad part name");
            var n = Ot.getEntity("meshNode", t, { returnType: "reference" })
              .active.materialID;
            return Ot.getEntity("material", n, { returnType: "reference" })
              .nameUQ;
          }
          getAvailableMaterials() {
            return (
              uT("getAvailableMaterials"),
              Promise.resolve().then(() => {
                var e = Ot.getEntityGroup("material");
                return e.allIds.map(t => {
                  var n = e.byId[t];
                  return this._parseEntity(n);
                });
              })
            );
          }
          _loadMaterialOptions(e, t) {
            return Promise.resolve().then(() => {
              if (void 0 === this.configuration[t]) return null;
              var e = [];
              return (
                Object.keys(this.configuration[t]).forEach(n => {
                  this.configuration[t][n].color &&
                    e.push(
                      this._changeMaterialColor(
                        n,
                        this.configuration[t][n].color,
                        { viewer3dUpdate: !1 }
                      )
                    );
                }),
                Promise.all(e)
              );
            });
          }
          _loadSwitchMaterials() {
            return Promise.resolve().then(() => {
              if (void 0 === this.configuration.switchMaterials) return null;
              var e = [];
              return (
                Object.keys(this.configuration.switchMaterials).forEach(t => {
                  e.push(
                    this._switchMaterials(
                      t,
                      this.configuration.switchMaterials[t],
                      { viewer3dUpdate: !1 }
                    )
                  );
                }),
                Promise.all(e)
              );
            });
          }
          _changeMaterialColor(e, t) {
            var n =
              arguments.length > 2 && void 0 !== arguments[2]
                ? arguments[2]
                : { viewer3dUpdate: !0 };
            return Promise.resolve().then(() => {
              if (!hT(t))
                throw w.default.setStandard(
                  "Invalid color value, expected hex color"
                );
              fT(e, "Material");
              var r = this._getID("material", e),
                i = Ot.getEntity("material", r);
              if (void 0 === i.config.color)
                throw w.default.setStandard("Material doesn't have color");
              return (i.config.color = t), this.updateEntity(i, n);
            });
          }
          _changeMaterial(e, t) {
            var n =
                arguments.length > 2 && void 0 !== arguments[2]
                  ? arguments[2]
                  : "meshNode",
              r =
                arguments.length > 3 && void 0 !== arguments[3]
                  ? arguments[3]
                  : { viewer3dUpdate: !0 };
            return Promise.resolve().then(() => {
              var i = this._getID("material", t),
                a = [];
              return (
                e
                  .map(e =>
                    "meshNode" !== n
                      ? aT.getID(n, "nameUQ", e)
                      : this._getMeshNodeID(e)
                  )
                  .filter(e => null !== e)
                  .forEach(e => {
                    if ("meshNode" === n) {
                      var t = [];
                      return (
                        this._getGroupChildren(e, t),
                        void t.forEach(e => {
                          var t = Ot.getEntity("meshNode", e);
                          (t.active.materialID = i),
                            a.push(this.updateEntity(t, r));
                        })
                      );
                    }
                    var o = Ot.getEntity(n, e);
                    (o.active.materialID = i), a.push(this.updateEntity(o, r));
                  }),
                Promise.all(a)
              );
            });
          }
          changeMaterial(e, t) {
            return (
              uT("changeMaterial", { parts: e }, { material: t }),
              Promise.resolve().then(
                () => (
                  fT(t, "Material"), pT(e, "parts"), this._changeMaterial(e, t)
                )
              )
            );
          }
          changeMaterials(e) {
            return (
              uT("changeMaterials", { partObjects: e }),
              Promise.resolve().then(() => {
                var t = [];
                return (
                  e.forEach(e => {
                    t.push(this._changeMaterial(e.parts, e.material));
                  }),
                  Promise.all(t)
                );
              })
            );
          }
          applyMaterialToAllParts(e) {
            return (
              uT("applyMaterialToAllParts", { materialName: e }),
              Promise.resolve().then(() => {
                fT(e, "Material");
                var t = this._getID("material", e),
                  n = Ot.getEntityGroup("meshNode"),
                  r = [];
                return (
                  n.allIds.forEach(e => {
                    var i = n.byId[e];
                    "Mesh" === sT.get(i.meshNodeTypeID).nameUQ &&
                      ((i.active.materialID = t), r.push(this.updateEntity(i)));
                  }),
                  Promise.all(r)
                );
              })
            );
          }
          _switchMaterials(e, t) {
            var n =
              arguments.length > 2 && void 0 !== arguments[2]
                ? arguments[2]
                : { viewer3dUpdate: !0 };
            return Promise.resolve().then(() => {
              fT(e, "Old Material"), fT(t, "New Material");
              var r = this._getID("material", e),
                i = this._getID("material", t),
                a = [],
                o = Ot.getEntityGroup("meshNode");
              return (
                o.allIds.forEach(e => {
                  var t = o.byId[e];
                  "Mesh" === sT.get(t.meshNodeTypeID).nameUQ &&
                    t.active.materialID === r &&
                    ((t.active.materialID = i),
                    a.push(this.updateEntity(t, n)));
                }),
                Promise.all(a)
              );
            });
          }
          switchMaterials(e, t) {
            return (
              uT("switchMaterial", { oldMaterial: e }, { newMaterial: t }),
              this._switchMaterials(e, t)
            );
          }
          changeAnnotationMaterial(e, t) {
            return (
              uT(
                "changeAnnotationMaterial",
                { annotationNames: e },
                { materialName: t }
              ),
              Promise.resolve().then(() => {
                fT(t, "Material");
                var n = this._getID("material", t),
                  r = Ot.getEntity("material", n);
                if (Number.parseInt(r.materialTypeID, 10) !== se)
                  throw w.default.setStandard("Bad material type");
                var i = e
                    .map(e => aT.getID("annotation", "nameUQ", e))
                    .filter(e => null !== e),
                  a = [];
                return (
                  i.forEach(e => {
                    var t = Ot.getEntity("annotation", e);
                    (t.active.materialID = n), a.push(this.updateEntity(t));
                  }),
                  Promise.all(a)
                );
              })
            );
          }
          changeMaterialColor(e, t) {
            return (
              uT("changeMaterialColor", { materialName: e }, { color: t }),
              this._changeMaterialColor(e, t)
            );
          }
          changeMaterialOption(e, t) {
            uT("changeMaterialOption", { materialName: e }, { options: t });
            var n = [
              "color",
              "opacity",
              "transparent",
              "metalness",
              "roughness"
            ];
            return Promise.resolve().then(() => {
              var r = this._getID("material", e),
                i = Ot.getEntity("material", r);
              return (
                Object.keys(t).forEach(e => {
                  n.includes(e) &&
                    void 0 !== i.config[e] &&
                    (i.config[e] = t[e]);
                }),
                this.updateEntity(i)
              );
            });
          }
          hideParts(e) {
            return (
              uT("hideParts", { parts: e }),
              Promise.resolve().then(() => {
                var t = e
                  .map(e => this._getMeshNodeID(e))
                  .filter(e => null !== e);
                return new _M(this.tufViewer3D).removeMeshNodesActive(t);
              })
            );
          }
          _prepareParts(e) {
            var t =
              !(arguments.length > 1 && void 0 !== arguments[1]) ||
              arguments[1];
            return Promise.resolve().then(() => {
              for (var n = [], r = [], i = 0; i < e.length; i += 1) {
                var a = null;
                e[i].material &&
                  (a = aT.getID("material", "nameUQ", e[i].material));
                for (var o = 0; o < e[i].parts.length; o += 1) {
                  var s = this._getMeshNodeID(e[i].parts[o]);
                  if (null !== s && (n.push(s), null !== a)) {
                    var l = Ot.getEntity("meshNode", s);
                    (l.active.materialID = a),
                      r.push(this.updateEntity(l, { viewer3dUpdate: t }));
                  }
                }
              }
              return Promise.all(r).then(() => n);
            });
          }
          showParts(e) {
            return (
              uT("showParts", { partObjects: e }),
              this._prepareParts(e).then(e =>
                new _M(this.tufViewer3D).addMeshNodesActive(e)
              )
            );
          }
          showAllParts() {
            uT("showAllParts");
            var e = null;
            return Promise.resolve()
              .then(() => {
                e = new _M(this.tufViewer3D);
                var t = Ot.getSingle("scene");
                return e.removeMeshNodesActive(t.active.meshNodes);
              })
              .then(() => {
                var t = Ot.getEntityGroup("meshNode");
                return e.addMeshNodesActive(t.allIds);
              });
          }
          showOnlyParts(e) {
            uT("showOnlyParts", { partObjects: e });
            var t = null;
            return Promise.resolve()
              .then(() => this._prepareParts(e))
              .then(e => {
                t = new _M(this.tufViewer3D);
                var n = Ot.getSingle("scene");
                return t
                  .removeMeshNodesActive(n.active.meshNodes)
                  .then(() => e);
              })
              .then(e => t.addMeshNodesActive(e));
          }
          getAvailableParts() {
            return (
              uT("getAvailableParts"),
              Promise.resolve().then(() => {
                var e = Ot.getEntityGroup("meshNode");
                return e.allIds.map(t => {
                  var n = e.byId[t],
                    r = Ot.getEntity("model", n.modelID, {
                      returnType: "reference"
                    }).nameUQ;
                  return {
                    type: "part",
                    shortName: n.titleUQ,
                    name: "".concat(r, ":").concat(n.titleUQ)
                  };
                });
              })
            );
          }
          getVisibleParts() {
            return (
              uT("getVisibleParts"),
              Promise.resolve().then(() => {
                var e = Ot.getSingle("scene"),
                  t = Ot.getEntityGroup("meshNode");
                return e.active.meshNodes.map(e => {
                  var n = t.byId[e],
                    r = Ot.getEntity("model", n.modelID, {
                      returnType: "reference"
                    }).nameUQ;
                  return {
                    type: "part",
                    shortName: n.titleUQ,
                    name: "".concat(r, ":").concat(n.titleUQ)
                  };
                });
              })
            );
          }
          getHiddenParts() {
            return (
              uT("getHiddenParts"),
              Promise.resolve().then(() => {
                var e = Ot.getSingle("scene"),
                  t = Ot.getEntityGroup("meshNode"),
                  n = t.allIds,
                  r = e.active.meshNodes;
                return n
                  .filter(e => !r.includes(e))
                  .map(e => {
                    var n = t.byId[e],
                      r = Ot.getEntity("model", n.modelID, {
                        returnType: "reference"
                      }).nameUQ;
                    return {
                      type: "part",
                      shortName: n.titleUQ,
                      name: "".concat(r, ":").concat(n.titleUQ)
                    };
                  });
              })
            );
          }
          _getGroupChildren(e, t) {
            var n = Ot.getEntity("meshNode", e);
            1 === Number.parseInt(n.meshNodeTypeID, 10) && t.push(e);
            for (
              var r = Ot.getEntity("node", n.nodeID), i = 0;
              i < r.children.length;
              i += 1
            ) {
              var a = Ot.getEntity("node", r.children[i]);
              "MeshNode" === a.getType().nameUQ &&
                this._getGroupChildren(a.relEntityID, t);
            }
          }
          showGroups(e) {
            return (
              uT("showGroups", { groups: e }),
              Promise.resolve().then(() => {
                pT(e, "groups");
                var t = [];
                return (
                  e.forEach(e => {
                    var n = this._getMeshNodeID(e);
                    if (null !== n) {
                      var r = [];
                      this._getGroupChildren(n, r), t.push(...new Set(r));
                    }
                  }),
                  new _M(this.tufViewer3D).addMeshNodesActive(t)
                );
              })
            );
          }
          hideGroups(e) {
            return (
              uT("hideGroups", { groups: e }),
              Promise.resolve().then(() => {
                pT(e, "groups");
                var t = [];
                return (
                  e.forEach(e => {
                    var n = this._getMeshNodeID(e);
                    if (null !== n) {
                      var r = [];
                      this._getGroupChildren(n, r), t.push(...new Set(r));
                    }
                  }),
                  new _M(this.tufViewer3D).removeMeshNodesActive(t)
                );
              })
            );
          }
          changeGroupMaterial(e) {
            return (
              uT("changeGroupMaterial", { groupObjects: e }),
              Promise.resolve().then(() => {
                for (var t = [], n = 0; n < e.length; n += 1) {
                  var r = null;
                  e[n].material &&
                    (r = aT.getID("material", "nameUQ", e[n].material));
                  for (var i = 0; i < e[n].groups.length; i += 1) {
                    var a = this._getMeshNodeID(e[n].groups[i]);
                    if (null !== a) {
                      var o = [];
                      this._getGroupChildren(a, o);
                      for (var s = 0; s < o.length; s += 1)
                        if (null !== r) {
                          var l = Ot.getEntity("meshNode", o[s]);
                          (l.active.materialID = r),
                            t.push(this.updateEntity(l));
                        }
                    }
                  }
                }
                return Promise.all(t);
              })
            );
          }
          isPartVisible(e) {
            return (
              uT("isPartVisible", { part: e }),
              Promise.resolve().then(() => {
                fT(e, "Part");
                var t = this._getMeshNodeID(e);
                if (null === t) throw w.default.setStandard("Part not found!");
                return Ot.getSingle("scene").active.meshNodes.includes(t);
              })
            );
          }
          selectParts(e) {
            return (
              uT("selectParts", { parts: e }),
              Promise.resolve().then(() => {
                var t = e.map(e => this._getNodeID(e)).filter(e => null !== e);
                return new _M(this.tufViewer3D).setSelectedNodes(t);
              })
            );
          }
          selectAllPartsExcept(e) {
            return (
              uT("selectAllPartsExcept", { parts: e }),
              Promise.resolve().then(() => {
                var t = Ot.getEntityGroup("meshNode").allIds,
                  n = e.map(e => this._getNodeID(e)).filter(e => null !== e),
                  r = t.filter(e => !n.includes(e));
                return new _M(this.tufViewer3D).setSelectedNodes(r);
              })
            );
          }
          getSelectedParts() {
            return (
              uT("getSelectedParts"),
              Promise.resolve()
                .then(() => new _M(this.tufViewer3D).getSelectedNodes())
                .then(e =>
                  e
                    .map(e => {
                      var t = this._getEntityFromNode(e);
                      if ("meshNode" !== t.entity) return null;
                      var n = Ot.getEntity("model", t.modelID, {
                          returnType: "reference"
                        }).nameUQ,
                        r = t.titleUQ;
                      return {
                        type: "part",
                        shortName: r,
                        name: "".concat(n, ":").concat(r)
                      };
                    })
                    .filter(e => null !== e)
                )
            );
          }
          getSelectedAnnotations() {
            return (
              uT("getSelectedAnnotations"),
              Promise.resolve()
                .then(() => new _M(this.tufViewer3D).getSelectedNodes())
                .then(e =>
                  e
                    .map(e => {
                      var t = this._getEntityFromNode(e);
                      return "annotation" !== t.entity
                        ? null
                        : this._parseEntity(t);
                    })
                    .filter(e => null !== e)
                )
            );
          }
          getSelected() {
            return (
              uT("getSelected"),
              Promise.resolve()
                .then(() => new _M(this.tufViewer3D).getSelectedNodes())
                .then(e =>
                  e
                    .map(e => {
                      var t = this._getEntityFromNode(e);
                      if ("annotation" === t.entity)
                        return this._parseEntity(t);
                      if ("meshNode" === t.entity) {
                        var n = Ot.getEntity("model", t.modelID, {
                            returnType: "reference"
                          }).nameUQ,
                          r = t.titleUQ;
                        return {
                          type: "part",
                          shortName: r,
                          name: "".concat(n, ":").concat(r)
                        };
                      }
                      return null;
                    })
                    .filter(e => null !== e)
                )
            );
          }
          isPartSelected(e) {
            return (
              uT("isPartSelected", { part: e }),
              Promise.resolve()
                .then(
                  () => (
                    fT(e, "Part"), new _M(this.tufViewer3D).getSelectedNodes()
                  )
                )
                .then(t =>
                  t.some(t => {
                    var n = this._getEntityFromNode(t);
                    return (
                      "meshNode" === n.entity &&
                      Ot.getEntity("meshNode", n.id, {
                        returnType: "reference"
                      }).titleUQ === e
                    );
                  })
                )
            );
          }
          _activateOnScene(e, t) {
            return Promise.resolve().then(() => {
              fT(t, "Name");
              var n = this._getID(e, t),
                r = Ot.getSingle("scene");
              return (r.active["".concat(e, "ID")] = n), this.updateEntity(r);
            });
          }
          activateCamera(e) {
            return (
              uT("activateCamera", { name: e }),
              Promise.resolve().then(() => {
                fT(e, "Name");
                var t = this._getID("camera", e);
                return new _M(this.tufViewer3D).setCurrentCameraActive(t);
              })
            );
          }
          activateCameraControl(e) {
            uT("activateCameraControl", { name: e });
            var t = null,
              n = null;
            return Promise.resolve()
              .then(() => this._getActiveOrbitControl())
              .catch(() => null)
              .then(r => {
                if (
                  (fT(e, "Name"),
                  (n = this._getID("controls", e)),
                  "2" !== Ot.getEntity("controls", n).controlsTypeID)
                )
                  throw w.default.setStandard("Invalid control");
                return (
                  (t = new _M(this.tufViewer3D)),
                  null !== r ? t.removeControlsActive([r.id]) : null
                );
              })
              .then(() => t.addControlsActive([n]));
          }
          activateEnvironment(e) {
            return (
              uT("activateEnvironment", { name: e }),
              this._activateOnScene("environment", e)
            );
          }
          activateRenderer(e) {
            return (
              uT("activateRenderer", { name: e }),
              this._activateOnScene("renderer", e).then(() => this.setup())
            );
          }
          _isActiveOnScene(e, t) {
            return Promise.resolve().then(() => {
              fT(t, "Name");
              var n = this._getID(e, t);
              return Ot.getSingle("scene").active["".concat(e, "ID")] === n;
            });
          }
          isActiveCamera(e) {
            return (
              uT("isActiveCamera", { name: e }),
              this._isActiveOnScene("camera", e)
            );
          }
          isActiveCameraControl(e) {
            return (
              uT("isActiveCameraControl", { name: e }),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .catch(() => null)
                .then(t => {
                  fT(e, "Name");
                  var n = this._getID("controls", e);
                  if ("2" !== Ot.getEntity("controls", n).controlsTypeID)
                    throw w.default.setStandard("Invalid control");
                  return null !== t && t.id === n;
                })
            );
          }
          isActiveEnvironment(e) {
            return (
              uT("isActiveEnvironment", { name: e }),
              this._isActiveOnScene("environment", e)
            );
          }
          isActiveRenderer(e) {
            return (
              uT("isActiveRenderer", { name: e }),
              this._isActiveOnScene("renderer", e)
            );
          }
          isVisibleLight(e) {
            return (
              uT("isVisibleLight", { name: e }),
              Promise.resolve().then(() => {
                var t = Ot.getSingle("scene"),
                  n = this._getID("light", e);
                return t.active.lights.includes(n);
              })
            );
          }
          showLights(e) {
            return (
              uT("showLights", { lights: e }),
              Promise.resolve()
                .then(() => this._findEntities("light", e))
                .then(e => new _M(this.tufViewer3D).addLightsActive(e))
            );
          }
          hideLights(e) {
            return (
              uT("hideLights", { lights: e }),
              Promise.resolve()
                .then(() => this._findEntities("light", e))
                .then(e => new _M(this.tufViewer3D).removeLightsActive(e))
            );
          }
          showOnlyLights(e) {
            uT("showOnlyLights", { lights: e });
            var t = null;
            return Promise.resolve()
              .then(() => this._findEntities("light", e))
              .then(e => {
                var n = Ot.getSingle("scene");
                return (t = new _M(this.tufViewer3D))
                  .removeLightsActive(n.active.lights)
                  .then(() => e);
              })
              .then(e => t.addLightsActive(e));
          }
          _prepareAnnotations(e) {
            for (var t = [], n = [], r = 0; r < e.length; r += 1) {
              var i = null;
              e[r].material &&
                (i = aT.getID("material", "nameUQ", e[r].material));
              for (var a = 0; a < e[r].annotations.length; a += 1) {
                var o = e[r].annotations[a],
                  s = aT.getID("annotation", "nameUQ", o);
                if (null !== s && (t.push(s), null !== i)) {
                  var l = Ot.getEntity("annotation", s);
                  (l.active.materialID = i), n.push(this.updateEntity(l));
                }
              }
            }
            return Promise.all(n).then(() => t);
          }
          showAnnotations(e) {
            return (
              uT("showAnnotations", { annotationObjects: e }),
              Promise.resolve()
                .then(() => this._prepareAnnotations(e))
                .then(e => new _M(this.tufViewer3D).addAnnotationsActive(e))
            );
          }
          hideAnnotations(e) {
            return (
              uT("hideAnnotations", e),
              Promise.resolve()
                .then(() => this._findEntities("annotation", e))
                .then(e => new _M(this.tufViewer3D).removeAnnotationsActive(e))
            );
          }
          showOnlyAnnotations(e) {
            uT("showOnlyAnnotations", { annotationObjects: e });
            var t = null;
            return Promise.resolve()
              .then(() => this._prepareAnnotations(e))
              .then(e => {
                t = new _M(this.tufViewer3D);
                var n = Ot.getSingle("scene");
                return t
                  .removeAnnotationsActive(n.active.annotations)
                  .then(() => e);
              })
              .then(e => t.addAnnotationsActive(e));
          }
          getAvailableAnnotations() {
            return (
              uT("getAvailableAnnotations"),
              Promise.resolve().then(() => {
                var e = Ot.getEntityGroup("annotation");
                return e.allIds.map(t => {
                  var n = e.byId[t];
                  return this._parseEntity(n);
                });
              })
            );
          }
          getSelectable() {
            return (
              uT("getSelectable"),
              Promise.resolve().then(() =>
                q_.get().active.selectable.map(e => {
                  var t = this._getEntityFromNode(e);
                  if ("meshNode" === t.entity) {
                    var n = Ot.getEntity("model", t.modelID, {
                      returnType: "reference"
                    }).nameUQ;
                    return {
                      type: "part",
                      shortName: t.titleUQ,
                      name: "".concat(n, ":").concat(t.titleUQ)
                    };
                  }
                  return this._parseEntity(t);
                })
              )
            );
          }
          getSelectableParts() {
            return (
              uT("getSelectableParts"),
              Promise.resolve().then(() =>
                q_
                  .get()
                  .active.selectable.map(e => {
                    var t = this._getEntityFromNode(e);
                    if ("meshNode" !== t.entity) return null;
                    var n = Ot.getEntity("model", t.modelID, {
                      returnType: "reference"
                    }).nameUQ;
                    return {
                      type: "part",
                      shortName: t.titleUQ,
                      name: "".concat(n, ":").concat(t.titleUQ)
                    };
                  })
                  .filter(e => null !== e)
              )
            );
          }
          _getActiveOrbitControl() {
            return Promise.resolve().then(() => {
              var e = Ot.getSingle("scene").active.controls.reduce((e, t) => {
                var n = vM.get(t);
                return "2" === n.controlsTypeID ? n : e;
              }, null);
              if (null === e)
                throw w.default.setStandard(
                  "Not supported for current active camera"
                );
              return e;
            });
          }
          enableAutoRotate(e) {
            return (
              uT("enableAutoRotate", { enable: e }),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .then(t => ((t.config.autoRotate = e), this.updateEntity(t)))
            );
          }
          setAutoRotateSpeed(e) {
            return (
              uT("setAutoRotateSpeed", { speed: e }),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .then(
                  t => ((t.config.autoRotateSpeed = e), this.updateEntity(t))
                )
            );
          }
          getCameraPosition() {
            return (
              uT("getCameraPosition"),
              Promise.resolve().then(() => {
                var e = Ot.getSingle("scene");
                return Ot.getEntity("camera", e.active.cameraID).activeConfig
                  .position;
              })
            );
          }
          setCameraPosition(e) {
            return (
              uT("setCameraPosition", { position: e }),
              Promise.resolve().then(() => {
                dT(e);
                var t = Ot.getSingle("scene"),
                  n = Ot.getEntity("camera", t.active.cameraID);
                return (n.activeConfig.position = e), this.updateEntity(n);
              })
            );
          }
          getCameraTarget() {
            return (
              uT("getCameraTarget"),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .then(e => e.activeConfig.target)
            );
          }
          setCameraTarget(e) {
            return (
              uT("setCameraTarget", { target: e }),
              Promise.resolve()
                .then(() => (dT(e), this._getActiveOrbitControl()))
                .then(t => ((t.activeConfig.target = e), this.updateEntity(t)))
            );
          }
          activateTransition(e, t, n) {
            return (
              uT(
                "activateTransition",
                { transitionName: e },
                { targetName: t },
                { duration: n }
              ),
              Promise.resolve()
                .then(() => {
                  fT(e, "Transition");
                  var r = this._getID("transition", e),
                    i = Ot.getEntity("transition", r);
                  if ((null !== n && (i.config.duration = n), null === t))
                    return this.updateEntity(i);
                  var a = i.targetEntityType,
                    o = null;
                  if ("meshNode" === a) {
                    if (null === (o = this._getMeshNodeID(t)))
                      throw w.default.setStandard("Bad part name");
                  } else o = aT.getID(a, "nameUQ", t);
                  return (i.targetEntityID = o), this.updateEntity(i);
                })
                .then(e =>
                  this.tufViewer3D.activateTransition(
                    e.id,
                    e.targetEntityID,
                    e.targetEntityType,
                    e.targetStateID
                  )
                )
            );
          }
          resetCameraPosition(e) {
            return (
              uT("resetCameraPosition", { cameraName: e }),
              Promise.resolve().then(() => {
                fT(e, "Name");
                var t = this._getID("camera", e),
                  n = Ot.getEntity("camera", t);
                return (
                  (n.activeConfig.position = n.config.position),
                  this.updateEntity(n)
                );
              })
            );
          }
          resetCameraTarget() {
            return (
              uT("resetCameraTarget"),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .then(
                  e => (
                    (e.activeConfig.target = e.config.target),
                    this.updateEntity(e)
                  )
                )
            );
          }
          enableCameraControls(e) {
            return (
              uT("enableCameraControls", { enable: e }),
              Promise.resolve()
                .then(() => this._getActiveOrbitControl())
                .then(t => ((t.config.enabled = e), this.updateEntity(t)))
            );
          }
          updateCameraControl(e, t, n, r, i) {
            return (
              uT(
                "updateCameraControl",
                { name: e },
                { minAzimuthAngle: t },
                { maxAzimuthAngle: n },
                { minPolarAngle: r },
                { maxPolarAngle: i }
              ),
              Promise.resolve().then(() => {
                fT(e, "Name");
                var a = this._getID("controls", e),
                  o = Ot.getEntity("controls", a);
                if ("2" !== o.controlsTypeID)
                  throw w.default.setStandard("Invalid control");
                return (
                  null !== t &&
                    (vT(t, "minAzimuthAngle"), (o.config.minAzimuthAngle = t)),
                  null !== n &&
                    (vT(n, "maxAzimuthAngle"), (o.config.maxAzimuthAngle = n)),
                  null !== r &&
                    (mT(r, "minPolarAngle"), (o.config.minPolarAngle = r)),
                  null !== i &&
                    (mT(i, "maxPolarAngle"), (o.config.maxPolarAngle = i)),
                  this.updateEntity(o)
                );
              })
            );
          }
          enableObjectControl(e, t) {
            return (
              uT("enableObjectControl", { name: e }, { enable: t }),
              Promise.resolve().then(() => {
                fT(e, "name");
                var n = this._getID("controls", e);
                return t
                  ? this.tufViewer3D.activateControls(n)
                  : this.tufViewer3D.deactivateControls(n);
              })
            );
          }
          getModelPosition(e) {
            return (
              uT("getModelPosition", { name: e }),
              Promise.resolve().then(() => {
                fT(e, "name");
                var t = this._getID("model", e);
                return Ot.getEntity("model", t).rel.rootNode().activeConfig
                  .position;
              })
            );
          }
          getPartPosition(e) {
            return (
              uT("getPartPosition", { name: e }),
              Promise.resolve().then(() => {
                fT(e, "name");
                var t = this._getMeshNodeID(e);
                if (null === t) throw w.default.setStandard("Bad part name");
                return Ot.getEntity("meshNode", t).activeConfig.position;
              })
            );
          }
          getPartCenter(e) {
            return (
              uT("getPartCenter", { name: e }),
              Promise.resolve()
                .then(() => {
                  fT(e, "name");
                  var t = this._getMeshNodeID(e);
                  if (null === t) throw w.default.setStandard("Bad part name");
                  var n = Ot.getEntity("meshNode", t);
                  return this.tufViewer3D.getBoundingBox(n.nodeID);
                })
                .then(e => [
                  (e.max[0] + e.min[0]) / 2,
                  (e.max[1] + e.min[1]) / 2,
                  (e.max[2] + e.min[2]) / 2
                ])
            );
          }
          _modelsMeshNodes(e) {
            var t = [];
            return (
              e.forEach(e => {
                var n = aT.getID("model", "nameUQ", e);
                if (null !== n) {
                  var r = Ot.getEntity("model", n);
                  t.push(...r.rel.meshNodes().allIds);
                }
              }),
              t
            );
          }
          showModels(e) {
            return (
              uT("showModels", { models: e }),
              Promise.resolve().then(() => {
                pT(e, "models");
                var t = this._modelsMeshNodes(e);
                return new _M(this.tufViewer3D).addMeshNodesActive(t);
              })
            );
          }
          hideModels(e) {
            return (
              uT("hideModels", { models: e }),
              Promise.resolve().then(() => {
                pT(e, "models");
                var t = this._modelsMeshNodes(e);
                return new _M(this.tufViewer3D).removeMeshNodesActive(t);
              })
            );
          }
          showOnlyModels(e) {
            uT("showOnlyModels", { models: e });
            var t = null;
            return Promise.resolve()
              .then(() => {
                pT(e, "models");
                var n = this._modelsMeshNodes(e),
                  r = Ot.getSingle("scene");
                return (t = new _M(this.tufViewer3D))
                  .removeMeshNodesActive(r.active.meshNodes)
                  .then(() => n);
              })
              .then(e => t.addMeshNodesActive(e));
          }
          addSelectable(e) {
            return (
              uT("addSelectable", { partNames: e }),
              Promise.resolve()
                .then(() => this._prepareSelectable(e))
                .then(e => new _M(this.tufViewer3D).addSelectableActive(e))
            );
          }
          setSelectable(e) {
            uT("setSelectable", { partNames: e });
            var t = null;
            return Promise.resolve()
              .then(() => this._prepareSelectable(e))
              .then(e => {
                var n = q_.get();
                return (t = new _M(this.tufViewer3D))
                  .removeSelectableActive(n.active.selectable)
                  .then(() => e);
              })
              .then(e => t.addSelectableActive(e));
          }
          setAllSelectable() {
            return (
              uT("setAllSelectable"),
              Promise.resolve().then(() => {
                var e = [],
                  t = Ot.getEntityGroup("meshNode");
                t.allIds.forEach(n => e.push(t.byId[n].nodeID));
                var n = Ot.getEntityGroup("annotation");
                return (
                  n.allIds.forEach(t => e.push(n.byId[t].nodeID)),
                  new _M(this.tufViewer3D).addSelectableActive(e)
                );
              })
            );
          }
          getSnapshot(e, t) {
            return (
              uT("getSnapshot", { width: e }, { height: t }),
              this.tufViewer3D.getSnapshot(e, t)
            );
          }
          changeEnvironmentBackgroundColor(e, t) {
            return (
              uT(
                "changeViewportBackgroundColor",
                { environmentName: e },
                { color: t }
              ),
              Promise.resolve().then(() => {
                if (!hT(t))
                  throw w.default.setStandard(
                    "Invalid color value, expected hex color"
                  );
                fT(e, "Viewport");
                var n = this._getID("environment", e),
                  r = Ot.getEntity("environment", n);
                return (
                  (r.config.bgType = "Color"),
                  (r.config.bgColor = t),
                  this.updateEntity(r)
                );
              })
            );
          }
          setEnvironmentTransparent(e) {
            return (
              uT("setViewportTransparent", { environmentName: e }),
              Promise.resolve().then(() => {
                fT(e, "Viewport");
                var t = this._getID("environment", e),
                  n = Ot.getEntity("environment", t);
                return (n.config.bgType = "Transparent"), this.updateEntity(n);
              })
            );
          }
        };
      }
    ]).default;
  }),
  "object" == typeof exports && "object" == typeof module
    ? (module.exports = t())
    : "function" == typeof define && define.amd
    ? define([], t)
    : "object" == typeof exports
    ? (exports.Unlimited3D = t())
    : (e.Unlimited3D = t());
